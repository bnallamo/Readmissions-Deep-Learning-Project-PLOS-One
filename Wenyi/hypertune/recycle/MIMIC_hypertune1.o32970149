nyx7509
2019-03-08 01:22:01.858240: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:22:02.024090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:22:02.024139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:22:15.612461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:22:15.612527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:22:15.612540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:22:15.612910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.2 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 16s - loss: 1.1476
Epoch 2/80
 - 2s - loss: 0.2144
Epoch 3/80
 - 2s - loss: 0.1741
Epoch 4/80
 - 2s - loss: 0.1685
Epoch 5/80
 - 2s - loss: 0.1642
Epoch 6/80
 - 2s - loss: 0.1586
Epoch 7/80
 - 2s - loss: 0.1507
Epoch 8/80
 - 2s - loss: 0.1401
Epoch 9/80
 - 2s - loss: 0.1278
Epoch 10/80
 - 2s - loss: 0.1162
Epoch 11/80
 - 2s - loss: 0.1063
Epoch 12/80
 - 2s - loss: 0.0976
Epoch 13/80
 - 2s - loss: 0.0903
Epoch 14/80
 - 2s - loss: 0.0840
Epoch 15/80
 - 2s - loss: 0.0789
Epoch 16/80
 - 2s - loss: 0.0748
Epoch 17/80
 - 2s - loss: 0.0714
Epoch 18/80
 - 2s - loss: 0.0685
Epoch 19/80
 - 2s - loss: 0.0660
Epoch 20/80
 - 2s - loss: 0.0639
Epoch 21/80
 - 2s - loss: 0.0621
Epoch 22/80
 - 2s - loss: 0.0605
Epoch 23/80
 - 2s - loss: 0.0592
Epoch 24/80
 - 2s - loss: 0.0581
Epoch 25/80
 - 2s - loss: 0.0571
Epoch 26/80
 - 2s - loss: 0.0563
Epoch 27/80
 - 2s - loss: 0.0555
Epoch 28/80
 - 2s - loss: 0.0550
Epoch 29/80
 - 2s - loss: 0.0544
Epoch 30/80
 - 2s - loss: 0.0539
Epoch 31/80
 - 2s - loss: 0.0535
Epoch 32/80
 - 2s - loss: 0.0532
Epoch 33/80
 - 2s - loss: 0.0528
Epoch 34/80
 - 2s - loss: 0.0526
Epoch 35/80
 - 2s - loss: 0.0523
Epoch 36/80
 - 2s - loss: 0.0521
Epoch 37/80
 - 2s - loss: 0.0519
Epoch 38/80
 - 2s - loss: 0.0517
Epoch 39/80
 - 2s - loss: 0.0515
Epoch 40/80
 - 2s - loss: 0.0514
Epoch 41/80
 - 2s - loss: 0.0512
Epoch 42/80
 - 2s - loss: 0.0511
Epoch 43/80
 - 2s - loss: 0.0510
Epoch 44/80
 - 2s - loss: 0.0509
Epoch 45/80
 - 2s - loss: 0.0508
Epoch 46/80
 - 2s - loss: 0.0507
Epoch 47/80
 - 2s - loss: 0.0506
Epoch 48/80
 - 2s - loss: 0.0506
Epoch 49/80
 - 2s - loss: 0.0505
Epoch 50/80
 - 2s - loss: 0.0504
Epoch 51/80
 - 2s - loss: 0.0504
Epoch 52/80
 - 2s - loss: 0.0503
Epoch 53/80
 - 2s - loss: 0.0502
Epoch 54/80
 - 2s - loss: 0.0502
Epoch 55/80
 - 2s - loss: 0.0502
Epoch 56/80
 - 2s - loss: 0.0501
Epoch 57/80
 - 2s - loss: 0.0501
Epoch 58/80
 - 2s - loss: 0.0500
Epoch 59/80
 - 2s - loss: 0.0500
Epoch 60/80
 - 2s - loss: 0.0500
Epoch 61/80
 - 2s - loss: 0.0499
Epoch 62/80
 - 2s - loss: 0.0499
Epoch 63/80
 - 2s - loss: 0.0499
Epoch 64/80
 - 2s - loss: 0.0498
Epoch 65/80
 - 2s - loss: 0.0487
Epoch 66/80
 - 2s - loss: 0.0486
Epoch 67/80
 - 2s - loss: 0.0486
Epoch 68/80
 - 2s - loss: 0.0486
Epoch 69/80
 - 2s - loss: 0.0486
Epoch 70/80
 - 2s - loss: 0.0483
Epoch 71/80
 - 2s - loss: 0.0483
Epoch 72/80
 - 2s - loss: 0.0483
Epoch 73/80
 - 2s - loss: 0.0483
Epoch 74/80
 - 2s - loss: 0.0482
Epoch 75/80
 - 2s - loss: 0.0482
Epoch 76/80
 - 2s - loss: 0.0482
Epoch 77/80
 - 2s - loss: 0.0482
Epoch 78/80
 - 2s - loss: 0.0482
Epoch 79/80
 - 2s - loss: 0.0482
Epoch 80/80
 - 2s - loss: 0.0482
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.5798 - val_loss: 0.9706
AUC: 0.8095

Epoch 2/80
 - 0s - loss: 1.9131 - val_loss: 0.7841
AUC: 0.8279

Epoch 3/80
 - 0s - loss: 1.3659 - val_loss: 0.6772
AUC: 0.8328

Epoch 4/80
 - 0s - loss: 1.2136 - val_loss: 0.6326
AUC: 0.8394

Epoch 5/80
 - 0s - loss: 1.1603 - val_loss: 0.6962
AUC: 0.8459

Epoch 6/80
 - 0s - loss: 1.1207 - val_loss: 0.6490
AUC: 0.8453

Epoch 7/80
 - 0s - loss: 1.1044 - val_loss: 0.7150
AUC: 0.8504

Epoch 8/80
 - 0s - loss: 1.0774 - val_loss: 0.6502
AUC: 0.8523

Epoch 9/80
 - 0s - loss: 1.0671 - val_loss: 0.6512
AUC: 0.8525

Epoch 10/80
 - 0s - loss: 1.0536 - val_loss: 0.6263
AUC: 0.8540

Epoch 11/80
 - 0s - loss: 1.0400 - val_loss: 0.6747
AUC: 0.8560

Epoch 12/80
 - 0s - loss: 1.0407 - val_loss: 0.6730
AUC: 0.8566

Epoch 13/80
 - 0s - loss: 1.0284 - val_loss: 0.6441
AUC: 0.8595

Epoch 14/80
 - 0s - loss: 1.0294 - val_loss: 0.5899
AUC: 0.8586

Epoch 15/80
 - 0s - loss: 1.0179 - val_loss: 0.6452
AUC: 0.8589

Epoch 16/80
 - 0s - loss: 1.0153 - val_loss: 0.6267
AUC: 0.8610

Epoch 17/80
 - 0s - loss: 1.0106 - val_loss: 0.5806
AUC: 0.8600

Epoch 18/80
 - 0s - loss: 1.0054 - val_loss: 0.6196
AUC: 0.8624

Epoch 19/80
 - 0s - loss: 1.0018 - val_loss: 0.6353
AUC: 0.8630

Epoch 20/80
 - 0s - loss: 1.0030 - val_loss: 0.6439
AUC: 0.8621

Epoch 21/80
 - 0s - loss: 1.0036 - val_loss: 0.6095
AUC: 0.8615

Epoch 22/80
 - 0s - loss: 0.9995 - val_loss: 0.6037
AUC: 0.8624

Epoch 23/80
 - 0s - loss: 0.9919 - val_loss: 0.5740
AUC: 0.8628

Epoch 24/80
 - 0s - loss: 0.9916 - val_loss: 0.5921
AUC: 0.8631

Epoch 25/80
 - 0s - loss: 0.9797 - val_loss: 0.6168
AUC: 0.8635

Epoch 26/80
 - 0s - loss: 0.9843 - val_loss: 0.5562
AUC: 0.8631

Epoch 27/80
 - 0s - loss: 0.9746 - val_loss: 0.6485
AUC: 0.8643

Epoch 28/80
 - 0s - loss: 0.9718 - val_loss: 0.6474
AUC: 0.8655

Epoch 29/80
 - 0s - loss: 0.9762 - val_loss: 0.6121
AUC: 0.8649

Epoch 30/80
 - 0s - loss: 0.9736 - val_loss: 0.6375
AUC: 0.8654

Epoch 31/80
 - 0s - loss: 0.9742 - val_loss: 0.6312
AUC: 0.8646

Epoch 32/80
 - 0s - loss: 0.9688 - val_loss: 0.5857
AUC: 0.8648

Epoch 33/80
 - 0s - loss: 0.9605 - val_loss: 0.5482
AUC: 0.8656

Epoch 34/80
 - 0s - loss: 0.9623 - val_loss: 0.5989
AUC: 0.8655

Epoch 35/80
 - 0s - loss: 0.9667 - val_loss: 0.5551
AUC: 0.8640

Epoch 36/80
 - 0s - loss: 0.9585 - val_loss: 0.5968
AUC: 0.8652

Epoch 37/80
 - 0s - loss: 0.9553 - val_loss: 0.5892
AUC: 0.8654

Epoch 38/80
 - 0s - loss: 0.9558 - val_loss: 0.6087
AUC: 0.8665

Epoch 39/80
 - 0s - loss: 0.9546 - val_loss: 0.6551
AUC: 0.8656

Epoch 40/80
 - 0s - loss: 0.9507 - val_loss: 0.5705
AUC: 0.8653

Epoch 41/80
 - 0s - loss: 0.9544 - val_loss: 0.5979
AUC: 0.8672

Epoch 42/80
 - 0s - loss: 0.9442 - val_loss: 0.5742
AUC: 0.8650

Epoch 43/80
 - 0s - loss: 0.9451 - val_loss: 0.5876
AUC: 0.8666

Epoch 44/80
 - 0s - loss: 0.9368 - val_loss: 0.5676
AUC: 0.8665

Epoch 45/80
 - 0s - loss: 0.9317 - val_loss: 0.6261
AUC: 0.8672

Epoch 46/80
 - 0s - loss: 0.9332 - val_loss: 0.5897
AUC: 0.8672

Epoch 47/80
 - 0s - loss: 0.9302 - val_loss: 0.5995
AUC: 0.8666

Epoch 48/80
 - 0s - loss: 0.9312 - val_loss: 0.5944
AUC: 0.8673

Epoch 49/80
 - 0s - loss: 0.9279 - val_loss: 0.5754
AUC: 0.8669

Epoch 50/80
 - 0s - loss: 0.9292 - val_loss: 0.5601
AUC: 0.8666

Epoch 51/80
 - 0s - loss: 0.9326 - val_loss: 0.5909
AUC: 0.8668

Epoch 52/80
 - 0s - loss: 0.9271 - val_loss: 0.6004
AUC: 0.8671

Epoch 53/80
 - 0s - loss: 0.9298 - val_loss: 0.5928
AUC: 0.8670

Epoch 54/80
 - 0s - loss: 0.9286 - val_loss: 0.5809
AUC: 0.8671

Epoch 55/80
 - 0s - loss: 0.9262 - val_loss: 0.5874
AUC: 0.8671

Epoch 56/80
 - 0s - loss: 0.9276 - val_loss: 0.5899
AUC: 0.8671

Epoch 57/80
 - 0s - loss: 0.9230 - val_loss: 0.5795
AUC: 0.8670

Epoch 58/80
 - 0s - loss: 0.9262 - val_loss: 0.5799
AUC: 0.8670

Epoch 59/80
 - 0s - loss: 0.9270 - val_loss: 0.5879
AUC: 0.8671

Epoch 60/80
 - 0s - loss: 0.9253 - val_loss: 0.5840
AUC: 0.8669

Epoch 61/80
 - 0s - loss: 0.9277 - val_loss: 0.5825
AUC: 0.8670

Epoch 62/80
 - 0s - loss: 0.9252 - val_loss: 0.5923
AUC: 0.8670

Epoch 63/80
 - 0s - loss: 0.9277 - val_loss: 0.5853
AUC: 0.8670

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9282 - val_loss: 0.5740
AUC: 0.8669

Epoch 2/30
 - 0s - loss: 0.9280 - val_loss: 0.5926
AUC: 0.8671

Epoch 3/30
 - 0s - loss: 0.9283 - val_loss: 0.5766
AUC: 0.8669

Epoch 4/30
 - 0s - loss: 0.9229 - val_loss: 0.5894
AUC: 0.8670

Epoch 5/30
 - 0s - loss: 0.9218 - val_loss: 0.5849
AUC: 0.8671

Epoch 6/30
 - 0s - loss: 0.9214 - val_loss: 0.5474
AUC: 0.8669

Epoch 7/30
 - 0s - loss: 0.9207 - val_loss: 0.5777
AUC: 0.8671

Epoch 8/30
 - 0s - loss: 0.9212 - val_loss: 0.6000
AUC: 0.8670

Epoch 9/30
 - 0s - loss: 0.9227 - val_loss: 0.5618
AUC: 0.8670

Epoch 10/30
 - 0s - loss: 0.9198 - val_loss: 0.5809
AUC: 0.8674

Epoch 11/30
 - 0s - loss: 0.9193 - val_loss: 0.5728
AUC: 0.8674

Epoch 12/30
 - 0s - loss: 0.9141 - val_loss: 0.5886
AUC: 0.8674

Epoch 13/30
 - 0s - loss: 0.9175 - val_loss: 0.5765
AUC: 0.8675

Epoch 14/30
 - 0s - loss: 0.9176 - val_loss: 0.5774
AUC: 0.8674

Epoch 15/30
 - 0s - loss: 0.9089 - val_loss: 0.5807
AUC: 0.8674

Epoch 16/30
 - 0s - loss: 0.9092 - val_loss: 0.5754
AUC: 0.8674

Epoch 17/30
 - 0s - loss: 0.9117 - val_loss: 0.5826
AUC: 0.8675

Epoch 18/30
 - 0s - loss: 0.9115 - val_loss: 0.5862
AUC: 0.8675

Epoch 19/30
 - 0s - loss: 0.9114 - val_loss: 0.5846
AUC: 0.8676

Epoch 20/30
 - 0s - loss: 0.9106 - val_loss: 0.5846
AUC: 0.8675

Epoch 21/30
 - 0s - loss: 0.9106 - val_loss: 0.5816
AUC: 0.8675

Epoch 22/30
 - 0s - loss: 0.9086 - val_loss: 0.5816
AUC: 0.8676

Epoch 23/30
 - 0s - loss: 0.9077 - val_loss: 0.5775
AUC: 0.8675

Epoch 24/30
 - 0s - loss: 0.9121 - val_loss: 0.5810
AUC: 0.8676

Epoch 25/30
 - 0s - loss: 0.9079 - val_loss: 0.5776
AUC: 0.8676

Epoch 26/30
 - 0s - loss: 0.9049 - val_loss: 0.5801
AUC: 0.8676

Epoch 27/30
 - 0s - loss: 0.9089 - val_loss: 0.5792
AUC: 0.8676

Epoch 28/30
 - 0s - loss: 0.9084 - val_loss: 0.5799
AUC: 0.8677

Epoch 29/30
 - 0s - loss: 0.9045 - val_loss: 0.5790
AUC: 0.8676

Epoch 30/30
 - 0s - loss: 0.9090 - val_loss: 0.5799
Using TensorFlow backend.
AUC: 0.8676

2019-03-08 01:26:19.313459: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:26:19.484263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:26:19.484310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:26:19.784490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:26:19.784541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:26:19.784551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:26:19.784821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1663
Epoch 2/80
 - 2s - loss: 0.2189
Epoch 3/80
 - 2s - loss: 0.1689
Epoch 4/80
 - 2s - loss: 0.1548
Epoch 5/80
 - 2s - loss: 0.1427
Epoch 6/80
 - 2s - loss: 0.1333
Epoch 7/80
 - 2s - loss: 0.1253
Epoch 8/80
 - 2s - loss: 0.1179
Epoch 9/80
 - 2s - loss: 0.1107
Epoch 10/80
 - 2s - loss: 0.1039
Epoch 11/80
 - 2s - loss: 0.0975
Epoch 12/80
 - 2s - loss: 0.0917
Epoch 13/80
 - 2s - loss: 0.0866
Epoch 14/80
 - 2s - loss: 0.0822
Epoch 15/80
 - 2s - loss: 0.0784
Epoch 16/80
 - 2s - loss: 0.0750
Epoch 17/80
 - 2s - loss: 0.0718
Epoch 18/80
 - 2s - loss: 0.0691
Epoch 19/80
 - 2s - loss: 0.0666
Epoch 20/80
 - 2s - loss: 0.0643
Epoch 21/80
 - 2s - loss: 0.0624
Epoch 22/80
 - 2s - loss: 0.0607
Epoch 23/80
 - 2s - loss: 0.0593
Epoch 24/80
 - 2s - loss: 0.0581
Epoch 25/80
 - 2s - loss: 0.0571
Epoch 26/80
 - 2s - loss: 0.0562
Epoch 27/80
 - 2s - loss: 0.0555
Epoch 28/80
 - 2s - loss: 0.0548
Epoch 29/80
 - 2s - loss: 0.0543
Epoch 30/80
 - 2s - loss: 0.0538
Epoch 31/80
 - 2s - loss: 0.0534
Epoch 32/80
 - 2s - loss: 0.0531
Epoch 33/80
 - 2s - loss: 0.0528
Epoch 34/80
 - 2s - loss: 0.0525
Epoch 35/80
 - 2s - loss: 0.0522
Epoch 36/80
 - 2s - loss: 0.0520
Epoch 37/80
 - 2s - loss: 0.0518
Epoch 38/80
 - 2s - loss: 0.0517
Epoch 39/80
 - 2s - loss: 0.0515
Epoch 40/80
 - 2s - loss: 0.0514
Epoch 41/80
 - 2s - loss: 0.0512
Epoch 42/80
 - 2s - loss: 0.0511
Epoch 43/80
 - 2s - loss: 0.0510
Epoch 44/80
 - 2s - loss: 0.0509
Epoch 45/80
 - 2s - loss: 0.0508
Epoch 46/80
 - 2s - loss: 0.0508
Epoch 47/80
 - 2s - loss: 0.0507
Epoch 48/80
 - 2s - loss: 0.0506
Epoch 49/80
 - 2s - loss: 0.0505
Epoch 50/80
 - 2s - loss: 0.0505
Epoch 51/80
 - 2s - loss: 0.0504
Epoch 52/80
 - 2s - loss: 0.0504
Epoch 53/80
 - 2s - loss: 0.0503
Epoch 54/80
 - 2s - loss: 0.0503
Epoch 55/80
 - 2s - loss: 0.0502
Epoch 56/80
 - 2s - loss: 0.0502
Epoch 57/80
 - 2s - loss: 0.0501
Epoch 58/80
 - 2s - loss: 0.0501
Epoch 59/80
 - 2s - loss: 0.0501
Epoch 60/80
 - 2s - loss: 0.0500
Epoch 61/80
 - 2s - loss: 0.0500
Epoch 62/80
 - 2s - loss: 0.0500
Epoch 63/80
 - 2s - loss: 0.0500
Epoch 64/80
 - 2s - loss: 0.0488
Epoch 65/80
 - 2s - loss: 0.0487
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 01:28:49.084619: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:28:49.256008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:28:49.256086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:28:49.563789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:28:49.563850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:28:49.563872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:28:49.564170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.3 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1726
Epoch 2/80
 - 2s - loss: 0.2195
Epoch 3/80
 - 2s - loss: 0.1729
Epoch 4/80
 - 2s - loss: 0.1647
Epoch 5/80
 - 2s - loss: 0.1575
Epoch 6/80
 - 2s - loss: 0.1493
Epoch 7/80
 - 2s - loss: 0.1402
Epoch 8/80
 - 2s - loss: 0.1300
Epoch 9/80
 - 2s - loss: 0.1195
Epoch 10/80
 - 2s - loss: 0.1099
Epoch 11/80
 - 2s - loss: 0.1014
Epoch 12/80
 - 2s - loss: 0.0940
Epoch 13/80
 - 2s - loss: 0.0876
Epoch 14/80
 - 2s - loss: 0.0823
Epoch 15/80
 - 2s - loss: 0.0779
Epoch 16/80
 - 2s - loss: 0.0743
Epoch 17/80
 - 2s - loss: 0.0712
Epoch 18/80
 - 2s - loss: 0.0685
Epoch 19/80
 - 2s - loss: 0.0661
Epoch 20/80
 - 2s - loss: 0.0640
Epoch 21/80
 - 2s - loss: 0.0622
Epoch 22/80
 - 2s - loss: 0.0607
Epoch 23/80
 - 2s - loss: 0.0594
Epoch 24/80
 - 2s - loss: 0.0582
Epoch 25/80
 - 2s - loss: 0.0573
Epoch 26/80
 - 2s - loss: 0.0565
Epoch 27/80
 - 2s - loss: 0.0558
Epoch 28/80
 - 2s - loss: 0.0552
Epoch 29/80
 - 2s - loss: 0.0546
Epoch 30/80
 - 2s - loss: 0.0542
Epoch 31/80
 - 2s - loss: 0.0538
Epoch 32/80
 - 2s - loss: 0.0534
Epoch 33/80
 - 2s - loss: 0.0531
Epoch 34/80
 - 2s - loss: 0.0528
Epoch 35/80
 - 2s - loss: 0.0526
Epoch 36/80
 - 2s - loss: 0.0524
Epoch 37/80
 - 2s - loss: 0.0522
Epoch 38/80
 - 2s - loss: 0.0520
Epoch 39/80
 - 2s - loss: 0.0519
Epoch 40/80
 - 2s - loss: 0.0517
Epoch 41/80
 - 2s - loss: 0.0516
Epoch 42/80
 - 2s - loss: 0.0515
Epoch 43/80
 - 2s - loss: 0.0514
Epoch 44/80
 - 2s - loss: 0.0513
Epoch 45/80
 - 2s - loss: 0.0512
Epoch 46/80
 - 2s - loss: 0.0511
Epoch 47/80
 - 2s - loss: 0.0510
Epoch 48/80
 - 2s - loss: 0.0509
Epoch 49/80
 - 2s - loss: 0.0508
Epoch 50/80
 - 2s - loss: 0.0508
Epoch 51/80
 - 2s - loss: 0.0507
Epoch 52/80
 - 2s - loss: 0.0507
Epoch 53/80
 - 2s - loss: 0.0506
Epoch 54/80
 - 2s - loss: 0.0506
Epoch 55/80
 - 2s - loss: 0.0505
Epoch 56/80
 - 2s - loss: 0.0505
Epoch 57/80
 - 2s - loss: 0.0504
Epoch 58/80
 - 2s - loss: 0.0504
Epoch 59/80
 - 2s - loss: 0.0504
Epoch 60/80
 - 2s - loss: 0.0503
Epoch 61/80
 - 2s - loss: 0.0503
Epoch 62/80
 - 2s - loss: 0.0492
Epoch 63/80
 - 2s - loss: 0.0491
Epoch 64/80
 - 2s - loss: 0.0490
Epoch 65/80
 - 2s - loss: 0.0490
Epoch 66/80
 - 2s - loss: 0.0490
Epoch 67/80
 - 2s - loss: 0.0487
Epoch 68/80
 - 2s - loss: 0.0487
Epoch 69/80
 - 2s - loss: 0.0487
Epoch 70/80
 - 2s - loss: 0.0487
Epoch 71/80
 - 2s - loss: 0.0487
Epoch 72/80
 - 2s - loss: 0.0487
Epoch 73/80
 - 2s - loss: 0.0487
Epoch 74/80
 - 2s - loss: 0.0487
Epoch 75/80
 - 2s - loss: 0.0487
Epoch 76/80
 - 2s - loss: 0.0487
Epoch 77/80
 - 2s - loss: 0.0487
Epoch 78/80
 - 2s - loss: 0.0487
Epoch 79/80
 - 2s - loss: 0.0487
Epoch 80/80
 - 2s - loss: 0.0487
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 108, in train_glove
    model.load_weights(cache_path+'glove_temp.h5')
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1161, in load_weights
    f, self.layers, reshape=reshape)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/saving.py", line 891, in load_weights_from_hdf5_group
    g = f[name]
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/group.py", line 177, in __getitem__
    oid = h5o.open(self.id, self._e(name), lapl=self._lapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5o.pyx", line 190, in h5py.h5o.open
KeyError: 'Unable to open object (unable to determine object type)'
2019-03-08 01:31:46.070560: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:31:46.235498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:31:46.235544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:31:46.534429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:31:46.534483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:31:46.534492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:31:46.534765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1007
Epoch 2/80
 - 2s - loss: 0.1963
Epoch 3/80
 - 2s - loss: 0.1670
Epoch 4/80
 - 2s - loss: 0.1549
Epoch 5/80
 - 2s - loss: 0.1398
Epoch 6/80
 - 2s - loss: 0.1248
Epoch 7/80
 - 2s - loss: 0.1137
Epoch 8/80
 - 2s - loss: 0.1047
Epoch 9/80
 - 2s - loss: 0.0963
Epoch 10/80
 - 2s - loss: 0.0886
Epoch 11/80
 - 2s - loss: 0.0820
Epoch 12/80
 - 2s - loss: 0.0765
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 01:32:32.496526: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:32:32.663154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:32:32.663193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:32:32.963709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:32:32.963766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:32:32.963775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:32:32.964040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0750
Epoch 2/80
 - 2s - loss: 0.1955
Epoch 3/80
 - 2s - loss: 0.1641
Epoch 4/80
 - 2s - loss: 0.1486
Epoch 5/80
 - 2s - loss: 0.1356
Epoch 6/80
 - 2s - loss: 0.1254
Epoch 7/80
 - 2s - loss: 0.1160
Epoch 8/80
 - 2s - loss: 0.1067
Epoch 9/80
 - 2s - loss: 0.0979
Epoch 10/80
 - 2s - loss: 0.0900
Epoch 11/80
 - 2s - loss: 0.0831
Epoch 12/80
 - 2s - loss: 0.0772
Epoch 13/80
 - 2s - loss: 0.0722
Epoch 14/80
 - 2s - loss: 0.0679
Epoch 15/80
 - 2s - loss: 0.0644
Epoch 16/80
 - 2s - loss: 0.0615
Epoch 17/80
 - 2s - loss: 0.0591
Epoch 18/80
 - 2s - loss: 0.0571
Epoch 19/80
 - 2s - loss: 0.0553
Epoch 20/80
 - 2s - loss: 0.0538
Epoch 21/80
 - 2s - loss: 0.0526
Epoch 22/80
 - 2s - loss: 0.0514
Epoch 23/80
 - 2s - loss: 0.0504
Epoch 24/80
 - 2s - loss: 0.0496
Epoch 25/80
 - 2s - loss: 0.0489
Epoch 26/80
 - 2s - loss: 0.0483
Epoch 27/80
 - 2s - loss: 0.0477
Epoch 28/80
 - 2s - loss: 0.0472
Epoch 29/80
 - 2s - loss: 0.0468
Epoch 30/80
 - 2s - loss: 0.0465
Epoch 31/80
 - 2s - loss: 0.0462
Epoch 32/80
 - 2s - loss: 0.0459
Epoch 33/80
 - 2s - loss: 0.0457
Epoch 34/80
 - 2s - loss: 0.0455
Epoch 35/80
 - 2s - loss: 0.0453
Epoch 36/80
 - 2s - loss: 0.0451
Epoch 37/80
 - 2s - loss: 0.0449
Epoch 38/80
 - 2s - loss: 0.0448
Epoch 39/80
 - 2s - loss: 0.0447
Epoch 40/80
 - 2s - loss: 0.0446
Epoch 41/80
 - 2s - loss: 0.0445
Epoch 42/80
 - 2s - loss: 0.0444
Epoch 43/80
 - 2s - loss: 0.0443
Epoch 44/80
 - 2s - loss: 0.0442
Epoch 45/80
 - 2s - loss: 0.0441
Epoch 46/80
 - 2s - loss: 0.0441
Epoch 47/80
 - 2s - loss: 0.0440
Epoch 48/80
 - 2s - loss: 0.0440
Epoch 49/80
 - 2s - loss: 0.0439
Epoch 50/80
 - 2s - loss: 0.0439
Epoch 51/80
 - 2s - loss: 0.0438
Epoch 52/80
 - 2s - loss: 0.0438
Epoch 53/80
 - 2s - loss: 0.0437
Epoch 54/80
 - 2s - loss: 0.0437
Epoch 55/80
 - 2s - loss: 0.0436
Epoch 56/80
 - 2s - loss: 0.0436
Epoch 57/80
 - 2s - loss: 0.0436
Epoch 58/80
 - 2s - loss: 0.0436
Epoch 59/80
 - 2s - loss: 0.0435
Epoch 60/80
 - 2s - loss: 0.0423
Epoch 61/80
 - 2s - loss: 0.0421
Epoch 62/80
 - 2s - loss: 0.0421
Epoch 63/80
 - 2s - loss: 0.0421
Epoch 64/80
 - 2s - loss: 0.0421
Epoch 65/80
 - 2s - loss: 0.0418
Epoch 66/80
 - 2s - loss: 0.0418
Epoch 67/80
 - 2s - loss: 0.0418
Epoch 68/80
 - 2s - loss: 0.0418
Epoch 69/80
 - 2s - loss: 0.0417
Epoch 70/80
 - 2s - loss: 0.0417
Epoch 71/80
 - 2s - loss: 0.0417
Epoch 72/80
 - 2s - loss: 0.0417
Epoch 73/80
 - 2s - loss: 0.0417
Epoch 74/80
 - 2s - loss: 0.0417
Epoch 75/80
 - 2s - loss: 0.0417
Epoch 76/80
 - 2s - loss: 0.0417
Epoch 77/80
 - 2s - loss: 0.0417
Epoch 78/80
 - 2s - loss: 0.0417
Epoch 79/80
 - 2s - loss: 0.0417
Epoch 80/80
 - 2s - loss: 0.0417
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.8412 - val_loss: 0.8753
AUC: 0.8269

Epoch 2/80
 - 0s - loss: 1.5541 - val_loss: 0.7988
AUC: 0.8448

Epoch 3/80
 - 0s - loss: 1.2162 - val_loss: 0.6696
AUC: 0.8476

Epoch 4/80
 - 0s - loss: 1.1536 - val_loss: 0.6365
AUC: 0.8518

Epoch 5/80
 - 0s - loss: 1.1246 - val_loss: 0.6870
AUC: 0.8551

Epoch 6/80
 - 0s - loss: 1.1040 - val_loss: 0.6634
AUC: 0.8599

Epoch 7/80
 - 0s - loss: 1.0842 - val_loss: 0.7101
AUC: 0.8610

Epoch 8/80
 - 0s - loss: 1.0725 - val_loss: 0.6046
AUC: 0.8612

Epoch 9/80
 - 0s - loss: 1.0630 - val_loss: 0.6896
AUC: 0.8640

Epoch 10/80
 - 0s - loss: 1.0538 - val_loss: 0.5834
AUC: 0.8633

Epoch 11/80
 - 0s - loss: 1.0406 - val_loss: 0.6573
AUC: 0.8661

Epoch 12/80
 - 0s - loss: 1.0432 - val_loss: 0.5885
AUC: 0.8648

Epoch 13/80
 - 0s - loss: 1.0322 - val_loss: 0.6566
AUC: 0.8667

Epoch 14/80
 - 0s - loss: 1.0275 - val_loss: 0.6203
AUC: 0.8662

Epoch 15/80
 - 0s - loss: 1.0174 - val_loss: 0.6162
AUC: 0.8674

Epoch 16/80
 - 0s - loss: 1.0156 - val_loss: 0.6175
AUC: 0.8692

Epoch 17/80
 - 0s - loss: 1.0103 - val_loss: 0.6148
AUC: 0.8683

Epoch 18/80
 - 0s - loss: 1.0045 - val_loss: 0.6124
AUC: 0.8686

Epoch 19/80
 - 0s - loss: 1.0006 - val_loss: 0.6182
AUC: 0.8694

Epoch 20/80
 - 0s - loss: 1.0058 - val_loss: 0.6372
AUC: 0.8713

Epoch 21/80
 - 0s - loss: 0.9901 - val_loss: 0.6033
AUC: 0.8710

Epoch 22/80
 - 0s - loss: 0.9866 - val_loss: 0.6050
AUC: 0.8711

Epoch 23/80
 - 0s - loss: 0.9847 - val_loss: 0.6116
AUC: 0.8714

Epoch 24/80
 - 0s - loss: 0.9879 - val_loss: 0.6044
AUC: 0.8713

Epoch 25/80
 - 0s - loss: 0.9851 - val_loss: 0.5771
AUC: 0.8708

Epoch 26/80
 - 0s - loss: 0.9808 - val_loss: 0.5914
AUC: 0.8713

Epoch 27/80
 - 0s - loss: 0.9848 - val_loss: 0.5829
AUC: 0.8713

Epoch 28/80
 - 0s - loss: 0.9839 - val_loss: 0.5983
AUC: 0.8716

Epoch 29/80
 - 0s - loss: 0.9866 - val_loss: 0.5886
AUC: 0.8714

Epoch 30/80
 - 0s - loss: 0.9793 - val_loss: 0.5968
AUC: 0.8719

Epoch 31/80
 - 0s - loss: 0.9757 - val_loss: 0.5863
AUC: 0.8717

Epoch 32/80
 - 0s - loss: 0.9785 - val_loss: 0.5815
AUC: 0.8718

Epoch 33/80
 - 0s - loss: 0.9740 - val_loss: 0.5935
AUC: 0.8720

Epoch 34/80
 - 0s - loss: 0.9740 - val_loss: 0.5869
AUC: 0.8718

Epoch 35/80
 - 0s - loss: 0.9736 - val_loss: 0.5979
AUC: 0.8722

Epoch 36/80
 - 0s - loss: 0.9792 - val_loss: 0.5934
AUC: 0.8721

Epoch 37/80
 - 0s - loss: 0.9761 - val_loss: 0.5797
AUC: 0.8719

Epoch 38/80
 - 0s - loss: 0.9664 - val_loss: 0.5898
AUC: 0.8721

Epoch 39/80
 - 0s - loss: 0.9773 - val_loss: 0.5884
AUC: 0.8721

Epoch 40/80
 - 0s - loss: 0.9719 - val_loss: 0.5993
AUC: 0.8723

Epoch 41/80
 - 0s - loss: 0.9712 - val_loss: 0.5884
AUC: 0.8721

Epoch 42/80
 - 0s - loss: 0.9698 - val_loss: 0.5922
AUC: 0.8721

Epoch 43/80
 - 0s - loss: 0.9703 - val_loss: 0.5877
AUC: 0.8721

Epoch 44/80
 - 0s - loss: 0.9737 - val_loss: 0.5897
AUC: 0.8721

Epoch 45/80
 - 0s - loss: 0.9704 - val_loss: 0.5865
AUC: 0.8721

Epoch 46/80
 - 0s - loss: 0.9731 - val_loss: 0.5881
AUC: 0.8721

Epoch 47/80
 - 0s - loss: 0.9739 - val_loss: 0.5874
AUC: 0.8721

Epoch 48/80
 - 0s - loss: 0.9710 - val_loss: 0.5908
AUC: 0.8721

Epoch 49/80
 - 0s - loss: 0.9746 - val_loss: 0.5903
AUC: 0.8721

Epoch 50/80
 - 0s - loss: 0.9690 - val_loss: 0.5888
AUC: 0.8721

Epoch 51/80
 - 0s - loss: 0.9721 - val_loss: 0.5893
AUC: 0.8721

Epoch 52/80
 - 0s - loss: 0.9711 - val_loss: 0.5883
AUC: 0.8721

Epoch 53/80
 - 0s - loss: 0.9723 - val_loss: 0.5892
AUC: 0.8721

Epoch 54/80
 - 0s - loss: 0.9752 - val_loss: 0.5874
AUC: 0.8721

Epoch 55/80
 - 0s - loss: 0.9660 - val_loss: 0.5887
AUC: 0.8721

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9738 - val_loss: 0.6007
AUC: 0.8721

Epoch 2/30
 - 0s - loss: 0.9761 - val_loss: 0.5784
AUC: 0.8720

Epoch 3/30
 - 0s - loss: 0.9659 - val_loss: 0.5747
AUC: 0.8721

Epoch 4/30
 - 0s - loss: 0.9686 - val_loss: 0.5894
AUC: 0.8724

Epoch 5/30
 - 0s - loss: 0.9640 - val_loss: 0.5707
AUC: 0.8722

Epoch 6/30
 - 0s - loss: 0.9650 - val_loss: 0.5628
AUC: 0.8722

Epoch 7/30
 - 0s - loss: 0.9583 - val_loss: 0.5844
AUC: 0.8726

Epoch 8/30
 - 0s - loss: 0.9630 - val_loss: 0.6114
AUC: 0.8730

Epoch 9/30
 - 0s - loss: 0.9576 - val_loss: 0.6028
AUC: 0.8732

Epoch 10/30
 - 0s - loss: 0.9611 - val_loss: 0.5786
AUC: 0.8728

Epoch 11/30
 - 0s - loss: 0.9590 - val_loss: 0.5902
AUC: 0.8730

Epoch 12/30
 - 0s - loss: 0.9613 - val_loss: 0.5776
AUC: 0.8729

Epoch 13/30
 - 0s - loss: 0.9577 - val_loss: 0.5868
AUC: 0.8731

Epoch 14/30
 - 0s - loss: 0.9536 - val_loss: 0.5685
AUC: 0.8729

Epoch 15/30
 - 0s - loss: 0.9546 - val_loss: 0.5890
AUC: 0.8734

Epoch 16/30
 - 0s - loss: 0.9538 - val_loss: 0.5919
AUC: 0.8735

Epoch 17/30
 - 0s - loss: 0.9532 - val_loss: 0.5778
AUC: 0.8733

Epoch 18/30
 - 0s - loss: 0.9531 - val_loss: 0.5825
AUC: 0.8734

Epoch 19/30
 - 0s - loss: 0.9518 - val_loss: 0.5803
AUC: 0.8734

Epoch 20/30
 - 0s - loss: 0.9443 - val_loss: 0.5791
AUC: 0.8734

Epoch 21/30
 - 0s - loss: 0.9438 - val_loss: 0.5761
AUC: 0.8733

Epoch 22/30
 - 0s - loss: 0.9413 - val_loss: 0.5794
AUC: 0.8733

Epoch 23/30
 - 0s - loss: 0.9515 - val_loss: 0.5843
AUC: 0.8735

Epoch 24/30
 - 0s - loss: 0.9525 - val_loss: 0.5793
AUC: 0.8734

Epoch 25/30
 - 0s - loss: 0.9499 - val_loss: 0.5824
AUC: 0.8735

Epoch 26/30
 - 0s - loss: 0.9465 - val_loss: 0.5804
AUC: 0.8734

Epoch 27/30
 - 0s - loss: 0.9418 - val_loss: 0.5779
AUC: 0.8734

Epoch 28/30
 - 0s - loss: 0.9460 - val_loss: 0.5777
AUC: 0.8734

Epoch 29/30
 - 0s - loss: 0.9429 - val_loss: 0.5781
AUC: 0.8734

Epoch 30/30
 - 0s - loss: 0.9478 - val_loss: 0.5777
Using TensorFlow backend.
AUC: 0.8734

2019-03-08 01:36:29.600006: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:36:29.767239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:36:29.767285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:36:30.070162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:36:30.070218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:36:30.070227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:36:30.070495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0737
Epoch 2/80
 - 2s - loss: 0.1964
Epoch 3/80
 - 2s - loss: 0.1697
Epoch 4/80
 - 2s - loss: 0.1607
Epoch 5/80
 - 2s - loss: 0.1494
Epoch 6/80
 - 2s - loss: 0.1357
Epoch 7/80
 - 2s - loss: 0.1226
Epoch 8/80
 - 2s - loss: 0.1107
Epoch 9/80
 - 2s - loss: 0.1005
Epoch 10/80
 - 2s - loss: 0.0922
Epoch 11/80
 - 2s - loss: 0.0854
Epoch 12/80
 - 2s - loss: 0.0794
Epoch 13/80
 - 2s - loss: 0.0740
Epoch 14/80
 - 2s - loss: 0.0693
Epoch 15/80
 - 2s - loss: 0.0654
Epoch 16/80
 - 2s - loss: 0.0622
Epoch 17/80
 - 2s - loss: 0.0597
Epoch 18/80
 - 2s - loss: 0.0576
Epoch 19/80
 - 2s - loss: 0.0558
Epoch 20/80
 - 2s - loss: 0.0544
Epoch 21/80
 - 2s - loss: 0.0531
Epoch 22/80
 - 2s - loss: 0.0520
Epoch 23/80
 - 2s - loss: 0.0510
Epoch 24/80
 - 2s - loss: 0.0501
Epoch 25/80
 - 2s - loss: 0.0494
Epoch 26/80
 - 2s - loss: 0.0487
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 01:37:43.779071: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:37:43.946949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:37:43.946995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:37:44.252069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:37:44.252126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:37:44.252145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:37:44.252424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0792
Epoch 2/80
 - 2s - loss: 0.1966
Epoch 3/80
 - 2s - loss: 0.1681
Epoch 4/80
 - 2s - loss: 0.1576
Epoch 5/80
 - 2s - loss: 0.1446
Epoch 6/80
 - 2s - loss: 0.1299
Epoch 7/80
 - 2s - loss: 0.1171
Epoch 8/80
 - 2s - loss: 0.1060
Epoch 9/80
 - 2s - loss: 0.0966
Epoch 10/80
 - 2s - loss: 0.0890
Epoch 11/80
 - 2s - loss: 0.0828
Epoch 12/80
 - 2s - loss: 0.0774
Epoch 13/80
 - 2s - loss: 0.0727
Epoch 14/80
 - 2s - loss: 0.0686
Epoch 15/80
 - 2s - loss: 0.0652
Epoch 16/80
 - 2s - loss: 0.0623
Epoch 17/80
 - 2s - loss: 0.0598
Epoch 18/80
 - 2s - loss: 0.0577
Epoch 19/80
 - 2s - loss: 0.0559
Epoch 20/80
 - 2s - loss: 0.0543
Epoch 21/80
 - 2s - loss: 0.0529
Epoch 22/80
 - 2s - loss: 0.0518
Epoch 23/80
 - 2s - loss: 0.0507
Epoch 24/80
 - 2s - loss: 0.0498
Epoch 25/80
 - 2s - loss: 0.0491
Epoch 26/80
 - 2s - loss: 0.0484
Epoch 27/80
 - 2s - loss: 0.0479
Epoch 28/80
 - 2s - loss: 0.0474
Epoch 29/80
 - 2s - loss: 0.0470
Epoch 30/80
 - 2s - loss: 0.0466
Epoch 31/80
 - 2s - loss: 0.0463
Epoch 32/80
 - 2s - loss: 0.0460
Epoch 33/80
 - 2s - loss: 0.0458
Epoch 34/80
 - 2s - loss: 0.0456
Epoch 35/80
 - 2s - loss: 0.0454
Epoch 36/80
 - 2s - loss: 0.0452
Epoch 37/80
 - 2s - loss: 0.0451
Epoch 38/80
 - 2s - loss: 0.0449
Epoch 39/80
 - 2s - loss: 0.0448
Epoch 40/80
 - 2s - loss: 0.0447
Epoch 41/80
 - 2s - loss: 0.0446
Epoch 42/80
 - 2s - loss: 0.0445
Epoch 43/80
 - 2s - loss: 0.0444
Epoch 44/80
 - 2s - loss: 0.0443
Epoch 45/80
 - 2s - loss: 0.0442
Epoch 46/80
 - 2s - loss: 0.0442
Epoch 47/80
 - 2s - loss: 0.0441
Epoch 48/80
 - 2s - loss: 0.0441
Epoch 49/80
 - 2s - loss: 0.0440
Epoch 50/80
 - 2s - loss: 0.0440
Epoch 51/80
 - 2s - loss: 0.0439
Epoch 52/80
 - 2s - loss: 0.0439
Epoch 53/80
 - 2s - loss: 0.0438
Epoch 54/80
 - 2s - loss: 0.0438
Epoch 55/80
 - 2s - loss: 0.0437
Epoch 56/80
 - 2s - loss: 0.0437
Epoch 57/80
 - 2s - loss: 0.0437
Epoch 58/80
 - 2s - loss: 0.0436
Epoch 59/80
 - 2s - loss: 0.0424
Epoch 60/80
 - 2s - loss: 0.0422
Epoch 61/80
 - 2s - loss: 0.0422
Epoch 62/80
 - 2s - loss: 0.0422
Epoch 63/80
 - 2s - loss: 0.0422
Epoch 64/80
 - 2s - loss: 0.0419
Epoch 65/80
 - 2s - loss: 0.0419
Epoch 66/80
 - 2s - loss: 0.0419
Epoch 67/80
 - 2s - loss: 0.0419
Epoch 68/80
 - 2s - loss: 0.0418
Epoch 69/80
 - 2s - loss: 0.0418
Epoch 70/80
 - 2s - loss: 0.0418
Epoch 71/80
 - 2s - loss: 0.0418
Epoch 72/80
 - 2s - loss: 0.0418
Epoch 73/80
 - 2s - loss: 0.0418
Epoch 74/80
 - 2s - loss: 0.0418
Epoch 75/80
 - 2s - loss: 0.0418
Epoch 76/80
 - 2s - loss: 0.0418
Epoch 77/80
 - 2s - loss: 0.0418
Epoch 78/80
 - 2s - loss: 0.0418
Epoch 79/80
 - 2s - loss: 0.0418
Epoch 80/80
 - 2s - loss: 0.0418
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.6301 - val_loss: 1.6339
AUC: 0.8011

Epoch 2/80
 - 0s - loss: 2.8648 - val_loss: 1.0806
AUC: 0.8265

Epoch 3/80
 - 0s - loss: 1.7504 - val_loss: 0.8190
AUC: 0.8358

Epoch 4/80
 - 0s - loss: 1.3480 - val_loss: 0.7365
AUC: 0.8384

Epoch 5/80
 - 0s - loss: 1.2000 - val_loss: 0.7573
AUC: 0.8438

Epoch 6/80
 - 0s - loss: 1.1486 - val_loss: 0.6300
AUC: 0.8455

Epoch 7/80
 - 0s - loss: 1.1153 - val_loss: 0.6379
AUC: 0.8487

Epoch 8/80
 - 0s - loss: 1.0986 - val_loss: 0.6678
AUC: 0.8511

Epoch 9/80
 - 0s - loss: 1.0844 - val_loss: 0.6496
AUC: 0.8526

Epoch 10/80
 - 0s - loss: 1.0667 - val_loss: 0.6031
AUC: 0.8532

Epoch 11/80
 - 0s - loss: 1.0598 - val_loss: 0.6192
AUC: 0.8547

Epoch 12/80
 - 0s - loss: 1.0575 - val_loss: 0.6556
AUC: 0.8553

Epoch 13/80
 - 0s - loss: 1.0512 - val_loss: 0.6525
AUC: 0.8579

Epoch 14/80
 - 0s - loss: 1.0450 - val_loss: 0.6471
AUC: 0.8590

Epoch 15/80
 - 0s - loss: 1.0364 - val_loss: 0.6703
AUC: 0.8590

Epoch 16/80
 - 0s - loss: 1.0355 - val_loss: 0.6086
AUC: 0.8592

Epoch 17/80
 - 0s - loss: 1.0303 - val_loss: 0.6689
AUC: 0.8614

Epoch 18/80
 - 0s - loss: 1.0294 - val_loss: 0.6083
AUC: 0.8600

Epoch 19/80
 - 0s - loss: 1.0199 - val_loss: 0.5898
AUC: 0.8604

Epoch 20/80
 - 0s - loss: 1.0218 - val_loss: 0.6617
AUC: 0.8617

Epoch 21/80
 - 0s - loss: 1.0160 - val_loss: 0.5930
AUC: 0.8608

Epoch 22/80
 - 0s - loss: 1.0111 - val_loss: 0.6625
AUC: 0.8633

Epoch 23/80
 - 0s - loss: 1.0085 - val_loss: 0.6371
AUC: 0.8605

Epoch 24/80
 - 0s - loss: 1.0097 - val_loss: 0.5970
AUC: 0.8633

Epoch 25/80
 - 0s - loss: 1.0059 - val_loss: 0.6139
AUC: 0.8634

Epoch 26/80
 - 0s - loss: 1.0002 - val_loss: 0.6010
AUC: 0.8635

Epoch 27/80
 - 0s - loss: 1.0019 - val_loss: 0.6170
AUC: 0.8646

Epoch 28/80
 - 0s - loss: 1.0003 - val_loss: 0.6185
AUC: 0.8655

Epoch 29/80
 - 0s - loss: 0.9960 - val_loss: 0.6107
AUC: 0.8642

Epoch 30/80
 - 0s - loss: 0.9846 - val_loss: 0.5974
AUC: 0.8649

Epoch 31/80
 - 0s - loss: 0.9840 - val_loss: 0.6112
AUC: 0.8654

Epoch 32/80
 - 0s - loss: 0.9786 - val_loss: 0.5816
AUC: 0.8654

Epoch 33/80
 - 0s - loss: 0.9788 - val_loss: 0.6293
AUC: 0.8658

Epoch 34/80
 - 0s - loss: 0.9798 - val_loss: 0.5818
AUC: 0.8651

Epoch 35/80
 - 0s - loss: 0.9764 - val_loss: 0.5954
AUC: 0.8656

Epoch 36/80
 - 0s - loss: 0.9711 - val_loss: 0.5972
AUC: 0.8655

Epoch 37/80
 - 0s - loss: 0.9762 - val_loss: 0.6526
AUC: 0.8658

Epoch 38/80
 - 0s - loss: 0.9759 - val_loss: 0.5900
AUC: 0.8657

Epoch 39/80
 - 0s - loss: 0.9767 - val_loss: 0.5983
AUC: 0.8658

Epoch 40/80
 - 0s - loss: 0.9779 - val_loss: 0.6126
AUC: 0.8660

Epoch 41/80
 - 0s - loss: 0.9757 - val_loss: 0.6333
AUC: 0.8659

Epoch 42/80
 - 0s - loss: 0.9730 - val_loss: 0.6321
AUC: 0.8664

Epoch 43/80
 - 0s - loss: 0.9765 - val_loss: 0.6083
AUC: 0.8662

Epoch 44/80
 - 0s - loss: 0.9669 - val_loss: 0.5982
AUC: 0.8659

Epoch 45/80
 - 0s - loss: 0.9741 - val_loss: 0.6091
AUC: 0.8660

Epoch 46/80
 - 0s - loss: 0.9708 - val_loss: 0.6000
AUC: 0.8659

Epoch 47/80
 - 0s - loss: 0.9699 - val_loss: 0.5982
AUC: 0.8659

Epoch 48/80
 - 0s - loss: 0.9656 - val_loss: 0.6049
AUC: 0.8660

Epoch 49/80
 - 0s - loss: 0.9705 - val_loss: 0.6118
AUC: 0.8661

Epoch 50/80
 - 0s - loss: 0.9676 - val_loss: 0.5975
AUC: 0.8658

Epoch 51/80
 - 0s - loss: 0.9717 - val_loss: 0.6021
AUC: 0.8660

Epoch 52/80
 - 0s - loss: 0.9691 - val_loss: 0.6004
AUC: 0.8661

Epoch 53/80
 - 0s - loss: 0.9710 - val_loss: 0.6022
AUC: 0.8661

Epoch 54/80
 - 0s - loss: 0.9709 - val_loss: 0.6009
AUC: 0.8661

Epoch 55/80
 - 0s - loss: 0.9747 - val_loss: 0.6034
AUC: 0.8662

Epoch 56/80
 - 0s - loss: 0.9681 - val_loss: 0.6015
AUC: 0.8662

Epoch 57/80
 - 0s - loss: 0.9675 - val_loss: 0.6027
AUC: 0.8662

Epoch 58/80
 - 0s - loss: 0.9676 - val_loss: 0.6005
AUC: 0.8662

Epoch 59/80
 - 0s - loss: 0.9724 - val_loss: 0.6016
AUC: 0.8662

Epoch 60/80
 - 0s - loss: 0.9644 - val_loss: 0.6018
AUC: 0.8662

Epoch 61/80
 - 0s - loss: 0.9629 - val_loss: 0.6014
AUC: 0.8662

Epoch 62/80
 - 0s - loss: 0.9681 - val_loss: 0.6010
AUC: 0.8662

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9711 - val_loss: 0.6025
AUC: 0.8662

Epoch 2/30
 - 1s - loss: 0.9737 - val_loss: 0.5993
AUC: 0.8665

Epoch 3/30
 - 1s - loss: 0.9696 - val_loss: 0.5995
AUC: 0.8666

Epoch 4/30
 - 1s - loss: 0.9656 - val_loss: 0.5991
AUC: 0.8664

Epoch 5/30
 - 1s - loss: 0.9679 - val_loss: 0.5805
AUC: 0.8663

Epoch 6/30
 - 1s - loss: 0.9649 - val_loss: 0.5838
AUC: 0.8665

Epoch 7/30
 - 1s - loss: 0.9671 - val_loss: 0.6068
AUC: 0.8669

Epoch 8/30
 - 1s - loss: 0.9576 - val_loss: 0.6079
AUC: 0.8669

Epoch 9/30
 - 0s - loss: 0.9626 - val_loss: 0.6222
AUC: 0.8674

Epoch 10/30
 - 1s - loss: 0.9623 - val_loss: 0.6173
AUC: 0.8673

Epoch 11/30
 - 0s - loss: 0.9557 - val_loss: 0.6043
AUC: 0.8673

Epoch 12/30
 - 0s - loss: 0.9614 - val_loss: 0.5997
AUC: 0.8674

Epoch 13/30
 - 0s - loss: 0.9593 - val_loss: 0.5975
AUC: 0.8675

Epoch 14/30
 - 0s - loss: 0.9556 - val_loss: 0.6143
AUC: 0.8676

Epoch 15/30
 - 0s - loss: 0.9526 - val_loss: 0.5920
AUC: 0.8677

Epoch 16/30
 - 0s - loss: 0.9455 - val_loss: 0.5926
AUC: 0.8677

Epoch 17/30
 - 0s - loss: 0.9496 - val_loss: 0.5916
AUC: 0.8677

Epoch 18/30
 - 0s - loss: 0.9476 - val_loss: 0.5946
AUC: 0.8677

Epoch 19/30
 - 0s - loss: 0.9441 - val_loss: 0.5917
AUC: 0.8676

Epoch 20/30
 - 0s - loss: 0.9517 - val_loss: 0.5962
AUC: 0.8677

Epoch 21/30
 - 0s - loss: 0.9468 - val_loss: 0.5901
AUC: 0.8676

Epoch 22/30
 - 0s - loss: 0.9448 - val_loss: 0.5956
AUC: 0.8677

Epoch 23/30
 - 0s - loss: 0.9489 - val_loss: 0.5917
AUC: 0.8677

Epoch 24/30
 - 1s - loss: 0.9502 - val_loss: 0.5921
AUC: 0.8678

Epoch 25/30
 - 0s - loss: 0.9458 - val_loss: 0.5973
AUC: 0.8679

Epoch 26/30
 - 0s - loss: 0.9439 - val_loss: 0.5959
AUC: 0.8679

Epoch 27/30
 - 0s - loss: 0.9467 - val_loss: 0.5938
AUC: 0.8679

Epoch 28/30
 - 0s - loss: 0.9447 - val_loss: 0.5933
AUC: 0.8679

Epoch 29/30
 - 0s - loss: 0.9405 - val_loss: 0.5930
AUC: 0.8679

Epoch 30/30
 - 0s - loss: 0.9448 - val_loss: 0.5929
Using TensorFlow backend.
AUC: 0.8679

2019-03-08 01:41:46.296227: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:41:46.462467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:41:46.462513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:41:46.765646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:41:46.765711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:41:46.765720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:41:46.765993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0253
Epoch 2/80
 - 2s - loss: 0.1799
Epoch 3/80
 - 2s - loss: 0.1478
Epoch 4/80
 - 2s - loss: 0.1267
Epoch 5/80
 - 2s - loss: 0.1114
Epoch 6/80
 - 2s - loss: 0.0997
Epoch 7/80
 - 2s - loss: 0.0901
Epoch 8/80
 - 2s - loss: 0.0819
Epoch 9/80
 - 2s - loss: 0.0749
Epoch 10/80
 - 2s - loss: 0.0691
Epoch 11/80
 - 2s - loss: 0.0644
Epoch 12/80
 - 2s - loss: 0.0606
Epoch 13/80
 - 2s - loss: 0.0574
Epoch 14/80
 - 2s - loss: 0.0548
Epoch 15/80
 - 2s - loss: 0.0525
Epoch 16/80
 - 2s - loss: 0.0506
Epoch 17/80
 - 2s - loss: 0.0488
Epoch 18/80
 - 2s - loss: 0.0473
Epoch 19/80
 - 2s - loss: 0.0460
Epoch 20/80
 - 2s - loss: 0.0448
Epoch 21/80
 - 2s - loss: 0.0438
Epoch 22/80
 - 2s - loss: 0.0430
Epoch 23/80
 - 2s - loss: 0.0422
Epoch 24/80
 - 2s - loss: 0.0415
Epoch 25/80
 - 2s - loss: 0.0409
Epoch 26/80
 - 2s - loss: 0.0404
Epoch 27/80
 - 2s - loss: 0.0399
Epoch 28/80
 - 2s - loss: 0.0396
Epoch 29/80
 - 2s - loss: 0.0392
Epoch 30/80
 - 2s - loss: 0.0389
Epoch 31/80
 - 2s - loss: 0.0387
Epoch 32/80
 - 2s - loss: 0.0384
Epoch 33/80
 - 2s - loss: 0.0382
Epoch 34/80
 - 2s - loss: 0.0380
Epoch 35/80
 - 2s - loss: 0.0379
Epoch 36/80
 - 2s - loss: 0.0377
Epoch 37/80
 - 2s - loss: 0.0376
Epoch 38/80
 - 2s - loss: 0.0375
Epoch 39/80
 - 2s - loss: 0.0374
Epoch 40/80
 - 2s - loss: 0.0373
Epoch 41/80
 - 2s - loss: 0.0372
Epoch 42/80
 - 2s - loss: 0.0371
Epoch 43/80
 - 2s - loss: 0.0370
Epoch 44/80
 - 2s - loss: 0.0369
Epoch 45/80
 - 2s - loss: 0.0369
Epoch 46/80
 - 2s - loss: 0.0368
Epoch 47/80
 - 2s - loss: 0.0368
Epoch 48/80
 - 2s - loss: 0.0367
Epoch 49/80
 - 2s - loss: 0.0366
Epoch 50/80
 - 2s - loss: 0.0366
Epoch 51/80
 - 2s - loss: 0.0365
Epoch 52/80
 - 2s - loss: 0.0365
Epoch 53/80
 - 2s - loss: 0.0365
Epoch 54/80
 - 2s - loss: 0.0364
Epoch 55/80
 - 2s - loss: 0.0364
Epoch 56/80
 - 2s - loss: 0.0363
Epoch 57/80
 - 2s - loss: 0.0363
Epoch 58/80
 - 2s - loss: 0.0363
Epoch 59/80
 - 2s - loss: 0.0347
Epoch 60/80
 - 2s - loss: 0.0346
Epoch 61/80
 - 2s - loss: 0.0346
Epoch 62/80
 - 2s - loss: 0.0346
Epoch 63/80
 - 2s - loss: 0.0346
Epoch 64/80
 - 2s - loss: 0.0342
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 01:44:12.936216: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:44:13.106259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:44:13.106304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:44:13.410486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:44:13.410542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:44:13.410551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:44:13.410822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0050
Epoch 2/80
 - 2s - loss: 0.1818
Epoch 3/80
 - 2s - loss: 0.1593
Epoch 4/80
 - 2s - loss: 0.1367
Epoch 5/80
 - 2s - loss: 0.1176
Epoch 6/80
 - 2s - loss: 0.1045
Epoch 7/80
 - 2s - loss: 0.0937
Epoch 8/80
 - 2s - loss: 0.0844
Epoch 9/80
 - 2s - loss: 0.0766
Epoch 10/80
 - 2s - loss: 0.0703
Epoch 11/80
 - 2s - loss: 0.0653
Epoch 12/80
 - 2s - loss: 0.0613
Epoch 13/80
 - 2s - loss: 0.0580
Epoch 14/80
 - 2s - loss: 0.0553
Epoch 15/80
 - 2s - loss: 0.0529
Epoch 16/80
 - 2s - loss: 0.0509
Epoch 17/80
 - 2s - loss: 0.0491
Epoch 18/80
 - 2s - loss: 0.0476
Epoch 19/80
 - 2s - loss: 0.0462
Epoch 20/80
 - 2s - loss: 0.0451
Epoch 21/80
 - 2s - loss: 0.0441
Epoch 22/80
 - 2s - loss: 0.0432
Epoch 23/80
 - 2s - loss: 0.0424
Epoch 24/80
 - 2s - loss: 0.0417
Epoch 25/80
 - 2s - loss: 0.0412
Epoch 26/80
 - 2s - loss: 0.0406
Epoch 27/80
 - 2s - loss: 0.0402
Epoch 28/80
 - 2s - loss: 0.0398
Epoch 29/80
 - 2s - loss: 0.0394
Epoch 30/80
 - 2s - loss: 0.0391
Epoch 31/80
 - 2s - loss: 0.0389
Epoch 32/80
 - 2s - loss: 0.0386
Epoch 33/80
 - 2s - loss: 0.0384
Epoch 34/80
 - 2s - loss: 0.0382
Epoch 35/80
 - 2s - loss: 0.0381
Epoch 36/80
 - 2s - loss: 0.0379
Epoch 37/80
 - 2s - loss: 0.0378
Epoch 38/80
 - 2s - loss: 0.0377
Epoch 39/80
 - 2s - loss: 0.0375
Epoch 40/80
 - 2s - loss: 0.0374
Epoch 41/80
 - 2s - loss: 0.0373
Epoch 42/80
 - 2s - loss: 0.0373
Epoch 43/80
 - 2s - loss: 0.0372
Epoch 44/80
 - 2s - loss: 0.0371
Epoch 45/80
 - 2s - loss: 0.0370
Epoch 46/80
 - 2s - loss: 0.0370
Epoch 47/80
 - 2s - loss: 0.0369
Epoch 48/80
 - 2s - loss: 0.0368
Epoch 49/80
 - 2s - loss: 0.0368
Epoch 50/80
 - 2s - loss: 0.0368
Epoch 51/80
 - 2s - loss: 0.0367
Epoch 52/80
 - 2s - loss: 0.0367
Epoch 53/80
 - 2s - loss: 0.0366
Epoch 54/80
 - 2s - loss: 0.0366
Epoch 55/80
 - 2s - loss: 0.0365
Epoch 56/80
 - 2s - loss: 0.0365
Epoch 57/80
 - 2s - loss: 0.0365
Epoch 58/80
 - 2s - loss: 0.0364
Epoch 59/80
 - 2s - loss: 0.0364
Epoch 60/80
 - 2s - loss: 0.0364
Epoch 61/80
 - 2s - loss: 0.0349
Epoch 62/80
 - 2s - loss: 0.0347
Epoch 63/80
 - 2s - loss: 0.0347
Epoch 64/80
 - 2s - loss: 0.0347
Epoch 65/80
 - 2s - loss: 0.0347
Epoch 66/80
 - 2s - loss: 0.0343
Epoch 67/80
 - 2s - loss: 0.0343
Epoch 68/80
 - 2s - loss: 0.0343
Epoch 69/80
 - 2s - loss: 0.0343
Epoch 70/80
 - 2s - loss: 0.0342
Epoch 71/80
 - 2s - loss: 0.0342
Epoch 72/80
 - 2s - loss: 0.0342
Epoch 73/80
 - 2s - loss: 0.0342
Epoch 74/80
 - 2s - loss: 0.0342
Epoch 75/80
 - 2s - loss: 0.0342
Epoch 76/80
 - 2s - loss: 0.0342
Epoch 77/80
 - 2s - loss: 0.0342
Epoch 78/80
 - 2s - loss: 0.0342
Epoch 79/80
 - 2s - loss: 0.0342
Epoch 80/80
 - 2s - loss: 0.0342
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.6567 - val_loss: 1.3062
AUC: 0.8276

Epoch 2/80
 - 0s - loss: 1.8249 - val_loss: 0.7507
AUC: 0.8397

Epoch 3/80
 - 0s - loss: 1.3065 - val_loss: 0.6536
AUC: 0.8473

Epoch 4/80
 - 0s - loss: 1.1877 - val_loss: 0.6755
AUC: 0.8568

Epoch 5/80
 - 0s - loss: 1.1491 - val_loss: 0.6419
AUC: 0.8593

Epoch 6/80
 - 0s - loss: 1.1021 - val_loss: 0.6557
AUC: 0.8608

Epoch 7/80
 - 0s - loss: 1.0903 - val_loss: 0.5934
AUC: 0.8628

Epoch 8/80
 - 0s - loss: 1.0789 - val_loss: 0.6841
AUC: 0.8679

Epoch 9/80
 - 0s - loss: 1.0691 - val_loss: 0.6785
AUC: 0.8683

Epoch 10/80
 - 0s - loss: 1.0569 - val_loss: 0.6026
AUC: 0.8696

Epoch 11/80
 - 0s - loss: 1.0453 - val_loss: 0.5794
AUC: 0.8696

Epoch 12/80
 - 0s - loss: 1.0368 - val_loss: 0.6330
AUC: 0.8702

Epoch 13/80
 - 0s - loss: 1.0341 - val_loss: 0.6077
AUC: 0.8709

Epoch 14/80
 - 0s - loss: 1.0242 - val_loss: 0.6218
AUC: 0.8733

Epoch 15/80
 - 0s - loss: 1.0218 - val_loss: 0.5972
AUC: 0.8734

Epoch 16/80
 - 0s - loss: 1.0136 - val_loss: 0.6053
AUC: 0.8735

Epoch 17/80
 - 0s - loss: 1.0115 - val_loss: 0.6239
AUC: 0.8746

Epoch 18/80
 - 0s - loss: 1.0108 - val_loss: 0.6424
AUC: 0.8751

Epoch 19/80
 - 0s - loss: 1.0042 - val_loss: 0.6613
AUC: 0.8755

Epoch 20/80
 - 0s - loss: 0.9991 - val_loss: 0.5802
AUC: 0.8756

Epoch 21/80
 - 0s - loss: 0.9976 - val_loss: 0.6270
AUC: 0.8753

Epoch 22/80
 - 0s - loss: 0.9841 - val_loss: 0.5682
AUC: 0.8745

Epoch 23/80
 - 0s - loss: 0.9770 - val_loss: 0.5977
AUC: 0.8753

Epoch 24/80
 - 0s - loss: 0.9800 - val_loss: 0.5876
AUC: 0.8751

Epoch 25/80
 - 0s - loss: 0.9767 - val_loss: 0.5952
AUC: 0.8753

Epoch 26/80
 - 0s - loss: 0.9761 - val_loss: 0.5961
AUC: 0.8753

Epoch 27/80
 - 0s - loss: 0.9748 - val_loss: 0.5819
AUC: 0.8755

Epoch 28/80
 - 0s - loss: 0.9751 - val_loss: 0.5919
AUC: 0.8755

Epoch 29/80
 - 0s - loss: 0.9719 - val_loss: 0.6175
AUC: 0.8762

Epoch 30/80
 - 0s - loss: 0.9731 - val_loss: 0.6295
AUC: 0.8763

Epoch 31/80
 - 0s - loss: 0.9739 - val_loss: 0.5711
AUC: 0.8754

Epoch 32/80
 - 0s - loss: 0.9680 - val_loss: 0.5803
AUC: 0.8753

Epoch 33/80
 - 0s - loss: 0.9692 - val_loss: 0.5923
AUC: 0.8756

Epoch 34/80
 - 0s - loss: 0.9646 - val_loss: 0.5891
AUC: 0.8756

Epoch 35/80
 - 0s - loss: 0.9664 - val_loss: 0.6049
AUC: 0.8759

Epoch 36/80
 - 0s - loss: 0.9663 - val_loss: 0.5893
AUC: 0.8756

Epoch 37/80
 - 0s - loss: 0.9670 - val_loss: 0.5961
AUC: 0.8757

Epoch 38/80
 - 0s - loss: 0.9650 - val_loss: 0.5787
AUC: 0.8754

Epoch 39/80
 - 0s - loss: 0.9636 - val_loss: 0.5976
AUC: 0.8757

Epoch 40/80
 - 0s - loss: 0.9639 - val_loss: 0.5867
AUC: 0.8757

Epoch 41/80
 - 0s - loss: 0.9729 - val_loss: 0.6018
AUC: 0.8759

Epoch 42/80
 - 0s - loss: 0.9648 - val_loss: 0.5898
AUC: 0.8757

Epoch 43/80
 - 0s - loss: 0.9666 - val_loss: 0.5906
AUC: 0.8757

Epoch 44/80
 - 0s - loss: 0.9642 - val_loss: 0.5912
AUC: 0.8757

Epoch 45/80
 - 0s - loss: 0.9659 - val_loss: 0.5926
AUC: 0.8758

Epoch 46/80
 - 0s - loss: 0.9606 - val_loss: 0.5923
AUC: 0.8757

Epoch 47/80
 - 0s - loss: 0.9641 - val_loss: 0.5896
AUC: 0.8757

Epoch 48/80
 - 0s - loss: 0.9661 - val_loss: 0.5937
AUC: 0.8757

Epoch 49/80
 - 0s - loss: 0.9644 - val_loss: 0.5938
AUC: 0.8757

Epoch 50/80
 - 0s - loss: 0.9670 - val_loss: 0.5939
AUC: 0.8757

Epoch 51/80
 - 0s - loss: 0.9643 - val_loss: 0.5933
AUC: 0.8757

Epoch 52/80
 - 0s - loss: 0.9611 - val_loss: 0.5916
AUC: 0.8757

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9765 - val_loss: 0.5988
AUC: 0.8761

Epoch 2/30
 - 0s - loss: 0.9727 - val_loss: 0.5961
AUC: 0.8762

Epoch 3/30
 - 0s - loss: 0.9639 - val_loss: 0.5983
AUC: 0.8764

Epoch 4/30
 - 0s - loss: 0.9670 - val_loss: 0.5818
AUC: 0.8762

Epoch 5/30
 - 0s - loss: 0.9604 - val_loss: 0.5778
AUC: 0.8760

Epoch 6/30
 - 0s - loss: 0.9598 - val_loss: 0.5828
AUC: 0.8761

Epoch 7/30
 - 0s - loss: 0.9613 - val_loss: 0.6073
AUC: 0.8767

Epoch 8/30
 - 0s - loss: 0.9553 - val_loss: 0.5743
AUC: 0.8764

Epoch 9/30
 - 0s - loss: 0.9524 - val_loss: 0.5868
AUC: 0.8767

Epoch 10/30
 - 0s - loss: 0.9549 - val_loss: 0.5713
AUC: 0.8764

Epoch 11/30
 - 0s - loss: 0.9536 - val_loss: 0.5767
AUC: 0.8767

Epoch 12/30
 - 0s - loss: 0.9481 - val_loss: 0.5926
AUC: 0.8769

Epoch 13/30
 - 0s - loss: 0.9511 - val_loss: 0.6045
AUC: 0.8770

Epoch 14/30
 - 0s - loss: 0.9487 - val_loss: 0.5877
AUC: 0.8770

Epoch 15/30
 - 0s - loss: 0.9417 - val_loss: 0.5810
AUC: 0.8771

Epoch 16/30
 - 0s - loss: 0.9441 - val_loss: 0.5627
AUC: 0.8769

Epoch 17/30
 - 0s - loss: 0.9437 - val_loss: 0.6108
AUC: 0.8777

Epoch 18/30
 - 0s - loss: 0.9365 - val_loss: 0.5763
AUC: 0.8772

Epoch 19/30
 - 0s - loss: 0.9383 - val_loss: 0.5818
AUC: 0.8772

Epoch 20/30
 - 1s - loss: 0.9388 - val_loss: 0.5902
AUC: 0.8776

Epoch 21/30
 - 1s - loss: 0.9357 - val_loss: 0.5860
AUC: 0.8775

Epoch 22/30
 - 1s - loss: 0.9319 - val_loss: 0.6004
AUC: 0.8776

Epoch 23/30
 - 1s - loss: 0.9339 - val_loss: 0.5729
AUC: 0.8773

Epoch 24/30
 - 1s - loss: 0.9258 - val_loss: 0.5978
AUC: 0.8779

Epoch 25/30
 - 1s - loss: 0.9286 - val_loss: 0.5907
AUC: 0.8778

Epoch 26/30
 - 1s - loss: 0.9188 - val_loss: 0.5565
AUC: 0.8774

Epoch 27/30
 - 1s - loss: 0.9251 - val_loss: 0.5788
AUC: 0.8776

Epoch 28/30
 - 1s - loss: 0.9197 - val_loss: 0.5689
AUC: 0.8777

Epoch 29/30
 - 1s - loss: 0.9194 - val_loss: 0.5816
AUC: 0.8779

Epoch 30/30
 - 1s - loss: 0.9165 - val_loss: 0.5677
Using TensorFlow backend.
AUC: 0.8777

2019-03-08 01:48:05.736380: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:48:05.903070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:48:05.903117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:48:06.202324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:48:06.202380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:48:06.202389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:48:06.202654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9757
Epoch 2/80
 - 2s - loss: 0.1811
Epoch 3/80
 - 2s - loss: 0.1552
Epoch 4/80
 - 2s - loss: 0.1343
Epoch 5/80
 - 2s - loss: 0.1193
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 01:48:34.460130: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:48:34.626722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:48:34.626772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:48:34.924710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:48:34.924769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:48:34.924779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:48:34.925038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.8995
Epoch 2/80
 - 2s - loss: 0.1694
Epoch 3/80
 - 2s - loss: 0.1345
Epoch 4/80
 - 2s - loss: 0.1052
Epoch 5/80
 - 2s - loss: 0.0888
Epoch 6/80
 - 2s - loss: 0.0779
Epoch 7/80
 - 2s - loss: 0.0696
Epoch 8/80
 - 2s - loss: 0.0631
Epoch 9/80
 - 2s - loss: 0.0579
Epoch 10/80
 - 2s - loss: 0.0536
Epoch 11/80
 - 2s - loss: 0.0501
Epoch 12/80
 - 2s - loss: 0.0472
Epoch 13/80
 - 2s - loss: 0.0447
Epoch 14/80
 - 2s - loss: 0.0425
Epoch 15/80
 - 2s - loss: 0.0406
Epoch 16/80
 - 2s - loss: 0.0390
Epoch 17/80
 - 2s - loss: 0.0375
Epoch 18/80
 - 2s - loss: 0.0362
Epoch 19/80
 - 2s - loss: 0.0350
Epoch 20/80
 - 2s - loss: 0.0340
Epoch 21/80
 - 2s - loss: 0.0331
Epoch 22/80
 - 2s - loss: 0.0323
Epoch 23/80
 - 2s - loss: 0.0316
Epoch 24/80
 - 2s - loss: 0.0309
Epoch 25/80
 - 2s - loss: 0.0304
Epoch 26/80
 - 2s - loss: 0.0299
Epoch 27/80
 - 2s - loss: 0.0295
Epoch 28/80
 - 2s - loss: 0.0291
Epoch 29/80
 - 2s - loss: 0.0288
Epoch 30/80
 - 2s - loss: 0.0285
Epoch 31/80
 - 2s - loss: 0.0283
Epoch 32/80
 - 2s - loss: 0.0280
Epoch 33/80
 - 2s - loss: 0.0279
Epoch 34/80
 - 2s - loss: 0.0277
Epoch 35/80
 - 2s - loss: 0.0275
Epoch 36/80
 - 2s - loss: 0.0274
Epoch 37/80
 - 2s - loss: 0.0272
Epoch 38/80
 - 2s - loss: 0.0271
Epoch 39/80
 - 2s - loss: 0.0270
Epoch 40/80
 - 2s - loss: 0.0269
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 01:50:13.076344: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:50:13.243365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:50:13.243412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:50:13.544785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:50:13.544840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:50:13.544849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:50:13.545115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.8931
Epoch 2/80
 - 2s - loss: 0.1677
Epoch 3/80
 - 2s - loss: 0.1344
Epoch 4/80
 - 2s - loss: 0.1102
Epoch 5/80
 - 2s - loss: 0.0932
Epoch 6/80
 - 2s - loss: 0.0809
Epoch 7/80
 - 2s - loss: 0.0714
Epoch 8/80
 - 2s - loss: 0.0643
Epoch 9/80
 - 2s - loss: 0.0589
Epoch 10/80
 - 2s - loss: 0.0545
Epoch 11/80
 - 2s - loss: 0.0509
Epoch 12/80
 - 2s - loss: 0.0478
Epoch 13/80
 - 2s - loss: 0.0453
Epoch 14/80
 - 2s - loss: 0.0431
Epoch 15/80
 - 2s - loss: 0.0411
Epoch 16/80
 - 2s - loss: 0.0394
Epoch 17/80
 - 2s - loss: 0.0379
Epoch 18/80
 - 2s - loss: 0.0366
Epoch 19/80
 - 2s - loss: 0.0354
Epoch 20/80
 - 2s - loss: 0.0343
Epoch 21/80
 - 2s - loss: 0.0334
Epoch 22/80
 - 2s - loss: 0.0325
Epoch 23/80
 - 2s - loss: 0.0318
Epoch 24/80
 - 2s - loss: 0.0312
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 01:51:23.331525: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:51:23.500048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:51:23.500109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:51:23.799999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:51:23.800054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:51:23.800064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:51:23.800328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9046
Epoch 2/80
 - 2s - loss: 0.1678
Epoch 3/80
 - 2s - loss: 0.1337
Epoch 4/80
 - 2s - loss: 0.1079
Epoch 5/80
 - 2s - loss: 0.0908
Epoch 6/80
 - 2s - loss: 0.0789
Epoch 7/80
 - 2s - loss: 0.0700
Epoch 8/80
 - 2s - loss: 0.0633
Epoch 9/80
 - 2s - loss: 0.0581
Epoch 10/80
 - 2s - loss: 0.0539
Epoch 11/80
 - 2s - loss: 0.0505
Epoch 12/80
 - 2s - loss: 0.0476
Epoch 13/80
 - 2s - loss: 0.0451
Epoch 14/80
 - 2s - loss: 0.0429
Epoch 15/80
 - 2s - loss: 0.0410
Epoch 16/80
 - 2s - loss: 0.0394
Epoch 17/80
 - 2s - loss: 0.0379
Epoch 18/80
 - 2s - loss: 0.0366
Epoch 19/80
 - 2s - loss: 0.0354
Epoch 20/80
 - 2s - loss: 0.0343
Epoch 21/80
 - 2s - loss: 0.0334
Epoch 22/80
 - 2s - loss: 0.0326
Epoch 23/80
 - 2s - loss: 0.0319
Epoch 24/80
 - 2s - loss: 0.0312
Epoch 25/80
 - 2s - loss: 0.0307
Epoch 26/80
 - 2s - loss: 0.0302
Epoch 27/80
 - 2s - loss: 0.0298
Epoch 28/80
 - 2s - loss: 0.0294
Epoch 29/80
 - 2s - loss: 0.0290
Epoch 30/80
 - 2s - loss: 0.0288
Epoch 31/80
 - 2s - loss: 0.0285
Epoch 32/80
 - 2s - loss: 0.0283
Epoch 33/80
 - 2s - loss: 0.0281
Epoch 34/80
 - 2s - loss: 0.0279
Epoch 35/80
 - 2s - loss: 0.0277
Epoch 36/80
 - 2s - loss: 0.0275
Epoch 37/80
 - 2s - loss: 0.0274
Epoch 38/80
 - 2s - loss: 0.0273
Epoch 39/80
 - 2s - loss: 0.0272
Epoch 40/80
 - 2s - loss: 0.0270
Epoch 41/80
 - 2s - loss: 0.0269
Epoch 42/80
 - 2s - loss: 0.0268
Epoch 43/80
 - 2s - loss: 0.0268
Epoch 44/80
 - 2s - loss: 0.0267
Epoch 45/80
 - 2s - loss: 0.0266
Epoch 46/80
 - 2s - loss: 0.0265
Epoch 47/80
 - 2s - loss: 0.0265
Epoch 48/80
 - 2s - loss: 0.0264
Epoch 49/80
 - 2s - loss: 0.0264
Epoch 50/80
 - 2s - loss: 0.0263
Epoch 51/80
 - 2s - loss: 0.0262
Epoch 52/80
 - 2s - loss: 0.0262
Epoch 53/80
 - 2s - loss: 0.0261
Epoch 54/80
 - 2s - loss: 0.0261
Epoch 55/80
 - 2s - loss: 0.0260
Epoch 56/80
 - 2s - loss: 0.0260
Epoch 57/80
 - 2s - loss: 0.0260
Epoch 58/80
 - 2s - loss: 0.0259
Epoch 59/80
 - 2s - loss: 0.0259
Epoch 60/80
 - 2s - loss: 0.0259
Epoch 61/80
 - 2s - loss: 0.0239
Epoch 62/80
 - 2s - loss: 0.0237
Epoch 63/80
 - 2s - loss: 0.0237
Epoch 64/80
 - 2s - loss: 0.0237
Epoch 65/80
 - 2s - loss: 0.0237
Epoch 66/80
 - 2s - loss: 0.0233
Epoch 67/80
 - 2s - loss: 0.0232
Epoch 68/80
 - 2s - loss: 0.0232
Epoch 69/80
 - 2s - loss: 0.0232
Epoch 70/80
 - 2s - loss: 0.0231
Epoch 71/80
 - 2s - loss: 0.0231
Epoch 72/80
 - 2s - loss: 0.0231
Epoch 73/80
 - 2s - loss: 0.0231
Epoch 74/80
 - 2s - loss: 0.0231
Epoch 75/80
 - 2s - loss: 0.0231
Epoch 76/80
 - 2s - loss: 0.0231
Epoch 77/80
 - 2s - loss: 0.0231
Epoch 78/80
 - 2s - loss: 0.0231
Epoch 79/80
 - 2s - loss: 0.0231
Epoch 80/80
 - 2s - loss: 0.0231
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.5869 - val_loss: 1.3225
AUC: 0.7951

Epoch 2/80
 - 0s - loss: 2.1278 - val_loss: 0.8194
AUC: 0.8281

Epoch 3/80
 - 0s - loss: 1.4481 - val_loss: 0.7880
AUC: 0.8391

Epoch 4/80
 - 0s - loss: 1.2202 - val_loss: 0.7253
AUC: 0.8442

Epoch 5/80
 - 0s - loss: 1.1562 - val_loss: 0.7498
AUC: 0.8464

Epoch 6/80
 - 0s - loss: 1.1280 - val_loss: 0.6853
AUC: 0.8491

Epoch 7/80
 - 0s - loss: 1.1027 - val_loss: 0.5836
AUC: 0.8491

Epoch 8/80
 - 0s - loss: 1.0720 - val_loss: 0.6640
AUC: 0.8540

Epoch 9/80
 - 0s - loss: 1.0647 - val_loss: 0.6463
AUC: 0.8556

Epoch 10/80
 - 0s - loss: 1.0587 - val_loss: 0.6389
AUC: 0.8548

Epoch 11/80
 - 0s - loss: 1.0429 - val_loss: 0.6242
AUC: 0.8565

Epoch 12/80
 - 0s - loss: 1.0333 - val_loss: 0.6468
AUC: 0.8578

Epoch 13/80
 - 0s - loss: 1.0279 - val_loss: 0.6393
AUC: 0.8594

Epoch 14/80
 - 0s - loss: 1.0265 - val_loss: 0.6837
AUC: 0.8597

Epoch 15/80
 - 0s - loss: 1.0188 - val_loss: 0.5999
AUC: 0.8568

Epoch 16/80
 - 0s - loss: 1.0066 - val_loss: 0.6566
AUC: 0.8610

Epoch 17/80
 - 0s - loss: 1.0058 - val_loss: 0.6139
AUC: 0.8608

Epoch 18/80
 - 0s - loss: 0.9885 - val_loss: 0.6315
AUC: 0.8611

Epoch 19/80
 - 0s - loss: 0.9941 - val_loss: 0.5993
AUC: 0.8605

Epoch 20/80
 - 0s - loss: 0.9903 - val_loss: 0.6149
AUC: 0.8609

Epoch 21/80
 - 0s - loss: 0.9902 - val_loss: 0.5951
AUC: 0.8605

Epoch 22/80
 - 0s - loss: 0.9852 - val_loss: 0.6016
AUC: 0.8607

Epoch 23/80
 - 0s - loss: 0.9923 - val_loss: 0.6223
AUC: 0.8614

Epoch 24/80
 - 0s - loss: 0.9902 - val_loss: 0.5981
AUC: 0.8613

Epoch 25/80
 - 0s - loss: 0.9913 - val_loss: 0.6187
AUC: 0.8614

Epoch 26/80
 - 0s - loss: 0.9875 - val_loss: 0.6128
AUC: 0.8612

Epoch 27/80
 - 0s - loss: 0.9830 - val_loss: 0.6159
AUC: 0.8613

Epoch 28/80
 - 0s - loss: 0.9744 - val_loss: 0.6018
AUC: 0.8611

Epoch 29/80
 - 0s - loss: 0.9812 - val_loss: 0.6125
AUC: 0.8614

Epoch 30/80
 - 0s - loss: 0.9837 - val_loss: 0.6137
AUC: 0.8614

Epoch 31/80
 - 0s - loss: 0.9783 - val_loss: 0.6117
AUC: 0.8614

Epoch 32/80
 - 0s - loss: 0.9822 - val_loss: 0.6114
AUC: 0.8614

Epoch 33/80
 - 0s - loss: 0.9720 - val_loss: 0.6086
AUC: 0.8614

Epoch 34/80
 - 0s - loss: 0.9761 - val_loss: 0.6161
AUC: 0.8615

Epoch 35/80
 - 0s - loss: 0.9724 - val_loss: 0.6134
AUC: 0.8614

Epoch 36/80
 - 0s - loss: 0.9806 - val_loss: 0.6165
AUC: 0.8615

Epoch 37/80
 - 0s - loss: 0.9814 - val_loss: 0.6127
AUC: 0.8616

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9778 - val_loss: 0.6215
AUC: 0.8621

Epoch 2/30
 - 0s - loss: 0.9743 - val_loss: 0.6048
AUC: 0.8619

Epoch 3/30
 - 0s - loss: 0.9767 - val_loss: 0.6014
AUC: 0.8618

Epoch 4/30
 - 0s - loss: 0.9760 - val_loss: 0.6272
AUC: 0.8624

Epoch 5/30
 - 0s - loss: 0.9717 - val_loss: 0.6138
AUC: 0.8628

Epoch 6/30
 - 0s - loss: 0.9704 - val_loss: 0.5882
AUC: 0.8623

Epoch 7/30
 - 0s - loss: 0.9646 - val_loss: 0.6206
AUC: 0.8631

Epoch 8/30
 - 0s - loss: 0.9616 - val_loss: 0.6182
AUC: 0.8629

Epoch 9/30
 - 0s - loss: 0.9547 - val_loss: 0.6077
AUC: 0.8630

Epoch 10/30
 - 0s - loss: 0.9629 - val_loss: 0.6293
AUC: 0.8636

Epoch 11/30
 - 0s - loss: 0.9546 - val_loss: 0.6148
AUC: 0.8636

Epoch 12/30
 - 0s - loss: 0.9531 - val_loss: 0.5936
AUC: 0.8632

Epoch 13/30
 - 0s - loss: 0.9521 - val_loss: 0.5944
AUC: 0.8633

Epoch 14/30
 - 0s - loss: 0.9470 - val_loss: 0.6014
AUC: 0.8636

Epoch 15/30
 - 0s - loss: 0.9492 - val_loss: 0.6075
AUC: 0.8640

Epoch 16/30
 - 0s - loss: 0.9487 - val_loss: 0.5961
AUC: 0.8639

Epoch 17/30
 - 0s - loss: 0.9460 - val_loss: 0.5934
AUC: 0.8639

Epoch 18/30
 - 0s - loss: 0.9483 - val_loss: 0.5994
AUC: 0.8639

Epoch 19/30
 - 0s - loss: 0.9376 - val_loss: 0.6038
AUC: 0.8640

Epoch 20/30
 - 0s - loss: 0.9364 - val_loss: 0.5932
AUC: 0.8638

Epoch 21/30
 - 0s - loss: 0.9373 - val_loss: 0.5983
AUC: 0.8639

Epoch 22/30
 - 0s - loss: 0.9401 - val_loss: 0.5889
AUC: 0.8637

Epoch 23/30
 - 0s - loss: 0.9392 - val_loss: 0.5951
AUC: 0.8638

Epoch 24/30
 - 0s - loss: 0.9333 - val_loss: 0.5956
AUC: 0.8638

Epoch 25/30
 - 0s - loss: 0.9384 - val_loss: 0.5924
AUC: 0.8639

Epoch 26/30
 - 0s - loss: 0.9441 - val_loss: 0.5965
AUC: 0.8640

Epoch 27/30
 - 0s - loss: 0.9414 - val_loss: 0.5958
AUC: 0.8639

Epoch 28/30
 - 0s - loss: 0.9359 - val_loss: 0.5969
AUC: 0.8640

Epoch 29/30
 - 0s - loss: 0.9348 - val_loss: 0.5952
AUC: 0.8639

Epoch 30/30
 - 0s - loss: 0.9391 - val_loss: 0.5963
Using TensorFlow backend.
AUC: 0.8640

2019-03-08 01:55:15.261242: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:55:15.431989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:55:15.432048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:55:15.732128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:55:15.732180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:55:15.732190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:55:15.732482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.7905
Epoch 2/80
 - 2s - loss: 0.1570
Epoch 3/80
 - 2s - loss: 0.1142
Epoch 4/80
 - 2s - loss: 0.0885
Epoch 5/80
 - 2s - loss: 0.0741
Epoch 6/80
 - 2s - loss: 0.0643
Epoch 7/80
 - 2s - loss: 0.0572
Epoch 8/80
 - 2s - loss: 0.0515
Epoch 9/80
 - 2s - loss: 0.0468
Epoch 10/80
 - 2s - loss: 0.0429
Epoch 11/80
 - 2s - loss: 0.0395
Epoch 12/80
 - 2s - loss: 0.0366
Epoch 13/80
 - 2s - loss: 0.0341
Epoch 14/80
 - 2s - loss: 0.0319
Epoch 15/80
 - 2s - loss: 0.0299
Epoch 16/80
 - 2s - loss: 0.0282
Epoch 17/80
 - 2s - loss: 0.0266
Epoch 18/80
 - 2s - loss: 0.0252
Epoch 19/80
 - 2s - loss: 0.0239
Epoch 20/80
 - 2s - loss: 0.0228
Epoch 21/80
 - 2s - loss: 0.0218
Epoch 22/80
 - 2s - loss: 0.0209
Epoch 23/80
 - 2s - loss: 0.0202
Epoch 24/80
 - 2s - loss: 0.0194
Epoch 25/80
 - 2s - loss: 0.0188
Epoch 26/80
 - 2s - loss: 0.0183
Epoch 27/80
 - 2s - loss: 0.0178
Epoch 28/80
 - 2s - loss: 0.0173
Epoch 29/80
 - 2s - loss: 0.0169
Epoch 30/80
 - 2s - loss: 0.0166
Epoch 31/80
 - 2s - loss: 0.0163
Epoch 32/80
 - 2s - loss: 0.0160
Epoch 33/80
 - 2s - loss: 0.0158
Epoch 34/80
 - 2s - loss: 0.0156
Epoch 35/80
 - 2s - loss: 0.0154
Epoch 36/80
 - 2s - loss: 0.0152
Epoch 37/80
 - 2s - loss: 0.0150
Epoch 38/80
 - 2s - loss: 0.0149
Epoch 39/80
 - 2s - loss: 0.0148
Epoch 40/80
 - 2s - loss: 0.0146
Epoch 41/80
 - 2s - loss: 0.0145
Epoch 42/80
 - 2s - loss: 0.0144
Epoch 43/80
 - 2s - loss: 0.0143
Epoch 44/80
 - 2s - loss: 0.0142
Epoch 45/80
 - 2s - loss: 0.0141
Epoch 46/80
 - 2s - loss: 0.0141
Epoch 47/80
 - 2s - loss: 0.0140
Epoch 48/80
 - 2s - loss: 0.0139
Epoch 49/80
 - 2s - loss: 0.0138
Epoch 50/80
 - 2s - loss: 0.0138
Epoch 51/80
 - 2s - loss: 0.0137
Epoch 52/80
 - 2s - loss: 0.0137
Epoch 53/80
 - 2s - loss: 0.0136
Epoch 54/80
 - 2s - loss: 0.0135
Epoch 55/80
 - 2s - loss: 0.0135
Epoch 56/80
 - 2s - loss: 0.0135
Epoch 57/80
 - 2s - loss: 0.0134
Epoch 58/80
 - 2s - loss: 0.0134
Epoch 59/80
 - 2s - loss: 0.0133
Epoch 60/80
 - 2s - loss: 0.0133
Epoch 61/80
 - 2s - loss: 0.0133
Epoch 62/80
 - 2s - loss: 0.0132
Epoch 63/80
 - 2s - loss: 0.0111
Epoch 64/80
 - 2s - loss: 0.0109
Epoch 65/80
 - 2s - loss: 0.0108
Epoch 66/80
 - 2s - loss: 0.0108
Epoch 67/80
 - 2s - loss: 0.0107
Epoch 68/80
 - 2s - loss: 0.0107
Epoch 69/80
 - 2s - loss: 0.0107
Epoch 70/80
 - 2s - loss: 0.0107
Epoch 71/80
 - 2s - loss: 0.0103
Epoch 72/80
 - 2s - loss: 0.0102
Epoch 73/80
 - 2s - loss: 0.0102
Epoch 74/80
 - 2s - loss: 0.0102
Epoch 75/80
 - 2s - loss: 0.0101
Epoch 76/80
 - 2s - loss: 0.0101
Epoch 77/80
 - 2s - loss: 0.0101
Epoch 78/80
 - 2s - loss: 0.0101
Epoch 79/80
 - 2s - loss: 0.0101
Epoch 80/80
 - 2s - loss: 0.0101
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.6104 - val_loss: 1.0997
AUC: 0.7832

Epoch 2/80
 - 0s - loss: 2.4465 - val_loss: 0.8335
AUC: 0.8185

Epoch 3/80
 - 0s - loss: 1.6143 - val_loss: 0.7902
AUC: 0.8346

Epoch 4/80
 - 0s - loss: 1.3049 - val_loss: 0.7177
AUC: 0.8443

Epoch 5/80
 - 0s - loss: 1.1898 - val_loss: 0.7132
AUC: 0.8492

Epoch 6/80
 - 0s - loss: 1.1421 - val_loss: 0.6681
AUC: 0.8546

Epoch 7/80
 - 0s - loss: 1.1280 - val_loss: 0.6831
AUC: 0.8591

Epoch 8/80
 - 0s - loss: 1.0919 - val_loss: 0.6749
AUC: 0.8630

Epoch 9/80
 - 0s - loss: 1.0810 - val_loss: 0.6715
AUC: 0.8640

Epoch 10/80
 - 0s - loss: 1.0697 - val_loss: 0.7247
AUC: 0.8657

Epoch 11/80
 - 0s - loss: 1.0760 - val_loss: 0.6402
AUC: 0.8662

Epoch 12/80
 - 0s - loss: 1.0567 - val_loss: 0.6738
AUC: 0.8673

Epoch 13/80
 - 0s - loss: 1.0402 - val_loss: 0.6193
AUC: 0.8684

Epoch 14/80
 - 0s - loss: 1.0339 - val_loss: 0.6020
AUC: 0.8690

Epoch 15/80
 - 0s - loss: 1.0298 - val_loss: 0.6032
AUC: 0.8699

Epoch 16/80
 - 0s - loss: 1.0155 - val_loss: 0.5907
AUC: 0.8693

Epoch 17/80
 - 0s - loss: 1.0143 - val_loss: 0.6327
AUC: 0.8691

Epoch 18/80
 - 0s - loss: 1.0035 - val_loss: 0.5904
AUC: 0.8697

Epoch 19/80
 - 0s - loss: 0.9955 - val_loss: 0.6031
AUC: 0.8706

Epoch 20/80
 - 0s - loss: 0.9930 - val_loss: 0.5596
AUC: 0.8697

Epoch 21/80
 - 0s - loss: 0.9941 - val_loss: 0.6752
AUC: 0.8722

Epoch 22/80
 - 0s - loss: 0.9833 - val_loss: 0.5538
AUC: 0.8710

Epoch 23/80
 - 0s - loss: 0.9744 - val_loss: 0.6682
AUC: 0.8720

Epoch 24/80
 - 0s - loss: 0.9709 - val_loss: 0.6470
AUC: 0.8715

Epoch 25/80
 - 0s - loss: 0.9767 - val_loss: 0.5809
AUC: 0.8720

Epoch 26/80
 - 0s - loss: 0.9707 - val_loss: 0.5798
AUC: 0.8725

Epoch 27/80
 - 0s - loss: 0.9618 - val_loss: 0.6339
AUC: 0.8719

Epoch 28/80
 - 0s - loss: 0.9578 - val_loss: 0.5920
AUC: 0.8717

Epoch 29/80
 - 0s - loss: 0.9496 - val_loss: 0.6641
AUC: 0.8725

Epoch 30/80
 - 0s - loss: 0.9458 - val_loss: 0.6279
AUC: 0.8705

Epoch 31/80
 - 0s - loss: 0.9391 - val_loss: 0.5531
AUC: 0.8702

Epoch 32/80
 - 0s - loss: 0.9407 - val_loss: 0.6696
AUC: 0.8724

Epoch 33/80
 - 0s - loss: 0.9322 - val_loss: 0.5647
AUC: 0.8720

Epoch 34/80
 - 0s - loss: 0.9230 - val_loss: 0.6389
AUC: 0.8728

Epoch 35/80
 - 0s - loss: 0.9200 - val_loss: 0.5913
AUC: 0.8709

Epoch 36/80
 - 0s - loss: 0.9181 - val_loss: 0.6019
AUC: 0.8725

Epoch 37/80
 - 0s - loss: 0.9149 - val_loss: 0.5812
AUC: 0.8720

Epoch 38/80
 - 0s - loss: 0.9166 - val_loss: 0.6114
AUC: 0.8719

Epoch 39/80
 - 0s - loss: 0.9078 - val_loss: 0.6302
AUC: 0.8706

Epoch 40/80
 - 0s - loss: 0.8999 - val_loss: 0.6043
AUC: 0.8705

Epoch 41/80
 - 0s - loss: 0.8998 - val_loss: 0.5771
AUC: 0.8707

Epoch 42/80
 - 0s - loss: 0.8865 - val_loss: 0.5792
AUC: 0.8706

Epoch 43/80
 - 0s - loss: 0.8790 - val_loss: 0.5956
AUC: 0.8711

Epoch 44/80
 - 0s - loss: 0.8737 - val_loss: 0.5538
AUC: 0.8711

Epoch 45/80
 - 0s - loss: 0.8734 - val_loss: 0.5919
AUC: 0.8708

Epoch 46/80
 - 0s - loss: 0.8718 - val_loss: 0.5865
AUC: 0.8711

Epoch 47/80
 - 0s - loss: 0.8695 - val_loss: 0.5618
AUC: 0.8699

Epoch 48/80
 - 0s - loss: 0.8687 - val_loss: 0.6101
AUC: 0.8707

Epoch 49/80
 - 0s - loss: 0.8734 - val_loss: 0.5749
AUC: 0.8707

Epoch 50/80
 - 0s - loss: 0.8669 - val_loss: 0.5333
AUC: 0.8698

Epoch 51/80
 - 0s - loss: 0.8679 - val_loss: 0.5611
AUC: 0.8704

Epoch 52/80
 - 0s - loss: 0.8662 - val_loss: 0.5362
AUC: 0.8698

Epoch 53/80
 - 0s - loss: 0.8592 - val_loss: 0.5744
AUC: 0.8705

Epoch 54/80
 - 0s - loss: 0.8629 - val_loss: 0.6065
AUC: 0.8707

Epoch 55/80
 - 0s - loss: 0.8659 - val_loss: 0.5591
AUC: 0.8707

Epoch 56/80
 - 0s - loss: 0.8624 - val_loss: 0.5725
AUC: 0.8703

Epoch 57/80
 - 0s - loss: 0.8614 - val_loss: 0.5515
AUC: 0.8697

Epoch 58/80
 - 0s - loss: 0.8607 - val_loss: 0.5297
AUC: 0.8692

Epoch 59/80
 - 0s - loss: 0.8571 - val_loss: 0.5457
AUC: 0.8698

Epoch 60/80
 - 0s - loss: 0.8585 - val_loss: 0.5292
AUC: 0.8699

Epoch 61/80
 - 0s - loss: 0.8546 - val_loss: 0.5543
AUC: 0.8698

Epoch 62/80
 - 0s - loss: 0.8506 - val_loss: 0.5946
AUC: 0.8697

Epoch 63/80
 - 0s - loss: 0.8508 - val_loss: 0.5789
AUC: 0.8701

Epoch 64/80
 - 0s - loss: 0.8500 - val_loss: 0.5618
AUC: 0.8698

Epoch 65/80
 - 0s - loss: 0.8479 - val_loss: 0.5464
AUC: 0.8693

Epoch 66/80
 - 0s - loss: 0.8543 - val_loss: 0.5734
AUC: 0.8699

Epoch 67/80
 - 0s - loss: 0.8502 - val_loss: 0.5847
AUC: 0.8695

Epoch 68/80
 - 0s - loss: 0.8464 - val_loss: 0.5753
AUC: 0.8694

Epoch 69/80
 - 0s - loss: 0.8407 - val_loss: 0.5626
AUC: 0.8691

Epoch 70/80
 - 0s - loss: 0.8456 - val_loss: 0.5723
AUC: 0.8689

Epoch 71/80
 - 0s - loss: 0.8385 - val_loss: 0.5649
AUC: 0.8690

Epoch 72/80
 - 0s - loss: 0.8394 - val_loss: 0.5708
AUC: 0.8690

Epoch 73/80
 - 0s - loss: 0.8342 - val_loss: 0.5670
AUC: 0.8691

Epoch 74/80
 - 0s - loss: 0.8396 - val_loss: 0.5690
AUC: 0.8692

Epoch 75/80
 - 0s - loss: 0.8355 - val_loss: 0.5705
AUC: 0.8690

Epoch 76/80
 - 0s - loss: 0.8370 - val_loss: 0.5540
AUC: 0.8689

Epoch 77/80
 - 0s - loss: 0.8401 - val_loss: 0.5566
AUC: 0.8688

Epoch 78/80
 - 0s - loss: 0.8399 - val_loss: 0.5632
AUC: 0.8689

Epoch 79/80
 - 0s - loss: 0.8330 - val_loss: 0.5645
AUC: 0.8689

Epoch 80/80
 - 0s - loss: 0.8367 - val_loss: 0.5556
AUC: 0.8689

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9098 - val_loss: 0.5965
AUC: 0.8721

Epoch 2/30
 - 1s - loss: 0.9089 - val_loss: 0.5703
AUC: 0.8718

Epoch 3/30
 - 1s - loss: 0.9038 - val_loss: 0.6017
AUC: 0.8723

Epoch 4/30
 - 1s - loss: 0.8991 - val_loss: 0.5810
AUC: 0.8720

Epoch 5/30
 - 1s - loss: 0.8996 - val_loss: 0.5812
AUC: 0.8718

Epoch 6/30
 - 1s - loss: 0.8929 - val_loss: 0.5774
AUC: 0.8716

Epoch 7/30
 - 1s - loss: 0.8954 - val_loss: 0.5844
AUC: 0.8715

Epoch 8/30
 - 1s - loss: 0.8907 - val_loss: 0.5963
AUC: 0.8716

Epoch 9/30
 - 1s - loss: 0.8867 - val_loss: 0.5698
AUC: 0.8713

Epoch 10/30
 - 1s - loss: 0.8825 - val_loss: 0.5749
AUC: 0.8712

Epoch 11/30
 - 1s - loss: 0.8858 - val_loss: 0.5722
AUC: 0.8711

Epoch 12/30
 - 1s - loss: 0.8833 - val_loss: 0.5731
AUC: 0.8712

Epoch 13/30
 - 1s - loss: 0.8813 - val_loss: 0.5788
AUC: 0.8712

Epoch 14/30
 - 1s - loss: 0.8724 - val_loss: 0.5530
AUC: 0.8707

Epoch 15/30
 - 1s - loss: 0.8735 - val_loss: 0.5828
AUC: 0.8705

Epoch 16/30
 - 1s - loss: 0.8756 - val_loss: 0.5819
AUC: 0.8709

Epoch 17/30
 - 1s - loss: 0.8662 - val_loss: 0.5726
AUC: 0.8706

Epoch 18/30
 - 1s - loss: 0.8600 - val_loss: 0.5674
AUC: 0.8704

Epoch 19/30
 - 1s - loss: 0.8713 - val_loss: 0.5461
AUC: 0.8701

Epoch 20/30
 - 1s - loss: 0.8630 - val_loss: 0.5800
AUC: 0.8705

Epoch 21/30
 - 1s - loss: 0.8566 - val_loss: 0.5671
AUC: 0.8702

Epoch 22/30
 - 1s - loss: 0.8579 - val_loss: 0.5832
AUC: 0.8701

Epoch 23/30
 - 1s - loss: 0.8603 - val_loss: 0.5548
AUC: 0.8698

Epoch 24/30
 - 1s - loss: 0.8516 - val_loss: 0.5600
AUC: 0.8695

Epoch 25/30
 - 1s - loss: 0.8573 - val_loss: 0.5656
AUC: 0.8695

Epoch 26/30
 - 1s - loss: 0.8431 - val_loss: 0.5535
AUC: 0.8690

Epoch 27/30
 - 1s - loss: 0.8450 - val_loss: 0.5291
AUC: 0.8688

Epoch 28/30
 - 1s - loss: 0.8445 - val_loss: 0.5544
AUC: 0.8689

Epoch 29/30
 - 1s - loss: 0.8435 - val_loss: 0.5467
AUC: 0.8689

Epoch 30/30
 - 1s - loss: 0.8387 - val_loss: 0.5687
Using TensorFlow backend.
AUC: 0.8690

2019-03-08 01:59:45.952799: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 01:59:46.123531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 01:59:46.123593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 01:59:46.427020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 01:59:46.427074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 01:59:46.427083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 01:59:46.427376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.7905
Epoch 2/80
 - 2s - loss: 0.1537
Epoch 3/80
 - 2s - loss: 0.1115
Epoch 4/80
 - 2s - loss: 0.0866
Epoch 5/80
 - 2s - loss: 0.0724
Epoch 6/80
 - 2s - loss: 0.0632
Epoch 7/80
 - 2s - loss: 0.0563
Epoch 8/80
 - 2s - loss: 0.0508
Epoch 9/80
 - 2s - loss: 0.0462
Epoch 10/80
 - 2s - loss: 0.0424
Epoch 11/80
 - 2s - loss: 0.0392
Epoch 12/80
 - 2s - loss: 0.0364
Epoch 13/80
 - 2s - loss: 0.0339
Epoch 14/80
 - 2s - loss: 0.0317
Epoch 15/80
 - 2s - loss: 0.0298
Epoch 16/80
 - 2s - loss: 0.0281
Epoch 17/80
 - 2s - loss: 0.0265
Epoch 18/80
 - 2s - loss: 0.0251
Epoch 19/80
 - 2s - loss: 0.0238
Epoch 20/80
 - 2s - loss: 0.0227
Epoch 21/80
 - 2s - loss: 0.0217
Epoch 22/80
 - 2s - loss: 0.0208
Epoch 23/80
 - 2s - loss: 0.0200
Epoch 24/80
 - 2s - loss: 0.0193
Epoch 25/80
 - 2s - loss: 0.0187
Epoch 26/80
 - 2s - loss: 0.0181
Epoch 27/80
 - 2s - loss: 0.0176
Epoch 28/80
 - 2s - loss: 0.0172
Epoch 29/80
 - 2s - loss: 0.0168
Epoch 30/80
 - 2s - loss: 0.0165
Epoch 31/80
 - 2s - loss: 0.0162
Epoch 32/80
 - 2s - loss: 0.0159
Epoch 33/80
 - 2s - loss: 0.0157
Epoch 34/80
 - 2s - loss: 0.0155
Epoch 35/80
 - 2s - loss: 0.0153
Epoch 36/80
 - 2s - loss: 0.0151
Epoch 37/80
 - 2s - loss: 0.0150
Epoch 38/80
 - 2s - loss: 0.0148
Epoch 39/80
 - 2s - loss: 0.0147
Epoch 40/80
 - 2s - loss: 0.0146
Epoch 41/80
 - 2s - loss: 0.0145
Epoch 42/80
 - 2s - loss: 0.0144
Epoch 43/80
 - 2s - loss: 0.0143
Epoch 44/80
 - 2s - loss: 0.0142
Epoch 45/80
 - 2s - loss: 0.0141
Epoch 46/80
 - 2s - loss: 0.0140
Epoch 47/80
 - 2s - loss: 0.0139
Epoch 48/80
 - 2s - loss: 0.0139
Epoch 49/80
 - 2s - loss: 0.0138
Epoch 50/80
 - 2s - loss: 0.0137
Epoch 51/80
 - 2s - loss: 0.0137
Epoch 52/80
 - 2s - loss: 0.0136
Epoch 53/80
 - 2s - loss: 0.0136
Epoch 54/80
 - 2s - loss: 0.0135
Epoch 55/80
 - 2s - loss: 0.0135
Epoch 56/80
 - 2s - loss: 0.0134
Epoch 57/80
 - 2s - loss: 0.0134
Epoch 58/80
 - 2s - loss: 0.0134
Epoch 59/80
 - 2s - loss: 0.0133
Epoch 60/80
 - 2s - loss: 0.0133
Epoch 61/80
 - 2s - loss: 0.0132
Epoch 62/80
 - 2s - loss: 0.0132
Epoch 63/80
 - 2s - loss: 0.0132
Epoch 64/80
 - 2s - loss: 0.0131
Epoch 65/80
 - 2s - loss: 0.0131
Epoch 66/80
 - 2s - loss: 0.0131
Epoch 67/80
 - 2s - loss: 0.0131
Epoch 68/80
 - 2s - loss: 0.0110
Epoch 69/80
 - 2s - loss: 0.0107
Epoch 70/80
 - 2s - loss: 0.0107
Epoch 71/80
 - 2s - loss: 0.0106
Epoch 72/80
 - 2s - loss: 0.0106
Epoch 73/80
 - 2s - loss: 0.0106
Epoch 74/80
 - 2s - loss: 0.0106
Epoch 75/80
 - 2s - loss: 0.0106
Epoch 76/80
 - 2s - loss: 0.0101
Epoch 77/80
 - 2s - loss: 0.0101
Epoch 78/80
 - 2s - loss: 0.0101
Epoch 79/80
 - 2s - loss: 0.0101
Epoch 80/80
 - 2s - loss: 0.0100
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.8117 - val_loss: 1.3034
AUC: 0.7948

Epoch 2/80
 - 0s - loss: 2.4397 - val_loss: 0.9478
AUC: 0.8259

Epoch 3/80
 - 0s - loss: 1.4962 - val_loss: 0.7163
AUC: 0.8293

Epoch 4/80
 - 0s - loss: 1.2251 - val_loss: 0.6489
AUC: 0.8345

Epoch 5/80
 - 0s - loss: 1.1691 - val_loss: 0.7442
AUC: 0.8475

Epoch 6/80
 - 0s - loss: 1.1276 - val_loss: 0.6318
AUC: 0.8517

Epoch 7/80
 - 0s - loss: 1.1094 - val_loss: 0.6733
AUC: 0.8561

Epoch 8/80
 - 0s - loss: 1.0837 - val_loss: 0.6020
AUC: 0.8572

Epoch 9/80
 - 0s - loss: 1.0673 - val_loss: 0.5888
AUC: 0.8578

Epoch 10/80
 - 0s - loss: 1.0568 - val_loss: 0.6337
AUC: 0.8609

Epoch 11/80
 - 0s - loss: 1.0458 - val_loss: 0.6095
AUC: 0.8611

Epoch 12/80
 - 0s - loss: 1.0299 - val_loss: 0.6481
AUC: 0.8639

Epoch 13/80
 - 0s - loss: 1.0269 - val_loss: 0.5793
AUC: 0.8640

Epoch 14/80
 - 0s - loss: 1.0255 - val_loss: 0.6471
AUC: 0.8661

Epoch 15/80
 - 0s - loss: 1.0118 - val_loss: 0.5987
AUC: 0.8658

Epoch 16/80
 - 0s - loss: 1.0039 - val_loss: 0.5985
AUC: 0.8671

Epoch 17/80
 - 0s - loss: 0.9929 - val_loss: 0.6940
AUC: 0.8686

Epoch 18/80
 - 0s - loss: 0.9976 - val_loss: 0.6075
AUC: 0.8678

Epoch 19/80
 - 0s - loss: 0.9854 - val_loss: 0.5644
AUC: 0.8667

Epoch 20/80
 - 0s - loss: 0.9797 - val_loss: 0.5514
AUC: 0.8668

Epoch 21/80
 - 0s - loss: 0.9787 - val_loss: 0.6184
AUC: 0.8685

Epoch 22/80
 - 0s - loss: 0.9653 - val_loss: 0.5679
AUC: 0.8673

Epoch 23/80
 - 0s - loss: 0.9690 - val_loss: 0.5777
AUC: 0.8690

Epoch 24/80
 - 0s - loss: 0.9647 - val_loss: 0.6782
AUC: 0.8702

Epoch 25/80
 - 0s - loss: 0.9537 - val_loss: 0.5504
AUC: 0.8688

Epoch 26/80
 - 0s - loss: 0.9529 - val_loss: 0.5275
AUC: 0.8671

Epoch 27/80
 - 0s - loss: 0.9480 - val_loss: 0.5529
AUC: 0.8672

Epoch 28/80
 - 0s - loss: 0.9425 - val_loss: 0.5982
AUC: 0.8684

Epoch 29/80
 - 0s - loss: 0.9433 - val_loss: 0.6076
AUC: 0.8696

Epoch 30/80
 - 0s - loss: 0.9293 - val_loss: 0.5553
AUC: 0.8687

Epoch 31/80
 - 0s - loss: 0.9251 - val_loss: 0.5482
AUC: 0.8694

Epoch 32/80
 - 0s - loss: 0.9239 - val_loss: 0.5182
AUC: 0.8684

Epoch 33/80
 - 0s - loss: 0.9288 - val_loss: 0.5744
AUC: 0.8688

Epoch 34/80
 - 0s - loss: 0.9132 - val_loss: 0.5528
AUC: 0.8687

Epoch 35/80
 - 0s - loss: 0.9074 - val_loss: 0.5450
AUC: 0.8687

Epoch 36/80
 - 0s - loss: 0.9051 - val_loss: 0.6171
AUC: 0.8697

Epoch 37/80
 - 0s - loss: 0.9002 - val_loss: 0.5571
AUC: 0.8691

Epoch 38/80
 - 0s - loss: 0.8930 - val_loss: 0.5674
AUC: 0.8693

Epoch 39/80
 - 0s - loss: 0.8886 - val_loss: 0.6011
AUC: 0.8688

Epoch 40/80
 - 0s - loss: 0.8855 - val_loss: 0.5857
AUC: 0.8696

Epoch 41/80
 - 0s - loss: 0.8813 - val_loss: 0.5412
AUC: 0.8678

Epoch 42/80
 - 0s - loss: 0.8758 - val_loss: 0.6022
AUC: 0.8682

Epoch 43/80
 - 0s - loss: 0.8612 - val_loss: 0.5420
AUC: 0.8674

Epoch 44/80
 - 0s - loss: 0.8583 - val_loss: 0.5396
AUC: 0.8673

Epoch 45/80
 - 0s - loss: 0.8552 - val_loss: 0.5643
AUC: 0.8671

Epoch 46/80
 - 0s - loss: 0.8542 - val_loss: 0.5590
AUC: 0.8675

Epoch 47/80
 - 0s - loss: 0.8545 - val_loss: 0.5752
AUC: 0.8677

Epoch 48/80
 - 0s - loss: 0.8494 - val_loss: 0.5436
AUC: 0.8670

Epoch 49/80
 - 0s - loss: 0.8499 - val_loss: 0.5555
AUC: 0.8671

Epoch 50/80
 - 0s - loss: 0.8438 - val_loss: 0.5479
AUC: 0.8669

Epoch 51/80
 - 0s - loss: 0.8431 - val_loss: 0.5500
AUC: 0.8672

Epoch 52/80
 - 0s - loss: 0.8449 - val_loss: 0.5369
AUC: 0.8660

Epoch 53/80
 - 0s - loss: 0.8394 - val_loss: 0.5430
AUC: 0.8665

Epoch 54/80
 - 0s - loss: 0.8415 - val_loss: 0.5560
AUC: 0.8669

Epoch 55/80
 - 0s - loss: 0.8404 - val_loss: 0.5504
AUC: 0.8668

Epoch 56/80
 - 0s - loss: 0.8414 - val_loss: 0.5498
AUC: 0.8669

Epoch 57/80
 - 0s - loss: 0.8426 - val_loss: 0.5473
AUC: 0.8668

Epoch 58/80
 - 0s - loss: 0.8352 - val_loss: 0.5484
AUC: 0.8668

Epoch 59/80
 - 0s - loss: 0.8425 - val_loss: 0.5542
AUC: 0.8670

Epoch 60/80
 - 0s - loss: 0.8393 - val_loss: 0.5517
AUC: 0.8668

Epoch 61/80
 - 0s - loss: 0.8370 - val_loss: 0.5435
AUC: 0.8667

Epoch 62/80
 - 0s - loss: 0.8391 - val_loss: 0.5485
AUC: 0.8668

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9519 - val_loss: 0.5955
AUC: 0.8698

Epoch 2/30
 - 1s - loss: 0.9402 - val_loss: 0.5825
AUC: 0.8695

Epoch 3/30
 - 1s - loss: 0.9447 - val_loss: 0.5813
AUC: 0.8695

Epoch 4/30
 - 1s - loss: 0.9323 - val_loss: 0.5982
AUC: 0.8697

Epoch 5/30
 - 1s - loss: 0.9279 - val_loss: 0.5584
AUC: 0.8690

Epoch 6/30
 - 1s - loss: 0.9293 - val_loss: 0.6092
AUC: 0.8700

Epoch 7/30
 - 1s - loss: 0.9319 - val_loss: 0.5837
AUC: 0.8695

Epoch 8/30
 - 1s - loss: 0.9184 - val_loss: 0.5613
AUC: 0.8693

Epoch 9/30
 - 1s - loss: 0.9181 - val_loss: 0.5693
AUC: 0.8695

Epoch 10/30
 - 1s - loss: 0.9184 - val_loss: 0.5773
AUC: 0.8697

Epoch 11/30
 - 1s - loss: 0.9141 - val_loss: 0.5587
AUC: 0.8692

Epoch 12/30
 - 1s - loss: 0.9092 - val_loss: 0.5584
AUC: 0.8690

Epoch 13/30
 - 1s - loss: 0.9054 - val_loss: 0.5837
AUC: 0.8696

Epoch 14/30
 - 1s - loss: 0.9079 - val_loss: 0.5802
AUC: 0.8695

Epoch 15/30
 - 1s - loss: 0.9004 - val_loss: 0.5929
AUC: 0.8697

Epoch 16/30
 - 1s - loss: 0.9023 - val_loss: 0.5688
AUC: 0.8693

Epoch 17/30
 - 1s - loss: 0.8925 - val_loss: 0.5636
AUC: 0.8691

Epoch 18/30
 - 1s - loss: 0.8991 - val_loss: 0.5650
AUC: 0.8692

Epoch 19/30
 - 1s - loss: 0.8970 - val_loss: 0.5653
AUC: 0.8691

Epoch 20/30
 - 1s - loss: 0.8965 - val_loss: 0.5665
AUC: 0.8692

Epoch 21/30
 - 1s - loss: 0.8958 - val_loss: 0.5721
AUC: 0.8693

Epoch 22/30
 - 1s - loss: 0.8928 - val_loss: 0.5621
AUC: 0.8691

Epoch 23/30
 - 1s - loss: 0.8878 - val_loss: 0.5687
AUC: 0.8692

Epoch 24/30
 - 1s - loss: 0.8960 - val_loss: 0.5630
AUC: 0.8691

Epoch 25/30
 - 1s - loss: 0.8986 - val_loss: 0.5653
AUC: 0.8691

Epoch 26/30
 - 1s - loss: 0.8909 - val_loss: 0.5659
AUC: 0.8691

Epoch 27/30
 - 1s - loss: 0.8942 - val_loss: 0.5655
AUC: 0.8691

Epoch 28/30
 - 1s - loss: 0.8903 - val_loss: 0.5663
AUC: 0.8691

Epoch 29/30
 - 1s - loss: 0.8941 - val_loss: 0.5668
AUC: 0.8691

Epoch 30/30
 - 1s - loss: 0.8932 - val_loss: 0.5668
Using TensorFlow backend.
AUC: 0.8691

2019-03-08 02:04:05.019967: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:04:05.189321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:04:05.189368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:04:05.491729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:04:05.491790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:04:05.491800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:04:05.492067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.8044
Epoch 2/80
 - 2s - loss: 0.1552
Epoch 3/80
 - 2s - loss: 0.1124
Epoch 4/80
 - 2s - loss: 0.0866
Epoch 5/80
 - 2s - loss: 0.0724
Epoch 6/80
 - 2s - loss: 0.0631
Epoch 7/80
 - 2s - loss: 0.0563
Epoch 8/80
 - 2s - loss: 0.0509
Epoch 9/80
 - 2s - loss: 0.0464
Epoch 10/80
 - 2s - loss: 0.0426
Epoch 11/80
 - 2s - loss: 0.0394
Epoch 12/80
 - 2s - loss: 0.0365
Epoch 13/80
 - 2s - loss: 0.0341
Epoch 14/80
 - 2s - loss: 0.0319
Epoch 15/80
 - 2s - loss: 0.0299
Epoch 16/80
 - 2s - loss: 0.0282
Epoch 17/80
 - 2s - loss: 0.0266
Epoch 18/80
 - 2s - loss: 0.0252
Epoch 19/80
 - 2s - loss: 0.0240
Epoch 20/80
 - 2s - loss: 0.0229
Epoch 21/80
 - 2s - loss: 0.0219
Epoch 22/80
 - 2s - loss: 0.0210
Epoch 23/80
 - 2s - loss: 0.0202
Epoch 24/80
 - 2s - loss: 0.0195
Epoch 25/80
 - 2s - loss: 0.0188
Epoch 26/80
 - 2s - loss: 0.0183
Epoch 27/80
 - 2s - loss: 0.0178
Epoch 28/80
 - 2s - loss: 0.0173
Epoch 29/80
 - 2s - loss: 0.0170
Epoch 30/80
 - 2s - loss: 0.0166
Epoch 31/80
 - 2s - loss: 0.0163
Epoch 32/80
 - 2s - loss: 0.0160
Epoch 33/80
 - 2s - loss: 0.0158
Epoch 34/80
 - 2s - loss: 0.0156
Epoch 35/80
 - 2s - loss: 0.0154
Epoch 36/80
 - 2s - loss: 0.0152
Epoch 37/80
 - 2s - loss: 0.0151
Epoch 38/80
 - 2s - loss: 0.0149
Epoch 39/80
 - 2s - loss: 0.0148
Epoch 40/80
 - 2s - loss: 0.0147
Epoch 41/80
 - 2s - loss: 0.0145
Epoch 42/80
 - 2s - loss: 0.0144
Epoch 43/80
 - 2s - loss: 0.0143
Epoch 44/80
 - 2s - loss: 0.0143
Epoch 45/80
 - 2s - loss: 0.0142
Epoch 46/80
 - 2s - loss: 0.0141
Epoch 47/80
 - 2s - loss: 0.0140
Epoch 48/80
 - 2s - loss: 0.0139
Epoch 49/80
 - 2s - loss: 0.0139
Epoch 50/80
 - 2s - loss: 0.0138
Epoch 51/80
 - 2s - loss: 0.0137
Epoch 52/80
 - 2s - loss: 0.0137
Epoch 53/80
 - 2s - loss: 0.0136
Epoch 54/80
 - 2s - loss: 0.0136
Epoch 55/80
 - 2s - loss: 0.0135
Epoch 56/80
 - 2s - loss: 0.0135
Epoch 57/80
 - 2s - loss: 0.0134
Epoch 58/80
 - 2s - loss: 0.0134
Epoch 59/80
 - 2s - loss: 0.0134
Epoch 60/80
 - 2s - loss: 0.0133
Epoch 61/80
 - 2s - loss: 0.0133
Epoch 62/80
 - 2s - loss: 0.0132
Epoch 63/80
 - 2s - loss: 0.0133
Epoch 64/80
 - 2s - loss: 0.0111
Epoch 65/80
 - 2s - loss: 0.0108
Epoch 66/80
 - 2s - loss: 0.0108
Epoch 67/80
 - 2s - loss: 0.0108
Epoch 68/80
 - 2s - loss: 0.0107
Epoch 69/80
 - 2s - loss: 0.0107
Epoch 70/80
 - 2s - loss: 0.0107
Epoch 71/80
 - 2s - loss: 0.0107
Epoch 72/80
 - 2s - loss: 0.0102
Epoch 73/80
 - 2s - loss: 0.0102
Epoch 74/80
 - 2s - loss: 0.0102
Epoch 75/80
 - 2s - loss: 0.0102
Epoch 76/80
 - 2s - loss: 0.0101
Epoch 77/80
 - 2s - loss: 0.0101
Epoch 78/80
 - 2s - loss: 0.0101
Epoch 79/80
 - 2s - loss: 0.0101
Epoch 80/80
 - 2s - loss: 0.0101
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.0201 - val_loss: 1.0213
AUC: 0.8159

Epoch 2/80
 - 0s - loss: 1.4564 - val_loss: 0.7268
AUC: 0.8331

Epoch 3/80
 - 0s - loss: 1.2041 - val_loss: 0.7136
AUC: 0.8430

Epoch 4/80
 - 0s - loss: 1.1358 - val_loss: 0.7354
AUC: 0.8514

Epoch 5/80
 - 0s - loss: 1.1002 - val_loss: 0.5565
AUC: 0.8506

Epoch 6/80
 - 0s - loss: 1.0764 - val_loss: 0.6024
AUC: 0.8565

Epoch 7/80
 - 0s - loss: 1.0633 - val_loss: 0.7320
AUC: 0.8601

Epoch 8/80
 - 0s - loss: 1.0460 - val_loss: 0.6668
AUC: 0.8617

Epoch 9/80
 - 0s - loss: 1.0328 - val_loss: 0.6557
AUC: 0.8628

Epoch 10/80
 - 0s - loss: 1.0190 - val_loss: 0.7040
AUC: 0.8637

Epoch 11/80
 - 0s - loss: 1.0118 - val_loss: 0.6066
AUC: 0.8638

Epoch 12/80
 - 0s - loss: 1.0088 - val_loss: 0.5684
AUC: 0.8623

Epoch 13/80
 - 0s - loss: 1.0012 - val_loss: 0.6299
AUC: 0.8639

Epoch 14/80
 - 0s - loss: 0.9832 - val_loss: 0.6524
AUC: 0.8654

Epoch 15/80
 - 0s - loss: 0.9799 - val_loss: 0.6002
AUC: 0.8644

Epoch 16/80
 - 0s - loss: 0.9633 - val_loss: 0.5844
AUC: 0.8649

Epoch 17/80
 - 0s - loss: 0.9625 - val_loss: 0.6073
AUC: 0.8654

Epoch 18/80
 - 0s - loss: 0.9606 - val_loss: 0.5891
AUC: 0.8647

Epoch 19/80
 - 0s - loss: 0.9578 - val_loss: 0.6224
AUC: 0.8656

Epoch 20/80
 - 0s - loss: 0.9520 - val_loss: 0.6087
AUC: 0.8655

Epoch 21/80
 - 0s - loss: 0.9499 - val_loss: 0.5949
AUC: 0.8656

Epoch 22/80
 - 0s - loss: 0.9549 - val_loss: 0.5908
AUC: 0.8656

Epoch 23/80
 - 0s - loss: 0.9526 - val_loss: 0.6251
AUC: 0.8659

Epoch 24/80
 - 0s - loss: 0.9515 - val_loss: 0.5837
AUC: 0.8655

Epoch 25/80
 - 0s - loss: 0.9480 - val_loss: 0.6107
AUC: 0.8656

Epoch 26/80
 - 0s - loss: 0.9410 - val_loss: 0.5967
AUC: 0.8656

Epoch 27/80
 - 0s - loss: 0.9430 - val_loss: 0.6016
AUC: 0.8657

Epoch 28/80
 - 0s - loss: 0.9434 - val_loss: 0.6051
AUC: 0.8656

Epoch 29/80
 - 0s - loss: 0.9440 - val_loss: 0.5809
AUC: 0.8652

Epoch 30/80
 - 0s - loss: 0.9418 - val_loss: 0.5972
AUC: 0.8656

Epoch 31/80
 - 0s - loss: 0.9427 - val_loss: 0.5929
AUC: 0.8655

Epoch 32/80
 - 0s - loss: 0.9402 - val_loss: 0.6081
AUC: 0.8657

Epoch 33/80
 - 0s - loss: 0.9373 - val_loss: 0.5974
AUC: 0.8656

Epoch 34/80
 - 0s - loss: 0.9404 - val_loss: 0.5986
AUC: 0.8656

Epoch 35/80
 - 0s - loss: 0.9375 - val_loss: 0.5875
AUC: 0.8654

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9486 - val_loss: 0.6218
AUC: 0.8662

Epoch 2/30
 - 1s - loss: 0.9396 - val_loss: 0.6045
AUC: 0.8661

Epoch 3/30
 - 1s - loss: 0.9438 - val_loss: 0.6343
AUC: 0.8666

Epoch 4/30
 - 1s - loss: 0.9376 - val_loss: 0.5661
AUC: 0.8654

Epoch 5/30
 - 1s - loss: 0.9301 - val_loss: 0.6056
AUC: 0.8661

Epoch 6/30
 - 1s - loss: 0.9298 - val_loss: 0.5689
AUC: 0.8658

Epoch 7/30
 - 1s - loss: 0.9295 - val_loss: 0.5734
AUC: 0.8658

Epoch 8/30
 - 1s - loss: 0.9281 - val_loss: 0.6012
AUC: 0.8664

Epoch 9/30
 - 1s - loss: 0.9286 - val_loss: 0.5994
AUC: 0.8664

Epoch 10/30
 - 1s - loss: 0.9159 - val_loss: 0.5762
AUC: 0.8660

Epoch 11/30
 - 1s - loss: 0.9153 - val_loss: 0.5804
AUC: 0.8659

Epoch 12/30
 - 1s - loss: 0.9145 - val_loss: 0.5869
AUC: 0.8660

Epoch 13/30
 - 1s - loss: 0.9149 - val_loss: 0.5898
AUC: 0.8663

Epoch 14/30
 - 1s - loss: 0.9090 - val_loss: 0.5948
AUC: 0.8665

Epoch 15/30
 - 1s - loss: 0.9060 - val_loss: 0.5831
AUC: 0.8663

Epoch 16/30
 - 1s - loss: 0.9014 - val_loss: 0.5858
AUC: 0.8663

Epoch 17/30
 - 1s - loss: 0.9010 - val_loss: 0.5916
AUC: 0.8664

Epoch 18/30
 - 1s - loss: 0.8994 - val_loss: 0.5817
AUC: 0.8663

Epoch 19/30
 - 1s - loss: 0.9020 - val_loss: 0.5903
AUC: 0.8664

Epoch 20/30
 - 1s - loss: 0.9008 - val_loss: 0.5944
AUC: 0.8664

Epoch 21/30
 - 1s - loss: 0.9006 - val_loss: 0.5828
AUC: 0.8662

Epoch 22/30
 - 1s - loss: 0.9008 - val_loss: 0.5845
AUC: 0.8662

Epoch 23/30
 - 1s - loss: 0.9043 - val_loss: 0.5795
AUC: 0.8661

Epoch 24/30
 - 1s - loss: 0.8894 - val_loss: 0.5762
AUC: 0.8661

Epoch 25/30
 - 1s - loss: 0.8991 - val_loss: 0.5791
AUC: 0.8661

Epoch 26/30
 - 1s - loss: 0.8940 - val_loss: 0.5822
AUC: 0.8662

Epoch 27/30
 - 1s - loss: 0.9009 - val_loss: 0.5830
AUC: 0.8662

Epoch 28/30
 - 1s - loss: 0.8971 - val_loss: 0.5820
AUC: 0.8662

Epoch 29/30
 - 1s - loss: 0.8931 - val_loss: 0.5805
AUC: 0.8661

Epoch 30/30
 - 1s - loss: 0.8923 - val_loss: 0.5812
Using TensorFlow backend.
AUC: 0.8662

2019-03-08 02:08:07.312567: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:08:07.483513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:08:07.483560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:08:07.785833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:08:07.785890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:08:07.785911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:08:07.786200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.8010
Epoch 2/80
 - 2s - loss: 0.1528
Epoch 3/80
 - 2s - loss: 0.1103
Epoch 4/80
 - 2s - loss: 0.0863
Epoch 5/80
 - 2s - loss: 0.0726
Epoch 6/80
 - 2s - loss: 0.0634
Epoch 7/80
 - 2s - loss: 0.0565
Epoch 8/80
 - 2s - loss: 0.0510
Epoch 9/80
 - 2s - loss: 0.0465
Epoch 10/80
 - 2s - loss: 0.0428
Epoch 11/80
 - 2s - loss: 0.0395
Epoch 12/80
 - 2s - loss: 0.0367
Epoch 13/80
 - 2s - loss: 0.0342
Epoch 14/80
 - 2s - loss: 0.0320
Epoch 15/80
 - 2s - loss: 0.0301
Epoch 16/80
 - 2s - loss: 0.0283
Epoch 17/80
 - 2s - loss: 0.0267
Epoch 18/80
 - 2s - loss: 0.0253
Epoch 19/80
 - 2s - loss: 0.0241
Epoch 20/80
 - 2s - loss: 0.0230
Epoch 21/80
 - 2s - loss: 0.0220
Epoch 22/80
 - 2s - loss: 0.0211
Epoch 23/80
 - 2s - loss: 0.0203
Epoch 24/80
 - 2s - loss: 0.0196
Epoch 25/80
 - 2s - loss: 0.0189
Epoch 26/80
 - 2s - loss: 0.0184
Epoch 27/80
 - 2s - loss: 0.0179
Epoch 28/80
 - 2s - loss: 0.0175
Epoch 29/80
 - 2s - loss: 0.0171
Epoch 30/80
 - 2s - loss: 0.0168
Epoch 31/80
 - 2s - loss: 0.0165
Epoch 32/80
 - 2s - loss: 0.0162
Epoch 33/80
 - 2s - loss: 0.0159
Epoch 34/80
 - 2s - loss: 0.0157
Epoch 35/80
 - 2s - loss: 0.0155
Epoch 36/80
 - 2s - loss: 0.0154
Epoch 37/80
 - 2s - loss: 0.0152
Epoch 38/80
 - 2s - loss: 0.0151
Epoch 39/80
 - 2s - loss: 0.0149
Epoch 40/80
 - 2s - loss: 0.0148
Epoch 41/80
 - 2s - loss: 0.0147
Epoch 42/80
 - 2s - loss: 0.0146
Epoch 43/80
 - 2s - loss: 0.0145
Epoch 44/80
 - 2s - loss: 0.0144
Epoch 45/80
 - 2s - loss: 0.0143
Epoch 46/80
 - 2s - loss: 0.0142
Epoch 47/80
 - 2s - loss: 0.0141
Epoch 48/80
 - 2s - loss: 0.0141
Epoch 49/80
 - 2s - loss: 0.0140
Epoch 50/80
 - 2s - loss: 0.0139
Epoch 51/80
 - 2s - loss: 0.0139
Epoch 52/80
 - 2s - loss: 0.0138
Epoch 53/80
 - 2s - loss: 0.0138
Epoch 54/80
 - 2s - loss: 0.0137
Epoch 55/80
 - 2s - loss: 0.0137
Epoch 56/80
 - 2s - loss: 0.0136
Epoch 57/80
 - 2s - loss: 0.0136
Epoch 58/80
 - 2s - loss: 0.0135
Epoch 59/80
 - 2s - loss: 0.0135
Epoch 60/80
 - 2s - loss: 0.0135
Epoch 61/80
 - 2s - loss: 0.0134
Epoch 62/80
 - 2s - loss: 0.0134
Epoch 63/80
 - 2s - loss: 0.0134
Epoch 64/80
 - 2s - loss: 0.0133
Epoch 65/80
 - 2s - loss: 0.0133
Epoch 66/80
 - 2s - loss: 0.0112
Epoch 67/80
 - 2s - loss: 0.0109
Epoch 68/80
 - 2s - loss: 0.0109
Epoch 69/80
 - 2s - loss: 0.0108
Epoch 70/80
 - 2s - loss: 0.0108
Epoch 71/80
 - 2s - loss: 0.0108
Epoch 72/80
 - 2s - loss: 0.0108
Epoch 73/80
 - 2s - loss: 0.0108
Epoch 74/80
 - 2s - loss: 0.0103
Epoch 75/80
 - 2s - loss: 0.0103
Epoch 76/80
 - 2s - loss: 0.0103
Epoch 77/80
 - 2s - loss: 0.0103
Epoch 78/80
 - 2s - loss: 0.0102
Epoch 79/80
 - 2s - loss: 0.0102
Epoch 80/80
 - 2s - loss: 0.0102
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.8632 - val_loss: 1.4788
AUC: 0.8187

Epoch 2/80
 - 0s - loss: 1.8228 - val_loss: 0.7153
AUC: 0.8275

Epoch 3/80
 - 0s - loss: 1.2721 - val_loss: 0.7213
AUC: 0.8398

Epoch 4/80
 - 0s - loss: 1.1783 - val_loss: 0.6314
AUC: 0.8435

Epoch 5/80
 - 0s - loss: 1.1231 - val_loss: 0.6869
AUC: 0.8485

Epoch 6/80
 - 0s - loss: 1.1001 - val_loss: 0.6716
AUC: 0.8539

Epoch 7/80
 - 0s - loss: 1.0756 - val_loss: 0.6246
AUC: 0.8553

Epoch 8/80
 - 0s - loss: 1.0588 - val_loss: 0.6592
AUC: 0.8565

Epoch 9/80
 - 0s - loss: 1.0552 - val_loss: 0.6835
AUC: 0.8591

Epoch 10/80
 - 0s - loss: 1.0418 - val_loss: 0.6435
AUC: 0.8615

Epoch 11/80
 - 0s - loss: 1.0248 - val_loss: 0.6173
AUC: 0.8615

Epoch 12/80
 - 0s - loss: 1.0141 - val_loss: 0.6482
AUC: 0.8622

Epoch 13/80
 - 0s - loss: 1.0044 - val_loss: 0.6552
AUC: 0.8610

Epoch 14/80
 - 0s - loss: 1.0021 - val_loss: 0.6702
AUC: 0.8652

Epoch 15/80
 - 0s - loss: 0.9966 - val_loss: 0.6310
AUC: 0.8652

Epoch 16/80
 - 0s - loss: 0.9857 - val_loss: 0.6422
AUC: 0.8634

Epoch 17/80
 - 0s - loss: 0.9836 - val_loss: 0.6274
AUC: 0.8641

Epoch 18/80
 - 0s - loss: 0.9715 - val_loss: 0.5878
AUC: 0.8655

Epoch 19/80
 - 0s - loss: 0.9687 - val_loss: 0.5988
AUC: 0.8658

Epoch 20/80
 - 0s - loss: 0.9552 - val_loss: 0.5657
AUC: 0.8646

Epoch 21/80
 - 0s - loss: 0.9599 - val_loss: 0.6432
AUC: 0.8664

Epoch 22/80
 - 0s - loss: 0.9560 - val_loss: 0.6955
AUC: 0.8657

Epoch 23/80
 - 0s - loss: 0.9475 - val_loss: 0.5584
AUC: 0.8648

Epoch 24/80
 - 0s - loss: 0.9470 - val_loss: 0.6174
AUC: 0.8660

Epoch 25/80
 - 0s - loss: 0.9354 - val_loss: 0.5724
AUC: 0.8662

Epoch 26/80
 - 0s - loss: 0.9293 - val_loss: 0.6043
AUC: 0.8650

Epoch 27/80
 - 0s - loss: 0.9218 - val_loss: 0.5033
AUC: 0.8639

Epoch 28/80
 - 0s - loss: 0.9347 - val_loss: 0.6331
AUC: 0.8669

Epoch 29/80
 - 0s - loss: 0.9216 - val_loss: 0.6440
AUC: 0.8656

Epoch 30/80
 - 0s - loss: 0.9063 - val_loss: 0.4838
AUC: 0.8642

Epoch 31/80
 - 0s - loss: 0.9096 - val_loss: 0.5543
AUC: 0.8654

Epoch 32/80
 - 0s - loss: 0.9206 - val_loss: 0.5417
AUC: 0.8646

Epoch 33/80
 - 0s - loss: 0.9033 - val_loss: 0.5692
AUC: 0.8649

Epoch 34/80
 - 0s - loss: 0.8911 - val_loss: 0.6009
AUC: 0.8652

Epoch 35/80
 - 0s - loss: 0.8908 - val_loss: 0.6073
AUC: 0.8644

Epoch 36/80
 - 0s - loss: 0.8789 - val_loss: 0.5456
AUC: 0.8642

Epoch 37/80
 - 0s - loss: 0.8910 - val_loss: 0.5830
AUC: 0.8644

Epoch 38/80
 - 0s - loss: 0.8804 - val_loss: 0.5505
AUC: 0.8642

Epoch 39/80
 - 0s - loss: 0.8669 - val_loss: 0.5711
AUC: 0.8648

Epoch 40/80
 - 0s - loss: 0.8662 - val_loss: 0.6295
AUC: 0.8637

Epoch 41/80
 - 0s - loss: 0.8395 - val_loss: 0.5784
AUC: 0.8641

Epoch 42/80
 - 0s - loss: 0.8395 - val_loss: 0.5683
AUC: 0.8640

Epoch 43/80
 - 0s - loss: 0.8352 - val_loss: 0.5677
AUC: 0.8642

Epoch 44/80
 - 0s - loss: 0.8325 - val_loss: 0.5742
AUC: 0.8641

Epoch 45/80
 - 0s - loss: 0.8336 - val_loss: 0.5572
AUC: 0.8637

Epoch 46/80
 - 0s - loss: 0.8328 - val_loss: 0.5507
AUC: 0.8637

Epoch 47/80
 - 0s - loss: 0.8346 - val_loss: 0.5545
AUC: 0.8634

Epoch 48/80
 - 0s - loss: 0.8281 - val_loss: 0.5991
AUC: 0.8639

Epoch 49/80
 - 0s - loss: 0.8375 - val_loss: 0.5622
AUC: 0.8631

Epoch 50/80
 - 0s - loss: 0.8310 - val_loss: 0.5508
AUC: 0.8626

Epoch 51/80
 - 0s - loss: 0.8258 - val_loss: 0.5612
AUC: 0.8630

Epoch 52/80
 - 0s - loss: 0.8235 - val_loss: 0.5639
AUC: 0.8631

Epoch 53/80
 - 0s - loss: 0.8241 - val_loss: 0.5641
AUC: 0.8631

Epoch 54/80
 - 0s - loss: 0.8192 - val_loss: 0.5465
AUC: 0.8630

Epoch 55/80
 - 0s - loss: 0.8229 - val_loss: 0.5531
AUC: 0.8630

Epoch 56/80
 - 0s - loss: 0.8181 - val_loss: 0.5602
AUC: 0.8630

Epoch 57/80
 - 0s - loss: 0.8232 - val_loss: 0.5543
AUC: 0.8629

Epoch 58/80
 - 0s - loss: 0.8180 - val_loss: 0.5654
AUC: 0.8630

Epoch 59/80
 - 0s - loss: 0.8263 - val_loss: 0.5652
AUC: 0.8630

Epoch 60/80
 - 0s - loss: 0.8229 - val_loss: 0.5647
AUC: 0.8629

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9080 - val_loss: 0.5807
AUC: 0.8663

Epoch 2/30
 - 1s - loss: 0.8942 - val_loss: 0.5859
AUC: 0.8663

Epoch 3/30
 - 1s - loss: 0.8901 - val_loss: 0.6019
AUC: 0.8664

Epoch 4/30
 - 1s - loss: 0.8910 - val_loss: 0.5915
AUC: 0.8662

Epoch 5/30
 - 1s - loss: 0.8890 - val_loss: 0.5794
AUC: 0.8660

Epoch 6/30
 - 1s - loss: 0.8865 - val_loss: 0.5615
AUC: 0.8659

Epoch 7/30
 - 1s - loss: 0.8862 - val_loss: 0.5874
AUC: 0.8657

Epoch 8/30
 - 1s - loss: 0.8748 - val_loss: 0.5975
AUC: 0.8658

Epoch 9/30
 - 1s - loss: 0.8777 - val_loss: 0.5815
AUC: 0.8656

Epoch 10/30
 - 1s - loss: 0.8781 - val_loss: 0.5816
AUC: 0.8655

Epoch 11/30
 - 1s - loss: 0.8665 - val_loss: 0.5765
AUC: 0.8653

Epoch 12/30
 - 1s - loss: 0.8672 - val_loss: 0.5715
AUC: 0.8651

Epoch 13/30
 - 1s - loss: 0.8650 - val_loss: 0.5880
AUC: 0.8652

Epoch 14/30
 - 1s - loss: 0.8634 - val_loss: 0.5888
AUC: 0.8650

Epoch 15/30
 - 1s - loss: 0.8601 - val_loss: 0.5706
AUC: 0.8649

Epoch 16/30
 - 1s - loss: 0.8597 - val_loss: 0.5928
AUC: 0.8651

Epoch 17/30
 - 1s - loss: 0.8570 - val_loss: 0.5764
AUC: 0.8649

Epoch 18/30
 - 1s - loss: 0.8546 - val_loss: 0.5611
AUC: 0.8646

Epoch 19/30
 - 1s - loss: 0.8552 - val_loss: 0.5677
AUC: 0.8647

Epoch 20/30
 - 1s - loss: 0.8488 - val_loss: 0.5699
AUC: 0.8647

Epoch 21/30
 - 1s - loss: 0.8513 - val_loss: 0.5678
AUC: 0.8646

Epoch 22/30
 - 1s - loss: 0.8547 - val_loss: 0.5691
AUC: 0.8646

Epoch 23/30
 - 1s - loss: 0.8450 - val_loss: 0.5711
AUC: 0.8647

Epoch 24/30
 - 1s - loss: 0.8513 - val_loss: 0.5665
AUC: 0.8646

Epoch 25/30
 - 1s - loss: 0.8427 - val_loss: 0.5706
AUC: 0.8646

Epoch 26/30
 - 1s - loss: 0.8443 - val_loss: 0.5669
AUC: 0.8645

Epoch 27/30
 - 1s - loss: 0.8484 - val_loss: 0.5585
AUC: 0.8644

Epoch 28/30
 - 1s - loss: 0.8437 - val_loss: 0.5676
AUC: 0.8645

Epoch 29/30
 - 1s - loss: 0.8473 - val_loss: 0.5636
AUC: 0.8644

Epoch 30/30
 - 1s - loss: 0.8405 - val_loss: 0.5628
Using TensorFlow backend.
AUC: 0.8644

2019-03-08 02:12:20.656138: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:12:20.824403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:12:20.824449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:12:21.124089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:12:21.124141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:12:21.124151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:12:21.124416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3623
Epoch 2/80
 - 2s - loss: 0.3513
Epoch 3/80
 - 2s - loss: 0.3065
Epoch 4/80
 - 2s - loss: 0.2901
Epoch 5/80
 - 2s - loss: 0.2713
Epoch 6/80
 - 2s - loss: 0.2534
Epoch 7/80
 - 2s - loss: 0.2381
Epoch 8/80
 - 2s - loss: 0.2239
Epoch 9/80
 - 2s - loss: 0.2103
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:13:01.419092: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:13:01.586759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:13:01.586830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:13:01.895144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:13:01.895186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:13:01.895195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:13:01.895559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.2 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3789
Epoch 2/80
 - 2s - loss: 0.3541
Epoch 3/80
 - 2s - loss: 0.3053
Epoch 4/80
 - 2s - loss: 0.2874
Epoch 5/80
 - 2s - loss: 0.2701
Epoch 6/80
 - 2s - loss: 0.2528
Epoch 7/80
 - 2s - loss: 0.2338
Epoch 8/80
 - 2s - loss: 0.2157
Epoch 9/80
 - 2s - loss: 0.2016
Epoch 10/80
 - 2s - loss: 0.1902
Epoch 11/80
 - 2s - loss: 0.1805
Epoch 12/80
 - 2s - loss: 0.1721
Epoch 13/80
 - 2s - loss: 0.1647
Epoch 14/80
 - 2s - loss: 0.1581
Epoch 15/80
 - 2s - loss: 0.1520
Epoch 16/80
 - 2s - loss: 0.1464
Epoch 17/80
 - 2s - loss: 0.1416
Epoch 18/80
 - 2s - loss: 0.1374
Epoch 19/80
 - 2s - loss: 0.1341
Epoch 20/80
 - 2s - loss: 0.1313
Epoch 21/80
 - 2s - loss: 0.1291
Epoch 22/80
 - 2s - loss: 0.1271
Epoch 23/80
 - 2s - loss: 0.1255
Epoch 24/80
 - 2s - loss: 0.1241
Epoch 25/80
 - 2s - loss: 0.1229
Epoch 26/80
 - 2s - loss: 0.1219
Epoch 27/80
 - 2s - loss: 0.1210
Epoch 28/80
 - 2s - loss: 0.1203
Epoch 29/80
 - 2s - loss: 0.1196
Epoch 30/80
 - 2s - loss: 0.1191
Epoch 31/80
 - 2s - loss: 0.1186
Epoch 32/80
 - 2s - loss: 0.1182
Epoch 33/80
 - 2s - loss: 0.1178
Epoch 34/80
 - 2s - loss: 0.1174
Epoch 35/80
 - 2s - loss: 0.1172
Epoch 36/80
 - 2s - loss: 0.1169
Epoch 37/80
 - 2s - loss: 0.1167
Epoch 38/80
 - 2s - loss: 0.1165
Epoch 39/80
 - 2s - loss: 0.1163
Epoch 40/80
 - 2s - loss: 0.1161
Epoch 41/80
 - 2s - loss: 0.1160
Epoch 42/80
 - 2s - loss: 0.1158
Epoch 43/80
 - 2s - loss: 0.1156
Epoch 44/80
 - 2s - loss: 0.1156
Epoch 45/80
 - 2s - loss: 0.1154
Epoch 46/80
 - 2s - loss: 0.1153
Epoch 47/80
 - 2s - loss: 0.1152
Epoch 48/80
 - 2s - loss: 0.1151
Epoch 49/80
 - 2s - loss: 0.1151
Epoch 50/80
 - 2s - loss: 0.1150
Epoch 51/80
 - 2s - loss: 0.1149
Epoch 52/80
 - 2s - loss: 0.1148
Epoch 53/80
 - 2s - loss: 0.1147
Epoch 54/80
 - 2s - loss: 0.1147
Epoch 55/80
 - 2s - loss: 0.1146
Epoch 56/80
 - 2s - loss: 0.1146
Epoch 57/80
 - 2s - loss: 0.1145
Epoch 58/80
 - 2s - loss: 0.1145
Epoch 59/80
 - 2s - loss: 0.1144
Epoch 60/80
 - 2s - loss: 0.1144
Epoch 61/80
 - 2s - loss: 0.1143
Epoch 62/80
 - 2s - loss: 0.1143
Epoch 63/80
 - 2s - loss: 0.1142
Epoch 64/80
 - 2s - loss: 0.1142
Epoch 65/80
 - 2s - loss: 0.1142
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:15:26.396129: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:15:26.564214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:15:26.564262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:15:26.863060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:15:26.863116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:15:26.863125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:15:26.863392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3828
Epoch 2/80
 - 2s - loss: 0.3524
Epoch 3/80
 - 2s - loss: 0.3041
Epoch 4/80
 - 2s - loss: 0.2874
Epoch 5/80
 - 2s - loss: 0.2687
Epoch 6/80
 - 2s - loss: 0.2478
Epoch 7/80
 - 2s - loss: 0.2283
Epoch 8/80
 - 2s - loss: 0.2138
Epoch 9/80
 - 2s - loss: 0.2024
Epoch 10/80
 - 2s - loss: 0.1917
Epoch 11/80
 - 2s - loss: 0.1819
Epoch 12/80
 - 2s - loss: 0.1730
Epoch 13/80
 - 2s - loss: 0.1652
Epoch 14/80
 - 2s - loss: 0.1579
Epoch 15/80
 - 2s - loss: 0.1514
Epoch 16/80
 - 2s - loss: 0.1457
Epoch 17/80
 - 2s - loss: 0.1410
Epoch 18/80
 - 2s - loss: 0.1370
Epoch 19/80
 - 2s - loss: 0.1339
Epoch 20/80
 - 2s - loss: 0.1312
Epoch 21/80
 - 2s - loss: 0.1290
Epoch 22/80
 - 2s - loss: 0.1271
Epoch 23/80
 - 2s - loss: 0.1255
Epoch 24/80
 - 2s - loss: 0.1241
Epoch 25/80
 - 2s - loss: 0.1230
Epoch 26/80
 - 2s - loss: 0.1220
Epoch 27/80
 - 2s - loss: 0.1212
Epoch 28/80
 - 2s - loss: 0.1205
Epoch 29/80
 - 2s - loss: 0.1199
Epoch 30/80
 - 2s - loss: 0.1193
Epoch 31/80
 - 2s - loss: 0.1188
Epoch 32/80
 - 2s - loss: 0.1185
Epoch 33/80
 - 2s - loss: 0.1181
Epoch 34/80
 - 2s - loss: 0.1178
Epoch 35/80
 - 2s - loss: 0.1175
Epoch 36/80
 - 2s - loss: 0.1172
Epoch 37/80
 - 2s - loss: 0.1170
Epoch 38/80
 - 2s - loss: 0.1168
Epoch 39/80
 - 2s - loss: 0.1166
Epoch 40/80
 - 2s - loss: 0.1164
Epoch 41/80
 - 2s - loss: 0.1162
Epoch 42/80
 - 2s - loss: 0.1161
Epoch 43/80
 - 2s - loss: 0.1160
Epoch 44/80
 - 2s - loss: 0.1159
Epoch 45/80
 - 2s - loss: 0.1157
Epoch 46/80
 - 2s - loss: 0.1157
Epoch 47/80
 - 2s - loss: 0.1155
Epoch 48/80
 - 2s - loss: 0.1155
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:17:18.839546: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:17:19.007436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:17:19.007483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:17:19.307126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:17:19.307181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:17:19.307191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:17:19.307455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1457
Epoch 2/80
 - 2s - loss: 0.2144
Epoch 3/80
 - 2s - loss: 0.1723
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1116, in save_weights
    saving.save_weights_to_hdf5_group(f, self.layers)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/saving.py", line 446, in save_weights_to_hdf5_group
    g = f.create_group(layer.name)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/group.py", line 60, in create_group
    gid = h5g.create(self.id, name, lcpl=lcpl, gcpl=gcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5g.pyx", line 161, in h5py.h5g.create
ValueError: Unable to create group (name already exists)
2019-03-08 02:17:43.815466: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:17:43.986020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:17:43.986065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:17:44.285888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:17:44.285944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:17:44.285953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:17:44.286240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1386
Epoch 2/80
 - 2s - loss: 0.2174
Epoch 3/80
 - 2s - loss: 0.1704
Epoch 4/80
 - 2s - loss: 0.1600
Epoch 5/80
 - 2s - loss: 0.1515
Epoch 6/80
 - 2s - loss: 0.1427
Epoch 7/80
 - 2s - loss: 0.1337
Epoch 8/80
 - 2s - loss: 0.1247
Epoch 9/80
 - 2s - loss: 0.1157
Epoch 10/80
 - 2s - loss: 0.1076
Epoch 11/80
 - 2s - loss: 0.1007
Epoch 12/80
 - 2s - loss: 0.0946
Epoch 13/80
 - 2s - loss: 0.0892
Epoch 14/80
 - 2s - loss: 0.0841
Epoch 15/80
 - 2s - loss: 0.0795
Epoch 16/80
 - 2s - loss: 0.0754
Epoch 17/80
 - 2s - loss: 0.0718
Epoch 18/80
 - 2s - loss: 0.0686
Epoch 19/80
 - 2s - loss: 0.0660
Epoch 20/80
 - 2s - loss: 0.0637
Epoch 21/80
 - 2s - loss: 0.0619
Epoch 22/80
 - 2s - loss: 0.0603
Epoch 23/80
 - 2s - loss: 0.0590
Epoch 24/80
 - 2s - loss: 0.0578
Epoch 25/80
 - 2s - loss: 0.0569
Epoch 26/80
 - 2s - loss: 0.0560
Epoch 27/80
 - 2s - loss: 0.0553
Epoch 28/80
 - 2s - loss: 0.0547
Epoch 29/80
 - 2s - loss: 0.0542
Epoch 30/80
 - 2s - loss: 0.0537
Epoch 31/80
 - 2s - loss: 0.0533
Epoch 32/80
 - 2s - loss: 0.0530
Epoch 33/80
 - 2s - loss: 0.0527
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:19:10.627773: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:19:10.796805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:19:10.796852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:19:11.096011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:19:11.096055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:19:11.096064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:19:11.096330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1493
Epoch 2/80
 - 2s - loss: 0.2153
Epoch 3/80
 - 2s - loss: 0.1733
Epoch 4/80
 - 2s - loss: 0.1666
Epoch 5/80
 - 2s - loss: 0.1613
Epoch 6/80
 - 2s - loss: 0.1545
Epoch 7/80
 - 2s - loss: 0.1450
Epoch 8/80
 - 2s - loss: 0.1335
Epoch 9/80
 - 2s - loss: 0.1224
Epoch 10/80
 - 2s - loss: 0.1131
Epoch 11/80
 - 2s - loss: 0.1052
Epoch 12/80
 - 2s - loss: 0.0982
Epoch 13/80
 - 2s - loss: 0.0916
Epoch 14/80
 - 2s - loss: 0.0857
Epoch 15/80
 - 2s - loss: 0.0806
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:19:59.321189: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:19:59.501082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:19:59.501130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:19:59.852517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:19:59.852580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:19:59.852590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:19:59.852929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1837
Epoch 2/80
 - 2s - loss: 0.2201
Epoch 3/80
 - 2s - loss: 0.1718
Epoch 4/80
 - 2s - loss: 0.1620
Epoch 5/80
 - 2s - loss: 0.1528
Epoch 6/80
 - 2s - loss: 0.1434
Epoch 7/80
 - 2s - loss: 0.1344
Epoch 8/80
 - 2s - loss: 0.1253
Epoch 9/80
 - 2s - loss: 0.1162
Epoch 10/80
 - 2s - loss: 0.1080
Epoch 11/80
 - 2s - loss: 0.1008
Epoch 12/80
 - 2s - loss: 0.0944
Epoch 13/80
 - 2s - loss: 0.0886
Epoch 14/80
 - 2s - loss: 0.0832
Epoch 15/80
 - 2s - loss: 0.0784
Epoch 16/80
 - 2s - loss: 0.0743
Epoch 17/80
 - 2s - loss: 0.0710
Epoch 18/80
 - 2s - loss: 0.0681
Epoch 19/80
 - 2s - loss: 0.0658
Epoch 20/80
 - 2s - loss: 0.0637
Epoch 21/80
 - 2s - loss: 0.0620
Epoch 22/80
 - 2s - loss: 0.0604
Epoch 23/80
 - 2s - loss: 0.0591
Epoch 24/80
 - 2s - loss: 0.0579
Epoch 25/80
 - 2s - loss: 0.0569
Epoch 26/80
 - 2s - loss: 0.0560
Epoch 27/80
 - 2s - loss: 0.0553
Epoch 28/80
 - 2s - loss: 0.0547
Epoch 29/80
 - 2s - loss: 0.0541
Epoch 30/80
 - 2s - loss: 0.0537
Epoch 31/80
 - 2s - loss: 0.0533
Epoch 32/80
 - 2s - loss: 0.0529
Epoch 33/80
 - 2s - loss: 0.0527
Epoch 34/80
 - 2s - loss: 0.0524
Epoch 35/80
 - 2s - loss: 0.0522
Epoch 36/80
 - 2s - loss: 0.0520
Epoch 37/80
 - 2s - loss: 0.0518
Epoch 38/80
 - 2s - loss: 0.0516
Epoch 39/80
 - 2s - loss: 0.0515
Epoch 40/80
 - 2s - loss: 0.0514
Epoch 41/80
 - 2s - loss: 0.0513
Epoch 42/80
 - 2s - loss: 0.0512
Epoch 43/80
 - 2s - loss: 0.0511
Epoch 44/80
 - 2s - loss: 0.0510
Epoch 45/80
 - 2s - loss: 0.0509
Epoch 46/80
 - 2s - loss: 0.0508
Epoch 47/80
 - 2s - loss: 0.0507
Epoch 48/80
 - 2s - loss: 0.0507
Epoch 49/80
 - 2s - loss: 0.0506
Epoch 50/80
 - 2s - loss: 0.0506
Epoch 51/80
 - 2s - loss: 0.0505
Epoch 52/80
 - 2s - loss: 0.0505
Epoch 53/80
 - 2s - loss: 0.0504
Epoch 54/80
 - 2s - loss: 0.0504
Epoch 55/80
 - 2s - loss: 0.0503
Epoch 56/80
 - 2s - loss: 0.0503
Epoch 57/80
 - 2s - loss: 0.0503
Epoch 58/80
 - 2s - loss: 0.0503
Epoch 59/80
 - 2s - loss: 0.0491
Epoch 60/80
 - 2s - loss: 0.0490
Epoch 61/80
 - 2s - loss: 0.0490
Epoch 62/80
 - 2s - loss: 0.0490
Epoch 63/80
 - 2s - loss: 0.0490
Epoch 64/80
 - 2s - loss: 0.0487
Epoch 65/80
 - 2s - loss: 0.0487
Epoch 66/80
 - 2s - loss: 0.0487
Epoch 67/80
 - 2s - loss: 0.0487
Epoch 68/80
 - 2s - loss: 0.0486
Epoch 69/80
 - 2s - loss: 0.0486
Epoch 70/80
 - 2s - loss: 0.0486
Epoch 71/80
 - 2s - loss: 0.0486
Epoch 72/80
 - 2s - loss: 0.0486
Epoch 73/80
 - 2s - loss: 0.0486
Epoch 74/80
 - 2s - loss: 0.0486
Epoch 75/80
 - 2s - loss: 0.0486
Epoch 76/80
 - 2s - loss: 0.0486
Epoch 77/80
 - 2s - loss: 0.0486
Epoch 78/80
 - 2s - loss: 0.0486
Epoch 79/80
 - 2s - loss: 0.0486
Epoch 80/80
 - 2s - loss: 0.0486
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 6.2704 - val_loss: 2.7701
AUC: 0.7223

Epoch 2/80
 - 0s - loss: 4.0053 - val_loss: 1.3761
AUC: 0.7602

Epoch 3/80
 - 0s - loss: 2.5285 - val_loss: 1.1968
AUC: 0.8002

Epoch 4/80
 - 0s - loss: 1.7613 - val_loss: 0.8428
AUC: 0.8057

Epoch 5/80
 - 0s - loss: 1.4196 - val_loss: 0.7796
AUC: 0.8141

Epoch 6/80
 - 0s - loss: 1.2982 - val_loss: 0.7524
AUC: 0.8239

Epoch 7/80
 - 0s - loss: 1.2315 - val_loss: 0.7841
AUC: 0.8308

Epoch 8/80
 - 0s - loss: 1.1892 - val_loss: 0.6719
AUC: 0.8333

Epoch 9/80
 - 0s - loss: 1.1740 - val_loss: 0.7668
AUC: 0.8379

Epoch 10/80
 - 0s - loss: 1.1427 - val_loss: 0.6907
AUC: 0.8394

Epoch 11/80
 - 0s - loss: 1.1357 - val_loss: 0.6848
AUC: 0.8402

Epoch 12/80
 - 0s - loss: 1.1242 - val_loss: 0.6624
AUC: 0.8423

Epoch 13/80
 - 0s - loss: 1.1144 - val_loss: 0.6942
AUC: 0.8452

Epoch 14/80
 - 0s - loss: 1.1058 - val_loss: 0.6748
AUC: 0.8466

Epoch 15/80
 - 0s - loss: 1.1015 - val_loss: 0.6789
AUC: 0.8469

Epoch 16/80
 - 0s - loss: 1.0952 - val_loss: 0.6931
AUC: 0.8488

Epoch 17/80
 - 0s - loss: 1.0836 - val_loss: 0.6865
AUC: 0.8498

Epoch 18/80
 - 0s - loss: 1.0768 - val_loss: 0.6584
AUC: 0.8501

Epoch 19/80
 - 0s - loss: 1.0816 - val_loss: 0.6388
AUC: 0.8509

Epoch 20/80
 - 0s - loss: 1.0818 - val_loss: 0.6389
AUC: 0.8517

Epoch 21/80
 - 0s - loss: 1.0720 - val_loss: 0.7073
AUC: 0.8533

Epoch 22/80
 - 0s - loss: 1.0645 - val_loss: 0.6632
AUC: 0.8531

Epoch 23/80
 - 0s - loss: 1.0628 - val_loss: 0.6688
AUC: 0.8531

Epoch 24/80
 - 0s - loss: 1.0625 - val_loss: 0.6412
AUC: 0.8541

Epoch 25/80
 - 0s - loss: 1.0578 - val_loss: 0.6217
AUC: 0.8548

Epoch 26/80
 - 0s - loss: 1.0562 - val_loss: 0.6418
AUC: 0.8547

Epoch 27/80
 - 0s - loss: 1.0523 - val_loss: 0.6456
AUC: 0.8561

Epoch 28/80
 - 0s - loss: 1.0528 - val_loss: 0.6089
AUC: 0.8554

Epoch 29/80
 - 0s - loss: 1.0404 - val_loss: 0.6760
AUC: 0.8570

Epoch 30/80
 - 0s - loss: 1.0414 - val_loss: 0.5887
AUC: 0.8548

Epoch 31/80
 - 0s - loss: 1.0415 - val_loss: 0.6398
AUC: 0.8576

Epoch 32/80
 - 0s - loss: 1.0401 - val_loss: 0.6329
AUC: 0.8574

Epoch 33/80
 - 0s - loss: 1.0365 - val_loss: 0.7142
AUC: 0.8589

Epoch 34/80
 - 0s - loss: 1.0365 - val_loss: 0.6393
AUC: 0.8579

Epoch 35/80
 - 0s - loss: 1.0339 - val_loss: 0.6378
AUC: 0.8590

Epoch 36/80
 - 0s - loss: 1.0258 - val_loss: 0.6370
AUC: 0.8590

Epoch 37/80
 - 0s - loss: 1.0267 - val_loss: 0.6449
AUC: 0.8589

Epoch 38/80
 - 0s - loss: 1.0225 - val_loss: 0.6337
AUC: 0.8594

Epoch 39/80
 - 0s - loss: 1.0226 - val_loss: 0.6172
AUC: 0.8593

Epoch 40/80
 - 0s - loss: 1.0261 - val_loss: 0.6369
AUC: 0.8600

Epoch 41/80
 - 0s - loss: 1.0198 - val_loss: 0.6256
AUC: 0.8602

Epoch 42/80
 - 0s - loss: 1.0183 - val_loss: 0.6441
AUC: 0.8606

Epoch 43/80
 - 0s - loss: 1.0130 - val_loss: 0.6226
AUC: 0.8606

Epoch 44/80
 - 0s - loss: 1.0057 - val_loss: 0.6332
AUC: 0.8602

Epoch 45/80
 - 0s - loss: 1.0141 - val_loss: 0.6306
AUC: 0.8605

Epoch 46/80
 - 0s - loss: 1.0195 - val_loss: 0.6378
AUC: 0.8606

Epoch 47/80
 - 0s - loss: 1.0192 - val_loss: 0.6200
AUC: 0.8606

Epoch 48/80
 - 0s - loss: 1.0081 - val_loss: 0.6450
AUC: 0.8608

Epoch 49/80
 - 0s - loss: 1.0144 - val_loss: 0.6425
AUC: 0.8609

Epoch 50/80
 - 0s - loss: 1.0103 - val_loss: 0.6012
AUC: 0.8609

Epoch 51/80
 - 0s - loss: 1.0142 - val_loss: 0.6213
AUC: 0.8610

Epoch 52/80
 - 0s - loss: 1.0073 - val_loss: 0.6214
AUC: 0.8609

Epoch 53/80
 - 0s - loss: 1.0118 - val_loss: 0.6202
AUC: 0.8610

Epoch 54/80
 - 0s - loss: 1.0088 - val_loss: 0.6242
AUC: 0.8609

Epoch 55/80
 - 0s - loss: 1.0124 - val_loss: 0.6226
AUC: 0.8609

Epoch 56/80
 - 0s - loss: 1.0106 - val_loss: 0.6215
AUC: 0.8609

Epoch 57/80
 - 0s - loss: 1.0137 - val_loss: 0.6232
AUC: 0.8609

Epoch 58/80
 - 0s - loss: 1.0104 - val_loss: 0.6246
AUC: 0.8610

Epoch 59/80
 - 0s - loss: 1.0107 - val_loss: 0.6252
AUC: 0.8611

Epoch 60/80
 - 0s - loss: 1.0098 - val_loss: 0.6236
AUC: 0.8610

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0030 - val_loss: 0.6024
AUC: 0.8611

Epoch 2/30
 - 0s - loss: 1.0049 - val_loss: 0.6065
AUC: 0.8613

Epoch 3/30
 - 0s - loss: 1.0135 - val_loss: 0.6180
AUC: 0.8616

Epoch 4/30
 - 0s - loss: 1.0081 - val_loss: 0.6227
AUC: 0.8619

Epoch 5/30
 - 0s - loss: 1.0026 - val_loss: 0.6223
AUC: 0.8620

Epoch 6/30
 - 0s - loss: 1.0068 - val_loss: 0.5985
AUC: 0.8620

Epoch 7/30
 - 0s - loss: 0.9995 - val_loss: 0.6230
AUC: 0.8622

Epoch 8/30
 - 0s - loss: 1.0016 - val_loss: 0.6208
AUC: 0.8624

Epoch 9/30
 - 0s - loss: 1.0009 - val_loss: 0.6175
AUC: 0.8625

Epoch 10/30
 - 0s - loss: 1.0010 - val_loss: 0.6148
AUC: 0.8627

Epoch 11/30
 - 0s - loss: 0.9980 - val_loss: 0.6207
AUC: 0.8628

Epoch 12/30
 - 0s - loss: 0.9934 - val_loss: 0.6097
AUC: 0.8628

Epoch 13/30
 - 0s - loss: 0.9940 - val_loss: 0.6036
AUC: 0.8629

Epoch 14/30
 - 0s - loss: 0.9969 - val_loss: 0.6066
AUC: 0.8631

Epoch 15/30
 - 0s - loss: 0.9912 - val_loss: 0.6170
AUC: 0.8632

Epoch 16/30
 - 0s - loss: 0.9888 - val_loss: 0.6189
AUC: 0.8635

Epoch 17/30
 - 0s - loss: 0.9914 - val_loss: 0.6139
AUC: 0.8634

Epoch 18/30
 - 0s - loss: 0.9869 - val_loss: 0.6120
AUC: 0.8634

Epoch 19/30
 - 0s - loss: 0.9878 - val_loss: 0.6163
AUC: 0.8635

Epoch 20/30
 - 0s - loss: 0.9902 - val_loss: 0.6125
AUC: 0.8635

Epoch 21/30
 - 0s - loss: 0.9913 - val_loss: 0.6137
AUC: 0.8635

Epoch 22/30
 - 0s - loss: 0.9850 - val_loss: 0.6109
AUC: 0.8636

Epoch 23/30
 - 0s - loss: 0.9919 - val_loss: 0.6142
AUC: 0.8636

Epoch 24/30
 - 0s - loss: 0.9847 - val_loss: 0.6115
AUC: 0.8636

Epoch 25/30
 - 0s - loss: 0.9860 - val_loss: 0.6104
AUC: 0.8636

Epoch 26/30
 - 0s - loss: 0.9942 - val_loss: 0.6139
AUC: 0.8636

Epoch 27/30
 - 0s - loss: 0.9886 - val_loss: 0.6143
AUC: 0.8636

Epoch 28/30
 - 0s - loss: 0.9835 - val_loss: 0.6134
AUC: 0.8637

Epoch 29/30
 - 0s - loss: 0.9901 - val_loss: 0.6126
AUC: 0.8636

Epoch 30/30
 - 0s - loss: 0.9858 - val_loss: 0.6116
Using TensorFlow backend.
AUC: 0.8636

2019-03-08 02:24:01.736190: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:24:01.907603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:24:01.907659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:24:02.216457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:24:02.216512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:24:02.216522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:24:02.216847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6791
Epoch 2/80
 - 2s - loss: 0.1268
Epoch 3/80
 - 2s - loss: 0.0726
Epoch 4/80
 - 2s - loss: 0.0661
Epoch 5/80
 - 2s - loss: 0.0636
Epoch 6/80
 - 2s - loss: 0.0618
Epoch 7/80
 - 2s - loss: 0.0596
Epoch 8/80
 - 2s - loss: 0.0571
Epoch 9/80
 - 2s - loss: 0.0540
Epoch 10/80
 - 2s - loss: 0.0506
Epoch 11/80
 - 2s - loss: 0.0471
Epoch 12/80
 - 2s - loss: 0.0437
Epoch 13/80
 - 2s - loss: 0.0405
Epoch 14/80
 - 2s - loss: 0.0376
Epoch 15/80
 - 2s - loss: 0.0350
Epoch 16/80
 - 2s - loss: 0.0325
Epoch 17/80
 - 2s - loss: 0.0303
Epoch 18/80
 - 2s - loss: 0.0284
Epoch 19/80
 - 2s - loss: 0.0267
Epoch 20/80
 - 2s - loss: 0.0253
Epoch 21/80
 - 2s - loss: 0.0241
Epoch 22/80
 - 2s - loss: 0.0231
Epoch 23/80
 - 2s - loss: 0.0222
Epoch 24/80
 - 2s - loss: 0.0215
Epoch 25/80
 - 2s - loss: 0.0208
Epoch 26/80
 - 2s - loss: 0.0203
Epoch 27/80
 - 2s - loss: 0.0198
Epoch 28/80
 - 2s - loss: 0.0194
Epoch 29/80
 - 2s - loss: 0.0190
Epoch 30/80
 - 2s - loss: 0.0187
Epoch 31/80
 - 2s - loss: 0.0185
Epoch 32/80
 - 2s - loss: 0.0182
Epoch 33/80
 - 2s - loss: 0.0180
Epoch 34/80
 - 2s - loss: 0.0178
Epoch 35/80
 - 2s - loss: 0.0177
Epoch 36/80
 - 2s - loss: 0.0176
Epoch 37/80
 - 2s - loss: 0.0174
Epoch 38/80
 - 2s - loss: 0.0173
Epoch 39/80
 - 2s - loss: 0.0172
Epoch 40/80
 - 2s - loss: 0.0172
Epoch 41/80
 - 2s - loss: 0.0171
Epoch 42/80
 - 2s - loss: 0.0170
Epoch 43/80
 - 2s - loss: 0.0169
Epoch 44/80
 - 2s - loss: 0.0169
Epoch 45/80
 - 2s - loss: 0.0168
Epoch 46/80
 - 2s - loss: 0.0168
Epoch 47/80
 - 2s - loss: 0.0167
Epoch 48/80
 - 2s - loss: 0.0167
Epoch 49/80
 - 2s - loss: 0.0167
Epoch 50/80
 - 2s - loss: 0.0166
Epoch 51/80
 - 2s - loss: 0.0166
Epoch 52/80
 - 2s - loss: 0.0166
Epoch 53/80
 - 2s - loss: 0.0165
Epoch 54/80
 - 2s - loss: 0.0165
Epoch 55/80
 - 2s - loss: 0.0161
Epoch 56/80
 - 2s - loss: 0.0161
Epoch 57/80
 - 2s - loss: 0.0160
Epoch 58/80
 - 2s - loss: 0.0160
Epoch 59/80
 - 2s - loss: 0.0159
Epoch 60/80
 - 2s - loss: 0.0159
Epoch 61/80
 - 2s - loss: 0.0159
Epoch 62/80
 - 2s - loss: 0.0159
Epoch 63/80
 - 2s - loss: 0.0159
Epoch 64/80
 - 2s - loss: 0.0159
Epoch 65/80
 - 2s - loss: 0.0159
Epoch 66/80
 - 2s - loss: 0.0159
Epoch 67/80
 - 2s - loss: 0.0159
Epoch 68/80
 - 2s - loss: 0.0159
Epoch 69/80
 - 2s - loss: 0.0159
Epoch 70/80
 - 2s - loss: 0.0159
Epoch 71/80
 - 2s - loss: 0.0159
Epoch 72/80
 - 2s - loss: 0.0159
Epoch 73/80
 - 2s - loss: 0.0159
Epoch 74/80
 - 2s - loss: 0.0159
Epoch 75/80
 - 2s - loss: 0.0159
Epoch 76/80
 - 2s - loss: 0.0159
Epoch 77/80
 - 2s - loss: 0.0159
Epoch 78/80
 - 2s - loss: 0.0159
Epoch 79/80
 - 2s - loss: 0.0159
Epoch 80/80
 - 2s - loss: 0.0159
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.1692 - val_loss: 1.1725
AUC: 0.7753

Epoch 2/80
 - 0s - loss: 2.2475 - val_loss: 0.8907
AUC: 0.7927

Epoch 3/80
 - 0s - loss: 1.5632 - val_loss: 0.8134
AUC: 0.7998

Epoch 4/80
 - 0s - loss: 1.3339 - val_loss: 0.7687
AUC: 0.8116

Epoch 5/80
 - 0s - loss: 1.2348 - val_loss: 0.7243
AUC: 0.8211

Epoch 6/80
 - 0s - loss: 1.2056 - val_loss: 0.6913
AUC: 0.8289

Epoch 7/80
 - 0s - loss: 1.1814 - val_loss: 0.6846
AUC: 0.8321

Epoch 8/80
 - 0s - loss: 1.1519 - val_loss: 0.6906
AUC: 0.8380

Epoch 9/80
 - 0s - loss: 1.1297 - val_loss: 0.7021
AUC: 0.8403

Epoch 10/80
 - 0s - loss: 1.1244 - val_loss: 0.6982
AUC: 0.8437

Epoch 11/80
 - 0s - loss: 1.1192 - val_loss: 0.6791
AUC: 0.8463

Epoch 12/80
 - 0s - loss: 1.0929 - val_loss: 0.6590
AUC: 0.8463

Epoch 13/80
 - 0s - loss: 1.0949 - val_loss: 0.6497
AUC: 0.8480

Epoch 14/80
 - 0s - loss: 1.0928 - val_loss: 0.6666
AUC: 0.8492

Epoch 15/80
 - 0s - loss: 1.0814 - val_loss: 0.6993
AUC: 0.8508

Epoch 16/80
 - 0s - loss: 1.0746 - val_loss: 0.6346
AUC: 0.8510

Epoch 17/80
 - 0s - loss: 1.0676 - val_loss: 0.6993
AUC: 0.8524

Epoch 18/80
 - 0s - loss: 1.0663 - val_loss: 0.6405
AUC: 0.8519

Epoch 19/80
 - 0s - loss: 1.0626 - val_loss: 0.6625
AUC: 0.8532

Epoch 20/80
 - 0s - loss: 1.0590 - val_loss: 0.6394
AUC: 0.8534

Epoch 21/80
 - 0s - loss: 1.0438 - val_loss: 0.6440
AUC: 0.8536

Epoch 22/80
 - 0s - loss: 1.0513 - val_loss: 0.6174
AUC: 0.8531

Epoch 23/80
 - 0s - loss: 1.0454 - val_loss: 0.5867
AUC: 0.8538

Epoch 24/80
 - 0s - loss: 1.0485 - val_loss: 0.6361
AUC: 0.8553

Epoch 25/80
 - 0s - loss: 1.0383 - val_loss: 0.6246
AUC: 0.8561

Epoch 26/80
 - 0s - loss: 1.0419 - val_loss: 0.6800
AUC: 0.8574

Epoch 27/80
 - 0s - loss: 1.0378 - val_loss: 0.6249
AUC: 0.8578

Epoch 28/80
 - 0s - loss: 1.0283 - val_loss: 0.5960
AUC: 0.8565

Epoch 29/80
 - 0s - loss: 1.0288 - val_loss: 0.6612
AUC: 0.8588

Epoch 30/80
 - 0s - loss: 1.0310 - val_loss: 0.6731
AUC: 0.8585

Epoch 31/80
 - 0s - loss: 1.0290 - val_loss: 0.6328
AUC: 0.8595

Epoch 32/80
 - 0s - loss: 1.0298 - val_loss: 0.5971
AUC: 0.8591

Epoch 33/80
 - 0s - loss: 1.0245 - val_loss: 0.6526
AUC: 0.8603

Epoch 34/80
 - 0s - loss: 1.0181 - val_loss: 0.6313
AUC: 0.8601

Epoch 35/80
 - 0s - loss: 1.0176 - val_loss: 0.6128
AUC: 0.8597

Epoch 36/80
 - 0s - loss: 1.0096 - val_loss: 0.6038
AUC: 0.8595

Epoch 37/80
 - 0s - loss: 1.0182 - val_loss: 0.6303
AUC: 0.8603

Epoch 38/80
 - 0s - loss: 1.0116 - val_loss: 0.6162
AUC: 0.8600

Epoch 39/80
 - 0s - loss: 1.0139 - val_loss: 0.6262
AUC: 0.8608

Epoch 40/80
 - 0s - loss: 1.0098 - val_loss: 0.6076
AUC: 0.8602

Epoch 41/80
 - 0s - loss: 1.0147 - val_loss: 0.6227
AUC: 0.8606

Epoch 42/80
 - 0s - loss: 1.0093 - val_loss: 0.6150
AUC: 0.8604

Epoch 43/80
 - 0s - loss: 1.0133 - val_loss: 0.6047
AUC: 0.8600

Epoch 44/80
 - 0s - loss: 1.0075 - val_loss: 0.6163
AUC: 0.8603

Epoch 45/80
 - 0s - loss: 1.0071 - val_loss: 0.6184
AUC: 0.8603

Epoch 46/80
 - 0s - loss: 1.0094 - val_loss: 0.6239
AUC: 0.8606

Epoch 47/80
 - 0s - loss: 1.0076 - val_loss: 0.6150
AUC: 0.8604

Epoch 48/80
 - 0s - loss: 1.0094 - val_loss: 0.6183
AUC: 0.8604

Epoch 49/80
 - 0s - loss: 1.0132 - val_loss: 0.6174
AUC: 0.8604

Epoch 50/80
 - 0s - loss: 1.0099 - val_loss: 0.6205
AUC: 0.8605

Epoch 51/80
 - 0s - loss: 1.0065 - val_loss: 0.6144
AUC: 0.8604

Epoch 52/80
 - 0s - loss: 1.0107 - val_loss: 0.6197
AUC: 0.8605

Epoch 53/80
 - 0s - loss: 1.0084 - val_loss: 0.6148
AUC: 0.8604

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0147 - val_loss: 0.6403
AUC: 0.8610

Epoch 2/30
 - 0s - loss: 1.0084 - val_loss: 0.6105
AUC: 0.8606

Epoch 3/30
 - 0s - loss: 1.0109 - val_loss: 0.6391
AUC: 0.8612

Epoch 4/30
 - 0s - loss: 1.0078 - val_loss: 0.6179
AUC: 0.8609

Epoch 5/30
 - 0s - loss: 1.0089 - val_loss: 0.6164
AUC: 0.8608

Epoch 6/30
 - 0s - loss: 1.0024 - val_loss: 0.6206
AUC: 0.8609

Epoch 7/30
 - 0s - loss: 1.0095 - val_loss: 0.6105
AUC: 0.8611

Epoch 8/30
 - 0s - loss: 1.0046 - val_loss: 0.6114
AUC: 0.8611

Epoch 9/30
 - 0s - loss: 1.0029 - val_loss: 0.6188
AUC: 0.8615

Epoch 10/30
 - 0s - loss: 1.0040 - val_loss: 0.6127
AUC: 0.8614

Epoch 11/30
 - 0s - loss: 1.0012 - val_loss: 0.6050
AUC: 0.8615

Epoch 12/30
 - 0s - loss: 0.9987 - val_loss: 0.6134
AUC: 0.8618

Epoch 13/30
 - 0s - loss: 1.0061 - val_loss: 0.6072
AUC: 0.8619

Epoch 14/30
 - 0s - loss: 0.9991 - val_loss: 0.6284
AUC: 0.8626

Epoch 15/30
 - 0s - loss: 0.9990 - val_loss: 0.6202
AUC: 0.8626

Epoch 16/30
 - 0s - loss: 0.9939 - val_loss: 0.6028
AUC: 0.8622

Epoch 17/30
 - 0s - loss: 0.9914 - val_loss: 0.6020
AUC: 0.8623

Epoch 18/30
 - 0s - loss: 0.9995 - val_loss: 0.6148
AUC: 0.8628

Epoch 19/30
 - 0s - loss: 0.9921 - val_loss: 0.6134
AUC: 0.8629

Epoch 20/30
 - 0s - loss: 0.9893 - val_loss: 0.6026
AUC: 0.8627

Epoch 21/30
 - 0s - loss: 0.9894 - val_loss: 0.6074
AUC: 0.8628

Epoch 22/30
 - 0s - loss: 0.9899 - val_loss: 0.6126
AUC: 0.8630

Epoch 23/30
 - 0s - loss: 0.9853 - val_loss: 0.6122
AUC: 0.8632

Epoch 24/30
 - 0s - loss: 0.9876 - val_loss: 0.6058
AUC: 0.8631

Epoch 25/30
 - 0s - loss: 0.9872 - val_loss: 0.6215
AUC: 0.8636

Epoch 26/30
 - 0s - loss: 0.9820 - val_loss: 0.6069
AUC: 0.8635

Epoch 27/30
 - 0s - loss: 0.9849 - val_loss: 0.6074
AUC: 0.8635

Epoch 28/30
 - 0s - loss: 0.9808 - val_loss: 0.6085
AUC: 0.8635

Epoch 29/30
 - 0s - loss: 0.9861 - val_loss: 0.6044
AUC: 0.8634

Epoch 30/30
 - 0s - loss: 0.9828 - val_loss: 0.6077
Using TensorFlow backend.
AUC: 0.8635

2019-03-08 02:27:57.160929: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:27:57.332261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:27:57.332309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:27:57.638485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:27:57.638542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:27:57.638551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:27:57.638825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6817
Epoch 2/80
 - 2s - loss: 0.1303
Epoch 3/80
 - 2s - loss: 0.0726
Epoch 4/80
 - 2s - loss: 0.0658
Epoch 5/80
 - 2s - loss: 0.0628
Epoch 6/80
 - 2s - loss: 0.0603
Epoch 7/80
 - 2s - loss: 0.0577
Epoch 8/80
 - 2s - loss: 0.0551
Epoch 9/80
 - 2s - loss: 0.0523
Epoch 10/80
 - 2s - loss: 0.0493
Epoch 11/80
 - 2s - loss: 0.0462
Epoch 12/80
 - 2s - loss: 0.0430
Epoch 13/80
 - 2s - loss: 0.0398
Epoch 14/80
 - 2s - loss: 0.0369
Epoch 15/80
 - 2s - loss: 0.0342
Epoch 16/80
 - 2s - loss: 0.0319
Epoch 17/80
 - 2s - loss: 0.0298
Epoch 18/80
 - 2s - loss: 0.0281
Epoch 19/80
 - 2s - loss: 0.0265
Epoch 20/80
 - 2s - loss: 0.0251
Epoch 21/80
 - 2s - loss: 0.0240
Epoch 22/80
 - 2s - loss: 0.0230
Epoch 23/80
 - 2s - loss: 0.0221
Epoch 24/80
 - 2s - loss: 0.0214
Epoch 25/80
 - 2s - loss: 0.0207
Epoch 26/80
 - 2s - loss: 0.0202
Epoch 27/80
 - 2s - loss: 0.0197
Epoch 28/80
 - 2s - loss: 0.0193
Epoch 29/80
 - 2s - loss: 0.0189
Epoch 30/80
 - 2s - loss: 0.0186
Epoch 31/80
 - 2s - loss: 0.0184
Epoch 32/80
 - 2s - loss: 0.0182
Epoch 33/80
 - 2s - loss: 0.0180
Epoch 34/80
 - 2s - loss: 0.0178
Epoch 35/80
 - 2s - loss: 0.0177
Epoch 36/80
 - 2s - loss: 0.0175
Epoch 37/80
 - 2s - loss: 0.0174
Epoch 38/80
 - 2s - loss: 0.0173
Epoch 39/80
 - 2s - loss: 0.0172
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1116, in save_weights
    saving.save_weights_to_hdf5_group(f, self.layers)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/saving.py", line 446, in save_weights_to_hdf5_group
    g = f.create_group(layer.name)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/group.py", line 60, in create_group
    gid = h5g.create(self.id, name, lcpl=lcpl, gcpl=gcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5g.pyx", line 161, in h5py.h5g.create
ValueError: Unable to create group (name already exists)
2019-03-08 02:29:32.854393: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:29:33.020564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:29:33.020611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:29:33.327948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:29:33.328002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:29:33.328011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:29:33.328276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6962
Epoch 2/80
 - 2s - loss: 0.1322
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:29:55.838291: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:29:56.009178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:29:56.009224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:29:56.316477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:29:56.316550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:29:56.316576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:29:56.316870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3791
Epoch 2/80
 - 2s - loss: 0.3519
Epoch 3/80
 - 2s - loss: 0.2932
Epoch 4/80
 - 2s - loss: 0.2663
Epoch 5/80
 - 2s - loss: 0.2474
Epoch 6/80
 - 2s - loss: 0.2336
Epoch 7/80
 - 2s - loss: 0.2221
Epoch 8/80
 - 2s - loss: 0.2109
Epoch 9/80
 - 2s - loss: 0.1993
Epoch 10/80
 - 2s - loss: 0.1879
Epoch 11/80
 - 2s - loss: 0.1777
Epoch 12/80
 - 2s - loss: 0.1690
Epoch 13/80
 - 2s - loss: 0.1619
Epoch 14/80
 - 2s - loss: 0.1557
Epoch 15/80
 - 2s - loss: 0.1502
Epoch 16/80
 - 2s - loss: 0.1451
Epoch 17/80
 - 2s - loss: 0.1407
Epoch 18/80
 - 2s - loss: 0.1368
Epoch 19/80
 - 2s - loss: 0.1335
Epoch 20/80
 - 2s - loss: 0.1307
Epoch 21/80
 - 2s - loss: 0.1284
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2ba231149668>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 02:30:56.837832: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:30:57.010256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:30:57.010303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:30:57.319648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:30:57.319703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:30:57.319713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:30:57.319979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3777
Epoch 2/80
 - 2s - loss: 0.3530
Epoch 3/80
 - 2s - loss: 0.3041
Epoch 4/80
 - 2s - loss: 0.2855
Epoch 5/80
 - 2s - loss: 0.2670
Epoch 6/80
 - 2s - loss: 0.2491
Epoch 7/80
 - 2s - loss: 0.2317
Epoch 8/80
 - 2s - loss: 0.2158
Epoch 9/80
 - 2s - loss: 0.2027
Epoch 10/80
 - 2s - loss: 0.1918
Epoch 11/80
 - 2s - loss: 0.1820
Epoch 12/80
 - 2s - loss: 0.1727
Epoch 13/80
 - 2s - loss: 0.1644
Epoch 14/80
 - 2s - loss: 0.1572
Epoch 15/80
 - 2s - loss: 0.1509
Epoch 16/80
 - 2s - loss: 0.1457
Epoch 17/80
 - 2s - loss: 0.1413
Epoch 18/80
 - 2s - loss: 0.1377
Epoch 19/80
 - 2s - loss: 0.1347
Epoch 20/80
 - 2s - loss: 0.1322
Epoch 21/80
 - 2s - loss: 0.1300
Epoch 22/80
 - 2s - loss: 0.1282
Epoch 23/80
 - 2s - loss: 0.1266
Epoch 24/80
 - 2s - loss: 0.1252
Epoch 25/80
 - 2s - loss: 0.1240
Epoch 26/80
 - 2s - loss: 0.1229
Epoch 27/80
 - 2s - loss: 0.1220
Epoch 28/80
 - 2s - loss: 0.1211
Epoch 29/80
 - 2s - loss: 0.1204
Epoch 30/80
 - 2s - loss: 0.1198
Epoch 31/80
 - 2s - loss: 0.1193
Epoch 32/80
 - 2s - loss: 0.1188
Epoch 33/80
 - 2s - loss: 0.1183
Epoch 34/80
 - 2s - loss: 0.1180
Epoch 35/80
 - 2s - loss: 0.1177
Epoch 36/80
 - 2s - loss: 0.1174
Epoch 37/80
 - 2s - loss: 0.1171
Epoch 38/80
 - 2s - loss: 0.1169
Epoch 39/80
 - 2s - loss: 0.1167
Epoch 40/80
 - 2s - loss: 0.1164
Epoch 41/80
 - 2s - loss: 0.1162
Epoch 42/80
 - 2s - loss: 0.1161
Epoch 43/80
 - 2s - loss: 0.1160
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:32:42.738088: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:32:42.908850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:32:42.908895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:32:43.220714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:32:43.220773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:32:43.220784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:32:43.221048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3769
Epoch 2/80
 - 2s - loss: 0.3507
Epoch 3/80
 - 2s - loss: 0.3073
Epoch 4/80
 - 2s - loss: 0.2932
Epoch 5/80
 - 2s - loss: 0.2778
Epoch 6/80
 - 2s - loss: 0.2615
Epoch 7/80
 - 2s - loss: 0.2445
Epoch 8/80
 - 2s - loss: 0.2267
Epoch 9/80
 - 2s - loss: 0.2098
Epoch 10/80
 - 2s - loss: 0.1952
Epoch 11/80
 - 2s - loss: 0.1830
Epoch 12/80
 - 2s - loss: 0.1724
Epoch 13/80
 - 2s - loss: 0.1637
Epoch 14/80
 - 2s - loss: 0.1565
Epoch 15/80
 - 2s - loss: 0.1506
Epoch 16/80
 - 2s - loss: 0.1456
Epoch 17/80
 - 2s - loss: 0.1414
Epoch 18/80
 - 2s - loss: 0.1378
Epoch 19/80
 - 2s - loss: 0.1348
Epoch 20/80
 - 2s - loss: 0.1323
Epoch 21/80
 - 2s - loss: 0.1301
Epoch 22/80
 - 2s - loss: 0.1282
Epoch 23/80
 - 2s - loss: 0.1265
Epoch 24/80
 - 2s - loss: 0.1251
Epoch 25/80
 - 2s - loss: 0.1239
Epoch 26/80
 - 2s - loss: 0.1229
Epoch 27/80
 - 2s - loss: 0.1220
Epoch 28/80
 - 2s - loss: 0.1212
Epoch 29/80
 - 2s - loss: 0.1205
Epoch 30/80
 - 2s - loss: 0.1199
Epoch 31/80
 - 2s - loss: 0.1194
Epoch 32/80
 - 2s - loss: 0.1189
Epoch 33/80
 - 2s - loss: 0.1185
Epoch 34/80
 - 2s - loss: 0.1182
Epoch 35/80
 - 2s - loss: 0.1178
Epoch 36/80
 - 2s - loss: 0.1176
Epoch 37/80
 - 2s - loss: 0.1173
Epoch 38/80
 - 2s - loss: 0.1171
Epoch 39/80
 - 2s - loss: 0.1169
Epoch 40/80
 - 2s - loss: 0.1167
Epoch 41/80
 - 2s - loss: 0.1165
Epoch 42/80
 - 2s - loss: 0.1164
Epoch 43/80
 - 2s - loss: 0.1162
Epoch 44/80
 - 2s - loss: 0.1160
Epoch 45/80
 - 2s - loss: 0.1159
Epoch 46/80
 - 2s - loss: 0.1158
Epoch 47/80
 - 2s - loss: 0.1157
Epoch 48/80
 - 2s - loss: 0.1156
Epoch 49/80
 - 2s - loss: 0.1155
Epoch 50/80
 - 2s - loss: 0.1154
Epoch 51/80
 - 2s - loss: 0.1154
Epoch 52/80
 - 2s - loss: 0.1153
Epoch 53/80
 - 2s - loss: 0.1152
Epoch 54/80
 - 2s - loss: 0.1151
Epoch 55/80
 - 2s - loss: 0.1151
Epoch 56/80
 - 2s - loss: 0.1150
Epoch 57/80
 - 2s - loss: 0.1150
Epoch 58/80
 - 2s - loss: 0.1149
Epoch 59/80
 - 2s - loss: 0.1148
Epoch 60/80
 - 2s - loss: 0.1148
Epoch 61/80
 - 2s - loss: 0.1148
Epoch 62/80
 - 2s - loss: 0.1147
Epoch 63/80
 - 2s - loss: 0.1147
Epoch 64/80
 - 2s - loss: 0.1146
Epoch 65/80
 - 2s - loss: 0.1146
Epoch 66/80
 - 2s - loss: 0.1146
Epoch 67/80
 - 2s - loss: 0.1145
Epoch 68/80
 - 2s - loss: 0.1145
Epoch 69/80
 - 2s - loss: 0.1145
Epoch 70/80
 - 2s - loss: 0.1144
Epoch 71/80
 - 2s - loss: 0.1122
Epoch 72/80
 - 2s - loss: 0.1120
Epoch 73/80
 - 2s - loss: 0.1119
Epoch 74/80
 - 2s - loss: 0.1119
Epoch 75/80
 - 2s - loss: 0.1119
Epoch 76/80
 - 2s - loss: 0.1114
Epoch 77/80
 - 2s - loss: 0.1113
Epoch 78/80
 - 2s - loss: 0.1113
Epoch 79/80
 - 2s - loss: 0.1113
Epoch 80/80
 - 2s - loss: 0.1112
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.4993 - val_loss: 1.6013
AUC: 0.7972

Epoch 2/80
 - 0s - loss: 2.0215 - val_loss: 0.9087
AUC: 0.8191

Epoch 3/80
 - 0s - loss: 1.3662 - val_loss: 0.7385
AUC: 0.8319

Epoch 4/80
 - 0s - loss: 1.2299 - val_loss: 0.7048
AUC: 0.8375

Epoch 5/80
 - 0s - loss: 1.1796 - val_loss: 0.6274
AUC: 0.8359

Epoch 6/80
 - 0s - loss: 1.1584 - val_loss: 0.6792
AUC: 0.8430

Epoch 7/80
 - 0s - loss: 1.1301 - val_loss: 0.6782
AUC: 0.8469

Epoch 8/80
 - 0s - loss: 1.1192 - val_loss: 0.6840
AUC: 0.8492

Epoch 9/80
 - 0s - loss: 1.1012 - val_loss: 0.6384
AUC: 0.8490

Epoch 10/80
 - 0s - loss: 1.0935 - val_loss: 0.6371
AUC: 0.8521

Epoch 11/80
 - 0s - loss: 1.0842 - val_loss: 0.5819
AUC: 0.8506

Epoch 12/80
 - 0s - loss: 1.0739 - val_loss: 0.7122
AUC: 0.8571

Epoch 13/80
 - 0s - loss: 1.0690 - val_loss: 0.6811
AUC: 0.8557

Epoch 14/80
 - 0s - loss: 1.0628 - val_loss: 0.6906
AUC: 0.8577

Epoch 15/80
 - 0s - loss: 1.0624 - val_loss: 0.5973
AUC: 0.8552

Epoch 16/80
 - 0s - loss: 1.0512 - val_loss: 0.5808
AUC: 0.8563

Epoch 17/80
 - 0s - loss: 1.0481 - val_loss: 0.6198
AUC: 0.8575

Epoch 18/80
 - 0s - loss: 1.0388 - val_loss: 0.6486
AUC: 0.8596

Epoch 19/80
 - 0s - loss: 1.0426 - val_loss: 0.6962
AUC: 0.8590

Epoch 20/80
 - 0s - loss: 1.0334 - val_loss: 0.6050
AUC: 0.8593

Epoch 21/80
 - 0s - loss: 1.0354 - val_loss: 0.6806
AUC: 0.8597

Epoch 22/80
 - 0s - loss: 1.0295 - val_loss: 0.6494
AUC: 0.8602

Epoch 23/80
 - 0s - loss: 1.0269 - val_loss: 0.6869
AUC: 0.8618

Epoch 24/80
 - 0s - loss: 1.0246 - val_loss: 0.6174
AUC: 0.8608

Epoch 25/80
 - 0s - loss: 1.0156 - val_loss: 0.5945
AUC: 0.8599

Epoch 26/80
 - 0s - loss: 1.0124 - val_loss: 0.5862
AUC: 0.8593

Epoch 27/80
 - 0s - loss: 1.0156 - val_loss: 0.6563
AUC: 0.8609

Epoch 28/80
 - 0s - loss: 1.0077 - val_loss: 0.6334
AUC: 0.8612

Epoch 29/80
 - 0s - loss: 1.0103 - val_loss: 0.6100
AUC: 0.8611

Epoch 30/80
 - 0s - loss: 1.0038 - val_loss: 0.6284
AUC: 0.8614

Epoch 31/80
 - 0s - loss: 1.0066 - val_loss: 0.6255
AUC: 0.8616

Epoch 32/80
 - 0s - loss: 1.0122 - val_loss: 0.6259
AUC: 0.8614

Epoch 33/80
 - 0s - loss: 1.0094 - val_loss: 0.6081
AUC: 0.8615

Epoch 34/80
 - 0s - loss: 1.0057 - val_loss: 0.6116
AUC: 0.8617

Epoch 35/80
 - 0s - loss: 1.0053 - val_loss: 0.6110
AUC: 0.8614

Epoch 36/80
 - 0s - loss: 1.0068 - val_loss: 0.6012
AUC: 0.8614

Epoch 37/80
 - 0s - loss: 1.0035 - val_loss: 0.6154
AUC: 0.8617

Epoch 38/80
 - 0s - loss: 1.0030 - val_loss: 0.6264
AUC: 0.8617

Epoch 39/80
 - 0s - loss: 0.9971 - val_loss: 0.6115
AUC: 0.8616

Epoch 40/80
 - 0s - loss: 1.0012 - val_loss: 0.6182
AUC: 0.8617

Epoch 41/80
 - 0s - loss: 1.0052 - val_loss: 0.6185
AUC: 0.8616

Epoch 42/80
 - 0s - loss: 1.0010 - val_loss: 0.6203
AUC: 0.8616

Epoch 43/80
 - 0s - loss: 0.9986 - val_loss: 0.6204
AUC: 0.8617

Epoch 44/80
 - 0s - loss: 1.0027 - val_loss: 0.6227
AUC: 0.8617

Epoch 45/80
 - 0s - loss: 0.9964 - val_loss: 0.6143
AUC: 0.8617

Epoch 46/80
 - 0s - loss: 1.0036 - val_loss: 0.6113
AUC: 0.8617

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0210 - val_loss: 0.6220
AUC: 0.8606

Epoch 2/30
 - 0s - loss: 1.0177 - val_loss: 0.6066
AUC: 0.8604

Epoch 3/30
 - 0s - loss: 1.0137 - val_loss: 0.6238
AUC: 0.8610

Epoch 4/30
 - 0s - loss: 1.0107 - val_loss: 0.6269
AUC: 0.8612

Epoch 5/30
 - 0s - loss: 1.0130 - val_loss: 0.6176
AUC: 0.8612

Epoch 6/30
 - 0s - loss: 1.0034 - val_loss: 0.6298
AUC: 0.8616

Epoch 7/30
 - 0s - loss: 1.0018 - val_loss: 0.6350
AUC: 0.8616

Epoch 8/30
 - 0s - loss: 1.0037 - val_loss: 0.6296
AUC: 0.8619

Epoch 9/30
 - 0s - loss: 1.0034 - val_loss: 0.6160
AUC: 0.8619

Epoch 10/30
 - 0s - loss: 1.0049 - val_loss: 0.6178
AUC: 0.8623

Epoch 11/30
 - 0s - loss: 1.0002 - val_loss: 0.6190
AUC: 0.8624

Epoch 12/30
 - 0s - loss: 1.0050 - val_loss: 0.6172
AUC: 0.8626

Epoch 13/30
 - 0s - loss: 1.0014 - val_loss: 0.6188
AUC: 0.8626

Epoch 14/30
 - 0s - loss: 1.0018 - val_loss: 0.6159
AUC: 0.8626

Epoch 15/30
 - 0s - loss: 0.9988 - val_loss: 0.6129
AUC: 0.8625

Epoch 16/30
 - 0s - loss: 1.0030 - val_loss: 0.6139
AUC: 0.8625

Epoch 17/30
 - 0s - loss: 1.0016 - val_loss: 0.6161
AUC: 0.8626

Epoch 18/30
 - 0s - loss: 0.9993 - val_loss: 0.6200
AUC: 0.8626

Epoch 19/30
 - 0s - loss: 0.9957 - val_loss: 0.6144
AUC: 0.8625

Epoch 20/30
 - 0s - loss: 0.9958 - val_loss: 0.6169
AUC: 0.8626

Epoch 21/30
 - 0s - loss: 1.0004 - val_loss: 0.6154
AUC: 0.8626

Epoch 22/30
 - 0s - loss: 1.0009 - val_loss: 0.6228
AUC: 0.8627

Epoch 23/30
 - 0s - loss: 1.0008 - val_loss: 0.6209
AUC: 0.8627

Epoch 24/30
 - 0s - loss: 0.9930 - val_loss: 0.6191
AUC: 0.8627

Epoch 25/30
 - 0s - loss: 0.9961 - val_loss: 0.6188
AUC: 0.8627

Epoch 26/30
 - 0s - loss: 0.9974 - val_loss: 0.6179
AUC: 0.8627

Epoch 27/30
 - 0s - loss: 0.9969 - val_loss: 0.6165
AUC: 0.8627

Epoch 28/30
 - 0s - loss: 0.9936 - val_loss: 0.6165
AUC: 0.8627

Epoch 29/30
 - 0s - loss: 0.9981 - val_loss: 0.6161
AUC: 0.8627

Epoch 30/30
 - 0s - loss: 0.9983 - val_loss: 0.6160
Using TensorFlow backend.
AUC: 0.8627

2019-03-08 02:36:35.310133: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:36:35.480010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:36:35.480070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:36:35.783983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:36:35.784039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:36:35.784048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:36:35.784313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1812
Epoch 2/80
 - 2s - loss: 0.2230
Epoch 3/80
 - 2s - loss: 0.1734
Epoch 4/80
 - 2s - loss: 0.1645
Epoch 5/80
 - 2s - loss: 0.1553
Epoch 6/80
 - 2s - loss: 0.1440
Epoch 7/80
 - 2s - loss: 0.1329
Epoch 8/80
 - 2s - loss: 0.1230
Epoch 9/80
 - 2s - loss: 0.1143
Epoch 10/80
 - 2s - loss: 0.1066
Epoch 11/80
 - 2s - loss: 0.0997
Epoch 12/80
 - 2s - loss: 0.0936
Epoch 13/80
 - 2s - loss: 0.0880
Epoch 14/80
 - 2s - loss: 0.0831
Epoch 15/80
 - 2s - loss: 0.0786
Epoch 16/80
 - 2s - loss: 0.0747
Epoch 17/80
 - 2s - loss: 0.0713
Epoch 18/80
 - 2s - loss: 0.0683
Epoch 19/80
 - 2s - loss: 0.0658
Epoch 20/80
 - 2s - loss: 0.0635
Epoch 21/80
 - 2s - loss: 0.0616
Epoch 22/80
 - 2s - loss: 0.0600
Epoch 23/80
 - 2s - loss: 0.0586
Epoch 24/80
 - 2s - loss: 0.0575
Epoch 25/80
 - 2s - loss: 0.0565
Epoch 26/80
 - 2s - loss: 0.0557
Epoch 27/80
 - 2s - loss: 0.0549
Epoch 28/80
 - 2s - loss: 0.0543
Epoch 29/80
 - 2s - loss: 0.0538
Epoch 30/80
 - 2s - loss: 0.0534
Epoch 31/80
 - 2s - loss: 0.0530
Epoch 32/80
 - 2s - loss: 0.0527
Epoch 33/80
 - 2s - loss: 0.0524
Epoch 34/80
 - 2s - loss: 0.0521
Epoch 35/80
 - 2s - loss: 0.0519
Epoch 36/80
 - 2s - loss: 0.0517
Epoch 37/80
 - 2s - loss: 0.0515
Epoch 38/80
 - 2s - loss: 0.0514
Epoch 39/80
 - 2s - loss: 0.0512
Epoch 40/80
 - 2s - loss: 0.0511
Epoch 41/80
 - 2s - loss: 0.0510
Epoch 42/80
 - 2s - loss: 0.0509
Epoch 43/80
 - 2s - loss: 0.0507
Epoch 44/80
 - 2s - loss: 0.0507
Epoch 45/80
 - 2s - loss: 0.0506
Epoch 46/80
 - 2s - loss: 0.0505
Epoch 47/80
 - 2s - loss: 0.0504
Epoch 48/80
 - 2s - loss: 0.0504
Epoch 49/80
 - 2s - loss: 0.0503
Epoch 50/80
 - 2s - loss: 0.0503
Epoch 51/80
 - 2s - loss: 0.0502
Epoch 52/80
 - 2s - loss: 0.0502
Epoch 53/80
 - 2s - loss: 0.0501
Epoch 54/80
 - 2s - loss: 0.0501
Epoch 55/80
 - 2s - loss: 0.0500
Epoch 56/80
 - 2s - loss: 0.0500
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2b557ed500f0>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 02:38:45.749705: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:38:45.916589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:38:45.916635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:38:46.219026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:38:46.219084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:38:46.219094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:38:46.219359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1389
Epoch 2/80
 - 2s - loss: 0.2155
Epoch 3/80
 - 2s - loss: 0.1720
Epoch 4/80
 - 2s - loss: 0.1639
Epoch 5/80
 - 2s - loss: 0.1569
Epoch 6/80
 - 2s - loss: 0.1483
Epoch 7/80
 - 2s - loss: 0.1379
Epoch 8/80
 - 2s - loss: 0.1273
Epoch 9/80
 - 2s - loss: 0.1175
Epoch 10/80
 - 2s - loss: 0.1090
Epoch 11/80
 - 2s - loss: 0.1012
Epoch 12/80
 - 2s - loss: 0.0943
Epoch 13/80
 - 2s - loss: 0.0882
Epoch 14/80
 - 2s - loss: 0.0829
Epoch 15/80
 - 2s - loss: 0.0783
Epoch 16/80
 - 2s - loss: 0.0745
Epoch 17/80
 - 2s - loss: 0.0713
Epoch 18/80
 - 2s - loss: 0.0685
Epoch 19/80
 - 2s - loss: 0.0662
Epoch 20/80
 - 2s - loss: 0.0641
Epoch 21/80
 - 2s - loss: 0.0623
Epoch 22/80
 - 2s - loss: 0.0608
Epoch 23/80
 - 2s - loss: 0.0595
Epoch 24/80
 - 2s - loss: 0.0583
Epoch 25/80
 - 2s - loss: 0.0573
Epoch 26/80
 - 2s - loss: 0.0564
Epoch 27/80
 - 2s - loss: 0.0557
Epoch 28/80
 - 2s - loss: 0.0551
Epoch 29/80
 - 2s - loss: 0.0545
Epoch 30/80
 - 2s - loss: 0.0540
Epoch 31/80
 - 2s - loss: 0.0536
Epoch 32/80
 - 2s - loss: 0.0533
Epoch 33/80
 - 2s - loss: 0.0530
Epoch 34/80
 - 2s - loss: 0.0527
Epoch 35/80
 - 2s - loss: 0.0525
Epoch 36/80
 - 2s - loss: 0.0523
Epoch 37/80
 - 2s - loss: 0.0520
Epoch 38/80
 - 2s - loss: 0.0519
Epoch 39/80
 - 2s - loss: 0.0517
Epoch 40/80
 - 2s - loss: 0.0516
Epoch 41/80
 - 2s - loss: 0.0515
Epoch 42/80
 - 2s - loss: 0.0513
Epoch 43/80
 - 2s - loss: 0.0512
Epoch 44/80
 - 2s - loss: 0.0511
Epoch 45/80
 - 2s - loss: 0.0510
Epoch 46/80
 - 2s - loss: 0.0510
Epoch 47/80
 - 2s - loss: 0.0509
Epoch 48/80
 - 2s - loss: 0.0508
Epoch 49/80
 - 2s - loss: 0.0507
Epoch 50/80
 - 2s - loss: 0.0507
Epoch 51/80
 - 2s - loss: 0.0506
Epoch 52/80
 - 2s - loss: 0.0506
Epoch 53/80
 - 2s - loss: 0.0505
Epoch 54/80
 - 2s - loss: 0.0505
Epoch 55/80
 - 2s - loss: 0.0504
Epoch 56/80
 - 2s - loss: 0.0504
Epoch 57/80
 - 2s - loss: 0.0504
Epoch 58/80
 - 2s - loss: 0.0503
Epoch 59/80
 - 2s - loss: 0.0503
Epoch 60/80
 - 2s - loss: 0.0502
Epoch 61/80
 - 2s - loss: 0.0502
Epoch 62/80
 - 2s - loss: 0.0491
Epoch 63/80
 - 2s - loss: 0.0490
Epoch 64/80
 - 2s - loss: 0.0490
Epoch 65/80
 - 2s - loss: 0.0490
Epoch 66/80
 - 2s - loss: 0.0489
Epoch 67/80
 - 2s - loss: 0.0487
Epoch 68/80
 - 2s - loss: 0.0487
Epoch 69/80
 - 2s - loss: 0.0487
Epoch 70/80
 - 2s - loss: 0.0487
Epoch 71/80
 - 2s - loss: 0.0486
Epoch 72/80
 - 2s - loss: 0.0486
Epoch 73/80
 - 2s - loss: 0.0486
Epoch 74/80
 - 2s - loss: 0.0486
Epoch 75/80
 - 2s - loss: 0.0486
Epoch 76/80
 - 2s - loss: 0.0486
Epoch 77/80
 - 2s - loss: 0.0486
Epoch 78/80
 - 2s - loss: 0.0486
Epoch 79/80
 - 2s - loss: 0.0486
Epoch 80/80
 - 2s - loss: 0.0486
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.2978 - val_loss: 1.3634
AUC: 0.7966

Epoch 2/80
 - 0s - loss: 2.0677 - val_loss: 0.8874
AUC: 0.8190

Epoch 3/80
 - 0s - loss: 1.3732 - val_loss: 0.7895
AUC: 0.8357

Epoch 4/80
 - 0s - loss: 1.2257 - val_loss: 0.7364
AUC: 0.8421

Epoch 5/80
 - 0s - loss: 1.1733 - val_loss: 0.6624
AUC: 0.8472

Epoch 6/80
 - 0s - loss: 1.1511 - val_loss: 0.6510
AUC: 0.8493

Epoch 7/80
 - 0s - loss: 1.1238 - val_loss: 0.7010
AUC: 0.8532

Epoch 8/80
 - 0s - loss: 1.1055 - val_loss: 0.5839
AUC: 0.8531

Epoch 9/80
 - 0s - loss: 1.0984 - val_loss: 0.6359
AUC: 0.8566

Epoch 10/80
 - 0s - loss: 1.0976 - val_loss: 0.6749
AUC: 0.8602

Epoch 11/80
 - 0s - loss: 1.0850 - val_loss: 0.6896
AUC: 0.8607

Epoch 12/80
 - 0s - loss: 1.0720 - val_loss: 0.6848
AUC: 0.8618

Epoch 13/80
 - 0s - loss: 1.0706 - val_loss: 0.6685
AUC: 0.8626

Epoch 14/80
 - 0s - loss: 1.0539 - val_loss: 0.6843
AUC: 0.8635

Epoch 15/80
 - 0s - loss: 1.0521 - val_loss: 0.5790
AUC: 0.8631

Epoch 16/80
 - 0s - loss: 1.0466 - val_loss: 0.6180
AUC: 0.8626

Epoch 17/80
 - 0s - loss: 1.0448 - val_loss: 0.5938
AUC: 0.8644

Epoch 18/80
 - 0s - loss: 1.0391 - val_loss: 0.6433
AUC: 0.8641

Epoch 19/80
 - 0s - loss: 1.0396 - val_loss: 0.5355
AUC: 0.8622

Epoch 20/80
 - 0s - loss: 1.0294 - val_loss: 0.6706
AUC: 0.8663

Epoch 21/80
 - 0s - loss: 1.0277 - val_loss: 0.6163
AUC: 0.8668

Epoch 22/80
 - 0s - loss: 1.0237 - val_loss: 0.5894
AUC: 0.8670

Epoch 23/80
 - 0s - loss: 1.0222 - val_loss: 0.5525
AUC: 0.8671

Epoch 24/80
 - 0s - loss: 1.0171 - val_loss: 0.6432
AUC: 0.8686

Epoch 25/80
 - 0s - loss: 1.0145 - val_loss: 0.6065
AUC: 0.8685

Epoch 26/80
 - 0s - loss: 1.0169 - val_loss: 0.6556
AUC: 0.8693

Epoch 27/80
 - 0s - loss: 1.0205 - val_loss: 0.5895
AUC: 0.8685

Epoch 28/80
 - 0s - loss: 1.0176 - val_loss: 0.6060
AUC: 0.8691

Epoch 29/80
 - 0s - loss: 1.0039 - val_loss: 0.6457
AUC: 0.8705

Epoch 30/80
 - 0s - loss: 1.0004 - val_loss: 0.5764
AUC: 0.8697

Epoch 31/80
 - 0s - loss: 0.9955 - val_loss: 0.5933
AUC: 0.8701

Epoch 32/80
 - 0s - loss: 1.0022 - val_loss: 0.6013
AUC: 0.8702

Epoch 33/80
 - 0s - loss: 0.9979 - val_loss: 0.6021
AUC: 0.8700

Epoch 34/80
 - 0s - loss: 0.9933 - val_loss: 0.5758
AUC: 0.8695

Epoch 35/80
 - 0s - loss: 0.9899 - val_loss: 0.6034
AUC: 0.8700

Epoch 36/80
 - 0s - loss: 0.9897 - val_loss: 0.5976
AUC: 0.8698

Epoch 37/80
 - 0s - loss: 0.9906 - val_loss: 0.6038
AUC: 0.8701

Epoch 38/80
 - 0s - loss: 0.9894 - val_loss: 0.6085
AUC: 0.8699

Epoch 39/80
 - 0s - loss: 0.9901 - val_loss: 0.6026
AUC: 0.8699

Epoch 40/80
 - 0s - loss: 0.9918 - val_loss: 0.5936
AUC: 0.8699

Epoch 41/80
 - 0s - loss: 0.9900 - val_loss: 0.5980
AUC: 0.8701

Epoch 42/80
 - 0s - loss: 0.9868 - val_loss: 0.5999
AUC: 0.8701

Epoch 43/80
 - 0s - loss: 0.9958 - val_loss: 0.5955
AUC: 0.8701

Epoch 44/80
 - 0s - loss: 0.9896 - val_loss: 0.6000
AUC: 0.8702

Epoch 45/80
 - 0s - loss: 0.9937 - val_loss: 0.5949
AUC: 0.8701

Epoch 46/80
 - 0s - loss: 0.9887 - val_loss: 0.5974
AUC: 0.8701

Epoch 47/80
 - 0s - loss: 0.9900 - val_loss: 0.5918
AUC: 0.8701

Epoch 48/80
 - 0s - loss: 0.9906 - val_loss: 0.5905
AUC: 0.8701

Epoch 49/80
 - 0s - loss: 0.9864 - val_loss: 0.5889
AUC: 0.8701

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0059 - val_loss: 0.6042
AUC: 0.8701

Epoch 2/30
 - 0s - loss: 0.9982 - val_loss: 0.6079
AUC: 0.8702

Epoch 3/30
 - 0s - loss: 0.9878 - val_loss: 0.6100
AUC: 0.8702

Epoch 4/30
 - 0s - loss: 0.9926 - val_loss: 0.6048
AUC: 0.8705

Epoch 5/30
 - 0s - loss: 0.9887 - val_loss: 0.5941
AUC: 0.8703

Epoch 6/30
 - 0s - loss: 0.9893 - val_loss: 0.5948
AUC: 0.8703

Epoch 7/30
 - 0s - loss: 0.9868 - val_loss: 0.5943
AUC: 0.8705

Epoch 8/30
 - 0s - loss: 0.9865 - val_loss: 0.5731
AUC: 0.8702

Epoch 9/30
 - 0s - loss: 0.9847 - val_loss: 0.5893
AUC: 0.8705

Epoch 10/30
 - 0s - loss: 0.9852 - val_loss: 0.5905
AUC: 0.8708

Epoch 11/30
 - 0s - loss: 0.9787 - val_loss: 0.6028
AUC: 0.8711

Epoch 12/30
 - 0s - loss: 0.9861 - val_loss: 0.5996
AUC: 0.8711

Epoch 13/30
 - 0s - loss: 0.9742 - val_loss: 0.5955
AUC: 0.8710

Epoch 14/30
 - 0s - loss: 0.9796 - val_loss: 0.5857
AUC: 0.8711

Epoch 15/30
 - 0s - loss: 0.9820 - val_loss: 0.5752
AUC: 0.8709

Epoch 16/30
 - 0s - loss: 0.9758 - val_loss: 0.5898
AUC: 0.8711

Epoch 17/30
 - 0s - loss: 0.9723 - val_loss: 0.5817
AUC: 0.8711

Epoch 18/30
 - 0s - loss: 0.9748 - val_loss: 0.5922
AUC: 0.8713

Epoch 19/30
 - 0s - loss: 0.9729 - val_loss: 0.5921
AUC: 0.8714

Epoch 20/30
 - 0s - loss: 0.9688 - val_loss: 0.5837
AUC: 0.8713

Epoch 21/30
 - 0s - loss: 0.9740 - val_loss: 0.5864
AUC: 0.8713

Epoch 22/30
 - 0s - loss: 0.9711 - val_loss: 0.5911
AUC: 0.8714

Epoch 23/30
 - 0s - loss: 0.9731 - val_loss: 0.5896
AUC: 0.8714

Epoch 24/30
 - 0s - loss: 0.9730 - val_loss: 0.5882
AUC: 0.8714

Epoch 25/30
 - 0s - loss: 0.9727 - val_loss: 0.5872
AUC: 0.8714

Epoch 26/30
 - 0s - loss: 0.9715 - val_loss: 0.5899
AUC: 0.8715

Epoch 27/30
 - 0s - loss: 0.9681 - val_loss: 0.5852
AUC: 0.8714

Epoch 28/30
 - 1s - loss: 0.9714 - val_loss: 0.5917
AUC: 0.8715

Epoch 29/30
 - 1s - loss: 0.9668 - val_loss: 0.5908
AUC: 0.8715

Epoch 30/30
 - 1s - loss: 0.9736 - val_loss: 0.5900
Using TensorFlow backend.
AUC: 0.8715

2019-03-08 02:42:36.638727: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:42:36.806144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:42:36.806190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:42:37.107330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:42:37.107386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:42:37.107396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:42:37.107662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1364
Epoch 2/80
 - 2s - loss: 0.2144
Epoch 3/80
 - 2s - loss: 0.1739
Epoch 4/80
 - 2s - loss: 0.1676
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:43:04.843545: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:43:05.010039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:43:05.010085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:43:05.309543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:43:05.309586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:43:05.309596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:43:05.309901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1512
Epoch 2/80
 - 2s - loss: 0.2178
Epoch 3/80
 - 2s - loss: 0.1719
Epoch 4/80
 - 2s - loss: 0.1631
Epoch 5/80
 - 2s - loss: 0.1557
Epoch 6/80
 - 2s - loss: 0.1466
Epoch 7/80
 - 2s - loss: 0.1354
Epoch 8/80
 - 2s - loss: 0.1235
Epoch 9/80
 - 2s - loss: 0.1130
Epoch 10/80
 - 2s - loss: 0.1046
Epoch 11/80
 - 2s - loss: 0.0981
Epoch 12/80
 - 2s - loss: 0.0927
Epoch 13/80
 - 2s - loss: 0.0879
Epoch 14/80
 - 2s - loss: 0.0833
Epoch 15/80
 - 2s - loss: 0.0788
Epoch 16/80
 - 2s - loss: 0.0748
Epoch 17/80
 - 2s - loss: 0.0712
Epoch 18/80
 - 2s - loss: 0.0682
Epoch 19/80
 - 2s - loss: 0.0657
Epoch 20/80
 - 2s - loss: 0.0636
Epoch 21/80
 - 2s - loss: 0.0618
Epoch 22/80
 - 2s - loss: 0.0603
Epoch 23/80
 - 2s - loss: 0.0590
Epoch 24/80
 - 2s - loss: 0.0579
Epoch 25/80
 - 2s - loss: 0.0570
Epoch 26/80
 - 2s - loss: 0.0562
Epoch 27/80
 - 2s - loss: 0.0555
Epoch 28/80
 - 2s - loss: 0.0549
Epoch 29/80
 - 2s - loss: 0.0544
Epoch 30/80
 - 2s - loss: 0.0539
Epoch 31/80
 - 2s - loss: 0.0535
Epoch 32/80
 - 2s - loss: 0.0532
Epoch 33/80
 - 2s - loss: 0.0529
Epoch 34/80
 - 2s - loss: 0.0527
Epoch 35/80
 - 2s - loss: 0.0524
Epoch 36/80
 - 2s - loss: 0.0522
Epoch 37/80
 - 2s - loss: 0.0520
Epoch 38/80
 - 2s - loss: 0.0519
Epoch 39/80
 - 2s - loss: 0.0517
Epoch 40/80
 - 2s - loss: 0.0516
Epoch 41/80
 - 2s - loss: 0.0515
Epoch 42/80
 - 2s - loss: 0.0514
Epoch 43/80
 - 2s - loss: 0.0513
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:44:52.000267: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:44:52.169976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:44:52.170022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:44:52.474795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:44:52.474870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:44:52.474906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:44:52.475195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6818
Epoch 2/80
 - 2s - loss: 0.1291
Epoch 3/80
 - 2s - loss: 0.0732
Epoch 4/80
 - 2s - loss: 0.0666
Epoch 5/80
 - 2s - loss: 0.0640
Epoch 6/80
 - 2s - loss: 0.0619
Epoch 7/80
 - 2s - loss: 0.0596
Epoch 8/80
 - 2s - loss: 0.0570
Epoch 9/80
 - 2s - loss: 0.0541
Epoch 10/80
 - 2s - loss: 0.0510
Epoch 11/80
 - 2s - loss: 0.0476
Epoch 12/80
 - 2s - loss: 0.0441
Epoch 13/80
 - 2s - loss: 0.0406
Epoch 14/80
 - 2s - loss: 0.0372
Epoch 15/80
 - 2s - loss: 0.0342
Epoch 16/80
 - 2s - loss: 0.0316
Epoch 17/80
 - 2s - loss: 0.0294
Epoch 18/80
 - 2s - loss: 0.0277
Epoch 19/80
 - 2s - loss: 0.0262
Epoch 20/80
 - 2s - loss: 0.0249
Epoch 21/80
 - 2s - loss: 0.0237
Epoch 22/80
 - 2s - loss: 0.0228
Epoch 23/80
 - 2s - loss: 0.0219
Epoch 24/80
 - 2s - loss: 0.0212
Epoch 25/80
 - 2s - loss: 0.0206
Epoch 26/80
 - 2s - loss: 0.0200
Epoch 27/80
 - 2s - loss: 0.0196
Epoch 28/80
 - 2s - loss: 0.0192
Epoch 29/80
 - 2s - loss: 0.0189
Epoch 30/80
 - 2s - loss: 0.0186
Epoch 31/80
 - 2s - loss: 0.0183
Epoch 32/80
 - 2s - loss: 0.0181
Epoch 33/80
 - 2s - loss: 0.0179
Epoch 34/80
 - 2s - loss: 0.0177
Epoch 35/80
 - 2s - loss: 0.0176
Epoch 36/80
 - 2s - loss: 0.0175
Epoch 37/80
 - 2s - loss: 0.0174
Epoch 38/80
 - 2s - loss: 0.0173
Epoch 39/80
 - 2s - loss: 0.0172
Epoch 40/80
 - 2s - loss: 0.0171
Epoch 41/80
 - 2s - loss: 0.0170
Epoch 42/80
 - 2s - loss: 0.0169
Epoch 43/80
 - 2s - loss: 0.0169
Epoch 44/80
 - 2s - loss: 0.0168
Epoch 45/80
 - 2s - loss: 0.0168
Epoch 46/80
 - 2s - loss: 0.0167
Epoch 47/80
 - 2s - loss: 0.0167
Epoch 48/80
 - 2s - loss: 0.0167
Epoch 49/80
 - 2s - loss: 0.0166
Epoch 50/80
 - 2s - loss: 0.0166
Epoch 51/80
 - 2s - loss: 0.0166
Epoch 52/80
 - 2s - loss: 0.0165
Epoch 53/80
 - 2s - loss: 0.0165
Epoch 54/80
 - 2s - loss: 0.0161
Epoch 55/80
 - 2s - loss: 0.0161
Epoch 56/80
 - 2s - loss: 0.0160
Epoch 57/80
 - 2s - loss: 0.0160
Epoch 58/80
 - 2s - loss: 0.0159
Epoch 59/80
 - 2s - loss: 0.0159
Epoch 60/80
 - 2s - loss: 0.0159
Epoch 61/80
 - 2s - loss: 0.0159
Epoch 62/80
 - 2s - loss: 0.0159
Epoch 63/80
 - 2s - loss: 0.0159
Epoch 64/80
 - 2s - loss: 0.0159
Epoch 65/80
 - 2s - loss: 0.0159
Epoch 66/80
 - 2s - loss: 0.0159
Epoch 67/80
 - 2s - loss: 0.0159
Epoch 68/80
 - 2s - loss: 0.0159
Epoch 69/80
 - 2s - loss: 0.0159
Epoch 70/80
 - 2s - loss: 0.0159
Epoch 71/80
 - 2s - loss: 0.0159
Epoch 72/80
 - 2s - loss: 0.0159
Epoch 73/80
 - 2s - loss: 0.0159
Epoch 74/80
 - 2s - loss: 0.0159
Epoch 75/80
 - 2s - loss: 0.0159
Epoch 76/80
 - 2s - loss: 0.0159
Epoch 77/80
 - 2s - loss: 0.0159
Epoch 78/80
 - 2s - loss: 0.0159
Epoch 79/80
 - 2s - loss: 0.0159
Epoch 80/80
 - 2s - loss: 0.0159
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 8.8777 - val_loss: 1.2972
AUC: 0.7067

Epoch 2/80
 - 0s - loss: 2.9643 - val_loss: 1.1019
AUC: 0.7808

Epoch 3/80
 - 0s - loss: 2.1944 - val_loss: 1.0229
AUC: 0.8054

Epoch 4/80
 - 0s - loss: 1.6776 - val_loss: 0.6947
AUC: 0.8150

Epoch 5/80
 - 0s - loss: 1.4040 - val_loss: 0.7982
AUC: 0.8290

Epoch 6/80
 - 0s - loss: 1.2479 - val_loss: 0.7345
AUC: 0.8338

Epoch 7/80
 - 0s - loss: 1.1926 - val_loss: 0.6943
AUC: 0.8345

Epoch 8/80
 - 0s - loss: 1.1673 - val_loss: 0.6608
AUC: 0.8334

Epoch 9/80
 - 0s - loss: 1.1298 - val_loss: 0.6838
AUC: 0.8403

Epoch 10/80
 - 0s - loss: 1.1237 - val_loss: 0.7064
AUC: 0.8422

Epoch 11/80
 - 0s - loss: 1.1095 - val_loss: 0.6870
AUC: 0.8441

Epoch 12/80
 - 0s - loss: 1.0972 - val_loss: 0.6595
AUC: 0.8444

Epoch 13/80
 - 0s - loss: 1.0915 - val_loss: 0.6548
AUC: 0.8456

Epoch 14/80
 - 0s - loss: 1.0795 - val_loss: 0.6299
AUC: 0.8474

Epoch 15/80
 - 0s - loss: 1.0725 - val_loss: 0.6394
AUC: 0.8479

Epoch 16/80
 - 0s - loss: 1.0790 - val_loss: 0.6571
AUC: 0.8501

Epoch 17/80
 - 0s - loss: 1.0601 - val_loss: 0.6648
AUC: 0.8505

Epoch 18/80
 - 0s - loss: 1.0571 - val_loss: 0.5661
AUC: 0.8494

Epoch 19/80
 - 0s - loss: 1.0550 - val_loss: 0.6423
AUC: 0.8525

Epoch 20/80
 - 0s - loss: 1.0464 - val_loss: 0.6223
AUC: 0.8533

Epoch 21/80
 - 0s - loss: 1.0436 - val_loss: 0.6362
AUC: 0.8531

Epoch 22/80
 - 0s - loss: 1.0405 - val_loss: 0.6283
AUC: 0.8537

Epoch 23/80
 - 0s - loss: 1.0383 - val_loss: 0.6356
AUC: 0.8551

Epoch 24/80
 - 0s - loss: 1.0306 - val_loss: 0.6122
AUC: 0.8549

Epoch 25/80
 - 0s - loss: 1.0335 - val_loss: 0.6633
AUC: 0.8561

Epoch 26/80
 - 0s - loss: 1.0292 - val_loss: 0.6402
AUC: 0.8561

Epoch 27/80
 - 0s - loss: 1.0296 - val_loss: 0.6381
AUC: 0.8561

Epoch 28/80
 - 0s - loss: 1.0287 - val_loss: 0.6839
AUC: 0.8572

Epoch 29/80
 - 0s - loss: 1.0170 - val_loss: 0.6505
AUC: 0.8573

Epoch 30/80
 - 0s - loss: 1.0099 - val_loss: 0.6405
AUC: 0.8573

Epoch 31/80
 - 0s - loss: 1.0178 - val_loss: 0.6105
AUC: 0.8570

Epoch 32/80
 - 0s - loss: 1.0146 - val_loss: 0.6365
AUC: 0.8575

Epoch 33/80
 - 0s - loss: 1.0172 - val_loss: 0.6191
AUC: 0.8573

Epoch 34/80
 - 0s - loss: 1.0107 - val_loss: 0.6224
AUC: 0.8577

Epoch 35/80
 - 0s - loss: 1.0088 - val_loss: 0.6202
AUC: 0.8573

Epoch 36/80
 - 0s - loss: 1.0067 - val_loss: 0.6019
AUC: 0.8571

Epoch 37/80
 - 0s - loss: 1.0109 - val_loss: 0.5959
AUC: 0.8572

Epoch 38/80
 - 0s - loss: 1.0058 - val_loss: 0.6152
AUC: 0.8576

Epoch 39/80
 - 0s - loss: 1.0037 - val_loss: 0.6267
AUC: 0.8577

Epoch 40/80
 - 0s - loss: 1.0089 - val_loss: 0.6154
AUC: 0.8575

Epoch 41/80
 - 0s - loss: 1.0060 - val_loss: 0.6242
AUC: 0.8577

Epoch 42/80
 - 0s - loss: 1.0064 - val_loss: 0.6236
AUC: 0.8578

Epoch 43/80
 - 0s - loss: 1.0072 - val_loss: 0.6204
AUC: 0.8578

Epoch 44/80
 - 0s - loss: 1.0078 - val_loss: 0.6248
AUC: 0.8578

Epoch 45/80
 - 0s - loss: 1.0062 - val_loss: 0.6231
AUC: 0.8578

Epoch 46/80
 - 0s - loss: 1.0012 - val_loss: 0.6240
AUC: 0.8578

Epoch 47/80
 - 0s - loss: 1.0076 - val_loss: 0.6272
AUC: 0.8580

Epoch 48/80
 - 0s - loss: 1.0082 - val_loss: 0.6208
AUC: 0.8580

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0062 - val_loss: 0.6257
AUC: 0.8582

Epoch 2/30
 - 0s - loss: 1.0058 - val_loss: 0.6182
AUC: 0.8583

Epoch 3/30
 - 0s - loss: 1.0031 - val_loss: 0.6179
AUC: 0.8585

Epoch 4/30
 - 0s - loss: 1.0012 - val_loss: 0.6243
AUC: 0.8588

Epoch 5/30
 - 0s - loss: 0.9997 - val_loss: 0.6269
AUC: 0.8589

Epoch 6/30
 - 0s - loss: 0.9953 - val_loss: 0.6248
AUC: 0.8592

Epoch 7/30
 - 0s - loss: 0.9966 - val_loss: 0.6275
AUC: 0.8595

Epoch 8/30
 - 0s - loss: 0.9954 - val_loss: 0.6042
AUC: 0.8593

Epoch 9/30
 - 0s - loss: 0.9923 - val_loss: 0.5965
AUC: 0.8592

Epoch 10/30
 - 0s - loss: 0.9945 - val_loss: 0.6435
AUC: 0.8602

Epoch 11/30
 - 0s - loss: 0.9957 - val_loss: 0.6165
AUC: 0.8599

Epoch 12/30
 - 0s - loss: 0.9950 - val_loss: 0.6213
AUC: 0.8600

Epoch 13/30
 - 0s - loss: 0.9897 - val_loss: 0.6120
AUC: 0.8600

Epoch 14/30
 - 0s - loss: 0.9878 - val_loss: 0.6284
AUC: 0.8606

Epoch 15/30
 - 0s - loss: 0.9895 - val_loss: 0.6079
AUC: 0.8603

Epoch 16/30
 - 0s - loss: 0.9859 - val_loss: 0.6097
AUC: 0.8604

Epoch 17/30
 - 0s - loss: 0.9855 - val_loss: 0.6161
AUC: 0.8608

Epoch 18/30
 - 0s - loss: 0.9815 - val_loss: 0.5998
AUC: 0.8606

Epoch 19/30
 - 0s - loss: 0.9854 - val_loss: 0.6164
AUC: 0.8609

Epoch 20/30
 - 0s - loss: 0.9776 - val_loss: 0.6111
AUC: 0.8608

Epoch 21/30
 - 0s - loss: 0.9786 - val_loss: 0.6110
AUC: 0.8608

Epoch 22/30
 - 0s - loss: 0.9850 - val_loss: 0.6115
AUC: 0.8609

Epoch 23/30
 - 0s - loss: 0.9810 - val_loss: 0.6160
AUC: 0.8610

Epoch 24/30
 - 0s - loss: 0.9804 - val_loss: 0.6116
AUC: 0.8610

Epoch 25/30
 - 0s - loss: 0.9853 - val_loss: 0.6139
AUC: 0.8611

Epoch 26/30
 - 0s - loss: 0.9791 - val_loss: 0.6123
AUC: 0.8610

Epoch 27/30
 - 0s - loss: 0.9791 - val_loss: 0.6097
AUC: 0.8610

Epoch 28/30
 - 0s - loss: 0.9794 - val_loss: 0.6086
AUC: 0.8610

Epoch 29/30
 - 0s - loss: 0.9822 - val_loss: 0.6105
AUC: 0.8611

Epoch 30/30
 - 0s - loss: 0.9775 - val_loss: 0.6094
Using TensorFlow backend.
AUC: 0.8611

2019-03-08 02:48:46.861553: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:48:47.029084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:48:47.029132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:48:47.331945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:48:47.332003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:48:47.332013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:48:47.332281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6932
Epoch 2/80
 - 2s - loss: 0.1322
Epoch 3/80
 - 2s - loss: 0.0736
Epoch 4/80
 - 2s - loss: 0.0669
Epoch 5/80
 - 2s - loss: 0.0643
Epoch 6/80
 - 2s - loss: 0.0624
Epoch 7/80
 - 2s - loss: 0.0601
Epoch 8/80
 - 2s - loss: 0.0571
Epoch 9/80
 - 2s - loss: 0.0533
Epoch 10/80
 - 2s - loss: 0.0494
Epoch 11/80
 - 2s - loss: 0.0458
Epoch 12/80
 - 2s - loss: 0.0425
Epoch 13/80
 - 2s - loss: 0.0395
Epoch 14/80
 - 2s - loss: 0.0366
Epoch 15/80
 - 2s - loss: 0.0340
Epoch 16/80
 - 2s - loss: 0.0317
Epoch 17/80
 - 2s - loss: 0.0296
Epoch 18/80
 - 2s - loss: 0.0278
Epoch 19/80
 - 2s - loss: 0.0262
Epoch 20/80
 - 2s - loss: 0.0248
Epoch 21/80
 - 2s - loss: 0.0237
Epoch 22/80
 - 2s - loss: 0.0227
Epoch 23/80
 - 2s - loss: 0.0218
Epoch 24/80
 - 2s - loss: 0.0211
Epoch 25/80
 - 2s - loss: 0.0205
Epoch 26/80
 - 2s - loss: 0.0200
Epoch 27/80
 - 2s - loss: 0.0195
Epoch 28/80
 - 2s - loss: 0.0192
Epoch 29/80
 - 2s - loss: 0.0188
Epoch 30/80
 - 2s - loss: 0.0186
Epoch 31/80
 - 2s - loss: 0.0183
Epoch 32/80
 - 2s - loss: 0.0181
Epoch 33/80
 - 2s - loss: 0.0179
Epoch 34/80
 - 2s - loss: 0.0177
Epoch 35/80
 - 2s - loss: 0.0176
Epoch 36/80
 - 2s - loss: 0.0175
Epoch 37/80
 - 2s - loss: 0.0174
Epoch 38/80
 - 2s - loss: 0.0173
Epoch 39/80
 - 2s - loss: 0.0172
Epoch 40/80
 - 2s - loss: 0.0171
Epoch 41/80
 - 2s - loss: 0.0170
Epoch 42/80
 - 2s - loss: 0.0170
Epoch 43/80
 - 2s - loss: 0.0169
Epoch 44/80
 - 2s - loss: 0.0169
Epoch 45/80
 - 2s - loss: 0.0168
Epoch 46/80
 - 2s - loss: 0.0168
Epoch 47/80
 - 2s - loss: 0.0167
Epoch 48/80
 - 2s - loss: 0.0167
Epoch 49/80
 - 2s - loss: 0.0167
Epoch 50/80
 - 2s - loss: 0.0166
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:50:44.246458: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:50:44.415051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:50:44.415093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:50:44.715040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:50:44.715095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:50:44.715104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:50:44.715368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6880
Epoch 2/80
 - 2s - loss: 0.1303
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:51:11.902842: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:51:12.067810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:51:12.067860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:51:12.369005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:51:12.369060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:51:12.369069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:51:12.369337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3533
Epoch 2/80
 - 2s - loss: 0.3507
Epoch 3/80
 - 2s - loss: 0.3092
Epoch 4/80
 - 2s - loss: 0.2984
Epoch 5/80
 - 2s - loss: 0.2871
Epoch 6/80
 - 2s - loss: 0.2728
Epoch 7/80
 - 2s - loss: 0.2538
Epoch 8/80
 - 2s - loss: 0.2306
Epoch 9/80
 - 2s - loss: 0.2093
Epoch 10/80
 - 2s - loss: 0.1936
Epoch 11/80
 - 2s - loss: 0.1811
Epoch 12/80
 - 2s - loss: 0.1707
Epoch 13/80
 - 2s - loss: 0.1619
Epoch 14/80
 - 2s - loss: 0.1547
Epoch 15/80
 - 2s - loss: 0.1487
Epoch 16/80
 - 2s - loss: 0.1436
Epoch 17/80
 - 2s - loss: 0.1393
Epoch 18/80
 - 2s - loss: 0.1357
Epoch 19/80
 - 2s - loss: 0.1326
Epoch 20/80
 - 2s - loss: 0.1299
Epoch 21/80
 - 2s - loss: 0.1277
Epoch 22/80
 - 2s - loss: 0.1258
Epoch 23/80
 - 2s - loss: 0.1241
Epoch 24/80
 - 2s - loss: 0.1228
Epoch 25/80
 - 2s - loss: 0.1217
Epoch 26/80
 - 2s - loss: 0.1207
Epoch 27/80
 - 2s - loss: 0.1199
Epoch 28/80
 - 2s - loss: 0.1192
Epoch 29/80
 - 2s - loss: 0.1186
Epoch 30/80
 - 2s - loss: 0.1181
Epoch 31/80
 - 2s - loss: 0.1176
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:52:35.606962: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:52:35.774624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:52:35.774670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:52:36.074264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:52:36.074320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:52:36.074329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:52:36.074596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3723
Epoch 2/80
 - 2s - loss: 0.3520
Epoch 3/80
 - 2s - loss: 0.3094
Epoch 4/80
 - 2s - loss: 0.2959
Epoch 5/80
 - 2s - loss: 0.2791
Epoch 6/80
 - 2s - loss: 0.2588
Epoch 7/80
 - 2s - loss: 0.2390
Epoch 8/80
 - 2s - loss: 0.2222
Epoch 9/80
 - 2s - loss: 0.2077
Epoch 10/80
 - 2s - loss: 0.1947
Epoch 11/80
 - 2s - loss: 0.1833
Epoch 12/80
 - 2s - loss: 0.1733
Epoch 13/80
 - 2s - loss: 0.1649
Epoch 14/80
 - 2s - loss: 0.1580
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:53:21.723990: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:53:21.892926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:53:21.892975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:53:22.202949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:53:22.203004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:53:22.203014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:53:22.203278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3851
Epoch 2/80
 - 2s - loss: 0.3533
Epoch 3/80
 - 2s - loss: 0.3083
Epoch 4/80
 - 2s - loss: 0.2946
Epoch 5/80
 - 2s - loss: 0.2788
Epoch 6/80
 - 2s - loss: 0.2587
Epoch 7/80
 - 2s - loss: 0.2367
Epoch 8/80
 - 2s - loss: 0.2185
Epoch 9/80
 - 2s - loss: 0.2047
Epoch 10/80
 - 2s - loss: 0.1933
Epoch 11/80
 - 2s - loss: 0.1833
Epoch 12/80
 - 2s - loss: 0.1743
Epoch 13/80
 - 2s - loss: 0.1663
Epoch 14/80
 - 2s - loss: 0.1592
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 02:54:11.752867: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:54:11.923891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:54:11.923936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:54:12.225885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:54:12.225936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:54:12.225946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:54:12.226226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1377
Epoch 2/80
 - 2s - loss: 0.2149
Epoch 3/80
 - 2s - loss: 0.1736
Epoch 4/80
 - 2s - loss: 0.1673
Epoch 5/80
 - 2s - loss: 0.1622
Epoch 6/80
 - 2s - loss: 0.1551
Epoch 7/80
 - 2s - loss: 0.1447
Epoch 8/80
 - 2s - loss: 0.1319
Epoch 9/80
 - 2s - loss: 0.1201
Epoch 10/80
 - 2s - loss: 0.1106
Epoch 11/80
 - 2s - loss: 0.1027
Epoch 12/80
 - 2s - loss: 0.0958
Epoch 13/80
 - 2s - loss: 0.0896
Epoch 14/80
 - 2s - loss: 0.0840
Epoch 15/80
 - 2s - loss: 0.0792
Epoch 16/80
 - 2s - loss: 0.0751
Epoch 17/80
 - 2s - loss: 0.0715
Epoch 18/80
 - 2s - loss: 0.0685
Epoch 19/80
 - 2s - loss: 0.0659
Epoch 20/80
 - 2s - loss: 0.0637
Epoch 21/80
 - 2s - loss: 0.0619
Epoch 22/80
 - 2s - loss: 0.0603
Epoch 23/80
 - 2s - loss: 0.0590
Epoch 24/80
 - 2s - loss: 0.0579
Epoch 25/80
 - 2s - loss: 0.0570
Epoch 26/80
 - 2s - loss: 0.0562
Epoch 27/80
 - 2s - loss: 0.0555
Epoch 28/80
 - 2s - loss: 0.0549
Epoch 29/80
 - 2s - loss: 0.0544
Epoch 30/80
 - 2s - loss: 0.0539
Epoch 31/80
 - 2s - loss: 0.0535
Epoch 32/80
 - 2s - loss: 0.0531
Epoch 33/80
 - 2s - loss: 0.0528
Epoch 34/80
 - 2s - loss: 0.0526
Epoch 35/80
 - 2s - loss: 0.0523
Epoch 36/80
 - 2s - loss: 0.0521
Epoch 37/80
 - 2s - loss: 0.0519
Epoch 38/80
 - 2s - loss: 0.0517
Epoch 39/80
 - 2s - loss: 0.0516
Epoch 40/80
 - 2s - loss: 0.0514
Epoch 41/80
 - 2s - loss: 0.0513
Epoch 42/80
 - 2s - loss: 0.0512
Epoch 43/80
 - 2s - loss: 0.0511
Epoch 44/80
 - 2s - loss: 0.0510
Epoch 45/80
 - 2s - loss: 0.0509
Epoch 46/80
 - 2s - loss: 0.0508
Epoch 47/80
 - 2s - loss: 0.0508
Epoch 48/80
 - 2s - loss: 0.0507
Epoch 49/80
 - 2s - loss: 0.0506
Epoch 50/80
 - 2s - loss: 0.0505
Epoch 51/80
 - 2s - loss: 0.0505
Epoch 52/80
 - 2s - loss: 0.0505
Epoch 53/80
 - 2s - loss: 0.0504
Epoch 54/80
 - 2s - loss: 0.0504
Epoch 55/80
 - 2s - loss: 0.0503
Epoch 56/80
 - 2s - loss: 0.0503
Epoch 57/80
 - 2s - loss: 0.0502
Epoch 58/80
 - 2s - loss: 0.0502
Epoch 59/80
 - 2s - loss: 0.0502
Epoch 60/80
 - 2s - loss: 0.0501
Epoch 61/80
 - 2s - loss: 0.0501
Epoch 62/80
 - 2s - loss: 0.0501
Epoch 63/80
 - 2s - loss: 0.0490
Epoch 64/80
 - 2s - loss: 0.0489
Epoch 65/80
 - 2s - loss: 0.0488
Epoch 66/80
 - 2s - loss: 0.0488
Epoch 67/80
 - 2s - loss: 0.0488
Epoch 68/80
 - 2s - loss: 0.0485
Epoch 69/80
 - 2s - loss: 0.0485
Epoch 70/80
 - 2s - loss: 0.0485
Epoch 71/80
 - 2s - loss: 0.0485
Epoch 72/80
 - 2s - loss: 0.0485
Epoch 73/80
 - 2s - loss: 0.0485
Epoch 74/80
 - 2s - loss: 0.0485
Epoch 75/80
 - 2s - loss: 0.0485
Epoch 76/80
 - 2s - loss: 0.0485
Epoch 77/80
 - 2s - loss: 0.0485
Epoch 78/80
 - 2s - loss: 0.0485
Epoch 79/80
 - 2s - loss: 0.0485
Epoch 80/80
 - 2s - loss: 0.0485
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.2824 - val_loss: 1.0139
AUC: 0.7700

Epoch 2/80
 - 0s - loss: 1.8990 - val_loss: 0.7615
AUC: 0.8206

Epoch 3/80
 - 0s - loss: 1.3219 - val_loss: 0.7370
AUC: 0.8385

Epoch 4/80
 - 0s - loss: 1.2033 - val_loss: 0.6918
AUC: 0.8477

Epoch 5/80
 - 0s - loss: 1.1583 - val_loss: 0.6905
AUC: 0.8531

Epoch 6/80
 - 0s - loss: 1.1313 - val_loss: 0.6538
AUC: 0.8544

Epoch 7/80
 - 0s - loss: 1.1160 - val_loss: 0.7010
AUC: 0.8569

Epoch 8/80
 - 0s - loss: 1.1146 - val_loss: 0.6396
AUC: 0.8576

Epoch 9/80
 - 0s - loss: 1.1057 - val_loss: 0.6251
AUC: 0.8607

Epoch 10/80
 - 0s - loss: 1.0841 - val_loss: 0.6056
AUC: 0.8611

Epoch 11/80
 - 0s - loss: 1.0770 - val_loss: 0.6368
AUC: 0.8612

Epoch 12/80
 - 0s - loss: 1.0754 - val_loss: 0.7030
AUC: 0.8644

Epoch 13/80
 - 0s - loss: 1.0696 - val_loss: 0.6578
AUC: 0.8654

Epoch 14/80
 - 0s - loss: 1.0521 - val_loss: 0.5868
AUC: 0.8653

Epoch 15/80
 - 0s - loss: 1.0572 - val_loss: 0.6632
AUC: 0.8664

Epoch 16/80
 - 0s - loss: 1.0511 - val_loss: 0.5904
AUC: 0.8655

Epoch 17/80
 - 0s - loss: 1.0489 - val_loss: 0.6501
AUC: 0.8681

Epoch 18/80
 - 0s - loss: 1.0487 - val_loss: 0.6662
AUC: 0.8694

Epoch 19/80
 - 0s - loss: 1.0451 - val_loss: 0.5818
AUC: 0.8691

Epoch 20/80
 - 0s - loss: 1.0432 - val_loss: 0.6391
AUC: 0.8702

Epoch 21/80
 - 0s - loss: 1.0409 - val_loss: 0.5849
AUC: 0.8695

Epoch 22/80
 - 0s - loss: 1.0323 - val_loss: 0.6305
AUC: 0.8707

Epoch 23/80
 - 0s - loss: 1.0331 - val_loss: 0.5932
AUC: 0.8708

Epoch 24/80
 - 0s - loss: 1.0267 - val_loss: 0.6121
AUC: 0.8712

Epoch 25/80
 - 0s - loss: 1.0265 - val_loss: 0.6557
AUC: 0.8710

Epoch 26/80
 - 0s - loss: 1.0243 - val_loss: 0.5954
AUC: 0.8719

Epoch 27/80
 - 0s - loss: 1.0166 - val_loss: 0.6179
AUC: 0.8716

Epoch 28/80
 - 0s - loss: 1.0178 - val_loss: 0.5842
AUC: 0.8723

Epoch 29/80
 - 0s - loss: 1.0203 - val_loss: 0.6521
AUC: 0.8729

Epoch 30/80
 - 0s - loss: 1.0100 - val_loss: 0.6223
AUC: 0.8732

Epoch 31/80
 - 0s - loss: 1.0089 - val_loss: 0.6235
AUC: 0.8733

Epoch 32/80
 - 0s - loss: 1.0024 - val_loss: 0.6101
AUC: 0.8732

Epoch 33/80
 - 0s - loss: 1.0098 - val_loss: 0.6003
AUC: 0.8731

Epoch 34/80
 - 0s - loss: 1.0028 - val_loss: 0.6245
AUC: 0.8736

Epoch 35/80
 - 0s - loss: 1.0021 - val_loss: 0.6317
AUC: 0.8735

Epoch 36/80
 - 0s - loss: 1.0021 - val_loss: 0.6100
AUC: 0.8737

Epoch 37/80
 - 0s - loss: 0.9997 - val_loss: 0.6262
AUC: 0.8735

Epoch 38/80
 - 0s - loss: 1.0050 - val_loss: 0.6031
AUC: 0.8737

Epoch 39/80
 - 0s - loss: 1.0019 - val_loss: 0.6200
AUC: 0.8738

Epoch 40/80
 - 0s - loss: 0.9914 - val_loss: 0.6006
AUC: 0.8736

Epoch 41/80
 - 0s - loss: 0.9989 - val_loss: 0.6126
AUC: 0.8737

Epoch 42/80
 - 0s - loss: 0.9977 - val_loss: 0.6175
AUC: 0.8738

Epoch 43/80
 - 0s - loss: 0.9985 - val_loss: 0.6064
AUC: 0.8738

Epoch 44/80
 - 0s - loss: 0.9973 - val_loss: 0.6106
AUC: 0.8738

Epoch 45/80
 - 0s - loss: 0.9985 - val_loss: 0.6077
AUC: 0.8738

Epoch 46/80
 - 0s - loss: 0.9983 - val_loss: 0.6096
AUC: 0.8737

Epoch 47/80
 - 0s - loss: 0.9948 - val_loss: 0.6119
AUC: 0.8738

Epoch 48/80
 - 0s - loss: 0.9983 - val_loss: 0.6122
AUC: 0.8739

Epoch 49/80
 - 0s - loss: 0.9974 - val_loss: 0.6075
AUC: 0.8738

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0006 - val_loss: 0.6177
AUC: 0.8740

Epoch 2/30
 - 0s - loss: 0.9958 - val_loss: 0.6176
AUC: 0.8741

Epoch 3/30
 - 0s - loss: 0.9948 - val_loss: 0.5938
AUC: 0.8740

Epoch 4/30
 - 0s - loss: 0.9904 - val_loss: 0.6079
AUC: 0.8742

Epoch 5/30
 - 0s - loss: 0.9951 - val_loss: 0.6035
AUC: 0.8742

Epoch 6/30
 - 0s - loss: 0.9932 - val_loss: 0.6070
AUC: 0.8743

Epoch 7/30
 - 0s - loss: 0.9904 - val_loss: 0.5866
AUC: 0.8741

Epoch 8/30
 - 0s - loss: 0.9910 - val_loss: 0.6165
AUC: 0.8745

Epoch 9/30
 - 0s - loss: 0.9853 - val_loss: 0.6066
AUC: 0.8746

Epoch 10/30
 - 0s - loss: 0.9863 - val_loss: 0.6214
AUC: 0.8747

Epoch 11/30
 - 0s - loss: 0.9860 - val_loss: 0.5864
AUC: 0.8744

Epoch 12/30
 - 0s - loss: 0.9888 - val_loss: 0.6055
AUC: 0.8746

Epoch 13/30
 - 0s - loss: 0.9862 - val_loss: 0.6161
AUC: 0.8748

Epoch 14/30
 - 0s - loss: 0.9894 - val_loss: 0.5957
AUC: 0.8748

Epoch 15/30
 - 0s - loss: 0.9839 - val_loss: 0.5980
AUC: 0.8746

Epoch 16/30
 - 0s - loss: 0.9789 - val_loss: 0.5888
AUC: 0.8747

Epoch 17/30
 - 0s - loss: 0.9843 - val_loss: 0.5971
AUC: 0.8751

Epoch 18/30
 - 0s - loss: 0.9845 - val_loss: 0.6048
AUC: 0.8753

Epoch 19/30
 - 0s - loss: 0.9802 - val_loss: 0.5756
AUC: 0.8749

Epoch 20/30
 - 0s - loss: 0.9839 - val_loss: 0.5951
AUC: 0.8752

Epoch 21/30
 - 0s - loss: 0.9777 - val_loss: 0.5817
AUC: 0.8752

Epoch 22/30
 - 0s - loss: 0.9780 - val_loss: 0.6023
AUC: 0.8752

Epoch 23/30
 - 0s - loss: 0.9769 - val_loss: 0.5982
AUC: 0.8754

Epoch 24/30
 - 0s - loss: 0.9700 - val_loss: 0.6140
AUC: 0.8756

Epoch 25/30
 - 0s - loss: 0.9740 - val_loss: 0.5922
AUC: 0.8755

Epoch 26/30
 - 0s - loss: 0.9683 - val_loss: 0.5950
AUC: 0.8754

Epoch 27/30
 - 0s - loss: 0.9695 - val_loss: 0.5979
AUC: 0.8755

Epoch 28/30
 - 0s - loss: 0.9715 - val_loss: 0.6220
AUC: 0.8757

Epoch 29/30
 - 0s - loss: 0.9789 - val_loss: 0.6089
AUC: 0.8756

Epoch 30/30
 - 0s - loss: 0.9665 - val_loss: 0.5943
Using TensorFlow backend.
AUC: 0.8756

2019-03-08 02:58:12.031634: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 02:58:12.202783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 02:58:12.202830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 02:58:12.509156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 02:58:12.509210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 02:58:12.509220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 02:58:12.509486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1552
Epoch 2/80
 - 2s - loss: 0.2177
Epoch 3/80
 - 2s - loss: 0.1741
Epoch 4/80
 - 2s - loss: 0.1674
Epoch 5/80
 - 2s - loss: 0.1620
Epoch 6/80
 - 2s - loss: 0.1542
Epoch 7/80
 - 2s - loss: 0.1433
Epoch 8/80
 - 2s - loss: 0.1312
Epoch 9/80
 - 2s - loss: 0.1203
Epoch 10/80
 - 2s - loss: 0.1109
Epoch 11/80
 - 2s - loss: 0.1029
Epoch 12/80
 - 2s - loss: 0.0957
Epoch 13/80
 - 2s - loss: 0.0893
Epoch 14/80
 - 2s - loss: 0.0838
Epoch 15/80
 - 2s - loss: 0.0790
Epoch 16/80
 - 2s - loss: 0.0751
Epoch 17/80
 - 2s - loss: 0.0717
Epoch 18/80
 - 2s - loss: 0.0688
Epoch 19/80
 - 2s - loss: 0.0663
Epoch 20/80
 - 2s - loss: 0.0643
Epoch 21/80
 - 2s - loss: 0.0625
Epoch 22/80
 - 2s - loss: 0.0610
Epoch 23/80
 - 2s - loss: 0.0598
Epoch 24/80
 - 2s - loss: 0.0587
Epoch 25/80
 - 2s - loss: 0.0577
Epoch 26/80
 - 2s - loss: 0.0568
Epoch 27/80
 - 2s - loss: 0.0561
Epoch 28/80
 - 2s - loss: 0.0554
Epoch 29/80
 - 2s - loss: 0.0549
Epoch 30/80
 - 2s - loss: 0.0544
Epoch 31/80
 - 2s - loss: 0.0539
Epoch 32/80
 - 2s - loss: 0.0536
Epoch 33/80
 - 2s - loss: 0.0532
Epoch 34/80
 - 2s - loss: 0.0529
Epoch 35/80
 - 2s - loss: 0.0527
Epoch 36/80
 - 2s - loss: 0.0524
Epoch 37/80
 - 2s - loss: 0.0522
Epoch 38/80
 - 2s - loss: 0.0520
Epoch 39/80
 - 2s - loss: 0.0519
Epoch 40/80
 - 2s - loss: 0.0517
Epoch 41/80
 - 2s - loss: 0.0516
Epoch 42/80
 - 2s - loss: 0.0515
Epoch 43/80
 - 2s - loss: 0.0514
Epoch 44/80
 - 2s - loss: 0.0512
Epoch 45/80
 - 2s - loss: 0.0512
Epoch 46/80
 - 2s - loss: 0.0511
Epoch 47/80
 - 2s - loss: 0.0510
Epoch 48/80
 - 2s - loss: 0.0509
Epoch 49/80
 - 2s - loss: 0.0508
Epoch 50/80
 - 2s - loss: 0.0508
Epoch 51/80
 - 2s - loss: 0.0507
Epoch 52/80
 - 2s - loss: 0.0507
Epoch 53/80
 - 2s - loss: 0.0506
Epoch 54/80
 - 2s - loss: 0.0506
Epoch 55/80
 - 2s - loss: 0.0505
Epoch 56/80
 - 2s - loss: 0.0505
Epoch 57/80
 - 2s - loss: 0.0504
Epoch 58/80
 - 2s - loss: 0.0504
Epoch 59/80
 - 2s - loss: 0.0503
Epoch 60/80
 - 2s - loss: 0.0503
Epoch 61/80
 - 2s - loss: 0.0503
Epoch 62/80
 - 2s - loss: 0.0503
Epoch 63/80
 - 2s - loss: 0.0502
Epoch 64/80
 - 2s - loss: 0.0491
Epoch 65/80
 - 2s - loss: 0.0490
Epoch 66/80
 - 2s - loss: 0.0490
Epoch 67/80
 - 2s - loss: 0.0490
Epoch 68/80
 - 2s - loss: 0.0490
Epoch 69/80
 - 2s - loss: 0.0487
Epoch 70/80
 - 2s - loss: 0.0487
Epoch 71/80
 - 2s - loss: 0.0487
Epoch 72/80
 - 2s - loss: 0.0487
Epoch 73/80
 - 2s - loss: 0.0486
Epoch 74/80
 - 2s - loss: 0.0486
Epoch 75/80
 - 2s - loss: 0.0486
Epoch 76/80
 - 2s - loss: 0.0486
Epoch 77/80
 - 2s - loss: 0.0486
Epoch 78/80
 - 2s - loss: 0.0486
Epoch 79/80
 - 2s - loss: 0.0486
Epoch 80/80
 - 2s - loss: 0.0486
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.1326 - val_loss: 0.9000
AUC: 0.8024

Epoch 2/80
 - 0s - loss: 1.5255 - val_loss: 0.7873
AUC: 0.8248

Epoch 3/80
 - 0s - loss: 1.2729 - val_loss: 0.6833
AUC: 0.8365

Epoch 4/80
 - 0s - loss: 1.1827 - val_loss: 0.6423
AUC: 0.8444

Epoch 5/80
 - 0s - loss: 1.1485 - val_loss: 0.7084
AUC: 0.8510

Epoch 6/80
 - 0s - loss: 1.1196 - val_loss: 0.6752
AUC: 0.8539

Epoch 7/80
 - 0s - loss: 1.0989 - val_loss: 0.6461
AUC: 0.8554

Epoch 8/80
 - 0s - loss: 1.0831 - val_loss: 0.5841
AUC: 0.8546

Epoch 9/80
 - 0s - loss: 1.0771 - val_loss: 0.6496
AUC: 0.8580

Epoch 10/80
 - 0s - loss: 1.0673 - val_loss: 0.5901
AUC: 0.8583

Epoch 11/80
 - 0s - loss: 1.0666 - val_loss: 0.5769
AUC: 0.8583

Epoch 12/80
 - 0s - loss: 1.0504 - val_loss: 0.6122
AUC: 0.8604

Epoch 13/80
 - 0s - loss: 1.0437 - val_loss: 0.6233
AUC: 0.8624

Epoch 14/80
 - 0s - loss: 1.0418 - val_loss: 0.6471
AUC: 0.8621

Epoch 15/80
 - 0s - loss: 1.0339 - val_loss: 0.6325
AUC: 0.8629

Epoch 16/80
 - 0s - loss: 1.0320 - val_loss: 0.6689
AUC: 0.8641

Epoch 17/80
 - 0s - loss: 1.0320 - val_loss: 0.6050
AUC: 0.8621

Epoch 18/80
 - 0s - loss: 1.0260 - val_loss: 0.6003
AUC: 0.8636

Epoch 19/80
 - 0s - loss: 1.0200 - val_loss: 0.6664
AUC: 0.8643

Epoch 20/80
 - 0s - loss: 1.0221 - val_loss: 0.6156
AUC: 0.8652

Epoch 21/80
 - 0s - loss: 1.0119 - val_loss: 0.5799
AUC: 0.8642

Epoch 22/80
 - 0s - loss: 1.0079 - val_loss: 0.6150
AUC: 0.8650

Epoch 23/80
 - 0s - loss: 1.0063 - val_loss: 0.6038
AUC: 0.8648

Epoch 24/80
 - 0s - loss: 1.0022 - val_loss: 0.6082
AUC: 0.8650

Epoch 25/80
 - 0s - loss: 1.0061 - val_loss: 0.6385
AUC: 0.8654

Epoch 26/80
 - 0s - loss: 0.9984 - val_loss: 0.5986
AUC: 0.8650

Epoch 27/80
 - 0s - loss: 1.0039 - val_loss: 0.6344
AUC: 0.8654

Epoch 28/80
 - 0s - loss: 1.0025 - val_loss: 0.6014
AUC: 0.8650

Epoch 29/80
 - 0s - loss: 0.9978 - val_loss: 0.6117
AUC: 0.8653

Epoch 30/80
 - 0s - loss: 1.0022 - val_loss: 0.5865
AUC: 0.8648

Epoch 31/80
 - 0s - loss: 1.0003 - val_loss: 0.5965
AUC: 0.8649

Epoch 32/80
 - 0s - loss: 0.9966 - val_loss: 0.6097
AUC: 0.8652

Epoch 33/80
 - 0s - loss: 0.9978 - val_loss: 0.6017
AUC: 0.8651

Epoch 34/80
 - 0s - loss: 0.9959 - val_loss: 0.6109
AUC: 0.8653

Epoch 35/80
 - 0s - loss: 0.9951 - val_loss: 0.6134
AUC: 0.8653

Epoch 36/80
 - 0s - loss: 0.9946 - val_loss: 0.5972
AUC: 0.8649

Epoch 37/80
 - 0s - loss: 0.9928 - val_loss: 0.6085
AUC: 0.8651

Epoch 38/80
 - 0s - loss: 0.9940 - val_loss: 0.5977
AUC: 0.8650

Epoch 39/80
 - 0s - loss: 0.9937 - val_loss: 0.6059
AUC: 0.8651

Epoch 40/80
 - 0s - loss: 0.9918 - val_loss: 0.6051
AUC: 0.8653

Epoch 41/80
 - 0s - loss: 0.9975 - val_loss: 0.6093
AUC: 0.8653

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0044 - val_loss: 0.6080
AUC: 0.8653

Epoch 2/30
 - 0s - loss: 1.0049 - val_loss: 0.6118
AUC: 0.8655

Epoch 3/30
 - 0s - loss: 1.0019 - val_loss: 0.5970
AUC: 0.8654

Epoch 4/30
 - 0s - loss: 0.9951 - val_loss: 0.5995
AUC: 0.8655

Epoch 5/30
 - 0s - loss: 0.9945 - val_loss: 0.6008
AUC: 0.8656

Epoch 6/30
 - 0s - loss: 0.9962 - val_loss: 0.6057
AUC: 0.8658

Epoch 7/30
 - 0s - loss: 0.9958 - val_loss: 0.5887
AUC: 0.8656

Epoch 8/30
 - 0s - loss: 0.9891 - val_loss: 0.5964
AUC: 0.8659

Epoch 9/30
 - 0s - loss: 0.9860 - val_loss: 0.6035
AUC: 0.8661

Epoch 10/30
 - 0s - loss: 0.9936 - val_loss: 0.5902
AUC: 0.8658

Epoch 11/30
 - 0s - loss: 0.9905 - val_loss: 0.6032
AUC: 0.8662

Epoch 12/30
 - 0s - loss: 0.9905 - val_loss: 0.6088
AUC: 0.8665

Epoch 13/30
 - 0s - loss: 0.9869 - val_loss: 0.5953
AUC: 0.8663

Epoch 14/30
 - 0s - loss: 0.9842 - val_loss: 0.6027
AUC: 0.8665

Epoch 15/30
 - 0s - loss: 0.9853 - val_loss: 0.5896
AUC: 0.8663

Epoch 16/30
 - 0s - loss: 0.9844 - val_loss: 0.6152
AUC: 0.8670

Epoch 17/30
 - 0s - loss: 0.9827 - val_loss: 0.6169
AUC: 0.8671

Epoch 18/30
 - 0s - loss: 0.9825 - val_loss: 0.5979
AUC: 0.8668

Epoch 19/30
 - 0s - loss: 0.9811 - val_loss: 0.5982
AUC: 0.8669

Epoch 20/30
 - 0s - loss: 0.9784 - val_loss: 0.5976
AUC: 0.8668

Epoch 21/30
 - 0s - loss: 0.9791 - val_loss: 0.5943
AUC: 0.8668

Epoch 22/30
 - 0s - loss: 0.9757 - val_loss: 0.5952
AUC: 0.8669

Epoch 23/30
 - 0s - loss: 0.9819 - val_loss: 0.5988
AUC: 0.8670

Epoch 24/30
 - 0s - loss: 0.9783 - val_loss: 0.5919
AUC: 0.8668

Epoch 25/30
 - 0s - loss: 0.9778 - val_loss: 0.5961
AUC: 0.8670

Epoch 26/30
 - 0s - loss: 0.9793 - val_loss: 0.5922
AUC: 0.8669

Epoch 27/30
 - 0s - loss: 0.9814 - val_loss: 0.6008
AUC: 0.8671

Epoch 28/30
 - 0s - loss: 0.9823 - val_loss: 0.5995
AUC: 0.8671

Epoch 29/30
 - 0s - loss: 0.9734 - val_loss: 0.5983
AUC: 0.8671

Epoch 30/30
 - 0s - loss: 0.9775 - val_loss: 0.5964
Using TensorFlow backend.
AUC: 0.8670

2019-03-08 03:02:05.439107: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:02:05.608943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:02:05.608994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:02:05.912167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:02:05.912219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:02:05.912239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:02:05.912506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1508
Epoch 2/80
 - 2s - loss: 0.2175
Epoch 3/80
 - 2s - loss: 0.1698
Epoch 4/80
 - 2s - loss: 0.1563
Epoch 5/80
 - 2s - loss: 0.1449
Epoch 6/80
 - 2s - loss: 0.1361
Epoch 7/80
 - 2s - loss: 0.1292
Epoch 8/80
 - 2s - loss: 0.1226
Epoch 9/80
 - 2s - loss: 0.1158
Epoch 10/80
 - 2s - loss: 0.1090
Epoch 11/80
 - 2s - loss: 0.1020
Epoch 12/80
 - 2s - loss: 0.0953
Epoch 13/80
 - 2s - loss: 0.0893
Epoch 14/80
 - 2s - loss: 0.0840
Epoch 15/80
 - 2s - loss: 0.0793
Epoch 16/80
 - 2s - loss: 0.0751
Epoch 17/80
 - 2s - loss: 0.0715
Epoch 18/80
 - 2s - loss: 0.0685
Epoch 19/80
 - 2s - loss: 0.0658
Epoch 20/80
 - 2s - loss: 0.0636
Epoch 21/80
 - 2s - loss: 0.0617
Epoch 22/80
 - 2s - loss: 0.0602
Epoch 23/80
 - 2s - loss: 0.0589
Epoch 24/80
 - 2s - loss: 0.0578
Epoch 25/80
 - 2s - loss: 0.0568
Epoch 26/80
 - 2s - loss: 0.0560
Epoch 27/80
 - 2s - loss: 0.0553
Epoch 28/80
 - 2s - loss: 0.0547
Epoch 29/80
 - 2s - loss: 0.0542
Epoch 30/80
 - 2s - loss: 0.0538
Epoch 31/80
 - 2s - loss: 0.0534
Epoch 32/80
 - 2s - loss: 0.0531
Epoch 33/80
 - 2s - loss: 0.0528
Epoch 34/80
 - 2s - loss: 0.0525
Epoch 35/80
 - 2s - loss: 0.0523
Epoch 36/80
 - 2s - loss: 0.0521
Epoch 37/80
 - 2s - loss: 0.0519
Epoch 38/80
 - 2s - loss: 0.0518
Epoch 39/80
 - 2s - loss: 0.0516
Epoch 40/80
 - 2s - loss: 0.0515
Epoch 41/80
 - 2s - loss: 0.0514
Epoch 42/80
 - 2s - loss: 0.0513
Epoch 43/80
 - 2s - loss: 0.0512
Epoch 44/80
 - 2s - loss: 0.0511
Epoch 45/80
 - 2s - loss: 0.0510
Epoch 46/80
 - 2s - loss: 0.0509
Epoch 47/80
 - 2s - loss: 0.0508
Epoch 48/80
 - 2s - loss: 0.0508
Epoch 49/80
 - 2s - loss: 0.0507
Epoch 50/80
 - 2s - loss: 0.0506
Epoch 51/80
 - 2s - loss: 0.0506
Epoch 52/80
 - 2s - loss: 0.0505
Epoch 53/80
 - 2s - loss: 0.0505
Epoch 54/80
 - 2s - loss: 0.0504
Epoch 55/80
 - 2s - loss: 0.0504
Epoch 56/80
 - 2s - loss: 0.0503
Epoch 57/80
 - 2s - loss: 0.0503
Epoch 58/80
 - 2s - loss: 0.0503
Epoch 59/80
 - 2s - loss: 0.0503
Epoch 60/80
 - 2s - loss: 0.0502
Epoch 61/80
 - 2s - loss: 0.0502
Epoch 62/80
 - 2s - loss: 0.0491
Epoch 63/80
 - 2s - loss: 0.0490
Epoch 64/80
 - 2s - loss: 0.0489
Epoch 65/80
 - 2s - loss: 0.0489
Epoch 66/80
 - 2s - loss: 0.0489
Epoch 67/80
 - 2s - loss: 0.0486
Epoch 68/80
 - 2s - loss: 0.0486
Epoch 69/80
 - 2s - loss: 0.0486
Epoch 70/80
 - 2s - loss: 0.0486
Epoch 71/80
 - 2s - loss: 0.0486
Epoch 72/80
 - 2s - loss: 0.0486
Epoch 73/80
 - 2s - loss: 0.0486
Epoch 74/80
 - 2s - loss: 0.0485
Epoch 75/80
 - 2s - loss: 0.0485
Epoch 76/80
 - 2s - loss: 0.0485
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:04:57.982959: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:04:58.149319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:04:58.149364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:04:58.457245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:04:58.457303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:04:58.457313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:04:58.457579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1448
Epoch 2/80
 - 2s - loss: 0.2156
Epoch 3/80
 - 2s - loss: 0.1730
Epoch 4/80
 - 2s - loss: 0.1654
Epoch 5/80
 - 2s - loss: 0.1591
Epoch 6/80
 - 2s - loss: 0.1517
Epoch 7/80
 - 2s - loss: 0.1428
Epoch 8/80
 - 2s - loss: 0.1329
Epoch 9/80
 - 2s - loss: 0.1227
Epoch 10/80
 - 2s - loss: 0.1132
Epoch 11/80
 - 2s - loss: 0.1044
Epoch 12/80
 - 2s - loss: 0.0967
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:05:40.561495: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:05:40.732001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:05:40.732049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:05:41.034918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:05:41.034977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:05:41.034986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:05:41.035269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6731
Epoch 2/80
 - 2s - loss: 0.1241
Epoch 3/80
 - 2s - loss: 0.0726
Epoch 4/80
 - 2s - loss: 0.0668
Epoch 5/80
 - 2s - loss: 0.0647
Epoch 6/80
 - 2s - loss: 0.0632
Epoch 7/80
 - 2s - loss: 0.0614
Epoch 8/80
 - 2s - loss: 0.0594
Epoch 9/80
 - 2s - loss: 0.0570
Epoch 10/80
 - 2s - loss: 0.0543
Epoch 11/80
 - 2s - loss: 0.0511
Epoch 12/80
 - 2s - loss: 0.0472
Epoch 13/80
 - 2s - loss: 0.0430
Epoch 14/80
 - 2s - loss: 0.0389
Epoch 15/80
 - 2s - loss: 0.0353
Epoch 16/80
 - 2s - loss: 0.0322
Epoch 17/80
 - 2s - loss: 0.0298
Epoch 18/80
 - 2s - loss: 0.0277
Epoch 19/80
 - 2s - loss: 0.0261
Epoch 20/80
 - 2s - loss: 0.0248
Epoch 21/80
 - 2s - loss: 0.0237
Epoch 22/80
 - 2s - loss: 0.0228
Epoch 23/80
 - 2s - loss: 0.0220
Epoch 24/80
 - 2s - loss: 0.0214
Epoch 25/80
 - 2s - loss: 0.0208
Epoch 26/80
 - 2s - loss: 0.0203
Epoch 27/80
 - 2s - loss: 0.0199
Epoch 28/80
 - 2s - loss: 0.0195
Epoch 29/80
 - 2s - loss: 0.0192
Epoch 30/80
 - 2s - loss: 0.0189
Epoch 31/80
 - 2s - loss: 0.0186
Epoch 32/80
 - 2s - loss: 0.0184
Epoch 33/80
 - 2s - loss: 0.0182
Epoch 34/80
 - 2s - loss: 0.0180
Epoch 35/80
 - 2s - loss: 0.0179
Epoch 36/80
 - 2s - loss: 0.0177
Epoch 37/80
 - 2s - loss: 0.0176
Epoch 38/80
 - 2s - loss: 0.0175
Epoch 39/80
 - 2s - loss: 0.0174
Epoch 40/80
 - 2s - loss: 0.0173
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:07:20.047554: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:07:20.229212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:07:20.229260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:07:20.535108: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:07:20.535161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:07:20.535170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:07:20.535439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6924
Epoch 2/80
 - 2s - loss: 0.1314
Epoch 3/80
 - 2s - loss: 0.0728
Epoch 4/80
 - 2s - loss: 0.0662
Epoch 5/80
 - 2s - loss: 0.0636
Epoch 6/80
 - 2s - loss: 0.0617
Epoch 7/80
 - 2s - loss: 0.0596
Epoch 8/80
 - 2s - loss: 0.0570
Epoch 9/80
 - 2s - loss: 0.0537
Epoch 10/80
 - 2s - loss: 0.0499
Epoch 11/80
 - 2s - loss: 0.0458
Epoch 12/80
 - 2s - loss: 0.0420
Epoch 13/80
 - 2s - loss: 0.0388
Epoch 14/80
 - 2s - loss: 0.0359
Epoch 15/80
 - 2s - loss: 0.0332
Epoch 16/80
 - 2s - loss: 0.0309
Epoch 17/80
 - 2s - loss: 0.0289
Epoch 18/80
 - 2s - loss: 0.0272
Epoch 19/80
 - 2s - loss: 0.0257
Epoch 20/80
 - 2s - loss: 0.0244
Epoch 21/80
 - 2s - loss: 0.0233
Epoch 22/80
 - 2s - loss: 0.0223
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:08:26.752730: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:08:26.921301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:08:26.921346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:08:27.224733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:08:27.224793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:08:27.224802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:08:27.225069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6766
Epoch 2/80
 - 2s - loss: 0.1257
Epoch 3/80
 - 2s - loss: 0.0725
Epoch 4/80
 - 2s - loss: 0.0665
Epoch 5/80
 - 2s - loss: 0.0642
Epoch 6/80
 - 2s - loss: 0.0625
Epoch 7/80
 - 2s - loss: 0.0604
Epoch 8/80
 - 2s - loss: 0.0580
Epoch 9/80
 - 2s - loss: 0.0550
Epoch 10/80
 - 2s - loss: 0.0516
Epoch 11/80
 - 2s - loss: 0.0478
Epoch 12/80
 - 2s - loss: 0.0439
Epoch 13/80
 - 2s - loss: 0.0404
Epoch 14/80
 - 2s - loss: 0.0371
Epoch 15/80
 - 2s - loss: 0.0342
Epoch 16/80
 - 2s - loss: 0.0316
Epoch 17/80
 - 2s - loss: 0.0294
Epoch 18/80
 - 2s - loss: 0.0275
Epoch 19/80
 - 2s - loss: 0.0259
Epoch 20/80
 - 2s - loss: 0.0246
Epoch 21/80
 - 2s - loss: 0.0234
Epoch 22/80
 - 2s - loss: 0.0225
Epoch 23/80
 - 2s - loss: 0.0217
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:09:35.002318: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:09:35.170336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:09:35.170381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:09:35.473167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:09:35.473222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:09:35.473231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:09:35.473498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3566
Epoch 2/80
 - 2s - loss: 0.3509
Epoch 3/80
 - 2s - loss: 0.3024
Epoch 4/80
 - 2s - loss: 0.2829
Epoch 5/80
 - 2s - loss: 0.2639
Epoch 6/80
 - 2s - loss: 0.2460
Epoch 7/80
 - 2s - loss: 0.2296
Epoch 8/80
 - 2s - loss: 0.2159
Epoch 9/80
 - 2s - loss: 0.2042
Epoch 10/80
 - 2s - loss: 0.1930
Epoch 11/80
 - 2s - loss: 0.1818
Epoch 12/80
 - 2s - loss: 0.1713
Epoch 13/80
 - 2s - loss: 0.1623
Epoch 14/80
 - 2s - loss: 0.1547
Epoch 15/80
 - 2s - loss: 0.1485
Epoch 16/80
 - 2s - loss: 0.1433
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:10:25.158268: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:10:25.327120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:10:25.327166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:10:25.628610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:10:25.628664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:10:25.628674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:10:25.628947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3702
Epoch 2/80
 - 2s - loss: 0.3530
Epoch 3/80
 - 2s - loss: 0.3103
Epoch 4/80
 - 2s - loss: 0.2962
Epoch 5/80
 - 2s - loss: 0.2768
Epoch 6/80
 - 2s - loss: 0.2564
Epoch 7/80
 - 2s - loss: 0.2392
Epoch 8/80
 - 2s - loss: 0.2242
Epoch 9/80
 - 2s - loss: 0.2101
Epoch 10/80
 - 2s - loss: 0.1966
Epoch 11/80
 - 2s - loss: 0.1846
Epoch 12/80
 - 2s - loss: 0.1743
Epoch 13/80
 - 2s - loss: 0.1656
Epoch 14/80
 - 2s - loss: 0.1581
Epoch 15/80
 - 2s - loss: 0.1517
Epoch 16/80
 - 2s - loss: 0.1462
Epoch 17/80
 - 2s - loss: 0.1415
Epoch 18/80
 - 2s - loss: 0.1376
Epoch 19/80
 - 2s - loss: 0.1344
Epoch 20/80
 - 2s - loss: 0.1317
Epoch 21/80
 - 2s - loss: 0.1295
Epoch 22/80
 - 2s - loss: 0.1275
Epoch 23/80
 - 2s - loss: 0.1258
Epoch 24/80
 - 2s - loss: 0.1244
Epoch 25/80
 - 2s - loss: 0.1232
Epoch 26/80
 - 2s - loss: 0.1222
Epoch 27/80
 - 2s - loss: 0.1213
Epoch 28/80
 - 2s - loss: 0.1205
Epoch 29/80
 - 2s - loss: 0.1198
Epoch 30/80
 - 2s - loss: 0.1193
Epoch 31/80
 - 2s - loss: 0.1187
Epoch 32/80
 - 2s - loss: 0.1183
Epoch 33/80
 - 2s - loss: 0.1179
Epoch 34/80
 - 2s - loss: 0.1175
Epoch 35/80
 - 2s - loss: 0.1172
Epoch 36/80
 - 2s - loss: 0.1169
Epoch 37/80
 - 2s - loss: 0.1167
Epoch 38/80
 - 2s - loss: 0.1164
Epoch 39/80
 - 2s - loss: 0.1162
Epoch 40/80
 - 2s - loss: 0.1160
Epoch 41/80
 - 2s - loss: 0.1158
Epoch 42/80
 - 2s - loss: 0.1157
Epoch 43/80
 - 2s - loss: 0.1155
Epoch 44/80
 - 2s - loss: 0.1154
Epoch 45/80
 - 2s - loss: 0.1153
Epoch 46/80
 - 2s - loss: 0.1152
Epoch 47/80
 - 2s - loss: 0.1150
Epoch 48/80
 - 2s - loss: 0.1149
Epoch 49/80
 - 2s - loss: 0.1148
Epoch 50/80
 - 2s - loss: 0.1148
Epoch 51/80
 - 2s - loss: 0.1147
Epoch 52/80
 - 2s - loss: 0.1146
Epoch 53/80
 - 2s - loss: 0.1145
Epoch 54/80
 - 2s - loss: 0.1144
Epoch 55/80
 - 2s - loss: 0.1144
Epoch 56/80
 - 2s - loss: 0.1143
Epoch 57/80
 - 2s - loss: 0.1143
Epoch 58/80
 - 2s - loss: 0.1142
Epoch 59/80
 - 2s - loss: 0.1142
Epoch 60/80
 - 2s - loss: 0.1141
Epoch 61/80
 - 2s - loss: 0.1141
Epoch 62/80
 - 2s - loss: 0.1140
Epoch 63/80
 - 2s - loss: 0.1140
Epoch 64/80
 - 2s - loss: 0.1139
Epoch 65/80
 - 2s - loss: 0.1139
Epoch 66/80
 - 2s - loss: 0.1139
Epoch 67/80
 - 2s - loss: 0.1138
Epoch 68/80
 - 2s - loss: 0.1138
Epoch 69/80
 - 2s - loss: 0.1138
Epoch 70/80
 - 2s - loss: 0.1137
Epoch 71/80
 - 2s - loss: 0.1137
Epoch 72/80
 - 2s - loss: 0.1137
Epoch 73/80
 - 2s - loss: 0.1137
Epoch 74/80
 - 2s - loss: 0.1115
Epoch 75/80
 - 2s - loss: 0.1112
Epoch 76/80
 - 2s - loss: 0.1112
Epoch 77/80
 - 2s - loss: 0.1112
Epoch 78/80
 - 2s - loss: 0.1112
Epoch 79/80
 - 2s - loss: 0.1106
Epoch 80/80
 - 2s - loss: 0.1106
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.8948 - val_loss: 1.3639
AUC: 0.8020

Epoch 2/80
 - 0s - loss: 3.1004 - val_loss: 1.1334
AUC: 0.8175

Epoch 3/80
 - 0s - loss: 2.0869 - val_loss: 0.8753
AUC: 0.8287

Epoch 4/80
 - 0s - loss: 1.5479 - val_loss: 0.8067
AUC: 0.8362

Epoch 5/80
 - 0s - loss: 1.3199 - val_loss: 0.7017
AUC: 0.8375

Epoch 6/80
 - 0s - loss: 1.2079 - val_loss: 0.7026
AUC: 0.8433

Epoch 7/80
 - 0s - loss: 1.1637 - val_loss: 0.7205
AUC: 0.8478

Epoch 8/80
 - 0s - loss: 1.1382 - val_loss: 0.6664
AUC: 0.8501

Epoch 9/80
 - 0s - loss: 1.1065 - val_loss: 0.6735
AUC: 0.8520

Epoch 10/80
 - 0s - loss: 1.1040 - val_loss: 0.6783
AUC: 0.8542

Epoch 11/80
 - 0s - loss: 1.0927 - val_loss: 0.6594
AUC: 0.8550

Epoch 12/80
 - 0s - loss: 1.0747 - val_loss: 0.7166
AUC: 0.8583

Epoch 13/80
 - 0s - loss: 1.0682 - val_loss: 0.6263
AUC: 0.8580

Epoch 14/80
 - 0s - loss: 1.0695 - val_loss: 0.6371
AUC: 0.8590

Epoch 15/80
 - 0s - loss: 1.0567 - val_loss: 0.6287
AUC: 0.8603

Epoch 16/80
 - 0s - loss: 1.0532 - val_loss: 0.6873
AUC: 0.8603

Epoch 17/80
 - 0s - loss: 1.0491 - val_loss: 0.6523
AUC: 0.8609

Epoch 18/80
 - 0s - loss: 1.0427 - val_loss: 0.5866
AUC: 0.8605

Epoch 19/80
 - 0s - loss: 1.0382 - val_loss: 0.6818
AUC: 0.8624

Epoch 20/80
 - 0s - loss: 1.0348 - val_loss: 0.6590
AUC: 0.8632

Epoch 21/80
 - 0s - loss: 1.0250 - val_loss: 0.6122
AUC: 0.8628

Epoch 22/80
 - 0s - loss: 1.0233 - val_loss: 0.6117
AUC: 0.8637

Epoch 23/80
 - 0s - loss: 1.0246 - val_loss: 0.6365
AUC: 0.8648

Epoch 24/80
 - 0s - loss: 1.0208 - val_loss: 0.5933
AUC: 0.8650

Epoch 25/80
 - 0s - loss: 1.0238 - val_loss: 0.6695
AUC: 0.8666

Epoch 26/80
 - 0s - loss: 1.0171 - val_loss: 0.6940
AUC: 0.8676

Epoch 27/80
 - 0s - loss: 1.0145 - val_loss: 0.5825
AUC: 0.8653

Epoch 28/80
 - 0s - loss: 1.0169 - val_loss: 0.6608
AUC: 0.8654

Epoch 29/80
 - 0s - loss: 1.0135 - val_loss: 0.5938
AUC: 0.8657

Epoch 30/80
 - 0s - loss: 1.0078 - val_loss: 0.6345
AUC: 0.8657

Epoch 31/80
 - 0s - loss: 1.0014 - val_loss: 0.6179
AUC: 0.8654

Epoch 32/80
 - 0s - loss: 1.0047 - val_loss: 0.6159
AUC: 0.8667

Epoch 33/80
 - 0s - loss: 1.0007 - val_loss: 0.6067
AUC: 0.8659

Epoch 34/80
 - 0s - loss: 1.0010 - val_loss: 0.6418
AUC: 0.8673

Epoch 35/80
 - 0s - loss: 0.9962 - val_loss: 0.6299
AUC: 0.8684

Epoch 36/80
 - 0s - loss: 0.9916 - val_loss: 0.6414
AUC: 0.8685

Epoch 37/80
 - 0s - loss: 0.9944 - val_loss: 0.6296
AUC: 0.8671

Epoch 38/80
 - 0s - loss: 0.9860 - val_loss: 0.6004
AUC: 0.8678

Epoch 39/80
 - 0s - loss: 0.9861 - val_loss: 0.6145
AUC: 0.8679

Epoch 40/80
 - 0s - loss: 0.9890 - val_loss: 0.5884
AUC: 0.8676

Epoch 41/80
 - 0s - loss: 0.9836 - val_loss: 0.6062
AUC: 0.8680

Epoch 42/80
 - 0s - loss: 0.9830 - val_loss: 0.5998
AUC: 0.8679

Epoch 43/80
 - 0s - loss: 0.9858 - val_loss: 0.5974
AUC: 0.8677

Epoch 44/80
 - 0s - loss: 0.9847 - val_loss: 0.6290
AUC: 0.8683

Epoch 45/80
 - 0s - loss: 0.9883 - val_loss: 0.6189
AUC: 0.8682

Epoch 46/80
 - 0s - loss: 0.9837 - val_loss: 0.5953
AUC: 0.8678

Epoch 47/80
 - 0s - loss: 0.9828 - val_loss: 0.6056
AUC: 0.8681

Epoch 48/80
 - 0s - loss: 0.9836 - val_loss: 0.6029
AUC: 0.8681

Epoch 49/80
 - 0s - loss: 0.9822 - val_loss: 0.6090
AUC: 0.8682

Epoch 50/80
 - 0s - loss: 0.9757 - val_loss: 0.6092
AUC: 0.8682

Epoch 51/80
 - 0s - loss: 0.9789 - val_loss: 0.6076
AUC: 0.8682

Epoch 52/80
 - 0s - loss: 0.9843 - val_loss: 0.6081
AUC: 0.8683

Epoch 53/80
 - 0s - loss: 0.9826 - val_loss: 0.6059
AUC: 0.8683

Epoch 54/80
 - 0s - loss: 0.9839 - val_loss: 0.6096
AUC: 0.8684

Epoch 55/80
 - 0s - loss: 0.9836 - val_loss: 0.6038
AUC: 0.8684

Epoch 56/80
 - 0s - loss: 0.9823 - val_loss: 0.6103
AUC: 0.8684

Epoch 57/80
 - 0s - loss: 0.9808 - val_loss: 0.5986
AUC: 0.8683

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9912 - val_loss: 0.6253
AUC: 0.8687

Epoch 2/30
 - 0s - loss: 0.9842 - val_loss: 0.6062
AUC: 0.8684

Epoch 3/30
 - 0s - loss: 0.9845 - val_loss: 0.5864
AUC: 0.8682

Epoch 4/30
 - 0s - loss: 0.9855 - val_loss: 0.6144
AUC: 0.8685

Epoch 5/30
 - 0s - loss: 0.9862 - val_loss: 0.6087
AUC: 0.8686

Epoch 6/30
 - 0s - loss: 0.9809 - val_loss: 0.6045
AUC: 0.8685

Epoch 7/30
 - 0s - loss: 0.9784 - val_loss: 0.6087
AUC: 0.8687

Epoch 8/30
 - 0s - loss: 0.9797 - val_loss: 0.6015
AUC: 0.8687

Epoch 9/30
 - 0s - loss: 0.9803 - val_loss: 0.6080
AUC: 0.8689

Epoch 10/30
 - 0s - loss: 0.9724 - val_loss: 0.6102
AUC: 0.8690

Epoch 11/30
 - 0s - loss: 0.9721 - val_loss: 0.6085
AUC: 0.8691

Epoch 12/30
 - 0s - loss: 0.9756 - val_loss: 0.5881
AUC: 0.8688

Epoch 13/30
 - 0s - loss: 0.9738 - val_loss: 0.6123
AUC: 0.8694

Epoch 14/30
 - 0s - loss: 0.9759 - val_loss: 0.6033
AUC: 0.8693

Epoch 15/30
 - 0s - loss: 0.9697 - val_loss: 0.6004
AUC: 0.8692

Epoch 16/30
 - 0s - loss: 0.9685 - val_loss: 0.6036
AUC: 0.8693

Epoch 17/30
 - 0s - loss: 0.9686 - val_loss: 0.6025
AUC: 0.8693

Epoch 18/30
 - 0s - loss: 0.9665 - val_loss: 0.6001
AUC: 0.8693

Epoch 19/30
 - 0s - loss: 0.9665 - val_loss: 0.6000
AUC: 0.8693

Epoch 20/30
 - 0s - loss: 0.9635 - val_loss: 0.6021
AUC: 0.8693

Epoch 21/30
 - 0s - loss: 0.9700 - val_loss: 0.6060
AUC: 0.8694

Epoch 22/30
 - 0s - loss: 0.9722 - val_loss: 0.5984
AUC: 0.8694

Epoch 23/30
 - 0s - loss: 0.9668 - val_loss: 0.6037
AUC: 0.8694

Epoch 24/30
 - 0s - loss: 0.9698 - val_loss: 0.6023
AUC: 0.8694

Epoch 25/30
 - 0s - loss: 0.9637 - val_loss: 0.6021
AUC: 0.8694

Epoch 26/30
 - 0s - loss: 0.9651 - val_loss: 0.6014
AUC: 0.8694

Epoch 27/30
 - 0s - loss: 0.9658 - val_loss: 0.6007
AUC: 0.8694

Epoch 28/30
 - 0s - loss: 0.9713 - val_loss: 0.6017
AUC: 0.8694

Epoch 29/30
 - 0s - loss: 0.9723 - val_loss: 0.6020
AUC: 0.8694

Epoch 30/30
 - 0s - loss: 0.9672 - val_loss: 0.6019
Using TensorFlow backend.
AUC: 0.8695

2019-03-08 03:14:27.210594: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:14:27.378112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:14:27.378157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:14:27.685617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:14:27.685670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:14:27.685680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:14:27.685953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3924
Epoch 2/80
 - 2s - loss: 0.3550
Epoch 3/80
 - 2s - loss: 0.2965
Epoch 4/80
 - 2s - loss: 0.2680
Epoch 5/80
 - 2s - loss: 0.2441
Epoch 6/80
 - 2s - loss: 0.2284
Epoch 7/80
 - 2s - loss: 0.2181
Epoch 8/80
 - 2s - loss: 0.2095
Epoch 9/80
 - 2s - loss: 0.2008
Epoch 10/80
 - 2s - loss: 0.1912
Epoch 11/80
 - 2s - loss: 0.1814
Epoch 12/80
 - 2s - loss: 0.1721
Epoch 13/80
 - 2s - loss: 0.1638
Epoch 14/80
 - 2s - loss: 0.1566
Epoch 15/80
 - 2s - loss: 0.1505
Epoch 16/80
 - 2s - loss: 0.1453
Epoch 17/80
 - 2s - loss: 0.1410
Epoch 18/80
 - 2s - loss: 0.1374
Epoch 19/80
 - 2s - loss: 0.1342
Epoch 20/80
 - 2s - loss: 0.1316
Epoch 21/80
 - 2s - loss: 0.1293
Epoch 22/80
 - 2s - loss: 0.1274
Epoch 23/80
 - 2s - loss: 0.1257
Epoch 24/80
 - 2s - loss: 0.1244
Epoch 25/80
 - 2s - loss: 0.1232
Epoch 26/80
 - 2s - loss: 0.1222
Epoch 27/80
 - 2s - loss: 0.1214
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2b50ce5b80b8>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 03:15:43.500975: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:15:43.672659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:15:43.672705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:15:43.975143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:15:43.975196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:15:43.975205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:15:43.975471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1233
Epoch 2/80
 - 2s - loss: 0.2109
Epoch 3/80
 - 2s - loss: 0.1728
Epoch 4/80
 - 2s - loss: 0.1665
Epoch 5/80
 - 2s - loss: 0.1612
Epoch 6/80
 - 2s - loss: 0.1549
Epoch 7/80
 - 2s - loss: 0.1477
Epoch 8/80
 - 2s - loss: 0.1390
Epoch 9/80
 - 2s - loss: 0.1284
Epoch 10/80
 - 2s - loss: 0.1167
Epoch 11/80
 - 2s - loss: 0.1063
Epoch 12/80
 - 2s - loss: 0.0978
Epoch 13/80
 - 2s - loss: 0.0908
Epoch 14/80
 - 2s - loss: 0.0850
Epoch 15/80
 - 2s - loss: 0.0801
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:16:33.735106: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:16:33.906845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:16:33.906894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:16:34.222562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:16:34.222610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:16:34.222620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:16:34.222915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1295
Epoch 2/80
 - 2s - loss: 0.2119
Epoch 3/80
 - 2s - loss: 0.1737
Epoch 4/80
 - 2s - loss: 0.1686
Epoch 5/80
 - 2s - loss: 0.1649
Epoch 6/80
 - 2s - loss: 0.1604
Epoch 7/80
 - 2s - loss: 0.1540
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:17:06.848289: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:17:07.017520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:17:07.017566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:17:07.324209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:17:07.324264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:17:07.324273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:17:07.324541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1581
Epoch 2/80
 - 2s - loss: 0.2146
Epoch 3/80
 - 2s - loss: 0.1737
Epoch 4/80
 - 2s - loss: 0.1670
Epoch 5/80
 - 2s - loss: 0.1600
Epoch 6/80
 - 2s - loss: 0.1501
Epoch 7/80
 - 2s - loss: 0.1392
Epoch 8/80
 - 2s - loss: 0.1293
Epoch 9/80
 - 2s - loss: 0.1204
Epoch 10/80
 - 2s - loss: 0.1117
Epoch 11/80
 - 2s - loss: 0.1033
Epoch 12/80
 - 2s - loss: 0.0958
Epoch 13/80
 - 2s - loss: 0.0893
Epoch 14/80
 - 2s - loss: 0.0837
Epoch 15/80
 - 2s - loss: 0.0789
Epoch 16/80
 - 2s - loss: 0.0747
Epoch 17/80
 - 2s - loss: 0.0711
Epoch 18/80
 - 2s - loss: 0.0681
Epoch 19/80
 - 2s - loss: 0.0656
Epoch 20/80
 - 2s - loss: 0.0635
Epoch 21/80
 - 2s - loss: 0.0617
Epoch 22/80
 - 2s - loss: 0.0602
Epoch 23/80
 - 2s - loss: 0.0589
Epoch 24/80
 - 2s - loss: 0.0579
Epoch 25/80
 - 2s - loss: 0.0569
Epoch 26/80
 - 2s - loss: 0.0561
Epoch 27/80
 - 2s - loss: 0.0555
Epoch 28/80
 - 2s - loss: 0.0549
Epoch 29/80
 - 2s - loss: 0.0543
Epoch 30/80
 - 2s - loss: 0.0539
Epoch 31/80
 - 2s - loss: 0.0535
Epoch 32/80
 - 2s - loss: 0.0532
Epoch 33/80
 - 2s - loss: 0.0529
Epoch 34/80
 - 2s - loss: 0.0526
Epoch 35/80
 - 2s - loss: 0.0524
Epoch 36/80
 - 2s - loss: 0.0522
Epoch 37/80
 - 2s - loss: 0.0520
Epoch 38/80
 - 2s - loss: 0.0518
Epoch 39/80
 - 2s - loss: 0.0517
Epoch 40/80
 - 2s - loss: 0.0515
Epoch 41/80
 - 2s - loss: 0.0514
Epoch 42/80
 - 2s - loss: 0.0513
Epoch 43/80
 - 2s - loss: 0.0512
Epoch 44/80
 - 2s - loss: 0.0511
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:18:56.517889: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:18:56.690455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:18:56.690500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:18:56.997357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:18:56.997413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:18:56.997422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:18:56.997705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1345
Epoch 2/80
 - 2s - loss: 0.2139
Epoch 3/80
 - 2s - loss: 0.1703
Epoch 4/80
 - 2s - loss: 0.1570
Epoch 5/80
 - 2s - loss: 0.1447
Epoch 6/80
 - 2s - loss: 0.1351
Epoch 7/80
 - 2s - loss: 0.1273
Epoch 8/80
 - 2s - loss: 0.1205
Epoch 9/80
 - 2s - loss: 0.1142
Epoch 10/80
 - 2s - loss: 0.1081
Epoch 11/80
 - 2s - loss: 0.1018
Epoch 12/80
 - 2s - loss: 0.0954
Epoch 13/80
 - 2s - loss: 0.0894
Epoch 14/80
 - 2s - loss: 0.0840
Epoch 15/80
 - 2s - loss: 0.0792
Epoch 16/80
 - 2s - loss: 0.0751
Epoch 17/80
 - 2s - loss: 0.0716
Epoch 18/80
 - 2s - loss: 0.0686
Epoch 19/80
 - 2s - loss: 0.0660
Epoch 20/80
 - 2s - loss: 0.0638
Epoch 21/80
 - 2s - loss: 0.0620
Epoch 22/80
 - 2s - loss: 0.0604
Epoch 23/80
 - 2s - loss: 0.0590
Epoch 24/80
 - 2s - loss: 0.0578
Epoch 25/80
 - 2s - loss: 0.0569
Epoch 26/80
 - 2s - loss: 0.0561
Epoch 27/80
 - 2s - loss: 0.0554
Epoch 28/80
 - 2s - loss: 0.0548
Epoch 29/80
 - 2s - loss: 0.0543
Epoch 30/80
 - 2s - loss: 0.0538
Epoch 31/80
 - 2s - loss: 0.0535
Epoch 32/80
 - 2s - loss: 0.0531
Epoch 33/80
 - 2s - loss: 0.0528
Epoch 34/80
 - 2s - loss: 0.0526
Epoch 35/80
 - 2s - loss: 0.0523
Epoch 36/80
 - 2s - loss: 0.0521
Epoch 37/80
 - 2s - loss: 0.0520
Epoch 38/80
 - 2s - loss: 0.0518
Epoch 39/80
 - 2s - loss: 0.0516
Epoch 40/80
 - 2s - loss: 0.0515
Epoch 41/80
 - 2s - loss: 0.0514
Epoch 42/80
 - 2s - loss: 0.0513
Epoch 43/80
 - 2s - loss: 0.0512
Epoch 44/80
 - 2s - loss: 0.0511
Epoch 45/80
 - 2s - loss: 0.0510
Epoch 46/80
 - 2s - loss: 0.0509
Epoch 47/80
 - 2s - loss: 0.0508
Epoch 48/80
 - 2s - loss: 0.0507
Epoch 49/80
 - 2s - loss: 0.0507
Epoch 50/80
 - 2s - loss: 0.0506
Epoch 51/80
 - 2s - loss: 0.0506
Epoch 52/80
 - 2s - loss: 0.0505
Epoch 53/80
 - 2s - loss: 0.0505
Epoch 54/80
 - 2s - loss: 0.0504
Epoch 55/80
 - 2s - loss: 0.0504
Epoch 56/80
 - 2s - loss: 0.0504
Epoch 57/80
 - 2s - loss: 0.0503
Epoch 58/80
 - 2s - loss: 0.0503
Epoch 59/80
 - 2s - loss: 0.0502
Epoch 60/80
 - 2s - loss: 0.0502
Epoch 61/80
 - 2s - loss: 0.0502
Epoch 62/80
 - 2s - loss: 0.0502
Epoch 63/80
 - 2s - loss: 0.0501
Epoch 64/80
 - 2s - loss: 0.0501
Epoch 65/80
 - 2s - loss: 0.0490
Epoch 66/80
 - 2s - loss: 0.0489
Epoch 67/80
 - 2s - loss: 0.0489
Epoch 68/80
 - 2s - loss: 0.0488
Epoch 69/80
 - 2s - loss: 0.0488
Epoch 70/80
 - 2s - loss: 0.0486
Epoch 71/80
 - 2s - loss: 0.0486
Epoch 72/80
 - 2s - loss: 0.0486
Epoch 73/80
 - 2s - loss: 0.0486
Epoch 74/80
 - 2s - loss: 0.0485
Epoch 75/80
 - 2s - loss: 0.0485
Epoch 76/80
 - 2s - loss: 0.0485
Epoch 77/80
 - 2s - loss: 0.0485
Epoch 78/80
 - 2s - loss: 0.0485
Epoch 79/80
 - 2s - loss: 0.0485
Epoch 80/80
 - 2s - loss: 0.0485
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 5.9237 - val_loss: 2.7252
AUC: 0.7876

Epoch 2/80
 - 0s - loss: 3.9926 - val_loss: 1.4481
AUC: 0.8167

Epoch 3/80
 - 0s - loss: 2.7129 - val_loss: 1.0680
AUC: 0.8275

Epoch 4/80
 - 0s - loss: 1.8054 - val_loss: 0.8777
AUC: 0.8320

Epoch 5/80
 - 0s - loss: 1.4201 - val_loss: 0.7829
AUC: 0.8383

Epoch 6/80
 - 0s - loss: 1.2708 - val_loss: 0.7287
AUC: 0.8418

Epoch 7/80
 - 0s - loss: 1.1846 - val_loss: 0.6829
AUC: 0.8451

Epoch 8/80
 - 0s - loss: 1.1513 - val_loss: 0.7143
AUC: 0.8478

Epoch 9/80
 - 0s - loss: 1.1337 - val_loss: 0.7084
AUC: 0.8501

Epoch 10/80
 - 0s - loss: 1.1226 - val_loss: 0.6402
AUC: 0.8504

Epoch 11/80
 - 0s - loss: 1.1018 - val_loss: 0.7093
AUC: 0.8526

Epoch 12/80
 - 0s - loss: 1.0935 - val_loss: 0.7064
AUC: 0.8531

Epoch 13/80
 - 0s - loss: 1.0814 - val_loss: 0.6291
AUC: 0.8532

Epoch 14/80
 - 0s - loss: 1.0786 - val_loss: 0.6633
AUC: 0.8546

Epoch 15/80
 - 0s - loss: 1.0629 - val_loss: 0.6616
AUC: 0.8553

Epoch 16/80
 - 0s - loss: 1.0695 - val_loss: 0.6684
AUC: 0.8559

Epoch 17/80
 - 0s - loss: 1.0578 - val_loss: 0.6340
AUC: 0.8578

Epoch 18/80
 - 0s - loss: 1.0532 - val_loss: 0.6936
AUC: 0.8582

Epoch 19/80
 - 0s - loss: 1.0447 - val_loss: 0.6811
AUC: 0.8577

Epoch 20/80
 - 0s - loss: 1.0449 - val_loss: 0.6004
AUC: 0.8572

Epoch 21/80
 - 0s - loss: 1.0325 - val_loss: 0.6460
AUC: 0.8598

Epoch 22/80
 - 0s - loss: 1.0348 - val_loss: 0.6687
AUC: 0.8601

Epoch 23/80
 - 0s - loss: 1.0255 - val_loss: 0.6363
AUC: 0.8607

Epoch 24/80
 - 0s - loss: 1.0293 - val_loss: 0.6402
AUC: 0.8625

Epoch 25/80
 - 0s - loss: 1.0287 - val_loss: 0.6977
AUC: 0.8619

Epoch 26/80
 - 0s - loss: 1.0134 - val_loss: 0.6716
AUC: 0.8638

Epoch 27/80
 - 0s - loss: 1.0187 - val_loss: 0.6777
AUC: 0.8635

Epoch 28/80
 - 0s - loss: 1.0129 - val_loss: 0.5986
AUC: 0.8639

Epoch 29/80
 - 0s - loss: 1.0131 - val_loss: 0.6457
AUC: 0.8628

Epoch 30/80
 - 0s - loss: 1.0074 - val_loss: 0.6140
AUC: 0.8638

Epoch 31/80
 - 0s - loss: 1.0076 - val_loss: 0.6466
AUC: 0.8650

Epoch 32/80
 - 0s - loss: 1.0072 - val_loss: 0.6213
AUC: 0.8653

Epoch 33/80
 - 0s - loss: 1.0028 - val_loss: 0.6216
AUC: 0.8646

Epoch 34/80
 - 0s - loss: 1.0048 - val_loss: 0.6056
AUC: 0.8647

Epoch 35/80
 - 0s - loss: 1.0053 - val_loss: 0.6352
AUC: 0.8663

Epoch 36/80
 - 0s - loss: 0.9915 - val_loss: 0.6377
AUC: 0.8660

Epoch 37/80
 - 0s - loss: 0.9912 - val_loss: 0.5972
AUC: 0.8632

Epoch 38/80
 - 0s - loss: 0.9946 - val_loss: 0.6162
AUC: 0.8672

Epoch 39/80
 - 0s - loss: 0.9936 - val_loss: 0.6077
AUC: 0.8663

Epoch 40/80
 - 0s - loss: 0.9846 - val_loss: 0.6695
AUC: 0.8658

Epoch 41/80
 - 0s - loss: 0.9927 - val_loss: 0.6775
AUC: 0.8660

Epoch 42/80
 - 0s - loss: 0.9881 - val_loss: 0.6140
AUC: 0.8665

Epoch 43/80
 - 0s - loss: 0.9807 - val_loss: 0.6623
AUC: 0.8667

Epoch 44/80
 - 0s - loss: 0.9837 - val_loss: 0.6733
AUC: 0.8645

Epoch 45/80
 - 0s - loss: 0.9850 - val_loss: 0.5964
AUC: 0.8670

Epoch 46/80
 - 0s - loss: 0.9821 - val_loss: 0.5926
AUC: 0.8671

Epoch 47/80
 - 0s - loss: 0.9723 - val_loss: 0.6116
AUC: 0.8659

Epoch 48/80
 - 0s - loss: 0.9804 - val_loss: 0.6020
AUC: 0.8668

Epoch 49/80
 - 0s - loss: 0.9771 - val_loss: 0.6020
AUC: 0.8666

Epoch 50/80
 - 0s - loss: 0.9776 - val_loss: 0.6117
AUC: 0.8667

Epoch 51/80
 - 0s - loss: 0.9711 - val_loss: 0.5673
AUC: 0.8677

Epoch 52/80
 - 0s - loss: 0.9694 - val_loss: 0.5966
AUC: 0.8669

Epoch 53/80
 - 0s - loss: 0.9702 - val_loss: 0.5592
AUC: 0.8668

Epoch 54/80
 - 0s - loss: 0.9691 - val_loss: 0.5481
AUC: 0.8664

Epoch 55/80
 - 0s - loss: 0.9677 - val_loss: 0.5900
AUC: 0.8681

Epoch 56/80
 - 0s - loss: 0.9629 - val_loss: 0.5258
AUC: 0.8664

Epoch 57/80
 - 0s - loss: 0.9743 - val_loss: 0.5830
AUC: 0.8666

Epoch 58/80
 - 0s - loss: 0.9643 - val_loss: 0.5921
AUC: 0.8677

Epoch 59/80
 - 0s - loss: 0.9612 - val_loss: 0.5626
AUC: 0.8668

Epoch 60/80
 - 0s - loss: 0.9628 - val_loss: 0.5526
AUC: 0.8674

Epoch 61/80
 - 0s - loss: 0.9593 - val_loss: 0.5863
AUC: 0.8678

Epoch 62/80
 - 0s - loss: 0.9635 - val_loss: 0.6264
AUC: 0.8683

Epoch 63/80
 - 0s - loss: 0.9544 - val_loss: 0.5921
AUC: 0.8680

Epoch 64/80
 - 0s - loss: 0.9547 - val_loss: 0.6190
AUC: 0.8672

Epoch 65/80
 - 0s - loss: 0.9520 - val_loss: 0.5919
AUC: 0.8673

Epoch 66/80
 - 0s - loss: 0.9513 - val_loss: 0.5552
AUC: 0.8675

Epoch 67/80
 - 0s - loss: 0.9438 - val_loss: 0.6141
AUC: 0.8682

Epoch 68/80
 - 0s - loss: 0.9407 - val_loss: 0.5959
AUC: 0.8681

Epoch 69/80
 - 0s - loss: 0.9461 - val_loss: 0.5888
AUC: 0.8678

Epoch 70/80
 - 0s - loss: 0.9419 - val_loss: 0.6042
AUC: 0.8679

Epoch 71/80
 - 0s - loss: 0.9439 - val_loss: 0.5866
AUC: 0.8679

Epoch 72/80
 - 0s - loss: 0.9416 - val_loss: 0.6057
AUC: 0.8680

Epoch 73/80
 - 0s - loss: 0.9420 - val_loss: 0.5965
AUC: 0.8680

Epoch 74/80
 - 0s - loss: 0.9378 - val_loss: 0.5759
AUC: 0.8677

Epoch 75/80
 - 0s - loss: 0.9425 - val_loss: 0.5706
AUC: 0.8678

Epoch 76/80
 - 0s - loss: 0.9417 - val_loss: 0.6075
AUC: 0.8681

Epoch 77/80
 - 0s - loss: 0.9435 - val_loss: 0.5855
AUC: 0.8679

Epoch 78/80
 - 0s - loss: 0.9349 - val_loss: 0.5834
AUC: 0.8678

Epoch 79/80
 - 0s - loss: 0.9387 - val_loss: 0.5899
AUC: 0.8679

Epoch 80/80
 - 0s - loss: 0.9389 - val_loss: 0.5881
AUC: 0.8677

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9517 - val_loss: 0.5964
AUC: 0.8684

Epoch 2/30
 - 0s - loss: 0.9488 - val_loss: 0.5866
AUC: 0.8685

Epoch 3/30
 - 0s - loss: 0.9433 - val_loss: 0.6080
AUC: 0.8683

Epoch 4/30
 - 0s - loss: 0.9479 - val_loss: 0.5792
AUC: 0.8681

Epoch 5/30
 - 0s - loss: 0.9426 - val_loss: 0.6022
AUC: 0.8681

Epoch 6/30
 - 0s - loss: 0.9424 - val_loss: 0.5802
AUC: 0.8685

Epoch 7/30
 - 0s - loss: 0.9462 - val_loss: 0.5953
AUC: 0.8685

Epoch 8/30
 - 0s - loss: 0.9369 - val_loss: 0.5894
AUC: 0.8682

Epoch 9/30
 - 0s - loss: 0.9429 - val_loss: 0.5951
AUC: 0.8684

Epoch 10/30
 - 0s - loss: 0.9365 - val_loss: 0.5920
AUC: 0.8688

Epoch 11/30
 - 0s - loss: 0.9395 - val_loss: 0.5905
AUC: 0.8688

Epoch 12/30
 - 0s - loss: 0.9345 - val_loss: 0.5768
AUC: 0.8686

Epoch 13/30
 - 0s - loss: 0.9366 - val_loss: 0.5841
AUC: 0.8687

Epoch 14/30
 - 0s - loss: 0.9367 - val_loss: 0.5935
AUC: 0.8688

Epoch 15/30
 - 0s - loss: 0.9370 - val_loss: 0.5708
AUC: 0.8687

Epoch 16/30
 - 0s - loss: 0.9318 - val_loss: 0.5786
AUC: 0.8689

Epoch 17/30
 - 0s - loss: 0.9329 - val_loss: 0.5739
AUC: 0.8689

Epoch 18/30
 - 0s - loss: 0.9351 - val_loss: 0.5775
AUC: 0.8691

Epoch 19/30
 - 0s - loss: 0.9284 - val_loss: 0.5728
AUC: 0.8689

Epoch 20/30
 - 0s - loss: 0.9284 - val_loss: 0.5970
AUC: 0.8691

Epoch 21/30
 - 0s - loss: 0.9250 - val_loss: 0.5803
AUC: 0.8691

Epoch 22/30
 - 0s - loss: 0.9295 - val_loss: 0.5833
AUC: 0.8692

Epoch 23/30
 - 0s - loss: 0.9231 - val_loss: 0.5707
AUC: 0.8692

Epoch 24/30
 - 0s - loss: 0.9258 - val_loss: 0.5969
AUC: 0.8692

Epoch 25/30
 - 0s - loss: 0.9257 - val_loss: 0.5795
AUC: 0.8693

Epoch 26/30
 - 0s - loss: 0.9196 - val_loss: 0.5769
AUC: 0.8694

Epoch 27/30
 - 0s - loss: 0.9214 - val_loss: 0.5748
AUC: 0.8695

Epoch 28/30
 - 0s - loss: 0.9149 - val_loss: 0.5888
AUC: 0.8695

Epoch 29/30
 - 0s - loss: 0.9154 - val_loss: 0.5703
AUC: 0.8694

Epoch 30/30
 - 0s - loss: 0.9224 - val_loss: 0.5648
Using TensorFlow backend.
AUC: 0.8695

2019-03-08 03:23:11.205718: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:23:11.375890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:23:11.375936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:23:11.683279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:23:11.683349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:23:11.683358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:23:11.683645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6879
Epoch 2/80
 - 2s - loss: 0.1312
Epoch 3/80
 - 2s - loss: 0.0723
Epoch 4/80
 - 2s - loss: 0.0655
Epoch 5/80
 - 2s - loss: 0.0628
Epoch 6/80
 - 2s - loss: 0.0607
Epoch 7/80
 - 2s - loss: 0.0583
Epoch 8/80
 - 2s - loss: 0.0553
Epoch 9/80
 - 2s - loss: 0.0517
Epoch 10/80
 - 2s - loss: 0.0477
Epoch 11/80
 - 2s - loss: 0.0439
Epoch 12/80
 - 2s - loss: 0.0405
Epoch 13/80
 - 2s - loss: 0.0376
Epoch 14/80
 - 2s - loss: 0.0349
Epoch 15/80
 - 2s - loss: 0.0325
Epoch 16/80
 - 2s - loss: 0.0304
Epoch 17/80
 - 2s - loss: 0.0287
Epoch 18/80
 - 2s - loss: 0.0272
Epoch 19/80
 - 2s - loss: 0.0259
Epoch 20/80
 - 2s - loss: 0.0247
Epoch 21/80
 - 2s - loss: 0.0237
Epoch 22/80
 - 2s - loss: 0.0228
Epoch 23/80
 - 2s - loss: 0.0220
Epoch 24/80
 - 2s - loss: 0.0213
Epoch 25/80
 - 2s - loss: 0.0207
Epoch 26/80
 - 2s - loss: 0.0202
Epoch 27/80
 - 2s - loss: 0.0197
Epoch 28/80
 - 2s - loss: 0.0193
Epoch 29/80
 - 2s - loss: 0.0189
Epoch 30/80
 - 2s - loss: 0.0186
Epoch 31/80
 - 2s - loss: 0.0184
Epoch 32/80
 - 2s - loss: 0.0182
Epoch 33/80
 - 2s - loss: 0.0180
Epoch 34/80
 - 2s - loss: 0.0178
Epoch 35/80
 - 2s - loss: 0.0176
Epoch 36/80
 - 2s - loss: 0.0175
Epoch 37/80
 - 2s - loss: 0.0174
Epoch 38/80
 - 2s - loss: 0.0173
Epoch 39/80
 - 2s - loss: 0.0172
Epoch 40/80
 - 2s - loss: 0.0171
Epoch 41/80
 - 2s - loss: 0.0170
Epoch 42/80
 - 2s - loss: 0.0170
Epoch 43/80
 - 2s - loss: 0.0169
Epoch 44/80
 - 2s - loss: 0.0168
Epoch 45/80
 - 2s - loss: 0.0168
Epoch 46/80
 - 2s - loss: 0.0167
Epoch 47/80
 - 2s - loss: 0.0167
Epoch 48/80
 - 2s - loss: 0.0167
Epoch 49/80
 - 2s - loss: 0.0166
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:25:06.809546: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:25:06.980102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:25:06.980148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:25:07.286139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:25:07.286189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:25:07.286198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:25:07.286461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6900
Epoch 2/80
 - 2s - loss: 0.1308
Epoch 3/80
 - 2s - loss: 0.0731
Epoch 4/80
 - 2s - loss: 0.0666
Epoch 5/80
 - 2s - loss: 0.0641
Epoch 6/80
 - 2s - loss: 0.0621
Epoch 7/80
 - 2s - loss: 0.0598
Epoch 8/80
 - 2s - loss: 0.0572
Epoch 9/80
 - 2s - loss: 0.0540
Epoch 10/80
 - 2s - loss: 0.0503
Epoch 11/80
 - 2s - loss: 0.0463
Epoch 12/80
 - 2s - loss: 0.0422
Epoch 13/80
 - 2s - loss: 0.0385
Epoch 14/80
 - 2s - loss: 0.0352
Epoch 15/80
 - 2s - loss: 0.0324
Epoch 16/80
 - 2s - loss: 0.0301
Epoch 17/80
 - 2s - loss: 0.0282
Epoch 18/80
 - 2s - loss: 0.0266
Epoch 19/80
 - 2s - loss: 0.0253
Epoch 20/80
 - 2s - loss: 0.0241
Epoch 21/80
 - 2s - loss: 0.0231
Epoch 22/80
 - 2s - loss: 0.0222
Epoch 23/80
 - 2s - loss: 0.0214
Epoch 24/80
 - 2s - loss: 0.0208
Epoch 25/80
 - 2s - loss: 0.0202
Epoch 26/80
 - 2s - loss: 0.0198
Epoch 27/80
 - 2s - loss: 0.0194
Epoch 28/80
 - 2s - loss: 0.0190
Epoch 29/80
 - 2s - loss: 0.0187
Epoch 30/80
 - 2s - loss: 0.0185
Epoch 31/80
 - 2s - loss: 0.0182
Epoch 32/80
 - 2s - loss: 0.0180
Epoch 33/80
 - 2s - loss: 0.0179
Epoch 34/80
 - 2s - loss: 0.0177
Epoch 35/80
 - 2s - loss: 0.0176
Epoch 36/80
 - 2s - loss: 0.0174
Epoch 37/80
 - 2s - loss: 0.0173
Epoch 38/80
 - 2s - loss: 0.0172
Epoch 39/80
 - 2s - loss: 0.0172
Epoch 40/80
 - 2s - loss: 0.0171
Epoch 41/80
 - 2s - loss: 0.0170
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:26:46.260682: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:26:46.432188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:26:46.432235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:26:46.735703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:26:46.735763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:26:46.735773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:26:46.736039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6903
Epoch 2/80
 - 2s - loss: 0.1332
Epoch 3/80
 - 2s - loss: 0.0729
Epoch 4/80
 - 2s - loss: 0.0666
Epoch 5/80
 - 2s - loss: 0.0641
Epoch 6/80
 - 2s - loss: 0.0619
Epoch 7/80
 - 2s - loss: 0.0591
Epoch 8/80
 - 2s - loss: 0.0554
Epoch 9/80
 - 2s - loss: 0.0511
Epoch 10/80
 - 2s - loss: 0.0468
Epoch 11/80
 - 2s - loss: 0.0429
Epoch 12/80
 - 2s - loss: 0.0396
Epoch 13/80
 - 2s - loss: 0.0369
Epoch 14/80
 - 2s - loss: 0.0344
Epoch 15/80
 - 2s - loss: 0.0322
Epoch 16/80
 - 2s - loss: 0.0303
Epoch 17/80
 - 2s - loss: 0.0286
Epoch 18/80
 - 2s - loss: 0.0271
Epoch 19/80
 - 2s - loss: 0.0257
Epoch 20/80
 - 2s - loss: 0.0245
Epoch 21/80
 - 2s - loss: 0.0234
Epoch 22/80
 - 2s - loss: 0.0224
Epoch 23/80
 - 2s - loss: 0.0216
Epoch 24/80
 - 2s - loss: 0.0209
Epoch 25/80
 - 2s - loss: 0.0203
Epoch 26/80
 - 2s - loss: 0.0198
Epoch 27/80
 - 2s - loss: 0.0194
Epoch 28/80
 - 2s - loss: 0.0190
Epoch 29/80
 - 2s - loss: 0.0187
Epoch 30/80
 - 2s - loss: 0.0184
Epoch 31/80
 - 2s - loss: 0.0182
Epoch 32/80
 - 2s - loss: 0.0180
Epoch 33/80
 - 2s - loss: 0.0178
Epoch 34/80
 - 2s - loss: 0.0176
Epoch 35/80
 - 2s - loss: 0.0175
Epoch 36/80
 - 2s - loss: 0.0174
Epoch 37/80
 - 2s - loss: 0.0173
Epoch 38/80
 - 2s - loss: 0.0172
Epoch 39/80
 - 2s - loss: 0.0171
Epoch 40/80
 - 2s - loss: 0.0170
Epoch 41/80
 - 2s - loss: 0.0169
Epoch 42/80
 - 2s - loss: 0.0169
Epoch 43/80
 - 2s - loss: 0.0168
Epoch 44/80
 - 2s - loss: 0.0168
Epoch 45/80
 - 2s - loss: 0.0167
Epoch 46/80
 - 2s - loss: 0.0167
Epoch 47/80
 - 2s - loss: 0.0166
Epoch 48/80
 - 2s - loss: 0.0166
Epoch 49/80
 - 2s - loss: 0.0166
Epoch 50/80
 - 2s - loss: 0.0165
Epoch 51/80
 - 2s - loss: 0.0165
Epoch 52/80
 - 2s - loss: 0.0165
Epoch 53/80
 - 2s - loss: 0.0164
Epoch 54/80
 - 2s - loss: 0.0164
Epoch 55/80
 - 2s - loss: 0.0160
Epoch 56/80
 - 2s - loss: 0.0160
Epoch 57/80
 - 2s - loss: 0.0160
Epoch 58/80
 - 2s - loss: 0.0160
Epoch 59/80
 - 2s - loss: 0.0158
Epoch 60/80
 - 2s - loss: 0.0158
Epoch 61/80
 - 2s - loss: 0.0158
Epoch 62/80
 - 2s - loss: 0.0158
Epoch 63/80
 - 2s - loss: 0.0158
Epoch 64/80
 - 2s - loss: 0.0158
Epoch 65/80
 - 2s - loss: 0.0158
Epoch 66/80
 - 2s - loss: 0.0158
Epoch 67/80
 - 2s - loss: 0.0158
Epoch 68/80
 - 2s - loss: 0.0158
Epoch 69/80
 - 2s - loss: 0.0158
Epoch 70/80
 - 2s - loss: 0.0158
Epoch 71/80
 - 2s - loss: 0.0158
Epoch 72/80
 - 2s - loss: 0.0158
Epoch 73/80
 - 2s - loss: 0.0158
Epoch 74/80
 - 2s - loss: 0.0158
Epoch 75/80
 - 2s - loss: 0.0158
Epoch 76/80
 - 2s - loss: 0.0158
Epoch 77/80
 - 2s - loss: 0.0158
Epoch 78/80
 - 2s - loss: 0.0158
Epoch 79/80
 - 2s - loss: 0.0158
Epoch 80/80
 - 2s - loss: 0.0158
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 5.3824 - val_loss: 2.2285
AUC: 0.7834

Epoch 2/80
 - 0s - loss: 3.2997 - val_loss: 1.2554
AUC: 0.8120

Epoch 3/80
 - 0s - loss: 2.3268 - val_loss: 0.9439
AUC: 0.8314

Epoch 4/80
 - 0s - loss: 1.6860 - val_loss: 0.7668
AUC: 0.8373

Epoch 5/80
 - 0s - loss: 1.3796 - val_loss: 0.6830
AUC: 0.8441

Epoch 6/80
 - 0s - loss: 1.2549 - val_loss: 0.7101
AUC: 0.8470

Epoch 7/80
 - 0s - loss: 1.1718 - val_loss: 0.6055
AUC: 0.8484

Epoch 8/80
 - 0s - loss: 1.1431 - val_loss: 0.6232
AUC: 0.8512

Epoch 9/80
 - 0s - loss: 1.1203 - val_loss: 0.6977
AUC: 0.8545

Epoch 10/80
 - 0s - loss: 1.0975 - val_loss: 0.6306
AUC: 0.8540

Epoch 11/80
 - 0s - loss: 1.0961 - val_loss: 0.7142
AUC: 0.8570

Epoch 12/80
 - 0s - loss: 1.0782 - val_loss: 0.6529
AUC: 0.8580

Epoch 13/80
 - 0s - loss: 1.0714 - val_loss: 0.6960
AUC: 0.8596

Epoch 14/80
 - 0s - loss: 1.0654 - val_loss: 0.6061
AUC: 0.8594

Epoch 15/80
 - 0s - loss: 1.0535 - val_loss: 0.6353
AUC: 0.8618

Epoch 16/80
 - 0s - loss: 1.0508 - val_loss: 0.6473
AUC: 0.8619

Epoch 17/80
 - 0s - loss: 1.0466 - val_loss: 0.6205
AUC: 0.8608

Epoch 18/80
 - 0s - loss: 1.0338 - val_loss: 0.6239
AUC: 0.8630

Epoch 19/80
 - 0s - loss: 1.0396 - val_loss: 0.6289
AUC: 0.8632

Epoch 20/80
 - 0s - loss: 1.0391 - val_loss: 0.6218
AUC: 0.8635

Epoch 21/80
 - 0s - loss: 1.0335 - val_loss: 0.6273
AUC: 0.8637

Epoch 22/80
 - 0s - loss: 1.0353 - val_loss: 0.6341
AUC: 0.8640

Epoch 23/80
 - 0s - loss: 1.0254 - val_loss: 0.6017
AUC: 0.8631

Epoch 24/80
 - 0s - loss: 1.0313 - val_loss: 0.6520
AUC: 0.8644

Epoch 25/80
 - 0s - loss: 1.0291 - val_loss: 0.6324
AUC: 0.8642

Epoch 26/80
 - 0s - loss: 1.0277 - val_loss: 0.6228
AUC: 0.8642

Epoch 27/80
 - 0s - loss: 1.0274 - val_loss: 0.6599
AUC: 0.8649

Epoch 28/80
 - 0s - loss: 1.0267 - val_loss: 0.6215
AUC: 0.8646

Epoch 29/80
 - 0s - loss: 1.0266 - val_loss: 0.6332
AUC: 0.8652

Epoch 30/80
 - 0s - loss: 1.0259 - val_loss: 0.6468
AUC: 0.8654

Epoch 31/80
 - 0s - loss: 1.0228 - val_loss: 0.6157
AUC: 0.8651

Epoch 32/80
 - 0s - loss: 1.0278 - val_loss: 0.6365
AUC: 0.8659

Epoch 33/80
 - 0s - loss: 1.0211 - val_loss: 0.6225
AUC: 0.8656

Epoch 34/80
 - 0s - loss: 1.0207 - val_loss: 0.6271
AUC: 0.8658

Epoch 35/80
 - 0s - loss: 1.0209 - val_loss: 0.6280
AUC: 0.8658

Epoch 36/80
 - 0s - loss: 1.0225 - val_loss: 0.6297
AUC: 0.8659

Epoch 37/80
 - 0s - loss: 1.0179 - val_loss: 0.6281
AUC: 0.8658

Epoch 38/80
 - 0s - loss: 1.0173 - val_loss: 0.6289
AUC: 0.8658

Epoch 39/80
 - 0s - loss: 1.0192 - val_loss: 0.6252
AUC: 0.8658

Epoch 40/80
 - 0s - loss: 1.0202 - val_loss: 0.6240
AUC: 0.8657

Epoch 41/80
 - 0s - loss: 1.0236 - val_loss: 0.6264
AUC: 0.8658

Epoch 42/80
 - 0s - loss: 1.0224 - val_loss: 0.6301
AUC: 0.8660

Epoch 43/80
 - 0s - loss: 1.0210 - val_loss: 0.6246
AUC: 0.8660

Epoch 44/80
 - 0s - loss: 1.0107 - val_loss: 0.6247
AUC: 0.8660

Epoch 45/80
 - 0s - loss: 1.0155 - val_loss: 0.6250
AUC: 0.8660

Epoch 46/80
 - 0s - loss: 1.0208 - val_loss: 0.6242
AUC: 0.8660

Epoch 47/80
 - 0s - loss: 1.0126 - val_loss: 0.6241
AUC: 0.8660

Epoch 48/80
 - 0s - loss: 1.0137 - val_loss: 0.6231
AUC: 0.8660

Epoch 49/80
 - 0s - loss: 1.0208 - val_loss: 0.6244
AUC: 0.8660

Epoch 50/80
 - 0s - loss: 1.0172 - val_loss: 0.6239
AUC: 0.8660

Epoch 51/80
 - 0s - loss: 1.0115 - val_loss: 0.6236
AUC: 0.8660

Epoch 52/80
 - 0s - loss: 1.0179 - val_loss: 0.6255
AUC: 0.8660

Epoch 53/80
 - 0s - loss: 1.0136 - val_loss: 0.6256
AUC: 0.8660

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0176 - val_loss: 0.6321
AUC: 0.8661

Epoch 2/30
 - 0s - loss: 1.0191 - val_loss: 0.6338
AUC: 0.8662

Epoch 3/30
 - 0s - loss: 1.0219 - val_loss: 0.6247
AUC: 0.8664

Epoch 4/30
 - 0s - loss: 1.0147 - val_loss: 0.6369
AUC: 0.8669

Epoch 5/30
 - 0s - loss: 1.0177 - val_loss: 0.6100
AUC: 0.8666

Epoch 6/30
 - 0s - loss: 1.0094 - val_loss: 0.6240
AUC: 0.8670

Epoch 7/30
 - 0s - loss: 1.0106 - val_loss: 0.6341
AUC: 0.8675

Epoch 8/30
 - 0s - loss: 1.0040 - val_loss: 0.6242
AUC: 0.8672

Epoch 9/30
 - 0s - loss: 1.0036 - val_loss: 0.6079
AUC: 0.8675

Epoch 10/30
 - 0s - loss: 1.0042 - val_loss: 0.6129
AUC: 0.8674

Epoch 11/30
 - 0s - loss: 1.0013 - val_loss: 0.6305
AUC: 0.8679

Epoch 12/30
 - 0s - loss: 1.0019 - val_loss: 0.6110
AUC: 0.8680

Epoch 13/30
 - 0s - loss: 0.9986 - val_loss: 0.6422
AUC: 0.8685

Epoch 14/30
 - 0s - loss: 0.9946 - val_loss: 0.6096
AUC: 0.8681

Epoch 15/30
 - 0s - loss: 0.9994 - val_loss: 0.6218
AUC: 0.8685

Epoch 16/30
 - 0s - loss: 0.9953 - val_loss: 0.6123
AUC: 0.8687

Epoch 17/30
 - 0s - loss: 1.0025 - val_loss: 0.6326
AUC: 0.8692

Epoch 18/30
 - 0s - loss: 0.9888 - val_loss: 0.6293
AUC: 0.8692

Epoch 19/30
 - 0s - loss: 0.9860 - val_loss: 0.5970
AUC: 0.8689

Epoch 20/30
 - 0s - loss: 0.9898 - val_loss: 0.6128
AUC: 0.8693

Epoch 21/30
 - 0s - loss: 0.9858 - val_loss: 0.6115
AUC: 0.8695

Epoch 22/30
 - 0s - loss: 0.9860 - val_loss: 0.6138
AUC: 0.8696

Epoch 23/30
 - 0s - loss: 0.9847 - val_loss: 0.5970
AUC: 0.8693

Epoch 24/30
 - 0s - loss: 0.9808 - val_loss: 0.5960
AUC: 0.8695

Epoch 25/30
 - 0s - loss: 0.9825 - val_loss: 0.6099
AUC: 0.8700

Epoch 26/30
 - 0s - loss: 0.9824 - val_loss: 0.6013
AUC: 0.8700

Epoch 27/30
 - 0s - loss: 0.9830 - val_loss: 0.6183
AUC: 0.8704

Epoch 28/30
 - 0s - loss: 0.9780 - val_loss: 0.5824
AUC: 0.8696

Epoch 29/30
 - 0s - loss: 0.9841 - val_loss: 0.5927
AUC: 0.8701

Epoch 30/30
 - 0s - loss: 0.9754 - val_loss: 0.5883
Using TensorFlow backend.
AUC: 0.8703

2019-03-08 03:30:43.764362: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:30:43.934156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:30:43.934203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:30:44.241694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:30:44.241750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:30:44.241764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:30:44.242035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3785
Epoch 2/80
 - 2s - loss: 0.3529
Epoch 3/80
 - 2s - loss: 0.3086
Epoch 4/80
 - 2s - loss: 0.2961
Epoch 5/80
 - 2s - loss: 0.2820
Epoch 6/80
 - 2s - loss: 0.2642
Epoch 7/80
 - 2s - loss: 0.2428
Epoch 8/80
 - 2s - loss: 0.2219
Epoch 9/80
 - 2s - loss: 0.2053
Epoch 10/80
 - 2s - loss: 0.1922
Epoch 11/80
 - 2s - loss: 0.1814
Epoch 12/80
 - 2s - loss: 0.1723
Epoch 13/80
 - 2s - loss: 0.1642
Epoch 14/80
 - 2s - loss: 0.1569
Epoch 15/80
 - 2s - loss: 0.1505
Epoch 16/80
 - 2s - loss: 0.1449
Epoch 17/80
 - 2s - loss: 0.1402
Epoch 18/80
 - 2s - loss: 0.1364
Epoch 19/80
 - 2s - loss: 0.1332
Epoch 20/80
 - 2s - loss: 0.1306
Epoch 21/80
 - 2s - loss: 0.1284
Epoch 22/80
 - 2s - loss: 0.1265
Epoch 23/80
 - 2s - loss: 0.1249
Epoch 24/80
 - 2s - loss: 0.1235
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:31:54.824511: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:31:54.994306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:31:54.994369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:31:55.302402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:31:55.302452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:31:55.302461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:31:55.302762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.2 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3591
Epoch 2/80
 - 2s - loss: 0.3499
Epoch 3/80
 - 2s - loss: 0.3014
Epoch 4/80
 - 2s - loss: 0.2836
Epoch 5/80
 - 2s - loss: 0.2682
Epoch 6/80
 - 2s - loss: 0.2546
Epoch 7/80
 - 2s - loss: 0.2411
Epoch 8/80
 - 2s - loss: 0.2265
Epoch 9/80
 - 2s - loss: 0.2118
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:32:31.726096: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:32:31.895725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:32:31.895801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:32:32.203329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:32:32.203385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:32:32.203394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:32:32.203663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.4049
Epoch 2/80
 - 2s - loss: 0.3543
Epoch 3/80
 - 2s - loss: 0.3077
Epoch 4/80
 - 2s - loss: 0.2933
Epoch 5/80
 - 2s - loss: 0.2758
Epoch 6/80
 - 2s - loss: 0.2547
Epoch 7/80
 - 2s - loss: 0.2337
Epoch 8/80
 - 2s - loss: 0.2154
Epoch 9/80
 - 2s - loss: 0.2008
Epoch 10/80
 - 2s - loss: 0.1886
Epoch 11/80
 - 2s - loss: 0.1779
Epoch 12/80
 - 2s - loss: 0.1687
Epoch 13/80
 - 2s - loss: 0.1608
Epoch 14/80
 - 2s - loss: 0.1541
Epoch 15/80
 - 2s - loss: 0.1485
Epoch 16/80
 - 2s - loss: 0.1437
Epoch 17/80
 - 2s - loss: 0.1396
Epoch 18/80
 - 2s - loss: 0.1360
Epoch 19/80
 - 2s - loss: 0.1330
Epoch 20/80
 - 2s - loss: 0.1305
Epoch 21/80
 - 2s - loss: 0.1284
Epoch 22/80
 - 2s - loss: 0.1266
Epoch 23/80
 - 2s - loss: 0.1250
Epoch 24/80
 - 2s - loss: 0.1237
Epoch 25/80
 - 2s - loss: 0.1226
Epoch 26/80
 - 2s - loss: 0.1217
Epoch 27/80
 - 2s - loss: 0.1208
Epoch 28/80
 - 2s - loss: 0.1202
Epoch 29/80
 - 2s - loss: 0.1196
Epoch 30/80
 - 2s - loss: 0.1191
Epoch 31/80
 - 2s - loss: 0.1186
Epoch 32/80
 - 2s - loss: 0.1182
Epoch 33/80
 - 2s - loss: 0.1179
Epoch 34/80
 - 2s - loss: 0.1176
Epoch 35/80
 - 2s - loss: 0.1173
Epoch 36/80
 - 2s - loss: 0.1171
Epoch 37/80
 - 2s - loss: 0.1169
Epoch 38/80
 - 2s - loss: 0.1167
Epoch 39/80
 - 2s - loss: 0.1165
Epoch 40/80
 - 2s - loss: 0.1163
Epoch 41/80
 - 2s - loss: 0.1162
Epoch 42/80
 - 2s - loss: 0.1161
Epoch 43/80
 - 2s - loss: 0.1159
Epoch 44/80
 - 2s - loss: 0.1158
Epoch 45/80
 - 2s - loss: 0.1157
Epoch 46/80
 - 2s - loss: 0.1156
Epoch 47/80
 - 2s - loss: 0.1155
Epoch 48/80
 - 2s - loss: 0.1154
Epoch 49/80
 - 2s - loss: 0.1154
Epoch 50/80
 - 2s - loss: 0.1153
Epoch 51/80
 - 2s - loss: 0.1152
Epoch 52/80
 - 2s - loss: 0.1151
Epoch 53/80
 - 2s - loss: 0.1151
Epoch 54/80
 - 2s - loss: 0.1150
Epoch 55/80
 - 2s - loss: 0.1150
Epoch 56/80
 - 2s - loss: 0.1149
Epoch 57/80
 - 2s - loss: 0.1149
Epoch 58/80
 - 2s - loss: 0.1148
Epoch 59/80
 - 2s - loss: 0.1148
Epoch 60/80
 - 2s - loss: 0.1147
Epoch 61/80
 - 2s - loss: 0.1147
Epoch 62/80
 - 2s - loss: 0.1147
Epoch 63/80
 - 2s - loss: 0.1146
Epoch 64/80
 - 2s - loss: 0.1146
Epoch 65/80
 - 2s - loss: 0.1146
Epoch 66/80
 - 2s - loss: 0.1145
Epoch 67/80
 - 2s - loss: 0.1145
Epoch 68/80
 - 2s - loss: 0.1145
Epoch 69/80
 - 2s - loss: 0.1145
Epoch 70/80
 - 2s - loss: 0.1122
Epoch 71/80
 - 2s - loss: 0.1120
Epoch 72/80
 - 2s - loss: 0.1119
Epoch 73/80
 - 2s - loss: 0.1119
Epoch 74/80
 - 2s - loss: 0.1119
Epoch 75/80
 - 2s - loss: 0.1113
Epoch 76/80
 - 2s - loss: 0.1113
Epoch 77/80
 - 2s - loss: 0.1113
Epoch 78/80
 - 2s - loss: 0.1113
Epoch 79/80
 - 2s - loss: 0.1112
Epoch 80/80
 - 2s - loss: 0.1112
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.5892 - val_loss: 1.1825
AUC: 0.8196

Epoch 2/80
 - 0s - loss: 1.9357 - val_loss: 0.7701
AUC: 0.8375

Epoch 3/80
 - 0s - loss: 1.3674 - val_loss: 0.7151
AUC: 0.8420

Epoch 4/80
 - 0s - loss: 1.2089 - val_loss: 0.6668
AUC: 0.8458

Epoch 5/80
 - 0s - loss: 1.1514 - val_loss: 0.6294
AUC: 0.8500

Epoch 6/80
 - 0s - loss: 1.1184 - val_loss: 0.7106
AUC: 0.8545

Epoch 7/80
 - 0s - loss: 1.1038 - val_loss: 0.6339
AUC: 0.8513

Epoch 8/80
 - 0s - loss: 1.0852 - val_loss: 0.6231
AUC: 0.8558

Epoch 9/80
 - 0s - loss: 1.0765 - val_loss: 0.6842
AUC: 0.8560

Epoch 10/80
 - 0s - loss: 1.0575 - val_loss: 0.6736
AUC: 0.8577

Epoch 11/80
 - 0s - loss: 1.0565 - val_loss: 0.6358
AUC: 0.8592

Epoch 12/80
 - 0s - loss: 1.0503 - val_loss: 0.5854
AUC: 0.8585

Epoch 13/80
 - 0s - loss: 1.0391 - val_loss: 0.6643
AUC: 0.8603

Epoch 14/80
 - 0s - loss: 1.0334 - val_loss: 0.5967
AUC: 0.8590

Epoch 15/80
 - 0s - loss: 1.0309 - val_loss: 0.5995
AUC: 0.8602

Epoch 16/80
 - 0s - loss: 1.0238 - val_loss: 0.6513
AUC: 0.8604

Epoch 17/80
 - 0s - loss: 1.0207 - val_loss: 0.5706
AUC: 0.8591

Epoch 18/80
 - 0s - loss: 1.0229 - val_loss: 0.6023
AUC: 0.8613

Epoch 19/80
 - 0s - loss: 1.0102 - val_loss: 0.6705
AUC: 0.8622

Epoch 20/80
 - 0s - loss: 1.0092 - val_loss: 0.5749
AUC: 0.8606

Epoch 21/80
 - 0s - loss: 1.0038 - val_loss: 0.6717
AUC: 0.8632

Epoch 22/80
 - 0s - loss: 1.0056 - val_loss: 0.6277
AUC: 0.8635

Epoch 23/80
 - 0s - loss: 1.0030 - val_loss: 0.5685
AUC: 0.8629

Epoch 24/80
 - 0s - loss: 1.0042 - val_loss: 0.6058
AUC: 0.8638

Epoch 25/80
 - 0s - loss: 0.9933 - val_loss: 0.5478
AUC: 0.8612

Epoch 26/80
 - 0s - loss: 0.9940 - val_loss: 0.5949
AUC: 0.8634

Epoch 27/80
 - 0s - loss: 0.9930 - val_loss: 0.5794
AUC: 0.8636

Epoch 28/80
 - 0s - loss: 0.9932 - val_loss: 0.6720
AUC: 0.8654

Epoch 29/80
 - 0s - loss: 0.9875 - val_loss: 0.5888
AUC: 0.8645

Epoch 30/80
 - 0s - loss: 0.9797 - val_loss: 0.5768
AUC: 0.8651

Epoch 31/80
 - 0s - loss: 0.9806 - val_loss: 0.5904
AUC: 0.8654

Epoch 32/80
 - 0s - loss: 0.9724 - val_loss: 0.5703
AUC: 0.8633

Epoch 33/80
 - 0s - loss: 0.9759 - val_loss: 0.6797
AUC: 0.8662

Epoch 34/80
 - 0s - loss: 0.9727 - val_loss: 0.5833
AUC: 0.8650

Epoch 35/80
 - 0s - loss: 0.9757 - val_loss: 0.6562
AUC: 0.8668

Epoch 36/80
 - 0s - loss: 0.9630 - val_loss: 0.5955
AUC: 0.8661

Epoch 37/80
 - 0s - loss: 0.9589 - val_loss: 0.5915
AUC: 0.8661

Epoch 38/80
 - 0s - loss: 0.9596 - val_loss: 0.6106
AUC: 0.8666

Epoch 39/80
 - 0s - loss: 0.9594 - val_loss: 0.5848
AUC: 0.8662

Epoch 40/80
 - 0s - loss: 0.9612 - val_loss: 0.5757
AUC: 0.8665

Epoch 41/80
 - 0s - loss: 0.9564 - val_loss: 0.5939
AUC: 0.8668

Epoch 42/80
 - 0s - loss: 0.9608 - val_loss: 0.6159
AUC: 0.8665

Epoch 43/80
 - 0s - loss: 0.9577 - val_loss: 0.5958
AUC: 0.8669

Epoch 44/80
 - 0s - loss: 0.9545 - val_loss: 0.6121
AUC: 0.8667

Epoch 45/80
 - 0s - loss: 0.9557 - val_loss: 0.5672
AUC: 0.8663

Epoch 46/80
 - 0s - loss: 0.9496 - val_loss: 0.5984
AUC: 0.8667

Epoch 47/80
 - 0s - loss: 0.9508 - val_loss: 0.5877
AUC: 0.8666

Epoch 48/80
 - 0s - loss: 0.9538 - val_loss: 0.5935
AUC: 0.8667

Epoch 49/80
 - 0s - loss: 0.9516 - val_loss: 0.6026
AUC: 0.8668

Epoch 50/80
 - 0s - loss: 0.9527 - val_loss: 0.6042
AUC: 0.8669

Epoch 51/80
 - 0s - loss: 0.9499 - val_loss: 0.5932
AUC: 0.8667

Epoch 52/80
 - 0s - loss: 0.9501 - val_loss: 0.5952
AUC: 0.8667

Epoch 53/80
 - 0s - loss: 0.9497 - val_loss: 0.5927
AUC: 0.8667

Epoch 54/80
 - 0s - loss: 0.9531 - val_loss: 0.6002
AUC: 0.8668

Epoch 55/80
 - 0s - loss: 0.9520 - val_loss: 0.6021
AUC: 0.8669

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9499 - val_loss: 0.5823
AUC: 0.8665

Epoch 2/30
 - 0s - loss: 0.9549 - val_loss: 0.6079
AUC: 0.8672

Epoch 3/30
 - 0s - loss: 0.9530 - val_loss: 0.6234
AUC: 0.8675

Epoch 4/30
 - 0s - loss: 0.9431 - val_loss: 0.5903
AUC: 0.8671

Epoch 5/30
 - 0s - loss: 0.9469 - val_loss: 0.5723
AUC: 0.8670

Epoch 6/30
 - 0s - loss: 0.9469 - val_loss: 0.5801
AUC: 0.8673

Epoch 7/30
 - 0s - loss: 0.9415 - val_loss: 0.5893
AUC: 0.8676

Epoch 8/30
 - 0s - loss: 0.9457 - val_loss: 0.5972
AUC: 0.8679

Epoch 9/30
 - 0s - loss: 0.9410 - val_loss: 0.5726
AUC: 0.8675

Epoch 10/30
 - 0s - loss: 0.9394 - val_loss: 0.5736
AUC: 0.8675

Epoch 11/30
 - 0s - loss: 0.9407 - val_loss: 0.5893
AUC: 0.8679

Epoch 12/30
 - 0s - loss: 0.9407 - val_loss: 0.5905
AUC: 0.8680

Epoch 13/30
 - 0s - loss: 0.9421 - val_loss: 0.5862
AUC: 0.8680

Epoch 14/30
 - 0s - loss: 0.9355 - val_loss: 0.5848
AUC: 0.8679

Epoch 15/30
 - 0s - loss: 0.9367 - val_loss: 0.5917
AUC: 0.8679

Epoch 16/30
 - 0s - loss: 0.9321 - val_loss: 0.5866
AUC: 0.8679

Epoch 17/30
 - 0s - loss: 0.9348 - val_loss: 0.5874
AUC: 0.8680

Epoch 18/30
 - 0s - loss: 0.9319 - val_loss: 0.5893
AUC: 0.8681

Epoch 19/30
 - 0s - loss: 0.9332 - val_loss: 0.5905
AUC: 0.8681

Epoch 20/30
 - 0s - loss: 0.9303 - val_loss: 0.5855
AUC: 0.8681

Epoch 21/30
 - 0s - loss: 0.9287 - val_loss: 0.5852
AUC: 0.8681

Epoch 22/30
 - 0s - loss: 0.9312 - val_loss: 0.5823
AUC: 0.8680

Epoch 23/30
 - 0s - loss: 0.9355 - val_loss: 0.5848
AUC: 0.8681

Epoch 24/30
 - 0s - loss: 0.9308 - val_loss: 0.5863
AUC: 0.8682

Epoch 25/30
 - 0s - loss: 0.9332 - val_loss: 0.5847
AUC: 0.8681

Epoch 26/30
 - 0s - loss: 0.9293 - val_loss: 0.5855
AUC: 0.8682

Epoch 27/30
 - 0s - loss: 0.9368 - val_loss: 0.5867
AUC: 0.8682

Epoch 28/30
 - 0s - loss: 0.9285 - val_loss: 0.5872
AUC: 0.8682

Epoch 29/30
 - 0s - loss: 0.9375 - val_loss: 0.5886
AUC: 0.8682

Epoch 30/30
 - 0s - loss: 0.9303 - val_loss: 0.5877
Using TensorFlow backend.
AUC: 0.8682

2019-03-08 03:36:31.026074: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:36:31.196387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:36:31.196433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:36:31.503736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:36:31.503837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:36:31.503849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:36:31.504216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1591
Epoch 2/80
 - 2s - loss: 0.2185
Epoch 3/80
 - 2s - loss: 0.1724
Epoch 4/80
 - 2s - loss: 0.1633
Epoch 5/80
 - 2s - loss: 0.1543
Epoch 6/80
 - 2s - loss: 0.1428
Epoch 7/80
 - 2s - loss: 0.1310
Epoch 8/80
 - 2s - loss: 0.1208
Epoch 9/80
 - 2s - loss: 0.1125
Epoch 10/80
 - 2s - loss: 0.1058
Epoch 11/80
 - 2s - loss: 0.0996
Epoch 12/80
 - 2s - loss: 0.0938
Epoch 13/80
 - 2s - loss: 0.0882
Epoch 14/80
 - 2s - loss: 0.0832
Epoch 15/80
 - 2s - loss: 0.0789
Epoch 16/80
 - 2s - loss: 0.0753
Epoch 17/80
 - 2s - loss: 0.0721
Epoch 18/80
 - 2s - loss: 0.0693
Epoch 19/80
 - 2s - loss: 0.0669
Epoch 20/80
 - 2s - loss: 0.0648
Epoch 21/80
 - 2s - loss: 0.0630
Epoch 22/80
 - 2s - loss: 0.0615
Epoch 23/80
 - 2s - loss: 0.0602
Epoch 24/80
 - 2s - loss: 0.0590
Epoch 25/80
 - 2s - loss: 0.0581
Epoch 26/80
 - 2s - loss: 0.0572
Epoch 27/80
 - 2s - loss: 0.0565
Epoch 28/80
 - 2s - loss: 0.0558
Epoch 29/80
 - 2s - loss: 0.0552
Epoch 30/80
 - 2s - loss: 0.0547
Epoch 31/80
 - 2s - loss: 0.0542
Epoch 32/80
 - 2s - loss: 0.0538
Epoch 33/80
 - 2s - loss: 0.0534
Epoch 34/80
 - 2s - loss: 0.0531
Epoch 35/80
 - 2s - loss: 0.0528
Epoch 36/80
 - 2s - loss: 0.0525
Epoch 37/80
 - 2s - loss: 0.0522
Epoch 38/80
 - 2s - loss: 0.0520
Epoch 39/80
 - 2s - loss: 0.0518
Epoch 40/80
 - 2s - loss: 0.0517
Epoch 41/80
 - 2s - loss: 0.0515
Epoch 42/80
 - 2s - loss: 0.0513
Epoch 43/80
 - 2s - loss: 0.0512
Epoch 44/80
 - 2s - loss: 0.0511
Epoch 45/80
 - 2s - loss: 0.0509
Epoch 46/80
 - 2s - loss: 0.0508
Epoch 47/80
 - 2s - loss: 0.0508
Epoch 48/80
 - 2s - loss: 0.0507
Epoch 49/80
 - 2s - loss: 0.0506
Epoch 50/80
 - 2s - loss: 0.0505
Epoch 51/80
 - 2s - loss: 0.0504
Epoch 52/80
 - 2s - loss: 0.0504
Epoch 53/80
 - 2s - loss: 0.0503
Epoch 54/80
 - 2s - loss: 0.0503
Epoch 55/80
 - 2s - loss: 0.0502
Epoch 56/80
 - 2s - loss: 0.0502
Epoch 57/80
 - 2s - loss: 0.0501
Epoch 58/80
 - 2s - loss: 0.0501
Epoch 59/80
 - 2s - loss: 0.0500
Epoch 60/80
 - 2s - loss: 0.0500
Epoch 61/80
 - 2s - loss: 0.0499
Epoch 62/80
 - 2s - loss: 0.0499
Epoch 63/80
 - 2s - loss: 0.0488
Epoch 64/80
 - 2s - loss: 0.0487
Epoch 65/80
 - 2s - loss: 0.0487
Epoch 66/80
 - 2s - loss: 0.0487
Epoch 67/80
 - 2s - loss: 0.0486
Epoch 68/80
 - 2s - loss: 0.0484
Epoch 69/80
 - 2s - loss: 0.0484
Epoch 70/80
 - 2s - loss: 0.0484
Epoch 71/80
 - 2s - loss: 0.0484
Epoch 72/80
 - 2s - loss: 0.0483
Epoch 73/80
 - 2s - loss: 0.0483
Epoch 74/80
 - 2s - loss: 0.0483
Epoch 75/80
 - 2s - loss: 0.0483
Epoch 76/80
 - 2s - loss: 0.0483
Epoch 77/80
 - 2s - loss: 0.0483
Epoch 78/80
 - 2s - loss: 0.0483
Epoch 79/80
 - 2s - loss: 0.0483
Epoch 80/80
 - 2s - loss: 0.0483
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 7.5602 - val_loss: 1.9035
AUC: 0.7145

Epoch 2/80
 - 0s - loss: 3.5865 - val_loss: 1.4671
AUC: 0.7910

Epoch 3/80
 - 0s - loss: 2.4313 - val_loss: 0.9120
AUC: 0.8154

Epoch 4/80
 - 0s - loss: 1.6985 - val_loss: 0.7422
AUC: 0.8367

Epoch 5/80
 - 0s - loss: 1.3650 - val_loss: 0.7398
AUC: 0.8462

Epoch 6/80
 - 0s - loss: 1.2434 - val_loss: 0.7121
AUC: 0.8498

Epoch 7/80
 - 0s - loss: 1.1899 - val_loss: 0.7349
AUC: 0.8556

Epoch 8/80
 - 0s - loss: 1.1626 - val_loss: 0.7417
AUC: 0.8570

Epoch 9/80
 - 0s - loss: 1.1326 - val_loss: 0.6516
AUC: 0.8580

Epoch 10/80
 - 0s - loss: 1.1084 - val_loss: 0.6910
AUC: 0.8616

Epoch 11/80
 - 0s - loss: 1.0949 - val_loss: 0.6279
AUC: 0.8616

Epoch 12/80
 - 0s - loss: 1.0833 - val_loss: 0.7177
AUC: 0.8630

Epoch 13/80
 - 0s - loss: 1.0867 - val_loss: 0.6160
AUC: 0.8625

Epoch 14/80
 - 0s - loss: 1.0737 - val_loss: 0.6775
AUC: 0.8642

Epoch 15/80
 - 0s - loss: 1.0713 - val_loss: 0.6939
AUC: 0.8650

Epoch 16/80
 - 0s - loss: 1.0599 - val_loss: 0.6296
AUC: 0.8645

Epoch 17/80
 - 0s - loss: 1.0562 - val_loss: 0.6781
AUC: 0.8657

Epoch 18/80
 - 0s - loss: 1.0547 - val_loss: 0.5915
AUC: 0.8638

Epoch 19/80
 - 0s - loss: 1.0572 - val_loss: 0.6790
AUC: 0.8652

Epoch 20/80
 - 0s - loss: 1.0381 - val_loss: 0.6874
AUC: 0.8659

Epoch 21/80
 - 0s - loss: 1.0331 - val_loss: 0.6083
AUC: 0.8654

Epoch 22/80
 - 0s - loss: 1.0405 - val_loss: 0.6135
AUC: 0.8656

Epoch 23/80
 - 0s - loss: 1.0373 - val_loss: 0.6188
AUC: 0.8665

Epoch 24/80
 - 0s - loss: 1.0276 - val_loss: 0.5753
AUC: 0.8682

Epoch 25/80
 - 0s - loss: 1.0286 - val_loss: 0.6292
AUC: 0.8675

Epoch 26/80
 - 0s - loss: 1.0248 - val_loss: 0.5838
AUC: 0.8682

Epoch 27/80
 - 0s - loss: 1.0216 - val_loss: 0.5869
AUC: 0.8684

Epoch 28/80
 - 0s - loss: 1.0163 - val_loss: 0.6088
AUC: 0.8693

Epoch 29/80
 - 0s - loss: 1.0217 - val_loss: 0.6521
AUC: 0.8702

Epoch 30/80
 - 0s - loss: 1.0120 - val_loss: 0.6044
AUC: 0.8690

Epoch 31/80
 - 0s - loss: 1.0180 - val_loss: 0.5950
AUC: 0.8697

Epoch 32/80
 - 0s - loss: 1.0142 - val_loss: 0.6667
AUC: 0.8706

Epoch 33/80
 - 0s - loss: 1.0119 - val_loss: 0.6908
AUC: 0.8685

Epoch 34/80
 - 0s - loss: 1.0063 - val_loss: 0.5968
AUC: 0.8691

Epoch 35/80
 - 0s - loss: 1.0034 - val_loss: 0.6311
AUC: 0.8709

Epoch 36/80
 - 0s - loss: 0.9945 - val_loss: 0.6092
AUC: 0.8708

Epoch 37/80
 - 0s - loss: 1.0001 - val_loss: 0.6134
AUC: 0.8709

Epoch 38/80
 - 0s - loss: 0.9900 - val_loss: 0.6294
AUC: 0.8710

Epoch 39/80
 - 0s - loss: 0.9956 - val_loss: 0.6358
AUC: 0.8710

Epoch 40/80
 - 0s - loss: 0.9931 - val_loss: 0.6133
AUC: 0.8710

Epoch 41/80
 - 0s - loss: 0.9980 - val_loss: 0.6198
AUC: 0.8714

Epoch 42/80
 - 0s - loss: 0.9895 - val_loss: 0.6019
AUC: 0.8711

Epoch 43/80
 - 0s - loss: 0.9919 - val_loss: 0.6120
AUC: 0.8712

Epoch 44/80
 - 0s - loss: 0.9934 - val_loss: 0.6328
AUC: 0.8714

Epoch 45/80
 - 0s - loss: 0.9899 - val_loss: 0.6092
AUC: 0.8713

Epoch 46/80
 - 0s - loss: 0.9934 - val_loss: 0.6008
AUC: 0.8712

Epoch 47/80
 - 0s - loss: 0.9848 - val_loss: 0.6092
AUC: 0.8713

Epoch 48/80
 - 0s - loss: 0.9835 - val_loss: 0.6092
AUC: 0.8713

Epoch 49/80
 - 0s - loss: 0.9872 - val_loss: 0.6117
AUC: 0.8714

Epoch 50/80
 - 0s - loss: 0.9911 - val_loss: 0.6111
AUC: 0.8714

Epoch 51/80
 - 0s - loss: 0.9865 - val_loss: 0.6141
AUC: 0.8714

Epoch 52/80
 - 0s - loss: 0.9864 - val_loss: 0.6058
AUC: 0.8713

Epoch 53/80
 - 0s - loss: 0.9842 - val_loss: 0.6093
AUC: 0.8713

Epoch 54/80
 - 0s - loss: 0.9843 - val_loss: 0.6140
AUC: 0.8714

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9922 - val_loss: 0.5967
AUC: 0.8712

Epoch 2/30
 - 0s - loss: 0.9941 - val_loss: 0.6176
AUC: 0.8710

Epoch 3/30
 - 0s - loss: 0.9910 - val_loss: 0.6095
AUC: 0.8714

Epoch 4/30
 - 0s - loss: 0.9824 - val_loss: 0.5949
AUC: 0.8713

Epoch 5/30
 - 0s - loss: 0.9845 - val_loss: 0.5950
AUC: 0.8715

Epoch 6/30
 - 0s - loss: 0.9859 - val_loss: 0.6120
AUC: 0.8718

Epoch 7/30
 - 0s - loss: 0.9806 - val_loss: 0.6117
AUC: 0.8718

Epoch 8/30
 - 1s - loss: 0.9854 - val_loss: 0.6128
AUC: 0.8720

Epoch 9/30
 - 1s - loss: 0.9870 - val_loss: 0.5855
AUC: 0.8717

Epoch 10/30
 - 0s - loss: 0.9767 - val_loss: 0.5964
AUC: 0.8720

Epoch 11/30
 - 0s - loss: 0.9824 - val_loss: 0.6048
AUC: 0.8723

Epoch 12/30
 - 1s - loss: 0.9787 - val_loss: 0.6237
AUC: 0.8727

Epoch 13/30
 - 1s - loss: 0.9799 - val_loss: 0.6293
AUC: 0.8726

Epoch 14/30
 - 1s - loss: 0.9766 - val_loss: 0.6074
AUC: 0.8722

Epoch 15/30
 - 1s - loss: 0.9733 - val_loss: 0.5930
AUC: 0.8724

Epoch 16/30
 - 1s - loss: 0.9756 - val_loss: 0.6106
AUC: 0.8729

Epoch 17/30
 - 0s - loss: 0.9721 - val_loss: 0.5930
AUC: 0.8728

Epoch 18/30
 - 0s - loss: 0.9689 - val_loss: 0.6181
AUC: 0.8731

Epoch 19/30
 - 0s - loss: 0.9728 - val_loss: 0.5974
AUC: 0.8729

Epoch 20/30
 - 0s - loss: 0.9665 - val_loss: 0.5997
AUC: 0.8729

Epoch 21/30
 - 0s - loss: 0.9630 - val_loss: 0.6037
AUC: 0.8730

Epoch 22/30
 - 0s - loss: 0.9657 - val_loss: 0.5996
AUC: 0.8728

Epoch 23/30
 - 0s - loss: 0.9673 - val_loss: 0.6041
AUC: 0.8729

Epoch 24/30
 - 0s - loss: 0.9675 - val_loss: 0.6017
AUC: 0.8729

Epoch 25/30
 - 0s - loss: 0.9719 - val_loss: 0.6020
AUC: 0.8729

Epoch 26/30
 - 0s - loss: 0.9656 - val_loss: 0.5982
AUC: 0.8729

Epoch 27/30
 - 0s - loss: 0.9664 - val_loss: 0.5993
AUC: 0.8729

Epoch 28/30
 - 0s - loss: 0.9678 - val_loss: 0.5973
AUC: 0.8729

Epoch 29/30
 - 0s - loss: 0.9691 - val_loss: 0.6048
AUC: 0.8730

Epoch 30/30
 - 0s - loss: 0.9685 - val_loss: 0.6034
Using TensorFlow backend.
AUC: 0.8730

2019-03-08 03:40:25.780727: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:40:25.948013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:40:25.948060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:40:26.251058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:40:26.251114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:40:26.251124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:40:26.251383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1520
Epoch 2/80
 - 2s - loss: 0.2176
Epoch 3/80
 - 2s - loss: 0.1681
Epoch 4/80
 - 2s - loss: 0.1549
Epoch 5/80
 - 2s - loss: 0.1450
Epoch 6/80
 - 2s - loss: 0.1373
Epoch 7/80
 - 2s - loss: 0.1303
Epoch 8/80
 - 2s - loss: 0.1235
Epoch 9/80
 - 2s - loss: 0.1165
Epoch 10/80
 - 2s - loss: 0.1095
Epoch 11/80
 - 2s - loss: 0.1027
Epoch 12/80
 - 2s - loss: 0.0962
Epoch 13/80
 - 2s - loss: 0.0901
Epoch 14/80
 - 2s - loss: 0.0845
Epoch 15/80
 - 2s - loss: 0.0795
Epoch 16/80
 - 2s - loss: 0.0751
Epoch 17/80
 - 2s - loss: 0.0712
Epoch 18/80
 - 2s - loss: 0.0681
Epoch 19/80
 - 2s - loss: 0.0655
Epoch 20/80
 - 2s - loss: 0.0634
Epoch 21/80
 - 2s - loss: 0.0616
Epoch 22/80
 - 2s - loss: 0.0601
Epoch 23/80
 - 2s - loss: 0.0588
Epoch 24/80
 - 2s - loss: 0.0578
Epoch 25/80
 - 2s - loss: 0.0568
Epoch 26/80
 - 2s - loss: 0.0560
Epoch 27/80
 - 2s - loss: 0.0553
Epoch 28/80
 - 2s - loss: 0.0547
Epoch 29/80
 - 2s - loss: 0.0542
Epoch 30/80
 - 2s - loss: 0.0538
Epoch 31/80
 - 2s - loss: 0.0534
Epoch 32/80
 - 2s - loss: 0.0531
Epoch 33/80
 - 2s - loss: 0.0528
Epoch 34/80
 - 2s - loss: 0.0525
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:41:52.044934: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:41:52.213362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:41:52.213409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:41:52.511797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:41:52.511853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:41:52.511862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:41:52.512120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1779
Epoch 2/80
 - 2s - loss: 0.2174
Epoch 3/80
 - 2s - loss: 0.1705
Epoch 4/80
 - 2s - loss: 0.1584
Epoch 5/80
 - 2s - loss: 0.1473
Epoch 6/80
 - 2s - loss: 0.1385
Epoch 7/80
 - 2s - loss: 0.1315
Epoch 8/80
 - 2s - loss: 0.1251
Epoch 9/80
 - 2s - loss: 0.1187
Epoch 10/80
 - 2s - loss: 0.1116
Epoch 11/80
 - 2s - loss: 0.1041
Epoch 12/80
 - 2s - loss: 0.0969
Epoch 13/80
 - 2s - loss: 0.0902
Epoch 14/80
 - 2s - loss: 0.0844
Epoch 15/80
 - 2s - loss: 0.0794
Epoch 16/80
 - 2s - loss: 0.0751
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:42:45.972582: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:42:46.140410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:42:46.140457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:42:46.443931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:42:46.443988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:42:46.443998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:42:46.444279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1837
Epoch 2/80
 - 2s - loss: 0.2217
Epoch 3/80
 - 2s - loss: 0.1674
Epoch 4/80
 - 2s - loss: 0.1519
Epoch 5/80
 - 2s - loss: 0.1409
Epoch 6/80
 - 2s - loss: 0.1325
Epoch 7/80
 - 2s - loss: 0.1251
Epoch 8/80
 - 2s - loss: 0.1183
Epoch 9/80
 - 2s - loss: 0.1117
Epoch 10/80
 - 2s - loss: 0.1052
Epoch 11/80
 - 2s - loss: 0.0986
Epoch 12/80
 - 2s - loss: 0.0923
Epoch 13/80
 - 2s - loss: 0.0867
Epoch 14/80
 - 2s - loss: 0.0818
Epoch 15/80
 - 2s - loss: 0.0774
Epoch 16/80
 - 2s - loss: 0.0736
Epoch 17/80
 - 2s - loss: 0.0703
Epoch 18/80
 - 2s - loss: 0.0675
Epoch 19/80
 - 2s - loss: 0.0652
Epoch 20/80
 - 2s - loss: 0.0632
Epoch 21/80
 - 2s - loss: 0.0615
Epoch 22/80
 - 2s - loss: 0.0600
Epoch 23/80
 - 2s - loss: 0.0588
Epoch 24/80
 - 2s - loss: 0.0577
Epoch 25/80
 - 2s - loss: 0.0568
Epoch 26/80
 - 2s - loss: 0.0560
Epoch 27/80
 - 2s - loss: 0.0553
Epoch 28/80
 - 2s - loss: 0.0547
Epoch 29/80
 - 2s - loss: 0.0542
Epoch 30/80
 - 2s - loss: 0.0538
Epoch 31/80
 - 2s - loss: 0.0534
Epoch 32/80
 - 2s - loss: 0.0531
Epoch 33/80
 - 2s - loss: 0.0528
Epoch 34/80
 - 2s - loss: 0.0526
Epoch 35/80
 - 2s - loss: 0.0523
Epoch 36/80
 - 2s - loss: 0.0521
Epoch 37/80
 - 2s - loss: 0.0519
Epoch 38/80
 - 2s - loss: 0.0518
Epoch 39/80
 - 2s - loss: 0.0516
Epoch 40/80
 - 2s - loss: 0.0515
Epoch 41/80
 - 2s - loss: 0.0514
Epoch 42/80
 - 2s - loss: 0.0512
Epoch 43/80
 - 2s - loss: 0.0511
Epoch 44/80
 - 2s - loss: 0.0510
Epoch 45/80
 - 2s - loss: 0.0509
Epoch 46/80
 - 2s - loss: 0.0509
Epoch 47/80
 - 2s - loss: 0.0508
Epoch 48/80
 - 2s - loss: 0.0507
Epoch 49/80
 - 2s - loss: 0.0507
Epoch 50/80
 - 2s - loss: 0.0506
Epoch 51/80
 - 2s - loss: 0.0505
Epoch 52/80
 - 2s - loss: 0.0505
Epoch 53/80
 - 2s - loss: 0.0504
Epoch 54/80
 - 2s - loss: 0.0504
Epoch 55/80
 - 2s - loss: 0.0504
Epoch 56/80
 - 2s - loss: 0.0503
Epoch 57/80
 - 2s - loss: 0.0503
Epoch 58/80
 - 2s - loss: 0.0502
Epoch 59/80
 - 2s - loss: 0.0502
Epoch 60/80
 - 2s - loss: 0.0491
Epoch 61/80
 - 2s - loss: 0.0490
Epoch 62/80
 - 2s - loss: 0.0490
Epoch 63/80
 - 2s - loss: 0.0490
Epoch 64/80
 - 2s - loss: 0.0489
Epoch 65/80
 - 2s - loss: 0.0487
Epoch 66/80
 - 2s - loss: 0.0487
Epoch 67/80
 - 2s - loss: 0.0487
Epoch 68/80
 - 2s - loss: 0.0487
Epoch 69/80
 - 2s - loss: 0.0486
Epoch 70/80
 - 2s - loss: 0.0486
Epoch 71/80
 - 2s - loss: 0.0486
Epoch 72/80
 - 2s - loss: 0.0486
Epoch 73/80
 - 2s - loss: 0.0486
Epoch 74/80
 - 2s - loss: 0.0486
Epoch 75/80
 - 2s - loss: 0.0486
Epoch 76/80
 - 2s - loss: 0.0486
Epoch 77/80
 - 2s - loss: 0.0486
Epoch 78/80
 - 2s - loss: 0.0486
Epoch 79/80
 - 2s - loss: 0.0486
Epoch 80/80
 - 2s - loss: 0.0486
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 5.9811 - val_loss: 1.8637
AUC: 0.7537

Epoch 2/80
 - 0s - loss: 2.9525 - val_loss: 1.0656
AUC: 0.8135

Epoch 3/80
 - 0s - loss: 2.0914 - val_loss: 0.8069
AUC: 0.8245

Epoch 4/80
 - 0s - loss: 1.5634 - val_loss: 0.6868
AUC: 0.8325

Epoch 5/80
 - 0s - loss: 1.3108 - val_loss: 0.7940
AUC: 0.8413

Epoch 6/80
 - 0s - loss: 1.2117 - val_loss: 0.8151
AUC: 0.8432

Epoch 7/80
 - 0s - loss: 1.1712 - val_loss: 0.7487
AUC: 0.8449

Epoch 8/80
 - 0s - loss: 1.1341 - val_loss: 0.6736
AUC: 0.8474

Epoch 9/80
 - 0s - loss: 1.1207 - val_loss: 0.6443
AUC: 0.8488

Epoch 10/80
 - 0s - loss: 1.1107 - val_loss: 0.6464
AUC: 0.8510

Epoch 11/80
 - 0s - loss: 1.0939 - val_loss: 0.6580
AUC: 0.8518

Epoch 12/80
 - 0s - loss: 1.0831 - val_loss: 0.6769
AUC: 0.8532

Epoch 13/80
 - 0s - loss: 1.0871 - val_loss: 0.6754
AUC: 0.8538

Epoch 14/80
 - 0s - loss: 1.0709 - val_loss: 0.6524
AUC: 0.8545

Epoch 15/80
 - 0s - loss: 1.0628 - val_loss: 0.6800
AUC: 0.8557

Epoch 16/80
 - 0s - loss: 1.0591 - val_loss: 0.5668
AUC: 0.8540

Epoch 17/80
 - 0s - loss: 1.0624 - val_loss: 0.5978
AUC: 0.8560

Epoch 18/80
 - 0s - loss: 1.0537 - val_loss: 0.7456
AUC: 0.8593

Epoch 19/80
 - 0s - loss: 1.0522 - val_loss: 0.6505
AUC: 0.8586

Epoch 20/80
 - 0s - loss: 1.0429 - val_loss: 0.6962
AUC: 0.8586

Epoch 21/80
 - 0s - loss: 1.0386 - val_loss: 0.6773
AUC: 0.8587

Epoch 22/80
 - 0s - loss: 1.0329 - val_loss: 0.6118
AUC: 0.8588

Epoch 23/80
 - 0s - loss: 1.0251 - val_loss: 0.5816
AUC: 0.8601

Epoch 24/80
 - 0s - loss: 1.0273 - val_loss: 0.5889
AUC: 0.8603

Epoch 25/80
 - 0s - loss: 1.0206 - val_loss: 0.6741
AUC: 0.8615

Epoch 26/80
 - 0s - loss: 1.0203 - val_loss: 0.6151
AUC: 0.8622

Epoch 27/80
 - 0s - loss: 1.0093 - val_loss: 0.6127
AUC: 0.8620

Epoch 28/80
 - 0s - loss: 1.0082 - val_loss: 0.6659
AUC: 0.8624

Epoch 29/80
 - 0s - loss: 1.0089 - val_loss: 0.6289
AUC: 0.8624

Epoch 30/80
 - 0s - loss: 1.0052 - val_loss: 0.6349
AUC: 0.8623

Epoch 31/80
 - 0s - loss: 1.0050 - val_loss: 0.6256
AUC: 0.8622

Epoch 32/80
 - 0s - loss: 1.0031 - val_loss: 0.6278
AUC: 0.8629

Epoch 33/80
 - 0s - loss: 0.9968 - val_loss: 0.6532
AUC: 0.8625

Epoch 34/80
 - 0s - loss: 1.0016 - val_loss: 0.6410
AUC: 0.8626

Epoch 35/80
 - 0s - loss: 1.0000 - val_loss: 0.6335
AUC: 0.8625

Epoch 36/80
 - 0s - loss: 1.0028 - val_loss: 0.6469
AUC: 0.8629

Epoch 37/80
 - 0s - loss: 1.0015 - val_loss: 0.6251
AUC: 0.8628

Epoch 38/80
 - 0s - loss: 0.9984 - val_loss: 0.6275
AUC: 0.8630

Epoch 39/80
 - 0s - loss: 0.9947 - val_loss: 0.6180
AUC: 0.8629

Epoch 40/80
 - 0s - loss: 1.0000 - val_loss: 0.6246
AUC: 0.8630

Epoch 41/80
 - 0s - loss: 0.9993 - val_loss: 0.6271
AUC: 0.8631

Epoch 42/80
 - 0s - loss: 0.9972 - val_loss: 0.6180
AUC: 0.8630

Epoch 43/80
 - 0s - loss: 0.9985 - val_loss: 0.6319
AUC: 0.8632

Epoch 44/80
 - 0s - loss: 0.9972 - val_loss: 0.6112
AUC: 0.8631

Epoch 45/80
 - 0s - loss: 1.0000 - val_loss: 0.6344
AUC: 0.8633

Epoch 46/80
 - 0s - loss: 0.9970 - val_loss: 0.6182
AUC: 0.8632

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9990 - val_loss: 0.6115
AUC: 0.8632

Epoch 2/30
 - 0s - loss: 0.9996 - val_loss: 0.6312
AUC: 0.8636

Epoch 3/30
 - 0s - loss: 0.9951 - val_loss: 0.6157
AUC: 0.8637

Epoch 4/30
 - 0s - loss: 0.9974 - val_loss: 0.6149
AUC: 0.8639

Epoch 5/30
 - 0s - loss: 0.9923 - val_loss: 0.6176
AUC: 0.8639

Epoch 6/30
 - 0s - loss: 0.9966 - val_loss: 0.6159
AUC: 0.8643

Epoch 7/30
 - 0s - loss: 0.9848 - val_loss: 0.6292
AUC: 0.8645

Epoch 8/30
 - 0s - loss: 0.9856 - val_loss: 0.6443
AUC: 0.8647

Epoch 9/30
 - 0s - loss: 0.9870 - val_loss: 0.6129
AUC: 0.8647

Epoch 10/30
 - 0s - loss: 0.9853 - val_loss: 0.6237
AUC: 0.8649

Epoch 11/30
 - 0s - loss: 0.9843 - val_loss: 0.6364
AUC: 0.8650

Epoch 12/30
 - 0s - loss: 0.9824 - val_loss: 0.6151
AUC: 0.8650

Epoch 13/30
 - 0s - loss: 0.9823 - val_loss: 0.6134
AUC: 0.8650

Epoch 14/30
 - 0s - loss: 0.9838 - val_loss: 0.6129
AUC: 0.8651

Epoch 15/30
 - 0s - loss: 0.9840 - val_loss: 0.6151
AUC: 0.8651

Epoch 16/30
 - 0s - loss: 0.9803 - val_loss: 0.6089
AUC: 0.8651

Epoch 17/30
 - 0s - loss: 0.9818 - val_loss: 0.6155
AUC: 0.8651

Epoch 18/30
 - 0s - loss: 0.9845 - val_loss: 0.6118
AUC: 0.8650

Epoch 19/30
 - 0s - loss: 0.9823 - val_loss: 0.6114
AUC: 0.8651

Epoch 20/30
 - 0s - loss: 0.9779 - val_loss: 0.6156
AUC: 0.8652

Epoch 21/30
 - 0s - loss: 0.9768 - val_loss: 0.6137
AUC: 0.8652

Epoch 22/30
 - 0s - loss: 0.9863 - val_loss: 0.6129
AUC: 0.8652

Epoch 23/30
 - 0s - loss: 0.9823 - val_loss: 0.6095
AUC: 0.8652

Epoch 24/30
 - 0s - loss: 0.9813 - val_loss: 0.6149
AUC: 0.8653

Epoch 25/30
 - 0s - loss: 0.9835 - val_loss: 0.6131
AUC: 0.8653

Epoch 26/30
 - 0s - loss: 0.9770 - val_loss: 0.6118
AUC: 0.8653

Epoch 27/30
 - 0s - loss: 0.9763 - val_loss: 0.6114
AUC: 0.8654

Epoch 28/30
 - 0s - loss: 0.9776 - val_loss: 0.6128
AUC: 0.8654

Epoch 29/30
 - 0s - loss: 0.9790 - val_loss: 0.6127
AUC: 0.8654

Epoch 30/30
 - 0s - loss: 0.9754 - val_loss: 0.6130
Using TensorFlow backend.
AUC: 0.8654

2019-03-08 03:46:39.125286: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:46:39.293139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:46:39.293185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:46:39.593630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:46:39.593686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:46:39.593694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:46:39.593968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6901
Epoch 2/80
 - 2s - loss: 0.1304
Epoch 3/80
 - 2s - loss: 0.0725
Epoch 4/80
 - 2s - loss: 0.0662
Epoch 5/80
 - 2s - loss: 0.0638
Epoch 6/80
 - 2s - loss: 0.0620
Epoch 7/80
 - 2s - loss: 0.0600
Epoch 8/80
 - 2s - loss: 0.0575
Epoch 9/80
 - 2s - loss: 0.0544
Epoch 10/80
 - 2s - loss: 0.0507
Epoch 11/80
 - 2s - loss: 0.0463
Epoch 12/80
 - 2s - loss: 0.0420
Epoch 13/80
 - 2s - loss: 0.0382
Epoch 14/80
 - 2s - loss: 0.0350
Epoch 15/80
 - 2s - loss: 0.0324
Epoch 16/80
 - 2s - loss: 0.0302
Epoch 17/80
 - 2s - loss: 0.0284
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:47:31.095689: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:47:31.264045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:47:31.264094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:47:31.565622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:47:31.565677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:47:31.565696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:47:31.565968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6915
Epoch 2/80
 - 2s - loss: 0.1327
Epoch 3/80
 - 2s - loss: 0.0712
Epoch 4/80
 - 2s - loss: 0.0635
Epoch 5/80
 - 2s - loss: 0.0590
Epoch 6/80
 - 2s - loss: 0.0560
Epoch 7/80
 - 2s - loss: 0.0535
Epoch 8/80
 - 2s - loss: 0.0513
Epoch 9/80
 - 2s - loss: 0.0491
Epoch 10/80
 - 2s - loss: 0.0468
Epoch 11/80
 - 2s - loss: 0.0443
Epoch 12/80
 - 2s - loss: 0.0416
Epoch 13/80
 - 2s - loss: 0.0387
Epoch 14/80
 - 2s - loss: 0.0358
Epoch 15/80
 - 2s - loss: 0.0331
Epoch 16/80
 - 2s - loss: 0.0309
Epoch 17/80
 - 2s - loss: 0.0289
Epoch 18/80
 - 2s - loss: 0.0273
Epoch 19/80
 - 2s - loss: 0.0259
Epoch 20/80
 - 2s - loss: 0.0246
Epoch 21/80
 - 2s - loss: 0.0235
Epoch 22/80
 - 2s - loss: 0.0226
Epoch 23/80
 - 2s - loss: 0.0218
Epoch 24/80
 - 2s - loss: 0.0211
Epoch 25/80
 - 2s - loss: 0.0205
Epoch 26/80
 - 2s - loss: 0.0200
Epoch 27/80
 - 2s - loss: 0.0196
Epoch 28/80
 - 2s - loss: 0.0192
Epoch 29/80
 - 2s - loss: 0.0189
Epoch 30/80
 - 2s - loss: 0.0186
Epoch 31/80
 - 2s - loss: 0.0184
Epoch 32/80
 - 2s - loss: 0.0182
Epoch 33/80
 - 2s - loss: 0.0180
Epoch 34/80
 - 2s - loss: 0.0178
Epoch 35/80
 - 2s - loss: 0.0177
Epoch 36/80
 - 2s - loss: 0.0176
Epoch 37/80
 - 2s - loss: 0.0175
Epoch 38/80
 - 2s - loss: 0.0173
Epoch 39/80
 - 2s - loss: 0.0173
Epoch 40/80
 - 2s - loss: 0.0172
Epoch 41/80
 - 2s - loss: 0.0171
Epoch 42/80
 - 2s - loss: 0.0170
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:49:12.880298: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:49:13.049004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:49:13.049071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:49:13.354439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:49:13.354495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:49:13.354504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:49:13.354775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6999
Epoch 2/80
 - 2s - loss: 0.1359
Epoch 3/80
 - 2s - loss: 0.0720
Epoch 4/80
 - 2s - loss: 0.0647
Epoch 5/80
 - 2s - loss: 0.0598
Epoch 6/80
 - 2s - loss: 0.0554
Epoch 7/80
 - 2s - loss: 0.0518
Epoch 8/80
 - 2s - loss: 0.0489
Epoch 9/80
 - 2s - loss: 0.0463
Epoch 10/80
 - 2s - loss: 0.0438
Epoch 11/80
 - 2s - loss: 0.0412
Epoch 12/80
 - 2s - loss: 0.0387
Epoch 13/80
 - 2s - loss: 0.0362
Epoch 14/80
 - 2s - loss: 0.0338
Epoch 15/80
 - 2s - loss: 0.0316
Epoch 16/80
 - 2s - loss: 0.0297
Epoch 17/80
 - 2s - loss: 0.0280
Epoch 18/80
 - 2s - loss: 0.0266
Epoch 19/80
 - 2s - loss: 0.0254
Epoch 20/80
 - 2s - loss: 0.0243
Epoch 21/80
 - 2s - loss: 0.0234
Epoch 22/80
 - 2s - loss: 0.0225
Epoch 23/80
 - 2s - loss: 0.0218
Epoch 24/80
 - 2s - loss: 0.0211
Epoch 25/80
 - 2s - loss: 0.0205
Epoch 26/80
 - 2s - loss: 0.0200
Epoch 27/80
 - 2s - loss: 0.0196
Epoch 28/80
 - 2s - loss: 0.0192
Epoch 29/80
 - 2s - loss: 0.0189
Epoch 30/80
 - 2s - loss: 0.0186
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:50:34.316894: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:50:34.482417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:50:34.482474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:50:34.786475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:50:34.786529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:50:34.786538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:50:34.786810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.4359
Epoch 2/80
 - 2s - loss: 0.3610
Epoch 3/80
 - 2s - loss: 0.2897
Epoch 4/80
 - 2s - loss: 0.2599
Epoch 5/80
 - 2s - loss: 0.2402
Epoch 6/80
 - 2s - loss: 0.2250
Epoch 7/80
 - 2s - loss: 0.2119
Epoch 8/80
 - 2s - loss: 0.1997
Epoch 9/80
 - 2s - loss: 0.1885
Epoch 10/80
 - 2s - loss: 0.1786
Epoch 11/80
 - 2s - loss: 0.1701
Epoch 12/80
 - 2s - loss: 0.1627
Epoch 13/80
 - 2s - loss: 0.1562
Epoch 14/80
 - 2s - loss: 0.1508
Epoch 15/80
 - 2s - loss: 0.1460
Epoch 16/80
 - 2s - loss: 0.1420
Epoch 17/80
 - 2s - loss: 0.1385
Epoch 18/80
 - 2s - loss: 0.1354
Epoch 19/80
 - 2s - loss: 0.1328
Epoch 20/80
 - 2s - loss: 0.1306
Epoch 21/80
 - 2s - loss: 0.1285
Epoch 22/80
 - 2s - loss: 0.1268
Epoch 23/80
 - 2s - loss: 0.1252
Epoch 24/80
 - 2s - loss: 0.1238
Epoch 25/80
 - 2s - loss: 0.1226
Epoch 26/80
 - 2s - loss: 0.1215
Epoch 27/80
 - 2s - loss: 0.1206
Epoch 28/80
 - 2s - loss: 0.1198
Epoch 29/80
 - 2s - loss: 0.1191
Epoch 30/80
 - 2s - loss: 0.1185
Epoch 31/80
 - 2s - loss: 0.1181
Epoch 32/80
 - 2s - loss: 0.1176
Epoch 33/80
 - 2s - loss: 0.1173
Epoch 34/80
 - 2s - loss: 0.1170
Epoch 35/80
 - 2s - loss: 0.1167
Epoch 36/80
 - 2s - loss: 0.1164
Epoch 37/80
 - 2s - loss: 0.1162
Epoch 38/80
 - 2s - loss: 0.1160
Epoch 39/80
 - 2s - loss: 0.1158
Epoch 40/80
 - 2s - loss: 0.1156
Epoch 41/80
 - 2s - loss: 0.1155
Epoch 42/80
 - 2s - loss: 0.1154
Epoch 43/80
 - 2s - loss: 0.1152
Epoch 44/80
 - 2s - loss: 0.1151
Epoch 45/80
 - 2s - loss: 0.1150
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:52:25.269898: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:52:25.443515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:52:25.443561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:52:25.747099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:52:25.747147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:52:25.747156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:52:25.747422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3533
Epoch 2/80
 - 2s - loss: 0.3499
Epoch 3/80
 - 2s - loss: 0.3100
Epoch 4/80
 - 2s - loss: 0.2986
Epoch 5/80
 - 2s - loss: 0.2850
Epoch 6/80
 - 2s - loss: 0.2676
Epoch 7/80
 - 2s - loss: 0.2476
Epoch 8/80
 - 2s - loss: 0.2277
Epoch 9/80
 - 2s - loss: 0.2106
Epoch 10/80
 - 2s - loss: 0.1961
Epoch 11/80
 - 2s - loss: 0.1831
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2b32fdc16198>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 03:53:05.472303: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:53:05.638550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:53:05.638595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:53:05.941036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:53:05.941088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:53:05.941098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:53:05.941363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3789
Epoch 2/80
 - 2s - loss: 0.3527
Epoch 3/80
 - 2s - loss: 0.3098
Epoch 4/80
 - 2s - loss: 0.2976
Epoch 5/80
 - 2s - loss: 0.2819
Epoch 6/80
 - 2s - loss: 0.2596
Epoch 7/80
 - 2s - loss: 0.2348
Epoch 8/80
 - 2s - loss: 0.2144
Epoch 9/80
 - 2s - loss: 0.2001
Epoch 10/80
 - 2s - loss: 0.1890
Epoch 11/80
 - 2s - loss: 0.1793
Epoch 12/80
 - 2s - loss: 0.1705
Epoch 13/80
 - 2s - loss: 0.1630
Epoch 14/80
 - 2s - loss: 0.1565
Epoch 15/80
 - 2s - loss: 0.1509
Epoch 16/80
 - 2s - loss: 0.1460
Epoch 17/80
 - 2s - loss: 0.1417
Epoch 18/80
 - 2s - loss: 0.1379
Epoch 19/80
 - 2s - loss: 0.1347
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:54:05.443228: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:54:05.611091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:54:05.611137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:54:05.913107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:54:05.913161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:54:05.913170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:54:05.913449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1336
Epoch 2/80
 - 2s - loss: 0.2157
Epoch 3/80
 - 2s - loss: 0.1722
Epoch 4/80
 - 2s - loss: 0.1626
Epoch 5/80
 - 2s - loss: 0.1534
Epoch 6/80
 - 2s - loss: 0.1445
Epoch 7/80
 - 2s - loss: 0.1360
Epoch 8/80
 - 2s - loss: 0.1273
Epoch 9/80
 - 2s - loss: 0.1188
Epoch 10/80
 - 2s - loss: 0.1112
Epoch 11/80
 - 2s - loss: 0.1040
Epoch 12/80
 - 2s - loss: 0.0970
Epoch 13/80
 - 2s - loss: 0.0904
Epoch 14/80
 - 2s - loss: 0.0846
Epoch 15/80
 - 2s - loss: 0.0796
Epoch 16/80
 - 2s - loss: 0.0752
Epoch 17/80
 - 2s - loss: 0.0715
Epoch 18/80
 - 2s - loss: 0.0684
Epoch 19/80
 - 2s - loss: 0.0658
Epoch 20/80
 - 2s - loss: 0.0636
Epoch 21/80
 - 2s - loss: 0.0618
Epoch 22/80
 - 2s - loss: 0.0603
Epoch 23/80
 - 2s - loss: 0.0590
Epoch 24/80
 - 2s - loss: 0.0579
Epoch 25/80
 - 2s - loss: 0.0569
Epoch 26/80
 - 2s - loss: 0.0561
Epoch 27/80
 - 2s - loss: 0.0554
Epoch 28/80
 - 2s - loss: 0.0548
Epoch 29/80
 - 2s - loss: 0.0543
Epoch 30/80
 - 2s - loss: 0.0538
Epoch 31/80
 - 2s - loss: 0.0534
Epoch 32/80
 - 2s - loss: 0.0530
Epoch 33/80
 - 2s - loss: 0.0527
Epoch 34/80
 - 2s - loss: 0.0524
Epoch 35/80
 - 2s - loss: 0.0522
Epoch 36/80
 - 2s - loss: 0.0520
Epoch 37/80
 - 2s - loss: 0.0518
Epoch 38/80
 - 2s - loss: 0.0516
Epoch 39/80
 - 2s - loss: 0.0514
Epoch 40/80
 - 2s - loss: 0.0513
Epoch 41/80
 - 2s - loss: 0.0512
Epoch 42/80
 - 2s - loss: 0.0511
Epoch 43/80
 - 2s - loss: 0.0509
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:55:54.202595: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:55:54.372109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:55:54.372154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:55:54.675005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:55:54.675073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:55:54.675082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:55:54.675347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1630
Epoch 2/80
 - 2s - loss: 0.2208
Epoch 3/80
 - 2s - loss: 0.1739
Epoch 4/80
 - 2s - loss: 0.1645
Epoch 5/80
 - 2s - loss: 0.1569
Epoch 6/80
 - 2s - loss: 0.1482
Epoch 7/80
 - 2s - loss: 0.1384
Epoch 8/80
 - 2s - loss: 0.1279
Epoch 9/80
 - 2s - loss: 0.1178
Epoch 10/80
 - 2s - loss: 0.1089
Epoch 11/80
 - 2s - loss: 0.1014
Epoch 12/80
 - 2s - loss: 0.0949
Epoch 13/80
 - 2s - loss: 0.0889
Epoch 14/80
 - 2s - loss: 0.0835
Epoch 15/80
 - 2s - loss: 0.0787
Epoch 16/80
 - 2s - loss: 0.0747
Epoch 17/80
 - 2s - loss: 0.0713
Epoch 18/80
 - 2s - loss: 0.0685
Epoch 19/80
 - 2s - loss: 0.0661
Epoch 20/80
 - 2s - loss: 0.0640
Epoch 21/80
 - 2s - loss: 0.0621
Epoch 22/80
 - 2s - loss: 0.0606
Epoch 23/80
 - 2s - loss: 0.0592
Epoch 24/80
 - 2s - loss: 0.0581
Epoch 25/80
 - 2s - loss: 0.0571
Epoch 26/80
 - 2s - loss: 0.0563
Epoch 27/80
 - 2s - loss: 0.0556
Epoch 28/80
 - 2s - loss: 0.0550
Epoch 29/80
 - 2s - loss: 0.0544
Epoch 30/80
 - 2s - loss: 0.0540
Epoch 31/80
 - 2s - loss: 0.0536
Epoch 32/80
 - 2s - loss: 0.0532
Epoch 33/80
 - 2s - loss: 0.0529
Epoch 34/80
 - 2s - loss: 0.0526
Epoch 35/80
 - 2s - loss: 0.0524
Epoch 36/80
 - 2s - loss: 0.0522
Epoch 37/80
 - 2s - loss: 0.0520
Epoch 38/80
 - 2s - loss: 0.0518
Epoch 39/80
 - 2s - loss: 0.0517
Epoch 40/80
 - 2s - loss: 0.0515
Epoch 41/80
 - 2s - loss: 0.0514
Epoch 42/80
 - 2s - loss: 0.0513
Epoch 43/80
 - 2s - loss: 0.0512
Epoch 44/80
 - 2s - loss: 0.0511
Epoch 45/80
 - 2s - loss: 0.0510
Epoch 46/80
 - 2s - loss: 0.0509
Epoch 47/80
 - 2s - loss: 0.0508
Epoch 48/80
 - 2s - loss: 0.0507
Epoch 49/80
 - 2s - loss: 0.0507
Epoch 50/80
 - 2s - loss: 0.0506
Epoch 51/80
 - 2s - loss: 0.0506
Epoch 52/80
 - 2s - loss: 0.0505
Epoch 53/80
 - 2s - loss: 0.0505
Epoch 54/80
 - 2s - loss: 0.0504
Epoch 55/80
 - 2s - loss: 0.0503
Epoch 56/80
 - 2s - loss: 0.0503
Epoch 57/80
 - 2s - loss: 0.0503
Epoch 58/80
 - 2s - loss: 0.0502
Epoch 59/80
 - 2s - loss: 0.0502
Epoch 60/80
 - 2s - loss: 0.0502
Epoch 61/80
 - 2s - loss: 0.0501
Epoch 62/80
 - 2s - loss: 0.0501
Epoch 63/80
 - 2s - loss: 0.0501
Epoch 64/80
 - 2s - loss: 0.0490
Epoch 65/80
 - 2s - loss: 0.0488
Epoch 66/80
 - 2s - loss: 0.0488
Epoch 67/80
 - 2s - loss: 0.0488
Epoch 68/80
 - 2s - loss: 0.0488
Epoch 69/80
 - 2s - loss: 0.0485
Epoch 70/80
 - 2s - loss: 0.0485
Epoch 71/80
 - 2s - loss: 0.0485
Epoch 72/80
 - 2s - loss: 0.0485
Epoch 73/80
 - 2s - loss: 0.0485
Epoch 74/80
 - 2s - loss: 0.0485
Epoch 75/80
 - 2s - loss: 0.0485
Epoch 76/80
 - 2s - loss: 0.0484
Epoch 77/80
 - 2s - loss: 0.0484
Epoch 78/80
 - 2s - loss: 0.0484
Epoch 79/80
 - 2s - loss: 0.0484
Epoch 80/80
 - 2s - loss: 0.0484
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 03:58:53.725877: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 03:58:53.897021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 03:58:53.897097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 03:58:54.201505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 03:58:54.201561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 03:58:54.201570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 03:58:54.201846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1505
Epoch 2/80
 - 2s - loss: 0.2135
Epoch 3/80
 - 2s - loss: 0.1723
Epoch 4/80
 - 2s - loss: 0.1636
Epoch 5/80
 - 2s - loss: 0.1530
Epoch 6/80
 - 2s - loss: 0.1418
Epoch 7/80
 - 2s - loss: 0.1326
Epoch 8/80
 - 2s - loss: 0.1249
Epoch 9/80
 - 2s - loss: 0.1177
Epoch 10/80
 - 2s - loss: 0.1103
Epoch 11/80
 - 2s - loss: 0.1030
Epoch 12/80
 - 2s - loss: 0.0960
Epoch 13/80
 - 2s - loss: 0.0896
Epoch 14/80
 - 2s - loss: 0.0841
Epoch 15/80
 - 2s - loss: 0.0793
Epoch 16/80
 - 2s - loss: 0.0752
Epoch 17/80
 - 2s - loss: 0.0716
Epoch 18/80
 - 2s - loss: 0.0686
Epoch 19/80
 - 2s - loss: 0.0660
Epoch 20/80
 - 2s - loss: 0.0639
Epoch 21/80
 - 2s - loss: 0.0620
Epoch 22/80
 - 2s - loss: 0.0605
Epoch 23/80
 - 2s - loss: 0.0593
Epoch 24/80
 - 2s - loss: 0.0582
Epoch 25/80
 - 2s - loss: 0.0573
Epoch 26/80
 - 2s - loss: 0.0565
Epoch 27/80
 - 2s - loss: 0.0558
Epoch 28/80
 - 2s - loss: 0.0552
Epoch 29/80
 - 2s - loss: 0.0547
Epoch 30/80
 - 2s - loss: 0.0542
Epoch 31/80
 - 2s - loss: 0.0538
Epoch 32/80
 - 2s - loss: 0.0535
Epoch 33/80
 - 2s - loss: 0.0531
Epoch 34/80
 - 2s - loss: 0.0529
Epoch 35/80
 - 2s - loss: 0.0526
Epoch 36/80
 - 2s - loss: 0.0524
Epoch 37/80
 - 2s - loss: 0.0522
Epoch 38/80
 - 2s - loss: 0.0520
Epoch 39/80
 - 2s - loss: 0.0518
Epoch 40/80
 - 2s - loss: 0.0517
Epoch 41/80
 - 2s - loss: 0.0515
Epoch 42/80
 - 2s - loss: 0.0514
Epoch 43/80
 - 2s - loss: 0.0513
Epoch 44/80
 - 2s - loss: 0.0512
Epoch 45/80
 - 2s - loss: 0.0511
Epoch 46/80
 - 2s - loss: 0.0510
Epoch 47/80
 - 2s - loss: 0.0509
Epoch 48/80
 - 2s - loss: 0.0508
Epoch 49/80
 - 2s - loss: 0.0508
Epoch 50/80
 - 2s - loss: 0.0507
Epoch 51/80
 - 2s - loss: 0.0506
Epoch 52/80
 - 2s - loss: 0.0506
Epoch 53/80
 - 2s - loss: 0.0505
Epoch 54/80
 - 2s - loss: 0.0505
Epoch 55/80
 - 2s - loss: 0.0504
Epoch 56/80
 - 2s - loss: 0.0504
Epoch 57/80
 - 2s - loss: 0.0504
Epoch 58/80
 - 2s - loss: 0.0503
Epoch 59/80
 - 2s - loss: 0.0503
Epoch 60/80
 - 2s - loss: 0.0502
Epoch 61/80
 - 2s - loss: 0.0502
Epoch 62/80
 - 2s - loss: 0.0502
Epoch 63/80
 - 2s - loss: 0.0490
Epoch 64/80
 - 2s - loss: 0.0489
Epoch 65/80
 - 2s - loss: 0.0489
Epoch 66/80
 - 2s - loss: 0.0489
Epoch 67/80
 - 2s - loss: 0.0489
Epoch 68/80
 - 2s - loss: 0.0486
Epoch 69/80
 - 2s - loss: 0.0486
Epoch 70/80
 - 2s - loss: 0.0486
Epoch 71/80
 - 2s - loss: 0.0486
Epoch 72/80
 - 2s - loss: 0.0485
Epoch 73/80
 - 2s - loss: 0.0485
Epoch 74/80
 - 2s - loss: 0.0485
Epoch 75/80
 - 2s - loss: 0.0485
Epoch 76/80
 - 2s - loss: 0.0485
Epoch 77/80
 - 2s - loss: 0.0485
Epoch 78/80
 - 2s - loss: 0.0485
Epoch 79/80
 - 2s - loss: 0.0485
Epoch 80/80
 - 2s - loss: 0.0485
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.4408 - val_loss: 1.2858
AUC: 0.7918

Epoch 2/80
 - 0s - loss: 2.3641 - val_loss: 1.0261
AUC: 0.8287

Epoch 3/80
 - 0s - loss: 1.5886 - val_loss: 0.8197
AUC: 0.8421

Epoch 4/80
 - 0s - loss: 1.2637 - val_loss: 0.7048
AUC: 0.8473

Epoch 5/80
 - 0s - loss: 1.1675 - val_loss: 0.6991
AUC: 0.8535

Epoch 6/80
 - 0s - loss: 1.1179 - val_loss: 0.6873
AUC: 0.8553

Epoch 7/80
 - 0s - loss: 1.1028 - val_loss: 0.5785
AUC: 0.8554

Epoch 8/80
 - 0s - loss: 1.0868 - val_loss: 0.6180
AUC: 0.8581

Epoch 9/80
 - 0s - loss: 1.0671 - val_loss: 0.6357
AUC: 0.8603

Epoch 10/80
 - 0s - loss: 1.0635 - val_loss: 0.6384
AUC: 0.8610

Epoch 11/80
 - 0s - loss: 1.0546 - val_loss: 0.5960
AUC: 0.8606

Epoch 12/80
 - 0s - loss: 1.0440 - val_loss: 0.6054
AUC: 0.8603

Epoch 13/80
 - 0s - loss: 1.0415 - val_loss: 0.6279
AUC: 0.8616

Epoch 14/80
 - 0s - loss: 1.0342 - val_loss: 0.6668
AUC: 0.8644

Epoch 15/80
 - 0s - loss: 1.0207 - val_loss: 0.6496
AUC: 0.8642

Epoch 16/80
 - 0s - loss: 1.0289 - val_loss: 0.6844
AUC: 0.8637

Epoch 17/80
 - 0s - loss: 1.0198 - val_loss: 0.6364
AUC: 0.8648

Epoch 18/80
 - 0s - loss: 1.0074 - val_loss: 0.6408
AUC: 0.8655

Epoch 19/80
 - 0s - loss: 1.0057 - val_loss: 0.6267
AUC: 0.8654

Epoch 20/80
 - 0s - loss: 1.0021 - val_loss: 0.6029
AUC: 0.8651

Epoch 21/80
 - 0s - loss: 1.0002 - val_loss: 0.6016
AUC: 0.8653

Epoch 22/80
 - 0s - loss: 0.9979 - val_loss: 0.6311
AUC: 0.8658

Epoch 23/80
 - 0s - loss: 1.0010 - val_loss: 0.6116
AUC: 0.8659

Epoch 24/80
 - 0s - loss: 1.0016 - val_loss: 0.6217
AUC: 0.8659

Epoch 25/80
 - 0s - loss: 0.9960 - val_loss: 0.6212
AUC: 0.8662

Epoch 26/80
 - 0s - loss: 0.9916 - val_loss: 0.6160
AUC: 0.8661

Epoch 27/80
 - 0s - loss: 0.9928 - val_loss: 0.6288
AUC: 0.8662

Epoch 28/80
 - 0s - loss: 0.9931 - val_loss: 0.6274
AUC: 0.8664

Epoch 29/80
 - 0s - loss: 0.9950 - val_loss: 0.6131
AUC: 0.8663

Epoch 30/80
 - 0s - loss: 0.9934 - val_loss: 0.6183
AUC: 0.8665

Epoch 31/80
 - 0s - loss: 0.9959 - val_loss: 0.6222
AUC: 0.8666

Epoch 32/80
 - 0s - loss: 0.9893 - val_loss: 0.6303
AUC: 0.8668

Epoch 33/80
 - 0s - loss: 0.9909 - val_loss: 0.6156
AUC: 0.8666

Epoch 34/80
 - 0s - loss: 0.9834 - val_loss: 0.6098
AUC: 0.8664

Epoch 35/80
 - 0s - loss: 0.9870 - val_loss: 0.6084
AUC: 0.8665

Epoch 36/80
 - 0s - loss: 0.9908 - val_loss: 0.6211
AUC: 0.8667

Epoch 37/80
 - 0s - loss: 0.9891 - val_loss: 0.6122
AUC: 0.8666

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9959 - val_loss: 0.6253
AUC: 0.8668

Epoch 2/30
 - 0s - loss: 0.9853 - val_loss: 0.6203
AUC: 0.8668

Epoch 3/30
 - 0s - loss: 0.9842 - val_loss: 0.6048
AUC: 0.8666

Epoch 4/30
 - 0s - loss: 0.9833 - val_loss: 0.6130
AUC: 0.8669

Epoch 5/30
 - 0s - loss: 0.9835 - val_loss: 0.6350
AUC: 0.8675

Epoch 6/30
 - 0s - loss: 0.9864 - val_loss: 0.6349
AUC: 0.8677

Epoch 7/30
 - 0s - loss: 0.9838 - val_loss: 0.6187
AUC: 0.8676

Epoch 8/30
 - 0s - loss: 0.9813 - val_loss: 0.6310
AUC: 0.8679

Epoch 9/30
 - 0s - loss: 0.9743 - val_loss: 0.5973
AUC: 0.8676

Epoch 10/30
 - 0s - loss: 0.9806 - val_loss: 0.6388
AUC: 0.8685

Epoch 11/30
 - 0s - loss: 0.9818 - val_loss: 0.6139
AUC: 0.8682

Epoch 12/30
 - 0s - loss: 0.9761 - val_loss: 0.6302
AUC: 0.8685

Epoch 13/30
 - 0s - loss: 0.9722 - val_loss: 0.6004
AUC: 0.8680

Epoch 14/30
 - 0s - loss: 0.9697 - val_loss: 0.6101
AUC: 0.8681

Epoch 15/30
 - 0s - loss: 0.9742 - val_loss: 0.6049
AUC: 0.8683

Epoch 16/30
 - 0s - loss: 0.9710 - val_loss: 0.6041
AUC: 0.8686

Epoch 17/30
 - 0s - loss: 0.9703 - val_loss: 0.6218
AUC: 0.8689

Epoch 18/30
 - 0s - loss: 0.9689 - val_loss: 0.6056
AUC: 0.8687

Epoch 19/30
 - 0s - loss: 0.9637 - val_loss: 0.6070
AUC: 0.8690

Epoch 20/30
 - 0s - loss: 0.9675 - val_loss: 0.6049
AUC: 0.8690

Epoch 21/30
 - 0s - loss: 0.9605 - val_loss: 0.6016
AUC: 0.8689

Epoch 22/30
 - 0s - loss: 0.9628 - val_loss: 0.6067
AUC: 0.8690

Epoch 23/30
 - 0s - loss: 0.9623 - val_loss: 0.6043
AUC: 0.8690

Epoch 24/30
 - 0s - loss: 0.9660 - val_loss: 0.6082
AUC: 0.8691

Epoch 25/30
 - 0s - loss: 0.9591 - val_loss: 0.6082
AUC: 0.8691

Epoch 26/30
 - 0s - loss: 0.9616 - val_loss: 0.5998
AUC: 0.8690

Epoch 27/30
 - 0s - loss: 0.9647 - val_loss: 0.6034
AUC: 0.8691

Epoch 28/30
 - 0s - loss: 0.9612 - val_loss: 0.6045
AUC: 0.8692

Epoch 29/30
 - 0s - loss: 0.9698 - val_loss: 0.6091
AUC: 0.8693

Epoch 30/30
 - 0s - loss: 0.9572 - val_loss: 0.6063
Using TensorFlow backend.
AUC: 0.8692

2019-03-08 04:02:43.023876: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:02:43.196615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:02:43.196661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:02:43.497646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:02:43.497703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:02:43.497712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:02:43.498007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1766
Epoch 2/80
 - 2s - loss: 0.2178
Epoch 3/80
 - 2s - loss: 0.1687
Epoch 4/80
 - 2s - loss: 0.1552
Epoch 5/80
 - 2s - loss: 0.1457
Epoch 6/80
 - 2s - loss: 0.1380
Epoch 7/80
 - 2s - loss: 0.1302
Epoch 8/80
 - 2s - loss: 0.1221
Epoch 9/80
 - 2s - loss: 0.1141
Epoch 10/80
 - 2s - loss: 0.1065
Epoch 11/80
 - 2s - loss: 0.0993
Epoch 12/80
 - 2s - loss: 0.0929
Epoch 13/80
 - 2s - loss: 0.0873
Epoch 14/80
 - 2s - loss: 0.0826
Epoch 15/80
 - 2s - loss: 0.0783
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 04:03:35.254846: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:03:35.424600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:03:35.424645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:03:35.725853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:03:35.725909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:03:35.725919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:03:35.726184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6986
Epoch 2/80
 - 2s - loss: 0.1344
Epoch 3/80
 - 2s - loss: 0.0726
Epoch 4/80
 - 2s - loss: 0.0666
Epoch 5/80
 - 2s - loss: 0.0640
Epoch 6/80
 - 2s - loss: 0.0614
Epoch 7/80
 - 2s - loss: 0.0583
Epoch 8/80
 - 2s - loss: 0.0548
Epoch 9/80
 - 2s - loss: 0.0511
Epoch 10/80
 - 2s - loss: 0.0475
Epoch 11/80
 - 2s - loss: 0.0440
Epoch 12/80
 - 2s - loss: 0.0406
Epoch 13/80
 - 2s - loss: 0.0374
Epoch 14/80
 - 2s - loss: 0.0347
Epoch 15/80
 - 2s - loss: 0.0323
Epoch 16/80
 - 2s - loss: 0.0303
Epoch 17/80
 - 2s - loss: 0.0286
Epoch 18/80
 - 2s - loss: 0.0272
Epoch 19/80
 - 2s - loss: 0.0259
Epoch 20/80
 - 2s - loss: 0.0248
Epoch 21/80
 - 2s - loss: 0.0237
Epoch 22/80
 - 2s - loss: 0.0228
Epoch 23/80
 - 2s - loss: 0.0220
Epoch 24/80
 - 2s - loss: 0.0213
Epoch 25/80
 - 2s - loss: 0.0206
Epoch 26/80
 - 2s - loss: 0.0201
Epoch 27/80
 - 2s - loss: 0.0196
Epoch 28/80
 - 2s - loss: 0.0192
Epoch 29/80
 - 2s - loss: 0.0189
Epoch 30/80
 - 2s - loss: 0.0186
Epoch 31/80
 - 2s - loss: 0.0184
Epoch 32/80
 - 2s - loss: 0.0182
Epoch 33/80
 - 2s - loss: 0.0180
Epoch 34/80
 - 2s - loss: 0.0178
Epoch 35/80
 - 2s - loss: 0.0176
Epoch 36/80
 - 2s - loss: 0.0175
Epoch 37/80
 - 2s - loss: 0.0174
Epoch 38/80
 - 2s - loss: 0.0173
Epoch 39/80
 - 2s - loss: 0.0172
Epoch 40/80
 - 2s - loss: 0.0171
Epoch 41/80
 - 2s - loss: 0.0170
Epoch 42/80
 - 2s - loss: 0.0170
Epoch 43/80
 - 2s - loss: 0.0169
Epoch 44/80
 - 2s - loss: 0.0169
Epoch 45/80
 - 2s - loss: 0.0168
Epoch 46/80
 - 2s - loss: 0.0168
Epoch 47/80
 - 2s - loss: 0.0167
Epoch 48/80
 - 2s - loss: 0.0167
Epoch 49/80
 - 2s - loss: 0.0166
Epoch 50/80
 - 2s - loss: 0.0166
Epoch 51/80
 - 2s - loss: 0.0166
Epoch 52/80
 - 2s - loss: 0.0166
Epoch 53/80
 - 2s - loss: 0.0165
Epoch 54/80
 - 2s - loss: 0.0165
Epoch 55/80
 - 2s - loss: 0.0161
Epoch 56/80
 - 2s - loss: 0.0161
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2aee460830f0>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 04:05:43.947867: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:05:44.119297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:05:44.119345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:05:44.425329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:05:44.425385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:05:44.425394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:05:44.425659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6913
Epoch 2/80
 - 2s - loss: 0.1293
Epoch 3/80
 - 2s - loss: 0.0727
Epoch 4/80
 - 2s - loss: 0.0661
Epoch 5/80
 - 2s - loss: 0.0636
Epoch 6/80
 - 2s - loss: 0.0616
Epoch 7/80
 - 2s - loss: 0.0592
Epoch 8/80
 - 2s - loss: 0.0564
Epoch 9/80
 - 2s - loss: 0.0531
Epoch 10/80
 - 2s - loss: 0.0494
Epoch 11/80
 - 2s - loss: 0.0454
Epoch 12/80
 - 2s - loss: 0.0415
Epoch 13/80
 - 2s - loss: 0.0378
Epoch 14/80
 - 2s - loss: 0.0347
Epoch 15/80
 - 2s - loss: 0.0320
Epoch 16/80
 - 2s - loss: 0.0298
Epoch 17/80
 - 2s - loss: 0.0280
Epoch 18/80
 - 2s - loss: 0.0264
Epoch 19/80
 - 2s - loss: 0.0251
Epoch 20/80
 - 2s - loss: 0.0240
Epoch 21/80
 - 2s - loss: 0.0231
Epoch 22/80
 - 2s - loss: 0.0223
Epoch 23/80
 - 2s - loss: 0.0216
Epoch 24/80
 - 2s - loss: 0.0210
Epoch 25/80
 - 2s - loss: 0.0205
Epoch 26/80
 - 2s - loss: 0.0200
Epoch 27/80
 - 2s - loss: 0.0196
Epoch 28/80
 - 2s - loss: 0.0193
Epoch 29/80
 - 2s - loss: 0.0189
Epoch 30/80
 - 2s - loss: 0.0187
Epoch 31/80
 - 2s - loss: 0.0184
Epoch 32/80
 - 2s - loss: 0.0182
Epoch 33/80
 - 2s - loss: 0.0180
Epoch 34/80
 - 2s - loss: 0.0178
Epoch 35/80
 - 2s - loss: 0.0177
Epoch 36/80
 - 2s - loss: 0.0175
Epoch 37/80
 - 2s - loss: 0.0174
Epoch 38/80
 - 2s - loss: 0.0173
Epoch 39/80
 - 2s - loss: 0.0172
Epoch 40/80
 - 2s - loss: 0.0171
Epoch 41/80
 - 2s - loss: 0.0171
Epoch 42/80
 - 2s - loss: 0.0170
Epoch 43/80
 - 2s - loss: 0.0169
Epoch 44/80
 - 2s - loss: 0.0169
Epoch 45/80
 - 2s - loss: 0.0168
Epoch 46/80
 - 2s - loss: 0.0168
Epoch 47/80
 - 2s - loss: 0.0167
Epoch 48/80
 - 2s - loss: 0.0167
Epoch 49/80
 - 2s - loss: 0.0167
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 04:07:40.788477: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:07:40.956808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:07:40.956855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:07:41.261241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:07:41.261296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:07:41.261306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:07:41.261571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6870
Epoch 2/80
 - 2s - loss: 0.1315
Epoch 3/80
 - 2s - loss: 0.0724
Epoch 4/80
 - 2s - loss: 0.0662
Epoch 5/80
 - 2s - loss: 0.0633
Epoch 6/80
 - 2s - loss: 0.0603
Epoch 7/80
 - 2s - loss: 0.0568
Epoch 8/80
 - 2s - loss: 0.0533
Epoch 9/80
 - 2s - loss: 0.0503
Epoch 10/80
 - 2s - loss: 0.0476
Epoch 11/80
 - 2s - loss: 0.0450
Epoch 12/80
 - 2s - loss: 0.0424
Epoch 13/80
 - 2s - loss: 0.0396
Epoch 14/80
 - 2s - loss: 0.0367
Epoch 15/80
 - 2s - loss: 0.0340
Epoch 16/80
 - 2s - loss: 0.0314
Epoch 17/80
 - 2s - loss: 0.0291
Epoch 18/80
 - 2s - loss: 0.0272
Epoch 19/80
 - 2s - loss: 0.0256
Epoch 20/80
 - 2s - loss: 0.0243
Epoch 21/80
 - 2s - loss: 0.0232
Epoch 22/80
 - 2s - loss: 0.0223
Epoch 23/80
 - 2s - loss: 0.0215
Epoch 24/80
 - 2s - loss: 0.0209
Epoch 25/80
 - 2s - loss: 0.0203
Epoch 26/80
 - 2s - loss: 0.0199
Epoch 27/80
 - 2s - loss: 0.0195
Epoch 28/80
 - 2s - loss: 0.0191
Epoch 29/80
 - 2s - loss: 0.0188
Epoch 30/80
 - 2s - loss: 0.0185
Epoch 31/80
 - 2s - loss: 0.0183
Epoch 32/80
 - 2s - loss: 0.0181
Epoch 33/80
 - 2s - loss: 0.0179
Epoch 34/80
 - 2s - loss: 0.0177
Epoch 35/80
 - 2s - loss: 0.0176
Epoch 36/80
 - 2s - loss: 0.0175
Epoch 37/80
 - 2s - loss: 0.0174
Epoch 38/80
 - 2s - loss: 0.0173
Epoch 39/80
 - 2s - loss: 0.0172
Epoch 40/80
 - 2s - loss: 0.0171
Epoch 41/80
 - 2s - loss: 0.0170
Epoch 42/80
 - 2s - loss: 0.0169
Epoch 43/80
 - 2s - loss: 0.0169
Epoch 44/80
 - 2s - loss: 0.0168
Epoch 45/80
 - 2s - loss: 0.0168
Epoch 46/80
 - 2s - loss: 0.0167
Epoch 47/80
 - 2s - loss: 0.0167
Epoch 48/80
 - 2s - loss: 0.0166
Epoch 49/80
 - 2s - loss: 0.0166
Epoch 50/80
 - 2s - loss: 0.0166
Epoch 51/80
 - 2s - loss: 0.0165
Epoch 52/80
 - 2s - loss: 0.0165
Epoch 53/80
 - 2s - loss: 0.0165
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2ab7cfc790f0>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 04:09:47.935595: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:09:48.103429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:09:48.103477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:09:48.406234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:09:48.406290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:09:48.406299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:09:48.406564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3765
Epoch 2/80
 - 2s - loss: 0.3505
Epoch 3/80
 - 2s - loss: 0.3102
Epoch 4/80
 - 2s - loss: 0.2998
Epoch 5/80
 - 2s - loss: 0.2868
Epoch 6/80
 - 2s - loss: 0.2678
Epoch 7/80
 - 2s - loss: 0.2447
Epoch 8/80
 - 2s - loss: 0.2237
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2b0dd33ca668>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 04:10:22.656368: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:10:22.836399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:10:22.836460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:10:23.176622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:10:23.176683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:10:23.176693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:10:23.177000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3824
Epoch 2/80
 - 2s - loss: 0.3525
Epoch 3/80
 - 2s - loss: 0.3001
Epoch 4/80
 - 2s - loss: 0.2762
Epoch 5/80
 - 2s - loss: 0.2565
Epoch 6/80
 - 2s - loss: 0.2418
Epoch 7/80
 - 2s - loss: 0.2295
Epoch 8/80
 - 2s - loss: 0.2178
Epoch 9/80
 - 2s - loss: 0.2059
Epoch 10/80
 - 2s - loss: 0.1939
Epoch 11/80
 - 2s - loss: 0.1824
Epoch 12/80
 - 2s - loss: 0.1721
Epoch 13/80
 - 2s - loss: 0.1637
Epoch 14/80
 - 2s - loss: 0.1567
Epoch 15/80
 - 2s - loss: 0.1509
Epoch 16/80
 - 2s - loss: 0.1460
Epoch 17/80
 - 2s - loss: 0.1417
Epoch 18/80
 - 2s - loss: 0.1380
Epoch 19/80
 - 2s - loss: 0.1348
Epoch 20/80
 - 2s - loss: 0.1321
Epoch 21/80
 - 2s - loss: 0.1297
Epoch 22/80
 - 2s - loss: 0.1276
Epoch 23/80
 - 2s - loss: 0.1259
Epoch 24/80
 - 2s - loss: 0.1244
Epoch 25/80
 - 2s - loss: 0.1231
Epoch 26/80
 - 2s - loss: 0.1221
Epoch 27/80
 - 2s - loss: 0.1211
Epoch 28/80
 - 2s - loss: 0.1203
Epoch 29/80
 - 2s - loss: 0.1197
Epoch 30/80
 - 2s - loss: 0.1190
Epoch 31/80
 - 2s - loss: 0.1185
Epoch 32/80
 - 2s - loss: 0.1181
Epoch 33/80
 - 2s - loss: 0.1177
Epoch 34/80
 - 2s - loss: 0.1173
Epoch 35/80
 - 2s - loss: 0.1170
Epoch 36/80
 - 2s - loss: 0.1168
Epoch 37/80
 - 2s - loss: 0.1165
Epoch 38/80
 - 2s - loss: 0.1163
Epoch 39/80
 - 2s - loss: 0.1161
Epoch 40/80
 - 2s - loss: 0.1159
Epoch 41/80
 - 2s - loss: 0.1157
Epoch 42/80
 - 2s - loss: 0.1156
Epoch 43/80
 - 2s - loss: 0.1155
Epoch 44/80
 - 2s - loss: 0.1153
Epoch 45/80
 - 2s - loss: 0.1152
Epoch 46/80
 - 2s - loss: 0.1151
Epoch 47/80
 - 2s - loss: 0.1150
Epoch 48/80
 - 2s - loss: 0.1149
Epoch 49/80
 - 2s - loss: 0.1148
Epoch 50/80
 - 2s - loss: 0.1147
Epoch 51/80
 - 2s - loss: 0.1146
Epoch 52/80
 - 2s - loss: 0.1146
Epoch 53/80
 - 2s - loss: 0.1145
Epoch 54/80
 - 2s - loss: 0.1145
Epoch 55/80
 - 2s - loss: 0.1144
Epoch 56/80
 - 2s - loss: 0.1143
Epoch 57/80
 - 2s - loss: 0.1143
Epoch 58/80
 - 2s - loss: 0.1143
Epoch 59/80
 - 2s - loss: 0.1142
Epoch 60/80
 - 2s - loss: 0.1142
Epoch 61/80
 - 2s - loss: 0.1141
Epoch 62/80
 - 2s - loss: 0.1141
Epoch 63/80
 - 2s - loss: 0.1141
Epoch 64/80
 - 2s - loss: 0.1140
Epoch 65/80
 - 2s - loss: 0.1140
Epoch 66/80
 - 2s - loss: 0.1140
Epoch 67/80
 - 2s - loss: 0.1139
Epoch 68/80
 - 2s - loss: 0.1117
Epoch 69/80
 - 2s - loss: 0.1115
Epoch 70/80
 - 2s - loss: 0.1114
Epoch 71/80
 - 2s - loss: 0.1114
Epoch 72/80
 - 2s - loss: 0.1114
Epoch 73/80
 - 2s - loss: 0.1109
Epoch 74/80
 - 2s - loss: 0.1108
Epoch 75/80
 - 2s - loss: 0.1108
Epoch 76/80
 - 2s - loss: 0.1108
Epoch 77/80
 - 2s - loss: 0.1107
Epoch 78/80
 - 2s - loss: 0.1107
Epoch 79/80
 - 2s - loss: 0.1107
Epoch 80/80
 - 2s - loss: 0.1107
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.1629 - val_loss: 1.1358
AUC: 0.7985

Epoch 2/80
 - 0s - loss: 1.9439 - val_loss: 0.7320
AUC: 0.8274

Epoch 3/80
 - 0s - loss: 1.4789 - val_loss: 0.7597
AUC: 0.8392

Epoch 4/80
 - 0s - loss: 1.2673 - val_loss: 0.7802
AUC: 0.8476

Epoch 5/80
 - 0s - loss: 1.1696 - val_loss: 0.6451
AUC: 0.8491

Epoch 6/80
 - 0s - loss: 1.1264 - val_loss: 0.7180
AUC: 0.8516

Epoch 7/80
 - 0s - loss: 1.0970 - val_loss: 0.6577
AUC: 0.8536

Epoch 8/80
 - 0s - loss: 1.0814 - val_loss: 0.6066
AUC: 0.8547

Epoch 9/80
 - 0s - loss: 1.0681 - val_loss: 0.6254
AUC: 0.8561

Epoch 10/80
 - 0s - loss: 1.0576 - val_loss: 0.6968
AUC: 0.8588

Epoch 11/80
 - 0s - loss: 1.0502 - val_loss: 0.6102
AUC: 0.8589

Epoch 12/80
 - 0s - loss: 1.0476 - val_loss: 0.6495
AUC: 0.8610

Epoch 13/80
 - 0s - loss: 1.0381 - val_loss: 0.6184
AUC: 0.8616

Epoch 14/80
 - 0s - loss: 1.0341 - val_loss: 0.6478
AUC: 0.8631

Epoch 15/80
 - 0s - loss: 1.0226 - val_loss: 0.5888
AUC: 0.8622

Epoch 16/80
 - 0s - loss: 1.0296 - val_loss: 0.5684
AUC: 0.8630

Epoch 17/80
 - 0s - loss: 1.0240 - val_loss: 0.6016
AUC: 0.8643

Epoch 18/80
 - 0s - loss: 1.0154 - val_loss: 0.5842
AUC: 0.8647

Epoch 19/80
 - 0s - loss: 1.0114 - val_loss: 0.5822
AUC: 0.8643

Epoch 20/80
 - 0s - loss: 1.0163 - val_loss: 0.5839
AUC: 0.8643

Epoch 21/80
 - 0s - loss: 1.0021 - val_loss: 0.6341
AUC: 0.8653

Epoch 22/80
 - 0s - loss: 1.0048 - val_loss: 0.6143
AUC: 0.8650

Epoch 23/80
 - 0s - loss: 0.9944 - val_loss: 0.6026
AUC: 0.8659

Epoch 24/80
 - 0s - loss: 0.9990 - val_loss: 0.6243
AUC: 0.8660

Epoch 25/80
 - 0s - loss: 0.9958 - val_loss: 0.6656
AUC: 0.8655

Epoch 26/80
 - 0s - loss: 0.9862 - val_loss: 0.6146
AUC: 0.8657

Epoch 27/80
 - 0s - loss: 0.9864 - val_loss: 0.6201
AUC: 0.8667

Epoch 28/80
 - 0s - loss: 0.9816 - val_loss: 0.6242
AUC: 0.8671

Epoch 29/80
 - 0s - loss: 0.9825 - val_loss: 0.6447
AUC: 0.8674

Epoch 30/80
 - 0s - loss: 0.9769 - val_loss: 0.6186
AUC: 0.8671

Epoch 31/80
 - 0s - loss: 0.9828 - val_loss: 0.6209
AUC: 0.8671

Epoch 32/80
 - 0s - loss: 0.9707 - val_loss: 0.5810
AUC: 0.8667

Epoch 33/80
 - 0s - loss: 0.9769 - val_loss: 0.6304
AUC: 0.8672

Epoch 34/80
 - 0s - loss: 0.9736 - val_loss: 0.6097
AUC: 0.8673

Epoch 35/80
 - 0s - loss: 0.9797 - val_loss: 0.6345
AUC: 0.8675

Epoch 36/80
 - 0s - loss: 0.9765 - val_loss: 0.5793
AUC: 0.8670

Epoch 37/80
 - 0s - loss: 0.9729 - val_loss: 0.6210
AUC: 0.8673

Epoch 38/80
 - 0s - loss: 0.9692 - val_loss: 0.6075
AUC: 0.8672

Epoch 39/80
 - 0s - loss: 0.9733 - val_loss: 0.6053
AUC: 0.8672

Epoch 40/80
 - 0s - loss: 0.9754 - val_loss: 0.6147
AUC: 0.8674

Epoch 41/80
 - 0s - loss: 0.9743 - val_loss: 0.6150
AUC: 0.8674

Epoch 42/80
 - 0s - loss: 0.9713 - val_loss: 0.6102
AUC: 0.8673

Epoch 43/80
 - 0s - loss: 0.9705 - val_loss: 0.6192
AUC: 0.8674

Epoch 44/80
 - 0s - loss: 0.9657 - val_loss: 0.6000
AUC: 0.8672

Epoch 45/80
 - 0s - loss: 0.9706 - val_loss: 0.6133
AUC: 0.8673

Epoch 46/80
 - 0s - loss: 0.9713 - val_loss: 0.6046
AUC: 0.8672

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9744 - val_loss: 0.5960
AUC: 0.8672

Epoch 2/30
 - 0s - loss: 0.9647 - val_loss: 0.5988
AUC: 0.8673

Epoch 3/30
 - 0s - loss: 0.9663 - val_loss: 0.5981
AUC: 0.8676

Epoch 4/30
 - 0s - loss: 0.9690 - val_loss: 0.6228
AUC: 0.8680

Epoch 5/30
 - 0s - loss: 0.9670 - val_loss: 0.6255
AUC: 0.8682

Epoch 6/30
 - 0s - loss: 0.9690 - val_loss: 0.6198
AUC: 0.8683

Epoch 7/30
 - 0s - loss: 0.9661 - val_loss: 0.6039
AUC: 0.8682

Epoch 8/30
 - 0s - loss: 0.9641 - val_loss: 0.6058
AUC: 0.8685

Epoch 9/30
 - 0s - loss: 0.9602 - val_loss: 0.6018
AUC: 0.8685

Epoch 10/30
 - 0s - loss: 0.9616 - val_loss: 0.6205
AUC: 0.8688

Epoch 11/30
 - 0s - loss: 0.9608 - val_loss: 0.6078
AUC: 0.8687

Epoch 12/30
 - 0s - loss: 0.9615 - val_loss: 0.6056
AUC: 0.8687

Epoch 13/30
 - 0s - loss: 0.9613 - val_loss: 0.6085
AUC: 0.8688

Epoch 14/30
 - 0s - loss: 0.9567 - val_loss: 0.6017
AUC: 0.8687

Epoch 15/30
 - 0s - loss: 0.9545 - val_loss: 0.6011
AUC: 0.8687

Epoch 16/30
 - 0s - loss: 0.9546 - val_loss: 0.6025
AUC: 0.8688

Epoch 17/30
 - 0s - loss: 0.9554 - val_loss: 0.6070
AUC: 0.8688

Epoch 18/30
 - 0s - loss: 0.9571 - val_loss: 0.6029
AUC: 0.8688

Epoch 19/30
 - 0s - loss: 0.9557 - val_loss: 0.5962
AUC: 0.8688

Epoch 20/30
 - 0s - loss: 0.9520 - val_loss: 0.5982
AUC: 0.8688

Epoch 21/30
 - 0s - loss: 0.9525 - val_loss: 0.5990
AUC: 0.8688

Epoch 22/30
 - 0s - loss: 0.9525 - val_loss: 0.5992
AUC: 0.8688

Epoch 23/30
 - 0s - loss: 0.9522 - val_loss: 0.5995
AUC: 0.8688

Epoch 24/30
 - 0s - loss: 0.9557 - val_loss: 0.6016
AUC: 0.8688

Epoch 25/30
 - 0s - loss: 0.9545 - val_loss: 0.6017
AUC: 0.8688

Epoch 26/30
 - 0s - loss: 0.9566 - val_loss: 0.6034
AUC: 0.8689

Epoch 27/30
 - 0s - loss: 0.9530 - val_loss: 0.6026
AUC: 0.8689

Epoch 28/30
 - 0s - loss: 0.9521 - val_loss: 0.6021
AUC: 0.8689

Epoch 29/30
 - 0s - loss: 0.9530 - val_loss: 0.6022
AUC: 0.8689

Epoch 30/30
 - 0s - loss: 0.9510 - val_loss: 0.6032
Using TensorFlow backend.
AUC: 0.8689

2019-03-08 04:14:15.917052: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:14:16.088434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:14:16.088481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:14:16.397415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:14:16.397473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:14:16.397483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:14:16.397762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.2 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3398
Epoch 2/80
 - 2s - loss: 0.3505
Epoch 3/80
 - 2s - loss: 0.3105
Epoch 4/80
 - 2s - loss: 0.3004
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 04:14:42.794952: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:14:42.961930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:14:42.961978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:14:43.280200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:14:43.280255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:14:43.280265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:14:43.280528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1403
Epoch 2/80
 - 2s - loss: 0.2153
Epoch 3/80
 - 2s - loss: 0.1732
Epoch 4/80
 - 2s - loss: 0.1664
Epoch 5/80
 - 2s - loss: 0.1609
Epoch 6/80
 - 2s - loss: 0.1539
Epoch 7/80
 - 2s - loss: 0.1450
Epoch 8/80
 - 2s - loss: 0.1344
Epoch 9/80
 - 2s - loss: 0.1229
Epoch 10/80
 - 2s - loss: 0.1119
Epoch 11/80
 - 2s - loss: 0.1028
Epoch 12/80
 - 2s - loss: 0.0955
Epoch 13/80
 - 2s - loss: 0.0893
Epoch 14/80
 - 2s - loss: 0.0837
Epoch 15/80
 - 2s - loss: 0.0790
Epoch 16/80
 - 2s - loss: 0.0749
Epoch 17/80
 - 2s - loss: 0.0713
Epoch 18/80
 - 2s - loss: 0.0683
Epoch 19/80
 - 2s - loss: 0.0658
Epoch 20/80
 - 2s - loss: 0.0636
Epoch 21/80
 - 2s - loss: 0.0618
Epoch 22/80
 - 2s - loss: 0.0602
Epoch 23/80
 - 2s - loss: 0.0590
Epoch 24/80
 - 2s - loss: 0.0578
Epoch 25/80
 - 2s - loss: 0.0569
Epoch 26/80
 - 2s - loss: 0.0561
Epoch 27/80
 - 2s - loss: 0.0554
Epoch 28/80
 - 2s - loss: 0.0548
Epoch 29/80
 - 2s - loss: 0.0543
Epoch 30/80
 - 2s - loss: 0.0538
Epoch 31/80
 - 2s - loss: 0.0534
Epoch 32/80
 - 2s - loss: 0.0531
Epoch 33/80
 - 2s - loss: 0.0528
Epoch 34/80
 - 2s - loss: 0.0525
Epoch 35/80
 - 2s - loss: 0.0523
Epoch 36/80
 - 2s - loss: 0.0521
Epoch 37/80
 - 2s - loss: 0.0519
Epoch 38/80
 - 2s - loss: 0.0517
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 04:16:15.435631: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:16:15.604343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:16:15.604389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:16:15.907667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:16:15.907724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:16:15.907733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:16:15.907997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1412
Epoch 2/80
 - 2s - loss: 0.2153
Epoch 3/80
 - 2s - loss: 0.1740
Epoch 4/80
 - 2s - loss: 0.1678
Epoch 5/80
 - 2s - loss: 0.1629
Epoch 6/80
 - 2s - loss: 0.1568
Epoch 7/80
 - 2s - loss: 0.1489
Epoch 8/80
 - 2s - loss: 0.1386
Epoch 9/80
 - 2s - loss: 0.1263
Epoch 10/80
 - 2s - loss: 0.1140
Epoch 11/80
 - 2s - loss: 0.1040
Epoch 12/80
 - 2s - loss: 0.0960
Epoch 13/80
 - 2s - loss: 0.0892
Epoch 14/80
 - 2s - loss: 0.0835
Epoch 15/80
 - 2s - loss: 0.0787
Epoch 16/80
 - 2s - loss: 0.0747
Epoch 17/80
 - 2s - loss: 0.0712
Epoch 18/80
 - 2s - loss: 0.0683
Epoch 19/80
 - 2s - loss: 0.0658
Epoch 20/80
 - 2s - loss: 0.0637
Epoch 21/80
 - 2s - loss: 0.0619
Epoch 22/80
 - 2s - loss: 0.0604
Epoch 23/80
 - 2s - loss: 0.0592
Epoch 24/80
 - 2s - loss: 0.0581
Epoch 25/80
 - 2s - loss: 0.0571
Epoch 26/80
 - 2s - loss: 0.0564
Epoch 27/80
 - 2s - loss: 0.0557
Epoch 28/80
 - 2s - loss: 0.0550
Epoch 29/80
 - 2s - loss: 0.0545
Epoch 30/80
 - 2s - loss: 0.0541
Epoch 31/80
 - 2s - loss: 0.0537
Epoch 32/80
 - 2s - loss: 0.0533
Epoch 33/80
 - 2s - loss: 0.0530
Epoch 34/80
 - 2s - loss: 0.0527
Epoch 35/80
 - 2s - loss: 0.0525
Epoch 36/80
 - 2s - loss: 0.0522
Epoch 37/80
 - 2s - loss: 0.0521
Epoch 38/80
 - 2s - loss: 0.0519
Epoch 39/80
 - 2s - loss: 0.0517
Epoch 40/80
 - 2s - loss: 0.0516
Epoch 41/80
 - 2s - loss: 0.0514
Epoch 42/80
 - 2s - loss: 0.0513
Epoch 43/80
 - 2s - loss: 0.0512
Epoch 44/80
 - 2s - loss: 0.0511
Epoch 45/80
 - 2s - loss: 0.0510
Epoch 46/80
 - 2s - loss: 0.0509
Epoch 47/80
 - 2s - loss: 0.0508
Epoch 48/80
 - 2s - loss: 0.0508
Epoch 49/80
 - 2s - loss: 0.0507
Epoch 50/80
 - 2s - loss: 0.0506
Epoch 51/80
 - 2s - loss: 0.0506
Epoch 52/80
 - 2s - loss: 0.0505
Epoch 53/80
 - 2s - loss: 0.0505
Epoch 54/80
 - 2s - loss: 0.0504
Epoch 55/80
 - 2s - loss: 0.0504
Epoch 56/80
 - 2s - loss: 0.0503
Epoch 57/80
 - 2s - loss: 0.0503
Epoch 58/80
 - 2s - loss: 0.0502
Epoch 59/80
 - 2s - loss: 0.0502
Epoch 60/80
 - 2s - loss: 0.0502
Epoch 61/80
 - 2s - loss: 0.0491
Epoch 62/80
 - 2s - loss: 0.0489
Epoch 63/80
 - 2s - loss: 0.0489
Epoch 64/80
 - 2s - loss: 0.0489
Epoch 65/80
 - 2s - loss: 0.0489
Epoch 66/80
 - 2s - loss: 0.0486
Epoch 67/80
 - 2s - loss: 0.0486
Epoch 68/80
 - 2s - loss: 0.0486
Epoch 69/80
 - 2s - loss: 0.0486
Epoch 70/80
 - 2s - loss: 0.0485
Epoch 71/80
 - 2s - loss: 0.0485
Epoch 72/80
 - 2s - loss: 0.0485
Epoch 73/80
 - 2s - loss: 0.0485
Epoch 74/80
 - 2s - loss: 0.0485
Epoch 75/80
 - 2s - loss: 0.0485
Epoch 76/80
 - 2s - loss: 0.0485
Epoch 77/80
 - 2s - loss: 0.0485
Epoch 78/80
 - 2s - loss: 0.0485
Epoch 79/80
 - 2s - loss: 0.0485
Epoch 80/80
 - 2s - loss: 0.0485
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.0933 - val_loss: 1.6416
AUC: 0.8049

Epoch 2/80
 - 0s - loss: 2.7540 - val_loss: 1.1427
AUC: 0.8344

Epoch 3/80
 - 0s - loss: 2.0005 - val_loss: 0.8765
AUC: 0.8471

Epoch 4/80
 - 0s - loss: 1.5653 - val_loss: 0.7330
AUC: 0.8521

Epoch 5/80
 - 0s - loss: 1.3643 - val_loss: 0.8020
AUC: 0.8547

Epoch 6/80
 - 0s - loss: 1.2124 - val_loss: 0.6433
AUC: 0.8533

Epoch 7/80
 - 0s - loss: 1.1515 - val_loss: 0.6723
AUC: 0.8570

Epoch 8/80
 - 0s - loss: 1.1180 - val_loss: 0.6167
AUC: 0.8575

Epoch 9/80
 - 0s - loss: 1.0941 - val_loss: 0.7185
AUC: 0.8608

Epoch 10/80
 - 0s - loss: 1.0718 - val_loss: 0.6085
AUC: 0.8597

Epoch 11/80
 - 0s - loss: 1.0656 - val_loss: 0.6720
AUC: 0.8622

Epoch 12/80
 - 0s - loss: 1.0604 - val_loss: 0.5870
AUC: 0.8604

Epoch 13/80
 - 0s - loss: 1.0473 - val_loss: 0.5893
AUC: 0.8609

Epoch 14/80
 - 0s - loss: 1.0373 - val_loss: 0.5893
AUC: 0.8628

Epoch 15/80
 - 0s - loss: 1.0368 - val_loss: 0.6467
AUC: 0.8642

Epoch 16/80
 - 0s - loss: 1.0284 - val_loss: 0.5768
AUC: 0.8640

Epoch 17/80
 - 0s - loss: 1.0211 - val_loss: 0.6406
AUC: 0.8643

Epoch 18/80
 - 0s - loss: 1.0250 - val_loss: 0.6211
AUC: 0.8647

Epoch 19/80
 - 0s - loss: 1.0166 - val_loss: 0.6200
AUC: 0.8646

Epoch 20/80
 - 0s - loss: 1.0129 - val_loss: 0.5937
AUC: 0.8650

Epoch 21/80
 - 0s - loss: 1.0096 - val_loss: 0.5659
AUC: 0.8646

Epoch 22/80
 - 0s - loss: 1.0088 - val_loss: 0.5858
AUC: 0.8662

Epoch 23/80
 - 0s - loss: 1.0043 - val_loss: 0.6576
AUC: 0.8665

Epoch 24/80
 - 0s - loss: 0.9964 - val_loss: 0.5526
AUC: 0.8651

Epoch 25/80
 - 0s - loss: 0.9953 - val_loss: 0.6001
AUC: 0.8666

Epoch 26/80
 - 0s - loss: 0.9948 - val_loss: 0.6094
AUC: 0.8659

Epoch 27/80
 - 0s - loss: 0.9929 - val_loss: 0.6295
AUC: 0.8667

Epoch 28/80
 - 0s - loss: 0.9923 - val_loss: 0.5931
AUC: 0.8665

Epoch 29/80
 - 0s - loss: 0.9871 - val_loss: 0.5642
AUC: 0.8670

Epoch 30/80
 - 0s - loss: 0.9856 - val_loss: 0.6092
AUC: 0.8674

Epoch 31/80
 - 0s - loss: 0.9829 - val_loss: 0.6163
AUC: 0.8677

Epoch 32/80
 - 0s - loss: 0.9812 - val_loss: 0.6596
AUC: 0.8681

Epoch 33/80
 - 0s - loss: 0.9760 - val_loss: 0.5887
AUC: 0.8669

Epoch 34/80
 - 0s - loss: 0.9733 - val_loss: 0.6022
AUC: 0.8674

Epoch 35/80
 - 0s - loss: 0.9644 - val_loss: 0.6106
AUC: 0.8679

Epoch 36/80
 - 0s - loss: 0.9736 - val_loss: 0.6131
AUC: 0.8681

Epoch 37/80
 - 0s - loss: 0.9696 - val_loss: 0.5898
AUC: 0.8678

Epoch 38/80
 - 0s - loss: 0.9646 - val_loss: 0.5580
AUC: 0.8675

Epoch 39/80
 - 0s - loss: 0.9612 - val_loss: 0.6194
AUC: 0.8681

Epoch 40/80
 - 0s - loss: 0.9669 - val_loss: 0.6379
AUC: 0.8682

Epoch 41/80
 - 0s - loss: 0.9632 - val_loss: 0.6286
AUC: 0.8682

Epoch 42/80
 - 0s - loss: 0.9588 - val_loss: 0.5617
AUC: 0.8674

Epoch 43/80
 - 0s - loss: 0.9578 - val_loss: 0.6031
AUC: 0.8679

Epoch 44/80
 - 0s - loss: 0.9604 - val_loss: 0.5692
AUC: 0.8676

Epoch 45/80
 - 0s - loss: 0.9598 - val_loss: 0.5961
AUC: 0.8679

Epoch 46/80
 - 0s - loss: 0.9558 - val_loss: 0.5908
AUC: 0.8678

Epoch 47/80
 - 0s - loss: 0.9585 - val_loss: 0.5926
AUC: 0.8679

Epoch 48/80
 - 0s - loss: 0.9609 - val_loss: 0.5959
AUC: 0.8679

Epoch 49/80
 - 0s - loss: 0.9603 - val_loss: 0.5917
AUC: 0.8679

Epoch 50/80
 - 0s - loss: 0.9536 - val_loss: 0.6011
AUC: 0.8680

Epoch 51/80
 - 0s - loss: 0.9581 - val_loss: 0.5966
AUC: 0.8679

Epoch 52/80
 - 0s - loss: 0.9586 - val_loss: 0.5954
AUC: 0.8680

Epoch 53/80
 - 0s - loss: 0.9558 - val_loss: 0.5869
AUC: 0.8679

Epoch 54/80
 - 0s - loss: 0.9521 - val_loss: 0.5872
AUC: 0.8680

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9625 - val_loss: 0.5957
AUC: 0.8683

Epoch 2/30
 - 0s - loss: 0.9616 - val_loss: 0.5836
AUC: 0.8680

Epoch 3/30
 - 0s - loss: 0.9551 - val_loss: 0.5767
AUC: 0.8680

Epoch 4/30
 - 0s - loss: 0.9584 - val_loss: 0.5693
AUC: 0.8681

Epoch 5/30
 - 0s - loss: 0.9569 - val_loss: 0.5914
AUC: 0.8684

Epoch 6/30
 - 0s - loss: 0.9553 - val_loss: 0.5693
AUC: 0.8682

Epoch 7/30
 - 0s - loss: 0.9524 - val_loss: 0.5714
AUC: 0.8684

Epoch 8/30
 - 0s - loss: 0.9469 - val_loss: 0.6090
AUC: 0.8689

Epoch 9/30
 - 0s - loss: 0.9501 - val_loss: 0.5728
AUC: 0.8687

Epoch 10/30
 - 0s - loss: 0.9497 - val_loss: 0.5845
AUC: 0.8689

Epoch 11/30
 - 0s - loss: 0.9470 - val_loss: 0.6061
AUC: 0.8691

Epoch 12/30
 - 0s - loss: 0.9443 - val_loss: 0.5814
AUC: 0.8689

Epoch 13/30
 - 0s - loss: 0.9420 - val_loss: 0.5807
AUC: 0.8690

Epoch 14/30
 - 0s - loss: 0.9448 - val_loss: 0.5932
AUC: 0.8691

Epoch 15/30
 - 0s - loss: 0.9434 - val_loss: 0.5865
AUC: 0.8691

Epoch 16/30
 - 0s - loss: 0.9473 - val_loss: 0.5885
AUC: 0.8691

Epoch 17/30
 - 0s - loss: 0.9398 - val_loss: 0.5860
AUC: 0.8691

Epoch 18/30
 - 0s - loss: 0.9394 - val_loss: 0.5914
AUC: 0.8692

Epoch 19/30
 - 0s - loss: 0.9407 - val_loss: 0.5829
AUC: 0.8692

Epoch 20/30
 - 0s - loss: 0.9401 - val_loss: 0.5871
AUC: 0.8692

Epoch 21/30
 - 0s - loss: 0.9475 - val_loss: 0.5872
AUC: 0.8692

Epoch 22/30
 - 0s - loss: 0.9389 - val_loss: 0.5857
AUC: 0.8692

Epoch 23/30
 - 0s - loss: 0.9423 - val_loss: 0.5861
AUC: 0.8692

Epoch 24/30
 - 0s - loss: 0.9424 - val_loss: 0.5821
AUC: 0.8692

Epoch 25/30
 - 0s - loss: 0.9371 - val_loss: 0.5837
AUC: 0.8692

Epoch 26/30
 - 0s - loss: 0.9425 - val_loss: 0.5841
AUC: 0.8692

Epoch 27/30
 - 0s - loss: 0.9374 - val_loss: 0.5851
AUC: 0.8692

Epoch 28/30
 - 0s - loss: 0.9367 - val_loss: 0.5841
AUC: 0.8692

Epoch 29/30
 - 0s - loss: 0.9410 - val_loss: 0.5831
AUC: 0.8692

Epoch 30/30
 - 0s - loss: 0.9399 - val_loss: 0.5835
Using TensorFlow backend.
AUC: 0.8692

2019-03-08 04:20:12.434873: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:20:12.601638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:20:12.601683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:20:12.901160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:20:12.901213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:20:12.901223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:20:12.901483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1573
Epoch 2/80
 - 2s - loss: 0.2173
Epoch 3/80
 - 2s - loss: 0.1742
Epoch 4/80
 - 2s - loss: 0.1673
Epoch 5/80
 - 2s - loss: 0.1614
Epoch 6/80
 - 2s - loss: 0.1537
Epoch 7/80
 - 2s - loss: 0.1437
Epoch 8/80
 - 2s - loss: 0.1322
Epoch 9/80
 - 2s - loss: 0.1209
Epoch 10/80
 - 2s - loss: 0.1115
Epoch 11/80
 - 2s - loss: 0.1032
Epoch 12/80
 - 2s - loss: 0.0957
Epoch 13/80
 - 2s - loss: 0.0891
Epoch 14/80
 - 2s - loss: 0.0835
Epoch 15/80
 - 2s - loss: 0.0788
Epoch 16/80
 - 2s - loss: 0.0748
Epoch 17/80
 - 2s - loss: 0.0713
Epoch 18/80
 - 2s - loss: 0.0684
Epoch 19/80
 - 2s - loss: 0.0659
Epoch 20/80
 - 2s - loss: 0.0639
Epoch 21/80
 - 2s - loss: 0.0621
Epoch 22/80
 - 2s - loss: 0.0606
Epoch 23/80
 - 2s - loss: 0.0593
Epoch 24/80
 - 2s - loss: 0.0582
Epoch 25/80
 - 2s - loss: 0.0572
Epoch 26/80
 - 2s - loss: 0.0564
Epoch 27/80
 - 2s - loss: 0.0557
Epoch 28/80
 - 2s - loss: 0.0551
Epoch 29/80
 - 2s - loss: 0.0546
Epoch 30/80
 - 2s - loss: 0.0541
Epoch 31/80
 - 2s - loss: 0.0537
Epoch 32/80
 - 2s - loss: 0.0534
Epoch 33/80
 - 2s - loss: 0.0530
Epoch 34/80
 - 2s - loss: 0.0528
Epoch 35/80
 - 2s - loss: 0.0525
Epoch 36/80
 - 2s - loss: 0.0523
Epoch 37/80
 - 2s - loss: 0.0521
Epoch 38/80
 - 2s - loss: 0.0519
Epoch 39/80
 - 2s - loss: 0.0518
Epoch 40/80
 - 2s - loss: 0.0516
Epoch 41/80
 - 2s - loss: 0.0515
Epoch 42/80
 - 2s - loss: 0.0514
Epoch 43/80
 - 2s - loss: 0.0513
Epoch 44/80
 - 2s - loss: 0.0512
Epoch 45/80
 - 2s - loss: 0.0511
Epoch 46/80
 - 2s - loss: 0.0510
Epoch 47/80
 - 2s - loss: 0.0509
Epoch 48/80
 - 2s - loss: 0.0509
Epoch 49/80
 - 2s - loss: 0.0508
Epoch 50/80
 - 2s - loss: 0.0507
Epoch 51/80
 - 2s - loss: 0.0507
Epoch 52/80
 - 2s - loss: 0.0506
Epoch 53/80
 - 2s - loss: 0.0506
Epoch 54/80
 - 2s - loss: 0.0505
Epoch 55/80
 - 2s - loss: 0.0505
Epoch 56/80
 - 2s - loss: 0.0504
Epoch 57/80
 - 2s - loss: 0.0504
Epoch 58/80
 - 2s - loss: 0.0503
Epoch 59/80
 - 2s - loss: 0.0503
Epoch 60/80
 - 2s - loss: 0.0503
Epoch 61/80
 - 2s - loss: 0.0503
Epoch 62/80
 - 2s - loss: 0.0492
Epoch 63/80
 - 2s - loss: 0.0490
Epoch 64/80
 - 2s - loss: 0.0490
Epoch 65/80
 - 2s - loss: 0.0490
Epoch 66/80
 - 2s - loss: 0.0490
Epoch 67/80
 - 2s - loss: 0.0487
Epoch 68/80
 - 2s - loss: 0.0487
Epoch 69/80
 - 2s - loss: 0.0487
Epoch 70/80
 - 2s - loss: 0.0487
Epoch 71/80
 - 2s - loss: 0.0486
Epoch 72/80
 - 2s - loss: 0.0486
Epoch 73/80
 - 2s - loss: 0.0486
Epoch 74/80
 - 2s - loss: 0.0486
Epoch 75/80
 - 2s - loss: 0.0486
Epoch 76/80
 - 2s - loss: 0.0486
Epoch 77/80
 - 2s - loss: 0.0486
Epoch 78/80
 - 2s - loss: 0.0486
Epoch 79/80
 - 2s - loss: 0.0486
Epoch 80/80
 - 2s - loss: 0.0486
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.5371 - val_loss: 1.2086
AUC: 0.8009

Epoch 2/80
 - 0s - loss: 2.3910 - val_loss: 0.9163
AUC: 0.8276

Epoch 3/80
 - 0s - loss: 1.8137 - val_loss: 0.8533
AUC: 0.8419

Epoch 4/80
 - 0s - loss: 1.4584 - val_loss: 0.7935
AUC: 0.8504

Epoch 5/80
 - 0s - loss: 1.2343 - val_loss: 0.7204
AUC: 0.8529

Epoch 6/80
 - 0s - loss: 1.1617 - val_loss: 0.6437
AUC: 0.8525

Epoch 7/80
 - 0s - loss: 1.1294 - val_loss: 0.5969
AUC: 0.8536

Epoch 8/80
 - 0s - loss: 1.0933 - val_loss: 0.6273
AUC: 0.8562

Epoch 9/80
 - 0s - loss: 1.0848 - val_loss: 0.6283
AUC: 0.8568

Epoch 10/80
 - 0s - loss: 1.0700 - val_loss: 0.7001
AUC: 0.8586

Epoch 11/80
 - 0s - loss: 1.0536 - val_loss: 0.6873
AUC: 0.8587

Epoch 12/80
 - 0s - loss: 1.0456 - val_loss: 0.6184
AUC: 0.8592

Epoch 13/80
 - 0s - loss: 1.0429 - val_loss: 0.6429
AUC: 0.8599

Epoch 14/80
 - 0s - loss: 1.0387 - val_loss: 0.5567
AUC: 0.8588

Epoch 15/80
 - 0s - loss: 1.0417 - val_loss: 0.7265
AUC: 0.8626

Epoch 16/80
 - 0s - loss: 1.0201 - val_loss: 0.5647
AUC: 0.8604

Epoch 17/80
 - 0s - loss: 1.0281 - val_loss: 0.6535
AUC: 0.8619

Epoch 18/80
 - 0s - loss: 1.0200 - val_loss: 0.6506
AUC: 0.8638

Epoch 19/80
 - 0s - loss: 1.0190 - val_loss: 0.7320
AUC: 0.8645

Epoch 20/80
 - 0s - loss: 1.0179 - val_loss: 0.6847
AUC: 0.8641

Epoch 21/80
 - 0s - loss: 1.0076 - val_loss: 0.6123
AUC: 0.8634

Epoch 22/80
 - 0s - loss: 1.0028 - val_loss: 0.6090
AUC: 0.8639

Epoch 23/80
 - 0s - loss: 1.0004 - val_loss: 0.6231
AUC: 0.8649

Epoch 24/80
 - 0s - loss: 0.9948 - val_loss: 0.6652
AUC: 0.8650

Epoch 25/80
 - 0s - loss: 0.9929 - val_loss: 0.6246
AUC: 0.8655

Epoch 26/80
 - 0s - loss: 0.9908 - val_loss: 0.6254
AUC: 0.8657

Epoch 27/80
 - 0s - loss: 0.9878 - val_loss: 0.6094
AUC: 0.8655

Epoch 28/80
 - 0s - loss: 0.9837 - val_loss: 0.6213
AUC: 0.8657

Epoch 29/80
 - 0s - loss: 0.9878 - val_loss: 0.6134
AUC: 0.8657

Epoch 30/80
 - 0s - loss: 0.9935 - val_loss: 0.5906
AUC: 0.8657

Epoch 31/80
 - 0s - loss: 0.9862 - val_loss: 0.5982
AUC: 0.8656

Epoch 32/80
 - 0s - loss: 0.9815 - val_loss: 0.6084
AUC: 0.8659

Epoch 33/80
 - 0s - loss: 0.9860 - val_loss: 0.6143
AUC: 0.8659

Epoch 34/80
 - 0s - loss: 0.9843 - val_loss: 0.6103
AUC: 0.8657

Epoch 35/80
 - 0s - loss: 0.9802 - val_loss: 0.6086
AUC: 0.8658

Epoch 36/80
 - 0s - loss: 0.9780 - val_loss: 0.6173
AUC: 0.8660

Epoch 37/80
 - 0s - loss: 0.9760 - val_loss: 0.6052
AUC: 0.8660

Epoch 38/80
 - 0s - loss: 0.9760 - val_loss: 0.6137
AUC: 0.8661

Epoch 39/80
 - 0s - loss: 0.9768 - val_loss: 0.6187
AUC: 0.8662

Epoch 40/80
 - 0s - loss: 0.9778 - val_loss: 0.6149
AUC: 0.8662

Epoch 41/80
 - 0s - loss: 0.9797 - val_loss: 0.6227
AUC: 0.8663

Epoch 42/80
 - 0s - loss: 0.9785 - val_loss: 0.5991
AUC: 0.8660

Epoch 43/80
 - 0s - loss: 0.9773 - val_loss: 0.6237
AUC: 0.8662

Epoch 44/80
 - 0s - loss: 0.9717 - val_loss: 0.6140
AUC: 0.8662

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9763 - val_loss: 0.6005
AUC: 0.8660

Epoch 2/30
 - 0s - loss: 0.9754 - val_loss: 0.6104
AUC: 0.8664

Epoch 3/30
 - 0s - loss: 0.9708 - val_loss: 0.5845
AUC: 0.8664

Epoch 4/30
 - 0s - loss: 0.9743 - val_loss: 0.6075
AUC: 0.8668

Epoch 5/30
 - 0s - loss: 0.9768 - val_loss: 0.6170
AUC: 0.8669

Epoch 6/30
 - 0s - loss: 0.9745 - val_loss: 0.6191
AUC: 0.8673

Epoch 7/30
 - 0s - loss: 0.9696 - val_loss: 0.6200
AUC: 0.8673

Epoch 8/30
 - 0s - loss: 0.9659 - val_loss: 0.5814
AUC: 0.8672

Epoch 9/30
 - 0s - loss: 0.9724 - val_loss: 0.6143
AUC: 0.8676

Epoch 10/30
 - 0s - loss: 0.9611 - val_loss: 0.6125
AUC: 0.8675

Epoch 11/30
 - 0s - loss: 0.9701 - val_loss: 0.5776
AUC: 0.8676

Epoch 12/30
 - 0s - loss: 0.9654 - val_loss: 0.6226
AUC: 0.8682

Epoch 13/30
 - 0s - loss: 0.9600 - val_loss: 0.5802
AUC: 0.8680

Epoch 14/30
 - 0s - loss: 0.9588 - val_loss: 0.6094
AUC: 0.8683

Epoch 15/30
 - 0s - loss: 0.9556 - val_loss: 0.5956
AUC: 0.8684

Epoch 16/30
 - 0s - loss: 0.9611 - val_loss: 0.6060
AUC: 0.8686

Epoch 17/30
 - 0s - loss: 0.9583 - val_loss: 0.6146
AUC: 0.8687

Epoch 18/30
 - 0s - loss: 0.9494 - val_loss: 0.5909
AUC: 0.8684

Epoch 19/30
 - 0s - loss: 0.9595 - val_loss: 0.6135
AUC: 0.8688

Epoch 20/30
 - 0s - loss: 0.9520 - val_loss: 0.5912
AUC: 0.8687

Epoch 21/30
 - 0s - loss: 0.9504 - val_loss: 0.6146
AUC: 0.8689

Epoch 22/30
 - 0s - loss: 0.9486 - val_loss: 0.5959
AUC: 0.8688

Epoch 23/30
 - 0s - loss: 0.9515 - val_loss: 0.6064
AUC: 0.8689

Epoch 24/30
 - 0s - loss: 0.9485 - val_loss: 0.5982
AUC: 0.8689

Epoch 25/30
 - 0s - loss: 0.9492 - val_loss: 0.5999
AUC: 0.8690

Epoch 26/30
 - 0s - loss: 0.9483 - val_loss: 0.5926
AUC: 0.8690

Epoch 27/30
 - 0s - loss: 0.9471 - val_loss: 0.5960
AUC: 0.8690

Epoch 28/30
 - 0s - loss: 0.9466 - val_loss: 0.6018
AUC: 0.8691

Epoch 29/30
 - 0s - loss: 0.9478 - val_loss: 0.5923
AUC: 0.8691

Epoch 30/30
 - 0s - loss: 0.9469 - val_loss: 0.5940
Using TensorFlow backend.
AUC: 0.8691

2019-03-08 04:24:01.965744: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:24:02.133724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:24:02.133789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:24:02.440971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:24:02.441030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:24:02.441041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:24:02.441339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1427
Epoch 2/80
 - 2s - loss: 0.2129
Epoch 3/80
 - 2s - loss: 0.1742
Epoch 4/80
 - 2s - loss: 0.1689
Epoch 5/80
 - 2s - loss: 0.1646
Epoch 6/80
 - 2s - loss: 0.1590
Epoch 7/80
 - 2s - loss: 0.1504
Epoch 8/80
 - 2s - loss: 0.1385
Epoch 9/80
 - 2s - loss: 0.1250
Epoch 10/80
 - 2s - loss: 0.1128
Epoch 11/80
 - 2s - loss: 0.1030
Epoch 12/80
 - 2s - loss: 0.0951
Epoch 13/80
 - 2s - loss: 0.0887
Epoch 14/80
 - 2s - loss: 0.0834
Epoch 15/80
 - 2s - loss: 0.0789
Epoch 16/80
 - 2s - loss: 0.0750
Epoch 17/80
 - 2s - loss: 0.0716
Epoch 18/80
 - 2s - loss: 0.0687
Epoch 19/80
 - 2s - loss: 0.0663
Epoch 20/80
 - 2s - loss: 0.0641
Epoch 21/80
 - 2s - loss: 0.0623
Epoch 22/80
 - 2s - loss: 0.0607
Epoch 23/80
 - 2s - loss: 0.0593
Epoch 24/80
 - 2s - loss: 0.0582
Epoch 25/80
 - 2s - loss: 0.0572
Epoch 26/80
 - 2s - loss: 0.0563
Epoch 27/80
 - 2s - loss: 0.0556
Epoch 28/80
 - 2s - loss: 0.0550
Epoch 29/80
 - 2s - loss: 0.0545
Epoch 30/80
 - 2s - loss: 0.0540
Epoch 31/80
 - 2s - loss: 0.0536
Epoch 32/80
 - 2s - loss: 0.0533
Epoch 33/80
 - 2s - loss: 0.0530
Epoch 34/80
 - 2s - loss: 0.0527
Epoch 35/80
 - 2s - loss: 0.0525
Epoch 36/80
 - 2s - loss: 0.0523
Epoch 37/80
 - 2s - loss: 0.0521
Epoch 38/80
 - 2s - loss: 0.0519
Epoch 39/80
 - 2s - loss: 0.0517
Epoch 40/80
 - 2s - loss: 0.0516
Epoch 41/80
 - 2s - loss: 0.0515
Epoch 42/80
 - 2s - loss: 0.0514
Epoch 43/80
 - 2s - loss: 0.0513
Epoch 44/80
 - 2s - loss: 0.0512
Epoch 45/80
 - 2s - loss: 0.0511
Epoch 46/80
 - 2s - loss: 0.0510
Epoch 47/80
 - 2s - loss: 0.0509
Epoch 48/80
 - 2s - loss: 0.0509
Epoch 49/80
 - 2s - loss: 0.0508
Epoch 50/80
 - 2s - loss: 0.0507
Epoch 51/80
 - 2s - loss: 0.0507
Epoch 52/80
 - 2s - loss: 0.0506
Epoch 53/80
 - 2s - loss: 0.0506
Epoch 54/80
 - 2s - loss: 0.0505
Epoch 55/80
 - 2s - loss: 0.0505
Epoch 56/80
 - 2s - loss: 0.0504
Epoch 57/80
 - 2s - loss: 0.0504
Epoch 58/80
 - 2s - loss: 0.0504
Epoch 59/80
 - 2s - loss: 0.0503
Epoch 60/80
 - 2s - loss: 0.0503
Epoch 61/80
 - 2s - loss: 0.0503
Epoch 62/80
 - 2s - loss: 0.0502
Epoch 63/80
 - 2s - loss: 0.0491
Epoch 64/80
 - 2s - loss: 0.0490
Epoch 65/80
 - 2s - loss: 0.0490
Epoch 66/80
 - 2s - loss: 0.0490
Epoch 67/80
 - 2s - loss: 0.0490
Epoch 68/80
 - 2s - loss: 0.0487
Epoch 69/80
 - 2s - loss: 0.0487
Epoch 70/80
 - 2s - loss: 0.0487
Epoch 71/80
 - 2s - loss: 0.0487
Epoch 72/80
 - 2s - loss: 0.0486
Epoch 73/80
 - 2s - loss: 0.0486
Epoch 74/80
 - 2s - loss: 0.0486
Epoch 75/80
 - 2s - loss: 0.0486
Epoch 76/80
 - 2s - loss: 0.0486
Epoch 77/80
 - 2s - loss: 0.0486
Epoch 78/80
 - 2s - loss: 0.0486
Epoch 79/80
 - 2s - loss: 0.0486
Epoch 80/80
 - 2s - loss: 0.0486
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.9920 - val_loss: 1.4271
AUC: 0.8048

Epoch 2/80
 - 0s - loss: 2.6247 - val_loss: 1.2445
AUC: 0.8302

Epoch 3/80
 - 0s - loss: 1.9780 - val_loss: 0.8550
AUC: 0.8406

Epoch 4/80
 - 0s - loss: 1.5094 - val_loss: 0.7283
AUC: 0.8480

Epoch 5/80
 - 0s - loss: 1.2886 - val_loss: 0.6324
AUC: 0.8511

Epoch 6/80
 - 0s - loss: 1.1988 - val_loss: 0.7111
AUC: 0.8530

Epoch 7/80
 - 0s - loss: 1.1434 - val_loss: 0.8069
AUC: 0.8554

Epoch 8/80
 - 0s - loss: 1.0980 - val_loss: 0.7004
AUC: 0.8554

Epoch 9/80
 - 0s - loss: 1.0879 - val_loss: 0.6285
AUC: 0.8576

Epoch 10/80
 - 0s - loss: 1.0760 - val_loss: 0.5940
AUC: 0.8588

Epoch 11/80
 - 0s - loss: 1.0763 - val_loss: 0.7766
AUC: 0.8603

Epoch 12/80
 - 0s - loss: 1.0593 - val_loss: 0.6867
AUC: 0.8606

Epoch 13/80
 - 0s - loss: 1.0506 - val_loss: 0.6379
AUC: 0.8603

Epoch 14/80
 - 0s - loss: 1.0399 - val_loss: 0.6980
AUC: 0.8639

Epoch 15/80
 - 0s - loss: 1.0355 - val_loss: 0.6376
AUC: 0.8629

Epoch 16/80
 - 0s - loss: 1.0275 - val_loss: 0.6408
AUC: 0.8636

Epoch 17/80
 - 0s - loss: 1.0224 - val_loss: 0.6870
AUC: 0.8631

Epoch 18/80
 - 0s - loss: 1.0263 - val_loss: 0.6958
AUC: 0.8647

Epoch 19/80
 - 0s - loss: 1.0300 - val_loss: 0.6093
AUC: 0.8640

Epoch 20/80
 - 0s - loss: 1.0143 - val_loss: 0.5768
AUC: 0.8648

Epoch 21/80
 - 0s - loss: 1.0134 - val_loss: 0.5854
AUC: 0.8648

Epoch 22/80
 - 0s - loss: 1.0036 - val_loss: 0.6136
AUC: 0.8663

Epoch 23/80
 - 0s - loss: 1.0073 - val_loss: 0.6189
AUC: 0.8668

Epoch 24/80
 - 0s - loss: 0.9967 - val_loss: 0.5916
AUC: 0.8659

Epoch 25/80
 - 0s - loss: 0.9976 - val_loss: 0.5673
AUC: 0.8654

Epoch 26/80
 - 0s - loss: 0.9951 - val_loss: 0.6018
AUC: 0.8661

Epoch 27/80
 - 0s - loss: 0.9945 - val_loss: 0.6364
AUC: 0.8662

Epoch 28/80
 - 0s - loss: 0.9904 - val_loss: 0.6977
AUC: 0.8673

Epoch 29/80
 - 0s - loss: 0.9856 - val_loss: 0.6322
AUC: 0.8655

Epoch 30/80
 - 0s - loss: 0.9819 - val_loss: 0.6535
AUC: 0.8678

Epoch 31/80
 - 0s - loss: 0.9841 - val_loss: 0.6250
AUC: 0.8686

Epoch 32/80
 - 0s - loss: 0.9839 - val_loss: 0.6463
AUC: 0.8684

Epoch 33/80
 - 0s - loss: 0.9766 - val_loss: 0.5620
AUC: 0.8686

Epoch 34/80
 - 0s - loss: 0.9769 - val_loss: 0.6195
AUC: 0.8684

Epoch 35/80
 - 0s - loss: 0.9738 - val_loss: 0.5823
AUC: 0.8682

Epoch 36/80
 - 0s - loss: 0.9724 - val_loss: 0.5867
AUC: 0.8692

Epoch 37/80
 - 0s - loss: 0.9666 - val_loss: 0.6140
AUC: 0.8694

Epoch 38/80
 - 0s - loss: 0.9685 - val_loss: 0.5862
AUC: 0.8695

Epoch 39/80
 - 0s - loss: 0.9641 - val_loss: 0.5925
AUC: 0.8688

Epoch 40/80
 - 0s - loss: 0.9679 - val_loss: 0.6494
AUC: 0.8698

Epoch 41/80
 - 0s - loss: 0.9573 - val_loss: 0.5881
AUC: 0.8685

Epoch 42/80
 - 0s - loss: 0.9593 - val_loss: 0.6763
AUC: 0.8693

Epoch 43/80
 - 0s - loss: 0.9571 - val_loss: 0.5729
AUC: 0.8678

Epoch 44/80
 - 0s - loss: 0.9492 - val_loss: 0.6136
AUC: 0.8704

Epoch 45/80
 - 0s - loss: 0.9472 - val_loss: 0.6025
AUC: 0.8701

Epoch 46/80
 - 0s - loss: 0.9424 - val_loss: 0.6191
AUC: 0.8700

Epoch 47/80
 - 0s - loss: 0.9495 - val_loss: 0.6069
AUC: 0.8704

Epoch 48/80
 - 0s - loss: 0.9468 - val_loss: 0.5630
AUC: 0.8703

Epoch 49/80
 - 0s - loss: 0.9473 - val_loss: 0.6024
AUC: 0.8706

Epoch 50/80
 - 0s - loss: 0.9427 - val_loss: 0.6309
AUC: 0.8704

Epoch 51/80
 - 0s - loss: 0.9450 - val_loss: 0.6108
AUC: 0.8705

Epoch 52/80
 - 0s - loss: 0.9400 - val_loss: 0.6214
AUC: 0.8705

Epoch 53/80
 - 0s - loss: 0.9413 - val_loss: 0.5868
AUC: 0.8704

Epoch 54/80
 - 0s - loss: 0.9356 - val_loss: 0.5940
AUC: 0.8704

Epoch 55/80
 - 0s - loss: 0.9398 - val_loss: 0.5896
AUC: 0.8703

Epoch 56/80
 - 0s - loss: 0.9415 - val_loss: 0.6049
AUC: 0.8704

Epoch 57/80
 - 0s - loss: 0.9340 - val_loss: 0.5771
AUC: 0.8704

Epoch 58/80
 - 0s - loss: 0.9381 - val_loss: 0.5959
AUC: 0.8703

Epoch 59/80
 - 0s - loss: 0.9388 - val_loss: 0.5922
AUC: 0.8703

Epoch 60/80
 - 0s - loss: 0.9333 - val_loss: 0.5910
AUC: 0.8704

Epoch 61/80
 - 0s - loss: 0.9358 - val_loss: 0.5887
AUC: 0.8705

Epoch 62/80
 - 0s - loss: 0.9384 - val_loss: 0.5945
AUC: 0.8705

Epoch 63/80
 - 0s - loss: 0.9354 - val_loss: 0.5833
AUC: 0.8704

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9478 - val_loss: 0.5999
AUC: 0.8705

Epoch 2/30
 - 0s - loss: 0.9374 - val_loss: 0.5978
AUC: 0.8703

Epoch 3/30
 - 0s - loss: 0.9405 - val_loss: 0.6114
AUC: 0.8706

Epoch 4/30
 - 0s - loss: 0.9385 - val_loss: 0.5956
AUC: 0.8704

Epoch 5/30
 - 0s - loss: 0.9300 - val_loss: 0.5708
AUC: 0.8708

Epoch 6/30
 - 0s - loss: 0.9346 - val_loss: 0.5931
AUC: 0.8708

Epoch 7/30
 - 0s - loss: 0.9308 - val_loss: 0.5839
AUC: 0.8709

Epoch 8/30
 - 0s - loss: 0.9339 - val_loss: 0.5930
AUC: 0.8710

Epoch 9/30
 - 0s - loss: 0.9309 - val_loss: 0.5829
AUC: 0.8712

Epoch 10/30
 - 0s - loss: 0.9248 - val_loss: 0.5754
AUC: 0.8711

Epoch 11/30
 - 0s - loss: 0.9266 - val_loss: 0.6139
AUC: 0.8714

Epoch 12/30
 - 0s - loss: 0.9261 - val_loss: 0.5956
AUC: 0.8714

Epoch 13/30
 - 0s - loss: 0.9286 - val_loss: 0.5871
AUC: 0.8713

Epoch 14/30
 - 0s - loss: 0.9249 - val_loss: 0.5961
AUC: 0.8715

Epoch 15/30
 - 0s - loss: 0.9239 - val_loss: 0.5996
AUC: 0.8716

Epoch 16/30
 - 0s - loss: 0.9241 - val_loss: 0.5837
AUC: 0.8715

Epoch 17/30
 - 0s - loss: 0.9260 - val_loss: 0.5852
AUC: 0.8715

Epoch 18/30
 - 0s - loss: 0.9207 - val_loss: 0.5852
AUC: 0.8716

Epoch 19/30
 - 0s - loss: 0.9220 - val_loss: 0.5895
AUC: 0.8716

Epoch 20/30
 - 0s - loss: 0.9209 - val_loss: 0.5840
AUC: 0.8716

Epoch 21/30
 - 0s - loss: 0.9212 - val_loss: 0.5851
AUC: 0.8716

Epoch 22/30
 - 0s - loss: 0.9191 - val_loss: 0.5878
AUC: 0.8716

Epoch 23/30
 - 0s - loss: 0.9166 - val_loss: 0.5861
AUC: 0.8717

Epoch 24/30
 - 0s - loss: 0.9232 - val_loss: 0.5877
AUC: 0.8716

Epoch 25/30
 - 0s - loss: 0.9193 - val_loss: 0.5866
AUC: 0.8716

Epoch 26/30
 - 0s - loss: 0.9143 - val_loss: 0.5859
AUC: 0.8716

Epoch 27/30
 - 0s - loss: 0.9163 - val_loss: 0.5849
AUC: 0.8716

Epoch 28/30
 - 0s - loss: 0.9206 - val_loss: 0.5836
AUC: 0.8716

Epoch 29/30
 - 0s - loss: 0.9251 - val_loss: 0.5846
AUC: 0.8717

Epoch 30/30
 - 0s - loss: 0.9140 - val_loss: 0.5846
Using TensorFlow backend.
AUC: 0.8717

2019-03-08 04:28:05.088312: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:28:05.259932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:28:05.259980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:28:05.566485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:28:05.566541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:28:05.566550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:28:05.566820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.2 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.7093
Epoch 2/80
 - 2s - loss: 0.1428
Epoch 3/80
 - 2s - loss: 0.0727
Epoch 4/80
 - 2s - loss: 0.0648
Epoch 5/80
 - 2s - loss: 0.0612
Epoch 6/80
 - 2s - loss: 0.0581
Epoch 7/80
 - 2s - loss: 0.0548
Epoch 8/80
 - 2s - loss: 0.0515
Epoch 9/80
 - 2s - loss: 0.0484
Epoch 10/80
 - 2s - loss: 0.0454
Epoch 11/80
 - 2s - loss: 0.0425
Epoch 12/80
 - 2s - loss: 0.0396
Epoch 13/80
 - 2s - loss: 0.0368
Epoch 14/80
 - 2s - loss: 0.0343
Epoch 15/80
 - 2s - loss: 0.0322
Epoch 16/80
 - 2s - loss: 0.0303
Epoch 17/80
 - 2s - loss: 0.0285
Epoch 18/80
 - 2s - loss: 0.0270
Epoch 19/80
 - 2s - loss: 0.0256
Epoch 20/80
 - 2s - loss: 0.0244
Epoch 21/80
 - 2s - loss: 0.0234
Epoch 22/80
 - 2s - loss: 0.0224
Epoch 23/80
 - 2s - loss: 0.0217
Epoch 24/80
 - 2s - loss: 0.0210
Epoch 25/80
 - 2s - loss: 0.0204
Epoch 26/80
 - 2s - loss: 0.0199
Epoch 27/80
 - 2s - loss: 0.0195
Epoch 28/80
 - 2s - loss: 0.0191
Epoch 29/80
 - 2s - loss: 0.0188
Epoch 30/80
 - 2s - loss: 0.0185
Epoch 31/80
 - 2s - loss: 0.0183
Epoch 32/80
 - 2s - loss: 0.0180
Epoch 33/80
 - 2s - loss: 0.0179
Epoch 34/80
 - 2s - loss: 0.0177
Epoch 35/80
 - 2s - loss: 0.0176
Epoch 36/80
 - 2s - loss: 0.0174
Epoch 37/80
 - 2s - loss: 0.0173
Epoch 38/80
 - 2s - loss: 0.0173
Epoch 39/80
 - 2s - loss: 0.0172
Epoch 40/80
 - 2s - loss: 0.0171
Epoch 41/80
 - 2s - loss: 0.0170
Epoch 42/80
 - 2s - loss: 0.0170
Epoch 43/80
 - 2s - loss: 0.0169
Epoch 44/80
 - 2s - loss: 0.0168
Epoch 45/80
 - 2s - loss: 0.0168
Epoch 46/80
 - 2s - loss: 0.0168
Epoch 47/80
 - 2s - loss: 0.0167
Epoch 48/80
 - 2s - loss: 0.0167
Epoch 49/80
 - 2s - loss: 0.0166
Epoch 50/80
 - 2s - loss: 0.0166
Epoch 51/80
 - 2s - loss: 0.0166
Epoch 52/80
 - 2s - loss: 0.0165
Epoch 53/80
 - 2s - loss: 0.0165
Epoch 54/80
 - 2s - loss: 0.0165
Epoch 55/80
 - 2s - loss: 0.0161
Epoch 56/80
 - 2s - loss: 0.0160
Epoch 57/80
 - 2s - loss: 0.0160
Epoch 58/80
 - 2s - loss: 0.0160
Epoch 59/80
 - 2s - loss: 0.0159
Epoch 60/80
 - 2s - loss: 0.0159
Epoch 61/80
 - 2s - loss: 0.0159
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 04:30:26.773296: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:30:26.947239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:30:26.947288: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:30:27.260042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:30:27.260115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:30:27.260125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:30:27.260396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6875
Epoch 2/80
 - 2s - loss: 0.1301
Epoch 3/80
 - 2s - loss: 0.0722
Epoch 4/80
 - 2s - loss: 0.0660
Epoch 5/80
 - 2s - loss: 0.0634
Epoch 6/80
 - 2s - loss: 0.0612
Epoch 7/80
 - 2s - loss: 0.0587
Epoch 8/80
 - 2s - loss: 0.0556
Epoch 9/80
 - 2s - loss: 0.0521
Epoch 10/80
 - 2s - loss: 0.0482
Epoch 11/80
 - 2s - loss: 0.0444
Epoch 12/80
 - 2s - loss: 0.0410
Epoch 13/80
 - 2s - loss: 0.0379
Epoch 14/80
 - 2s - loss: 0.0351
Epoch 15/80
 - 2s - loss: 0.0327
Epoch 16/80
 - 2s - loss: 0.0307
Epoch 17/80
 - 2s - loss: 0.0288
Epoch 18/80
 - 2s - loss: 0.0272
Epoch 19/80
 - 2s - loss: 0.0258
Epoch 20/80
 - 2s - loss: 0.0246
Epoch 21/80
 - 2s - loss: 0.0235
Epoch 22/80
 - 2s - loss: 0.0226
Epoch 23/80
 - 2s - loss: 0.0219
Epoch 24/80
 - 2s - loss: 0.0212
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 04:31:37.768074: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:31:37.938359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:31:37.938404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:31:38.248872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:31:38.248929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:31:38.248939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:31:38.249220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6934
Epoch 2/80
 - 2s - loss: 0.1309
Epoch 3/80
 - 2s - loss: 0.0718
Epoch 4/80
 - 2s - loss: 0.0661
Epoch 5/80
 - 2s - loss: 0.0638
Epoch 6/80
 - 2s - loss: 0.0619
Epoch 7/80
 - 2s - loss: 0.0598
Epoch 8/80
 - 2s - loss: 0.0574
Epoch 9/80
 - 2s - loss: 0.0547
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 04:32:14.279109: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:32:14.448885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:32:14.448942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:32:14.755613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:32:14.755670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:32:14.755679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:32:14.755949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3709
Epoch 2/80
 - 2s - loss: 0.3510
Epoch 3/80
 - 2s - loss: 0.3103
Epoch 4/80
 - 2s - loss: 0.2998
Epoch 5/80
 - 2s - loss: 0.2871
Epoch 6/80
 - 2s - loss: 0.2701
Epoch 7/80
 - 2s - loss: 0.2495
Epoch 8/80
 - 2s - loss: 0.2280
Epoch 9/80
 - 2s - loss: 0.2090
Epoch 10/80
 - 2s - loss: 0.1939
Epoch 11/80
 - 2s - loss: 0.1816
Epoch 12/80
 - 2s - loss: 0.1715
Epoch 13/80
 - 2s - loss: 0.1632
Epoch 14/80
 - 2s - loss: 0.1564
Epoch 15/80
 - 2s - loss: 0.1506
Epoch 16/80
 - 2s - loss: 0.1457
Epoch 17/80
 - 2s - loss: 0.1415
Epoch 18/80
 - 2s - loss: 0.1378
Epoch 19/80
 - 2s - loss: 0.1347
Epoch 20/80
 - 2s - loss: 0.1319
Epoch 21/80
 - 2s - loss: 0.1296
Epoch 22/80
 - 2s - loss: 0.1275
Epoch 23/80
 - 2s - loss: 0.1258
Epoch 24/80
 - 2s - loss: 0.1244
Epoch 25/80
 - 2s - loss: 0.1231
Epoch 26/80
 - 2s - loss: 0.1221
Epoch 27/80
 - 2s - loss: 0.1212
Epoch 28/80
 - 2s - loss: 0.1204
Epoch 29/80
 - 2s - loss: 0.1198
Epoch 30/80
 - 2s - loss: 0.1192
Epoch 31/80
 - 2s - loss: 0.1187
Epoch 32/80
 - 2s - loss: 0.1182
Epoch 33/80
 - 2s - loss: 0.1179
Epoch 34/80
 - 2s - loss: 0.1175
Epoch 35/80
 - 2s - loss: 0.1172
Epoch 36/80
 - 2s - loss: 0.1169
Epoch 37/80
 - 2s - loss: 0.1167
Epoch 38/80
 - 2s - loss: 0.1165
Epoch 39/80
 - 2s - loss: 0.1163
Epoch 40/80
 - 2s - loss: 0.1161
Epoch 41/80
 - 2s - loss: 0.1159
Epoch 42/80
 - 2s - loss: 0.1158
Epoch 43/80
 - 2s - loss: 0.1156
Epoch 44/80
 - 2s - loss: 0.1155
Epoch 45/80
 - 2s - loss: 0.1154
Epoch 46/80
 - 2s - loss: 0.1153
Epoch 47/80
 - 2s - loss: 0.1152
Epoch 48/80
 - 2s - loss: 0.1150
Epoch 49/80
 - 2s - loss: 0.1150
Epoch 50/80
 - 2s - loss: 0.1149
Epoch 51/80
 - 2s - loss: 0.1148
Epoch 52/80
 - 2s - loss: 0.1148
Epoch 53/80
 - 2s - loss: 0.1147
Epoch 54/80
 - 2s - loss: 0.1146
Epoch 55/80
 - 2s - loss: 0.1145
Epoch 56/80
 - 2s - loss: 0.1145
Epoch 57/80
 - 2s - loss: 0.1144
Epoch 58/80
 - 2s - loss: 0.1144
Epoch 59/80
 - 2s - loss: 0.1144
Epoch 60/80
 - 2s - loss: 0.1143
Epoch 61/80
 - 2s - loss: 0.1143
Epoch 62/80
 - 2s - loss: 0.1142
Epoch 63/80
 - 2s - loss: 0.1142
Epoch 64/80
 - 2s - loss: 0.1119
Epoch 65/80
 - 2s - loss: 0.1117
Epoch 66/80
 - 2s - loss: 0.1117
Epoch 67/80
 - 2s - loss: 0.1117
Epoch 68/80
 - 2s - loss: 0.1117
Epoch 69/80
 - 2s - loss: 0.1111
Epoch 70/80
 - 2s - loss: 0.1111
Epoch 71/80
 - 2s - loss: 0.1111
Epoch 72/80
 - 2s - loss: 0.1111
Epoch 73/80
 - 2s - loss: 0.1109
Epoch 74/80
 - 2s - loss: 0.1109
Epoch 75/80
 - 2s - loss: 0.1109
Epoch 76/80
 - 2s - loss: 0.1109
Epoch 77/80
 - 2s - loss: 0.1109
Epoch 78/80
 - 2s - loss: 0.1109
Epoch 79/80
 - 2s - loss: 0.1109
Epoch 80/80
 - 2s - loss: 0.1109
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.6451 - val_loss: 1.1316
AUC: 0.8202

Epoch 2/80
 - 0s - loss: 1.6681 - val_loss: 0.6021
AUC: 0.8348

Epoch 3/80
 - 0s - loss: 1.3260 - val_loss: 0.6671
AUC: 0.8454

Epoch 4/80
 - 0s - loss: 1.1705 - val_loss: 0.6056
AUC: 0.8491

Epoch 5/80
 - 0s - loss: 1.1081 - val_loss: 0.5864
AUC: 0.8485

Epoch 6/80
 - 0s - loss: 1.0837 - val_loss: 0.6498
AUC: 0.8547

Epoch 7/80
 - 0s - loss: 1.0570 - val_loss: 0.6443
AUC: 0.8544

Epoch 8/80
 - 0s - loss: 1.0494 - val_loss: 0.6677
AUC: 0.8569

Epoch 9/80
 - 0s - loss: 1.0472 - val_loss: 0.6701
AUC: 0.8576

Epoch 10/80
 - 0s - loss: 1.0328 - val_loss: 0.6312
AUC: 0.8581

Epoch 11/80
 - 0s - loss: 1.0257 - val_loss: 0.6768
AUC: 0.8590

Epoch 12/80
 - 0s - loss: 1.0171 - val_loss: 0.6358
AUC: 0.8599

Epoch 13/80
 - 0s - loss: 1.0120 - val_loss: 0.5831
AUC: 0.8594

Epoch 14/80
 - 0s - loss: 1.0002 - val_loss: 0.6493
AUC: 0.8611

Epoch 15/80
 - 0s - loss: 1.0033 - val_loss: 0.6778
AUC: 0.8602

Epoch 16/80
 - 0s - loss: 0.9953 - val_loss: 0.6633
AUC: 0.8617

Epoch 17/80
 - 0s - loss: 0.9955 - val_loss: 0.6732
AUC: 0.8611

Epoch 18/80
 - 0s - loss: 0.9872 - val_loss: 0.6228
AUC: 0.8623

Epoch 19/80
 - 0s - loss: 0.9877 - val_loss: 0.5520
AUC: 0.8618

Epoch 20/80
 - 0s - loss: 0.9815 - val_loss: 0.6340
AUC: 0.8607

Epoch 21/80
 - 0s - loss: 0.9764 - val_loss: 0.6756
AUC: 0.8636

Epoch 22/80
 - 0s - loss: 0.9754 - val_loss: 0.5709
AUC: 0.8623

Epoch 23/80
 - 0s - loss: 0.9778 - val_loss: 0.6541
AUC: 0.8632

Epoch 24/80
 - 0s - loss: 0.9647 - val_loss: 0.5743
AUC: 0.8627

Epoch 25/80
 - 0s - loss: 0.9653 - val_loss: 0.5863
AUC: 0.8640

Epoch 26/80
 - 0s - loss: 0.9635 - val_loss: 0.6102
AUC: 0.8627

Epoch 27/80
 - 0s - loss: 0.9602 - val_loss: 0.6110
AUC: 0.8648

Epoch 28/80
 - 0s - loss: 0.9554 - val_loss: 0.5531
AUC: 0.8628

Epoch 29/80
 - 0s - loss: 0.9546 - val_loss: 0.5183
AUC: 0.8628

Epoch 30/80
 - 0s - loss: 0.9544 - val_loss: 0.6116
AUC: 0.8646

Epoch 31/80
 - 0s - loss: 0.9419 - val_loss: 0.6491
AUC: 0.8636

Epoch 32/80
 - 0s - loss: 0.9414 - val_loss: 0.5826
AUC: 0.8636

Epoch 33/80
 - 0s - loss: 0.9415 - val_loss: 0.5558
AUC: 0.8650

Epoch 34/80
 - 0s - loss: 0.9361 - val_loss: 0.6000
AUC: 0.8655

Epoch 35/80
 - 0s - loss: 0.9300 - val_loss: 0.5776
AUC: 0.8648

Epoch 36/80
 - 0s - loss: 0.9325 - val_loss: 0.5267
AUC: 0.8650

Epoch 37/80
 - 0s - loss: 0.9355 - val_loss: 0.5665
AUC: 0.8640

Epoch 38/80
 - 0s - loss: 0.9337 - val_loss: 0.6081
AUC: 0.8650

Epoch 39/80
 - 0s - loss: 0.9364 - val_loss: 0.5612
AUC: 0.8658

Epoch 40/80
 - 0s - loss: 0.9108 - val_loss: 0.5535
AUC: 0.8661

Epoch 41/80
 - 0s - loss: 0.9149 - val_loss: 0.6050
AUC: 0.8662

Epoch 42/80
 - 0s - loss: 0.9085 - val_loss: 0.5530
AUC: 0.8662

Epoch 43/80
 - 0s - loss: 0.9114 - val_loss: 0.5902
AUC: 0.8666

Epoch 44/80
 - 0s - loss: 0.9105 - val_loss: 0.5791
AUC: 0.8663

Epoch 45/80
 - 0s - loss: 0.9055 - val_loss: 0.6028
AUC: 0.8664

Epoch 46/80
 - 0s - loss: 0.9060 - val_loss: 0.5602
AUC: 0.8663

Epoch 47/80
 - 0s - loss: 0.9032 - val_loss: 0.5661
AUC: 0.8666

Epoch 48/80
 - 0s - loss: 0.9032 - val_loss: 0.5532
AUC: 0.8660

Epoch 49/80
 - 0s - loss: 0.9042 - val_loss: 0.6169
AUC: 0.8666

Epoch 50/80
 - 0s - loss: 0.8968 - val_loss: 0.5740
AUC: 0.8663

Epoch 51/80
 - 0s - loss: 0.8965 - val_loss: 0.5796
AUC: 0.8664

Epoch 52/80
 - 0s - loss: 0.9013 - val_loss: 0.5848
AUC: 0.8664

Epoch 53/80
 - 0s - loss: 0.8933 - val_loss: 0.5872
AUC: 0.8663

Epoch 54/80
 - 0s - loss: 0.8943 - val_loss: 0.5729
AUC: 0.8664

Epoch 55/80
 - 0s - loss: 0.8973 - val_loss: 0.5695
AUC: 0.8663

Epoch 56/80
 - 0s - loss: 0.8977 - val_loss: 0.5792
AUC: 0.8664

Epoch 57/80
 - 0s - loss: 0.8965 - val_loss: 0.5767
AUC: 0.8664

Epoch 58/80
 - 0s - loss: 0.8949 - val_loss: 0.5800
AUC: 0.8665

Epoch 59/80
 - 0s - loss: 0.8968 - val_loss: 0.5682
AUC: 0.8664

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9030 - val_loss: 0.5519
AUC: 0.8663

Epoch 2/30
 - 0s - loss: 0.9035 - val_loss: 0.6104
AUC: 0.8666

Epoch 3/30
 - 0s - loss: 0.9001 - val_loss: 0.5735
AUC: 0.8668

Epoch 4/30
 - 0s - loss: 0.8988 - val_loss: 0.5771
AUC: 0.8667

Epoch 5/30
 - 0s - loss: 0.9025 - val_loss: 0.6028
AUC: 0.8668

Epoch 6/30
 - 0s - loss: 0.9027 - val_loss: 0.5560
AUC: 0.8666

Epoch 7/30
 - 0s - loss: 0.8979 - val_loss: 0.5780
AUC: 0.8667

Epoch 8/30
 - 0s - loss: 0.8948 - val_loss: 0.5687
AUC: 0.8665

Epoch 9/30
 - 0s - loss: 0.8941 - val_loss: 0.5713
AUC: 0.8669

Epoch 10/30
 - 0s - loss: 0.8941 - val_loss: 0.5846
AUC: 0.8671

Epoch 11/30
 - 0s - loss: 0.8894 - val_loss: 0.5835
AUC: 0.8670

Epoch 12/30
 - 0s - loss: 0.8891 - val_loss: 0.5712
AUC: 0.8670

Epoch 13/30
 - 0s - loss: 0.8860 - val_loss: 0.5693
AUC: 0.8671

Epoch 14/30
 - 0s - loss: 0.8857 - val_loss: 0.5740
AUC: 0.8671

Epoch 15/30
 - 0s - loss: 0.8887 - val_loss: 0.5699
AUC: 0.8671

Epoch 16/30
 - 0s - loss: 0.8879 - val_loss: 0.5723
AUC: 0.8671

Epoch 17/30
 - 0s - loss: 0.8880 - val_loss: 0.5680
AUC: 0.8671

Epoch 18/30
 - 0s - loss: 0.8845 - val_loss: 0.5710
AUC: 0.8671

Epoch 19/30
 - 0s - loss: 0.8866 - val_loss: 0.5721
AUC: 0.8671

Epoch 20/30
 - 0s - loss: 0.8817 - val_loss: 0.5734
AUC: 0.8672

Epoch 21/30
 - 0s - loss: 0.8868 - val_loss: 0.5742
AUC: 0.8671

Epoch 22/30
 - 0s - loss: 0.8884 - val_loss: 0.5745
AUC: 0.8672

Epoch 23/30
 - 0s - loss: 0.8864 - val_loss: 0.5729
AUC: 0.8671

Epoch 24/30
 - 0s - loss: 0.8865 - val_loss: 0.5725
AUC: 0.8671

Epoch 25/30
 - 0s - loss: 0.8848 - val_loss: 0.5723
AUC: 0.8671

Epoch 26/30
 - 0s - loss: 0.8844 - val_loss: 0.5717
AUC: 0.8671

Epoch 27/30
 - 0s - loss: 0.8824 - val_loss: 0.5702
AUC: 0.8671

Epoch 28/30
 - 0s - loss: 0.8833 - val_loss: 0.5718
AUC: 0.8672

Epoch 29/30
 - 0s - loss: 0.8797 - val_loss: 0.5712
AUC: 0.8672

Epoch 30/30
 - 0s - loss: 0.8868 - val_loss: 0.5717
Using TensorFlow backend.
AUC: 0.8672

2019-03-08 04:36:14.642593: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:36:14.814476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:36:14.814522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:36:15.121039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:36:15.121095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:36:15.121105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:36:15.121394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3839
Epoch 2/80
 - 2s - loss: 0.3531
Epoch 3/80
 - 2s - loss: 0.3078
Epoch 4/80
 - 2s - loss: 0.2927
Epoch 5/80
 - 2s - loss: 0.2741
Epoch 6/80
 - 2s - loss: 0.2526
Epoch 7/80
 - 2s - loss: 0.2328
Epoch 8/80
 - 2s - loss: 0.2158
Epoch 9/80
 - 2s - loss: 0.2014
Epoch 10/80
 - 2s - loss: 0.1895
Epoch 11/80
 - 2s - loss: 0.1796
Epoch 12/80
 - 2s - loss: 0.1707
Epoch 13/80
 - 2s - loss: 0.1629
Epoch 14/80
 - 2s - loss: 0.1559
Epoch 15/80
 - 2s - loss: 0.1500
Epoch 16/80
 - 2s - loss: 0.1449
Epoch 17/80
 - 2s - loss: 0.1404
Epoch 18/80
 - 2s - loss: 0.1365
Epoch 19/80
 - 2s - loss: 0.1332
Epoch 20/80
 - 2s - loss: 0.1306
Epoch 21/80
 - 2s - loss: 0.1282
Epoch 22/80
 - 2s - loss: 0.1264
Epoch 23/80
 - 2s - loss: 0.1248
Epoch 24/80
 - 2s - loss: 0.1234
Epoch 25/80
 - 2s - loss: 0.1223
Epoch 26/80
 - 2s - loss: 0.1214
Epoch 27/80
 - 2s - loss: 0.1205
Epoch 28/80
 - 2s - loss: 0.1199
Epoch 29/80
 - 2s - loss: 0.1192
Epoch 30/80
 - 2s - loss: 0.1187
Epoch 31/80
 - 2s - loss: 0.1182
Epoch 32/80
 - 2s - loss: 0.1178
Epoch 33/80
 - 2s - loss: 0.1174
Epoch 34/80
 - 2s - loss: 0.1171
Epoch 35/80
 - 2s - loss: 0.1168
Epoch 36/80
 - 2s - loss: 0.1166
Epoch 37/80
 - 2s - loss: 0.1163
Epoch 38/80
 - 2s - loss: 0.1161
Epoch 39/80
 - 2s - loss: 0.1159
Epoch 40/80
 - 2s - loss: 0.1157
Epoch 41/80
 - 2s - loss: 0.1156
Epoch 42/80
 - 2s - loss: 0.1155
Epoch 43/80
 - 2s - loss: 0.1153
Epoch 44/80
 - 2s - loss: 0.1152
Epoch 45/80
 - 2s - loss: 0.1151
Epoch 46/80
 - 2s - loss: 0.1150
Epoch 47/80
 - 2s - loss: 0.1149
Epoch 48/80
 - 2s - loss: 0.1148
Epoch 49/80
 - 2s - loss: 0.1147
Epoch 50/80
 - 2s - loss: 0.1146
Epoch 51/80
 - 2s - loss: 0.1145
Epoch 52/80
 - 2s - loss: 0.1145
Epoch 53/80
 - 2s - loss: 0.1144
Epoch 54/80
 - 2s - loss: 0.1144
Epoch 55/80
 - 2s - loss: 0.1143
Epoch 56/80
 - 2s - loss: 0.1142
Epoch 57/80
 - 2s - loss: 0.1142
Epoch 58/80
 - 2s - loss: 0.1141
Epoch 59/80
 - 2s - loss: 0.1141
Epoch 60/80
 - 2s - loss: 0.1141
Epoch 61/80
 - 2s - loss: 0.1140
Epoch 62/80
 - 2s - loss: 0.1140
Epoch 63/80
 - 2s - loss: 0.1117
Epoch 64/80
 - 2s - loss: 0.1115
Epoch 65/80
 - 2s - loss: 0.1115
Epoch 66/80
 - 2s - loss: 0.1115
Epoch 67/80
 - 2s - loss: 0.1114
Epoch 68/80
 - 2s - loss: 0.1109
Epoch 69/80
 - 2s - loss: 0.1109
Epoch 70/80
 - 2s - loss: 0.1109
Epoch 71/80
 - 2s - loss: 0.1109
Epoch 72/80
 - 2s - loss: 0.1107
Epoch 73/80
 - 2s - loss: 0.1107
Epoch 74/80
 - 2s - loss: 0.1107
Epoch 75/80
 - 2s - loss: 0.1107
Epoch 76/80
 - 2s - loss: 0.1107
Epoch 77/80
 - 2s - loss: 0.1107
Epoch 78/80
 - 2s - loss: 0.1107
Epoch 79/80
 - 2s - loss: 0.1107
Epoch 80/80
 - 2s - loss: 0.1107
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.7906 - val_loss: 1.3575
AUC: 0.8249

Epoch 2/80
 - 0s - loss: 1.6938 - val_loss: 0.7519
AUC: 0.8469

Epoch 3/80
 - 0s - loss: 1.2827 - val_loss: 0.7763
AUC: 0.8553

Epoch 4/80
 - 0s - loss: 1.1488 - val_loss: 0.7267
AUC: 0.8566

Epoch 5/80
 - 0s - loss: 1.1025 - val_loss: 0.6607
AUC: 0.8596

Epoch 6/80
 - 0s - loss: 1.0796 - val_loss: 0.6234
AUC: 0.8587

Epoch 7/80
 - 0s - loss: 1.0644 - val_loss: 0.6354
AUC: 0.8610

Epoch 8/80
 - 0s - loss: 1.0499 - val_loss: 0.6157
AUC: 0.8604

Epoch 9/80
 - 0s - loss: 1.0469 - val_loss: 0.5576
AUC: 0.8615

Epoch 10/80
 - 0s - loss: 1.0375 - val_loss: 0.5803
AUC: 0.8619

Epoch 11/80
 - 0s - loss: 1.0331 - val_loss: 0.6751
AUC: 0.8643

Epoch 12/80
 - 0s - loss: 1.0193 - val_loss: 0.6675
AUC: 0.8646

Epoch 13/80
 - 0s - loss: 1.0122 - val_loss: 0.5919
AUC: 0.8640

Epoch 14/80
 - 0s - loss: 1.0120 - val_loss: 0.5715
AUC: 0.8645

Epoch 15/80
 - 0s - loss: 1.0038 - val_loss: 0.6166
AUC: 0.8631

Epoch 16/80
 - 0s - loss: 1.0013 - val_loss: 0.6889
AUC: 0.8666

Epoch 17/80
 - 0s - loss: 0.9961 - val_loss: 0.5314
AUC: 0.8654

Epoch 18/80
 - 0s - loss: 1.0041 - val_loss: 0.5926
AUC: 0.8660

Epoch 19/80
 - 0s - loss: 0.9912 - val_loss: 0.5912
AUC: 0.8676

Epoch 20/80
 - 0s - loss: 0.9880 - val_loss: 0.5862
AUC: 0.8674

Epoch 21/80
 - 0s - loss: 0.9838 - val_loss: 0.6583
AUC: 0.8682

Epoch 22/80
 - 0s - loss: 0.9786 - val_loss: 0.5763
AUC: 0.8672

Epoch 23/80
 - 0s - loss: 0.9803 - val_loss: 0.6258
AUC: 0.8667

Epoch 24/80
 - 0s - loss: 0.9791 - val_loss: 0.5803
AUC: 0.8662

Epoch 25/80
 - 0s - loss: 0.9763 - val_loss: 0.5608
AUC: 0.8679

Epoch 26/80
 - 0s - loss: 0.9640 - val_loss: 0.6203
AUC: 0.8686

Epoch 27/80
 - 0s - loss: 0.9641 - val_loss: 0.5528
AUC: 0.8683

Epoch 28/80
 - 0s - loss: 0.9608 - val_loss: 0.5802
AUC: 0.8693

Epoch 29/80
 - 0s - loss: 0.9568 - val_loss: 0.6062
AUC: 0.8696

Epoch 30/80
 - 0s - loss: 0.9539 - val_loss: 0.5872
AUC: 0.8693

Epoch 31/80
 - 0s - loss: 0.9482 - val_loss: 0.6146
AUC: 0.8695

Epoch 32/80
 - 0s - loss: 0.9488 - val_loss: 0.6174
AUC: 0.8693

Epoch 33/80
 - 0s - loss: 0.9545 - val_loss: 0.5928
AUC: 0.8695

Epoch 34/80
 - 0s - loss: 0.9501 - val_loss: 0.5739
AUC: 0.8693

Epoch 35/80
 - 0s - loss: 0.9455 - val_loss: 0.5861
AUC: 0.8693

Epoch 36/80
 - 0s - loss: 0.9475 - val_loss: 0.5951
AUC: 0.8693

Epoch 37/80
 - 0s - loss: 0.9476 - val_loss: 0.6109
AUC: 0.8695

Epoch 38/80
 - 0s - loss: 0.9427 - val_loss: 0.5935
AUC: 0.8695

Epoch 39/80
 - 0s - loss: 0.9466 - val_loss: 0.5950
AUC: 0.8694

Epoch 40/80
 - 0s - loss: 0.9462 - val_loss: 0.5867
AUC: 0.8694

Epoch 41/80
 - 0s - loss: 0.9433 - val_loss: 0.5960
AUC: 0.8694

Epoch 42/80
 - 0s - loss: 0.9443 - val_loss: 0.5915
AUC: 0.8694

Epoch 43/80
 - 0s - loss: 0.9428 - val_loss: 0.5873
AUC: 0.8693

Epoch 44/80
 - 0s - loss: 0.9416 - val_loss: 0.6027
AUC: 0.8695

Epoch 45/80
 - 0s - loss: 0.9416 - val_loss: 0.5982
AUC: 0.8694

Epoch 46/80
 - 0s - loss: 0.9433 - val_loss: 0.6000
AUC: 0.8694

Epoch 47/80
 - 0s - loss: 0.9396 - val_loss: 0.5981
AUC: 0.8695

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9512 - val_loss: 0.5959
AUC: 0.8693

Epoch 2/30
 - 0s - loss: 0.9520 - val_loss: 0.5852
AUC: 0.8694

Epoch 3/30
 - 0s - loss: 0.9463 - val_loss: 0.5913
AUC: 0.8694

Epoch 4/30
 - 1s - loss: 0.9468 - val_loss: 0.6067
AUC: 0.8697

Epoch 5/30
 - 0s - loss: 0.9426 - val_loss: 0.5910
AUC: 0.8698

Epoch 6/30
 - 0s - loss: 0.9509 - val_loss: 0.5737
AUC: 0.8697

Epoch 7/30
 - 0s - loss: 0.9459 - val_loss: 0.5777
AUC: 0.8697

Epoch 8/30
 - 1s - loss: 0.9410 - val_loss: 0.6057
AUC: 0.8699

Epoch 9/30
 - 1s - loss: 0.9408 - val_loss: 0.5981
AUC: 0.8701

Epoch 10/30
 - 0s - loss: 0.9392 - val_loss: 0.5860
AUC: 0.8700

Epoch 11/30
 - 0s - loss: 0.9398 - val_loss: 0.5694
AUC: 0.8700

Epoch 12/30
 - 1s - loss: 0.9399 - val_loss: 0.5882
AUC: 0.8702

Epoch 13/30
 - 0s - loss: 0.9389 - val_loss: 0.6121
AUC: 0.8704

Epoch 14/30
 - 1s - loss: 0.9308 - val_loss: 0.5914
AUC: 0.8704

Epoch 15/30
 - 0s - loss: 0.9312 - val_loss: 0.5888
AUC: 0.8703

Epoch 16/30
 - 0s - loss: 0.9312 - val_loss: 0.5772
AUC: 0.8703

Epoch 17/30
 - 0s - loss: 0.9305 - val_loss: 0.5950
AUC: 0.8706

Epoch 18/30
 - 0s - loss: 0.9273 - val_loss: 0.5791
AUC: 0.8705

Epoch 19/30
 - 0s - loss: 0.9255 - val_loss: 0.5989
AUC: 0.8707

Epoch 20/30
 - 0s - loss: 0.9266 - val_loss: 0.5756
AUC: 0.8706

Epoch 21/30
 - 0s - loss: 0.9240 - val_loss: 0.5890
AUC: 0.8708

Epoch 22/30
 - 0s - loss: 0.9197 - val_loss: 0.5859
AUC: 0.8708

Epoch 23/30
 - 0s - loss: 0.9217 - val_loss: 0.5864
AUC: 0.8709

Epoch 24/30
 - 0s - loss: 0.9201 - val_loss: 0.5841
AUC: 0.8708

Epoch 25/30
 - 0s - loss: 0.9198 - val_loss: 0.5880
AUC: 0.8708

Epoch 26/30
 - 0s - loss: 0.9213 - val_loss: 0.5862
AUC: 0.8708

Epoch 27/30
 - 0s - loss: 0.9206 - val_loss: 0.5871
AUC: 0.8708

Epoch 28/30
 - 0s - loss: 0.9202 - val_loss: 0.5880
AUC: 0.8708

Epoch 29/30
 - 0s - loss: 0.9202 - val_loss: 0.5878
AUC: 0.8708

Epoch 30/30
 - 0s - loss: 0.9202 - val_loss: 0.5929
Using TensorFlow backend.
AUC: 0.8708

2019-03-08 04:40:04.093600: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:40:04.264035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:40:04.264095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:40:04.574382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:40:04.574438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:40:04.574447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:40:04.574712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3548
Epoch 2/80
 - 2s - loss: 0.3503
Epoch 3/80
 - 2s - loss: 0.3051
Epoch 4/80
 - 2s - loss: 0.2893
Epoch 5/80
 - 2s - loss: 0.2728
Epoch 6/80
 - 2s - loss: 0.2555
Epoch 7/80
 - 2s - loss: 0.2380
Epoch 8/80
 - 2s - loss: 0.2213
Epoch 9/80
 - 2s - loss: 0.2064
Epoch 10/80
 - 2s - loss: 0.1932
Epoch 11/80
 - 2s - loss: 0.1815
Epoch 12/80
 - 2s - loss: 0.1712
Epoch 13/80
 - 2s - loss: 0.1625
Epoch 14/80
 - 2s - loss: 0.1553
Epoch 15/80
 - 2s - loss: 0.1493
Epoch 16/80
 - 2s - loss: 0.1442
Epoch 17/80
 - 2s - loss: 0.1400
Epoch 18/80
 - 2s - loss: 0.1365
Epoch 19/80
 - 2s - loss: 0.1336
Epoch 20/80
 - 2s - loss: 0.1311
Epoch 21/80
 - 2s - loss: 0.1290
Epoch 22/80
 - 2s - loss: 0.1271
Epoch 23/80
 - 2s - loss: 0.1256
Epoch 24/80
 - 2s - loss: 0.1242
Epoch 25/80
 - 2s - loss: 0.1230
Epoch 26/80
 - 2s - loss: 0.1220
Epoch 27/80
 - 2s - loss: 0.1212
Epoch 28/80
 - 2s - loss: 0.1204
Epoch 29/80
 - 2s - loss: 0.1198
Epoch 30/80
 - 2s - loss: 0.1193
Epoch 31/80
 - 2s - loss: 0.1188
Epoch 32/80
 - 2s - loss: 0.1184
Epoch 33/80
 - 2s - loss: 0.1180
Epoch 34/80
 - 2s - loss: 0.1177
Epoch 35/80
 - 2s - loss: 0.1174
Epoch 36/80
 - 2s - loss: 0.1172
Epoch 37/80
 - 2s - loss: 0.1170
Epoch 38/80
 - 2s - loss: 0.1167
Epoch 39/80
 - 2s - loss: 0.1165
Epoch 40/80
 - 2s - loss: 0.1164
Epoch 41/80
 - 2s - loss: 0.1162
Epoch 42/80
 - 2s - loss: 0.1161
Epoch 43/80
 - 2s - loss: 0.1159
Epoch 44/80
 - 2s - loss: 0.1158
Epoch 45/80
 - 2s - loss: 0.1157
Epoch 46/80
 - 2s - loss: 0.1156
Epoch 47/80
 - 2s - loss: 0.1155
Epoch 48/80
 - 2s - loss: 0.1154
Epoch 49/80
 - 2s - loss: 0.1153
Epoch 50/80
 - 2s - loss: 0.1152
Epoch 51/80
 - 2s - loss: 0.1152
Epoch 52/80
 - 2s - loss: 0.1151
Epoch 53/80
 - 2s - loss: 0.1150
Epoch 54/80
 - 2s - loss: 0.1150
Epoch 55/80
 - 2s - loss: 0.1149
Epoch 56/80
 - 2s - loss: 0.1149
Epoch 57/80
 - 2s - loss: 0.1148
Epoch 58/80
 - 2s - loss: 0.1148
Epoch 59/80
 - 2s - loss: 0.1147
Epoch 60/80
 - 2s - loss: 0.1147
Epoch 61/80
 - 2s - loss: 0.1146
Epoch 62/80
 - 2s - loss: 0.1146
Epoch 63/80
 - 2s - loss: 0.1146
Epoch 64/80
 - 2s - loss: 0.1145
Epoch 65/80
 - 2s - loss: 0.1145
Epoch 66/80
 - 2s - loss: 0.1145
Epoch 67/80
 - 2s - loss: 0.1122
Epoch 68/80
 - 2s - loss: 0.1120
Epoch 69/80
 - 2s - loss: 0.1119
Epoch 70/80
 - 2s - loss: 0.1119
Epoch 71/80
 - 2s - loss: 0.1119
Epoch 72/80
 - 2s - loss: 0.1113
Epoch 73/80
 - 2s - loss: 0.1113
Epoch 74/80
 - 2s - loss: 0.1113
Epoch 75/80
 - 2s - loss: 0.1113
Epoch 76/80
 - 2s - loss: 0.1112
Epoch 77/80
 - 2s - loss: 0.1112
Epoch 78/80
 - 2s - loss: 0.1112
Epoch 79/80
 - 2s - loss: 0.1112
Epoch 80/80
 - 2s - loss: 0.1112
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.2797 - val_loss: 0.8947
AUC: 0.8166

Epoch 2/80
 - 0s - loss: 2.0082 - val_loss: 0.9577
AUC: 0.8424

Epoch 3/80
 - 0s - loss: 1.4369 - val_loss: 0.8210
AUC: 0.8518

Epoch 4/80
 - 0s - loss: 1.2336 - val_loss: 0.6887
AUC: 0.8520

Epoch 5/80
 - 0s - loss: 1.1449 - val_loss: 0.7480
AUC: 0.8533

Epoch 6/80
 - 0s - loss: 1.0995 - val_loss: 0.7319
AUC: 0.8542

Epoch 7/80
 - 0s - loss: 1.0849 - val_loss: 0.7045
AUC: 0.8569

Epoch 8/80
 - 0s - loss: 1.0780 - val_loss: 0.6087
AUC: 0.8555

Epoch 9/80
 - 0s - loss: 1.0666 - val_loss: 0.6384
AUC: 0.8583

Epoch 10/80
 - 0s - loss: 1.0438 - val_loss: 0.5869
AUC: 0.8589

Epoch 11/80
 - 0s - loss: 1.0393 - val_loss: 0.6738
AUC: 0.8612

Epoch 12/80
 - 0s - loss: 1.0362 - val_loss: 0.5558
AUC: 0.8597

Epoch 13/80
 - 0s - loss: 1.0211 - val_loss: 0.6454
AUC: 0.8622

Epoch 14/80
 - 0s - loss: 1.0201 - val_loss: 0.6729
AUC: 0.8622

Epoch 15/80
 - 0s - loss: 1.0097 - val_loss: 0.6112
AUC: 0.8630

Epoch 16/80
 - 0s - loss: 1.0087 - val_loss: 0.7081
AUC: 0.8636

Epoch 17/80
 - 0s - loss: 1.0070 - val_loss: 0.5829
AUC: 0.8636

Epoch 18/80
 - 0s - loss: 0.9943 - val_loss: 0.6550
AUC: 0.8625

Epoch 19/80
 - 0s - loss: 0.9918 - val_loss: 0.6654
AUC: 0.8651

Epoch 20/80
 - 0s - loss: 0.9892 - val_loss: 0.6242
AUC: 0.8653

Epoch 21/80
 - 0s - loss: 0.9885 - val_loss: 0.6591
AUC: 0.8647

Epoch 22/80
 - 0s - loss: 0.9869 - val_loss: 0.6834
AUC: 0.8663

Epoch 23/80
 - 0s - loss: 0.9758 - val_loss: 0.6188
AUC: 0.8664

Epoch 24/80
 - 0s - loss: 0.9721 - val_loss: 0.6043
AUC: 0.8663

Epoch 25/80
 - 0s - loss: 0.9750 - val_loss: 0.5887
AUC: 0.8660

Epoch 26/80
 - 0s - loss: 0.9634 - val_loss: 0.5782
AUC: 0.8660

Epoch 27/80
 - 0s - loss: 0.9677 - val_loss: 0.5973
AUC: 0.8663

Epoch 28/80
 - 0s - loss: 0.9621 - val_loss: 0.5881
AUC: 0.8661

Epoch 29/80
 - 0s - loss: 0.9591 - val_loss: 0.5779
AUC: 0.8665

Epoch 30/80
 - 0s - loss: 0.9626 - val_loss: 0.6193
AUC: 0.8670

Epoch 31/80
 - 0s - loss: 0.9586 - val_loss: 0.5763
AUC: 0.8665

Epoch 32/80
 - 0s - loss: 0.9629 - val_loss: 0.5902
AUC: 0.8668

Epoch 33/80
 - 0s - loss: 0.9529 - val_loss: 0.6041
AUC: 0.8670

Epoch 34/80
 - 0s - loss: 0.9535 - val_loss: 0.5997
AUC: 0.8670

Epoch 35/80
 - 0s - loss: 0.9558 - val_loss: 0.6060
AUC: 0.8671

Epoch 36/80
 - 0s - loss: 0.9587 - val_loss: 0.5979
AUC: 0.8669

Epoch 37/80
 - 0s - loss: 0.9551 - val_loss: 0.6076
AUC: 0.8671

Epoch 38/80
 - 0s - loss: 0.9550 - val_loss: 0.5921
AUC: 0.8668

Epoch 39/80
 - 0s - loss: 0.9589 - val_loss: 0.5991
AUC: 0.8670

Epoch 40/80
 - 0s - loss: 0.9483 - val_loss: 0.5879
AUC: 0.8668

Epoch 41/80
 - 0s - loss: 0.9573 - val_loss: 0.6063
AUC: 0.8671

Epoch 42/80
 - 0s - loss: 0.9525 - val_loss: 0.6012
AUC: 0.8671

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9552 - val_loss: 0.6012
AUC: 0.8669

Epoch 2/30
 - 0s - loss: 0.9543 - val_loss: 0.6056
AUC: 0.8670

Epoch 3/30
 - 0s - loss: 0.9545 - val_loss: 0.6071
AUC: 0.8674

Epoch 4/30
 - 0s - loss: 0.9485 - val_loss: 0.6164
AUC: 0.8675

Epoch 5/30
 - 0s - loss: 0.9464 - val_loss: 0.6198
AUC: 0.8677

Epoch 6/30
 - 0s - loss: 0.9446 - val_loss: 0.6027
AUC: 0.8677

Epoch 7/30
 - 0s - loss: 0.9488 - val_loss: 0.5960
AUC: 0.8676

Epoch 8/30
 - 0s - loss: 0.9430 - val_loss: 0.6115
AUC: 0.8679

Epoch 9/30
 - 0s - loss: 0.9476 - val_loss: 0.5741
AUC: 0.8675

Epoch 10/30
 - 0s - loss: 0.9454 - val_loss: 0.6176
AUC: 0.8682

Epoch 11/30
 - 0s - loss: 0.9399 - val_loss: 0.5928
AUC: 0.8676

Epoch 12/30
 - 0s - loss: 0.9391 - val_loss: 0.6187
AUC: 0.8681

Epoch 13/30
 - 0s - loss: 0.9330 - val_loss: 0.5741
AUC: 0.8678

Epoch 14/30
 - 0s - loss: 0.9357 - val_loss: 0.5673
AUC: 0.8673

Epoch 15/30
 - 0s - loss: 0.9331 - val_loss: 0.6135
AUC: 0.8686

Epoch 16/30
 - 0s - loss: 0.9327 - val_loss: 0.6025
AUC: 0.8683

Epoch 17/30
 - 0s - loss: 0.9369 - val_loss: 0.5818
AUC: 0.8680

Epoch 18/30
 - 0s - loss: 0.9315 - val_loss: 0.5647
AUC: 0.8679

Epoch 19/30
 - 0s - loss: 0.9263 - val_loss: 0.5970
AUC: 0.8684

Epoch 20/30
 - 0s - loss: 0.9312 - val_loss: 0.5912
AUC: 0.8684

Epoch 21/30
 - 0s - loss: 0.9265 - val_loss: 0.6036
AUC: 0.8687

Epoch 22/30
 - 0s - loss: 0.9231 - val_loss: 0.5752
AUC: 0.8685

Epoch 23/30
 - 0s - loss: 0.9259 - val_loss: 0.6015
AUC: 0.8690

Epoch 24/30
 - 0s - loss: 0.9217 - val_loss: 0.5582
AUC: 0.8683

Epoch 25/30
 - 0s - loss: 0.9180 - val_loss: 0.5771
AUC: 0.8685

Epoch 26/30
 - 0s - loss: 0.9210 - val_loss: 0.5749
AUC: 0.8689

Epoch 27/30
 - 0s - loss: 0.9170 - val_loss: 0.5839
AUC: 0.8688

Epoch 28/30
 - 0s - loss: 0.9252 - val_loss: 0.6005
AUC: 0.8690

Epoch 29/30
 - 0s - loss: 0.9215 - val_loss: 0.5809
AUC: 0.8689

Epoch 30/30
 - 0s - loss: 0.9116 - val_loss: 0.5739
Using TensorFlow backend.
AUC: 0.8687

2019-03-08 04:43:49.673500: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:43:49.843137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:43:49.843184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:43:50.148913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:43:50.148989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:43:50.149000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:43:50.149301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1465
Epoch 2/80
 - 2s - loss: 0.2150
Epoch 3/80
 - 2s - loss: 0.1719
Epoch 4/80
 - 2s - loss: 0.1646
Epoch 5/80
 - 2s - loss: 0.1588
Epoch 6/80
 - 2s - loss: 0.1518
Epoch 7/80
 - 2s - loss: 0.1432
Epoch 8/80
 - 2s - loss: 0.1331
Epoch 9/80
 - 2s - loss: 0.1220
Epoch 10/80
 - 2s - loss: 0.1115
Epoch 11/80
 - 2s - loss: 0.1024
Epoch 12/80
 - 2s - loss: 0.0946
Epoch 13/80
 - 2s - loss: 0.0883
Epoch 14/80
 - 2s - loss: 0.0832
Epoch 15/80
 - 2s - loss: 0.0789
Epoch 16/80
 - 2s - loss: 0.0754
Epoch 17/80
 - 2s - loss: 0.0723
Epoch 18/80
 - 2s - loss: 0.0694
Epoch 19/80
 - 2s - loss: 0.0669
Epoch 20/80
 - 2s - loss: 0.0647
Epoch 21/80
 - 2s - loss: 0.0627
Epoch 22/80
 - 2s - loss: 0.0610
Epoch 23/80
 - 2s - loss: 0.0596
Epoch 24/80
 - 2s - loss: 0.0584
Epoch 25/80
 - 2s - loss: 0.0573
Epoch 26/80
 - 2s - loss: 0.0564
Epoch 27/80
 - 2s - loss: 0.0557
Epoch 28/80
 - 2s - loss: 0.0550
Epoch 29/80
 - 2s - loss: 0.0544
Epoch 30/80
 - 2s - loss: 0.0539
Epoch 31/80
 - 2s - loss: 0.0535
Epoch 32/80
 - 2s - loss: 0.0532
Epoch 33/80
 - 2s - loss: 0.0528
Epoch 34/80
 - 2s - loss: 0.0525
Epoch 35/80
 - 2s - loss: 0.0523
Epoch 36/80
 - 2s - loss: 0.0521
Epoch 37/80
 - 2s - loss: 0.0518
Epoch 38/80
 - 2s - loss: 0.0517
Epoch 39/80
 - 2s - loss: 0.0515
Epoch 40/80
 - 2s - loss: 0.0514
Epoch 41/80
 - 2s - loss: 0.0512
Epoch 42/80
 - 2s - loss: 0.0511
Epoch 43/80
 - 2s - loss: 0.0510
Epoch 44/80
 - 2s - loss: 0.0509
Epoch 45/80
 - 2s - loss: 0.0508
Epoch 46/80
 - 2s - loss: 0.0507
Epoch 47/80
 - 2s - loss: 0.0506
Epoch 48/80
 - 2s - loss: 0.0506
Epoch 49/80
 - 2s - loss: 0.0505
Epoch 50/80
 - 2s - loss: 0.0504
Epoch 51/80
 - 2s - loss: 0.0504
Epoch 52/80
 - 2s - loss: 0.0503
Epoch 53/80
 - 2s - loss: 0.0503
Epoch 54/80
 - 2s - loss: 0.0502
Epoch 55/80
 - 2s - loss: 0.0502
Epoch 56/80
 - 2s - loss: 0.0501
Epoch 57/80
 - 2s - loss: 0.0501
Epoch 58/80
 - 2s - loss: 0.0501
Epoch 59/80
 - 2s - loss: 0.0500
Epoch 60/80
 - 2s - loss: 0.0500
Epoch 61/80
 - 2s - loss: 0.0500
Epoch 62/80
 - 2s - loss: 0.0499
Epoch 63/80
 - 2s - loss: 0.0499
Epoch 64/80
 - 2s - loss: 0.0488
Epoch 65/80
 - 2s - loss: 0.0487
Epoch 66/80
 - 2s - loss: 0.0487
Epoch 67/80
 - 2s - loss: 0.0487
Epoch 68/80
 - 2s - loss: 0.0486
Epoch 69/80
 - 2s - loss: 0.0484
Epoch 70/80
 - 2s - loss: 0.0484
Epoch 71/80
 - 2s - loss: 0.0484
Epoch 72/80
 - 2s - loss: 0.0484
Epoch 73/80
 - 2s - loss: 0.0483
Epoch 74/80
 - 2s - loss: 0.0483
Epoch 75/80
 - 2s - loss: 0.0483
Epoch 76/80
 - 2s - loss: 0.0483
Epoch 77/80
 - 2s - loss: 0.0483
Epoch 78/80
 - 2s - loss: 0.0483
Epoch 79/80
 - 2s - loss: 0.0483
Epoch 80/80
 - 2s - loss: 0.0483
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.4429 - val_loss: 1.3048
AUC: 0.7966

Epoch 2/80
 - 0s - loss: 2.7422 - val_loss: 0.9848
AUC: 0.8392

Epoch 3/80
 - 0s - loss: 1.9601 - val_loss: 0.8422
AUC: 0.8483

Epoch 4/80
 - 0s - loss: 1.4974 - val_loss: 0.7252
AUC: 0.8550

Epoch 5/80
 - 0s - loss: 1.2824 - val_loss: 0.6206
AUC: 0.8575

Epoch 6/80
 - 0s - loss: 1.1922 - val_loss: 0.6976
AUC: 0.8605

Epoch 7/80
 - 0s - loss: 1.1327 - val_loss: 0.7057
AUC: 0.8613

Epoch 8/80
 - 0s - loss: 1.1234 - val_loss: 0.6289
AUC: 0.8607

Epoch 9/80
 - 0s - loss: 1.1064 - val_loss: 0.6206
AUC: 0.8619

Epoch 10/80
 - 0s - loss: 1.0965 - val_loss: 0.7140
AUC: 0.8617

Epoch 11/80
 - 0s - loss: 1.0772 - val_loss: 0.5737
AUC: 0.8637

Epoch 12/80
 - 0s - loss: 1.0740 - val_loss: 0.7119
AUC: 0.8670

Epoch 13/80
 - 0s - loss: 1.0593 - val_loss: 0.5846
AUC: 0.8658

Epoch 14/80
 - 0s - loss: 1.0490 - val_loss: 0.7455
AUC: 0.8676

Epoch 15/80
 - 0s - loss: 1.0465 - val_loss: 0.7015
AUC: 0.8644

Epoch 16/80
 - 0s - loss: 1.0359 - val_loss: 0.6214
AUC: 0.8677

Epoch 17/80
 - 0s - loss: 1.0292 - val_loss: 0.7188
AUC: 0.8676

Epoch 18/80
 - 0s - loss: 1.0304 - val_loss: 0.6412
AUC: 0.8689

Epoch 19/80
 - 0s - loss: 1.0242 - val_loss: 0.5913
AUC: 0.8690

Epoch 20/80
 - 0s - loss: 1.0162 - val_loss: 0.5779
AUC: 0.8692

Epoch 21/80
 - 0s - loss: 1.0190 - val_loss: 0.6417
AUC: 0.8707

Epoch 22/80
 - 0s - loss: 1.0061 - val_loss: 0.6098
AUC: 0.8707

Epoch 23/80
 - 0s - loss: 1.0068 - val_loss: 0.6257
AUC: 0.8710

Epoch 24/80
 - 0s - loss: 1.0025 - val_loss: 0.6086
AUC: 0.8706

Epoch 25/80
 - 0s - loss: 0.9962 - val_loss: 0.6143
AUC: 0.8710

Epoch 26/80
 - 0s - loss: 1.0019 - val_loss: 0.6144
AUC: 0.8708

Epoch 27/80
 - 0s - loss: 0.9984 - val_loss: 0.6209
AUC: 0.8713

Epoch 28/80
 - 0s - loss: 0.9999 - val_loss: 0.6162
AUC: 0.8711

Epoch 29/80
 - 0s - loss: 0.9955 - val_loss: 0.5952
AUC: 0.8705

Epoch 30/80
 - 0s - loss: 1.0022 - val_loss: 0.6778
AUC: 0.8716

Epoch 31/80
 - 0s - loss: 0.9938 - val_loss: 0.6379
AUC: 0.8715

Epoch 32/80
 - 0s - loss: 0.9925 - val_loss: 0.6066
AUC: 0.8715

Epoch 33/80
 - 0s - loss: 0.9957 - val_loss: 0.6168
AUC: 0.8717

Epoch 34/80
 - 0s - loss: 0.9897 - val_loss: 0.6150
AUC: 0.8716

Epoch 35/80
 - 0s - loss: 0.9885 - val_loss: 0.6080
AUC: 0.8715

Epoch 36/80
 - 0s - loss: 0.9898 - val_loss: 0.6077
AUC: 0.8715

Epoch 37/80
 - 0s - loss: 0.9929 - val_loss: 0.6285
AUC: 0.8717

Epoch 38/80
 - 0s - loss: 0.9918 - val_loss: 0.6140
AUC: 0.8715

Epoch 39/80
 - 0s - loss: 0.9940 - val_loss: 0.6245
AUC: 0.8717

Epoch 40/80
 - 0s - loss: 0.9904 - val_loss: 0.6194
AUC: 0.8716

Epoch 41/80
 - 0s - loss: 0.9883 - val_loss: 0.6108
AUC: 0.8715

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9886 - val_loss: 0.6322
AUC: 0.8718

Epoch 2/30
 - 0s - loss: 0.9924 - val_loss: 0.6000
AUC: 0.8712

Epoch 3/30
 - 0s - loss: 0.9881 - val_loss: 0.6154
AUC: 0.8719

Epoch 4/30
 - 0s - loss: 0.9852 - val_loss: 0.5970
AUC: 0.8720

Epoch 5/30
 - 0s - loss: 0.9849 - val_loss: 0.6228
AUC: 0.8725

Epoch 6/30
 - 0s - loss: 0.9855 - val_loss: 0.6246
AUC: 0.8725

Epoch 7/30
 - 0s - loss: 0.9780 - val_loss: 0.6215
AUC: 0.8726

Epoch 8/30
 - 0s - loss: 0.9785 - val_loss: 0.6141
AUC: 0.8726

Epoch 9/30
 - 0s - loss: 0.9824 - val_loss: 0.6132
AUC: 0.8730

Epoch 10/30
 - 0s - loss: 0.9817 - val_loss: 0.6181
AUC: 0.8727

Epoch 11/30
 - 0s - loss: 0.9759 - val_loss: 0.6156
AUC: 0.8728

Epoch 12/30
 - 0s - loss: 0.9753 - val_loss: 0.6203
AUC: 0.8730

Epoch 13/30
 - 0s - loss: 0.9722 - val_loss: 0.6020
AUC: 0.8727

Epoch 14/30
 - 0s - loss: 0.9692 - val_loss: 0.6105
AUC: 0.8728

Epoch 15/30
 - 0s - loss: 0.9700 - val_loss: 0.6013
AUC: 0.8728

Epoch 16/30
 - 0s - loss: 0.9695 - val_loss: 0.6035
AUC: 0.8729

Epoch 17/30
 - 0s - loss: 0.9710 - val_loss: 0.6035
AUC: 0.8730

Epoch 18/30
 - 0s - loss: 0.9655 - val_loss: 0.6053
AUC: 0.8731

Epoch 19/30
 - 0s - loss: 0.9724 - val_loss: 0.6047
AUC: 0.8731

Epoch 20/30
 - 0s - loss: 0.9688 - val_loss: 0.6013
AUC: 0.8731

Epoch 21/30
 - 0s - loss: 0.9673 - val_loss: 0.6011
AUC: 0.8731

Epoch 22/30
 - 0s - loss: 0.9658 - val_loss: 0.5953
AUC: 0.8730

Epoch 23/30
 - 0s - loss: 0.9648 - val_loss: 0.5985
AUC: 0.8730

Epoch 24/30
 - 0s - loss: 0.9647 - val_loss: 0.5966
AUC: 0.8730

Epoch 25/30
 - 0s - loss: 0.9670 - val_loss: 0.6037
AUC: 0.8732

Epoch 26/30
 - 0s - loss: 0.9642 - val_loss: 0.6051
AUC: 0.8733

Epoch 27/30
 - 0s - loss: 0.9643 - val_loss: 0.6055
AUC: 0.8733

Epoch 28/30
 - 0s - loss: 0.9633 - val_loss: 0.5998
AUC: 0.8733

Epoch 29/30
 - 0s - loss: 0.9629 - val_loss: 0.6025
AUC: 0.8734

Epoch 30/30
 - 0s - loss: 0.9642 - val_loss: 0.5996
Using TensorFlow backend.
AUC: 0.8733

2019-03-08 04:47:40.491963: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:47:40.662974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:47:40.663023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:47:40.971130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:47:40.971187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:47:40.971196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:47:40.971465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1321
Epoch 2/80
 - 2s - loss: 0.2139
Epoch 3/80
 - 2s - loss: 0.1702
Epoch 4/80
 - 2s - loss: 0.1596
Epoch 5/80
 - 2s - loss: 0.1496
Epoch 6/80
 - 2s - loss: 0.1402
Epoch 7/80
 - 2s - loss: 0.1321
Epoch 8/80
 - 2s - loss: 0.1247
Epoch 9/80
 - 2s - loss: 0.1174
Epoch 10/80
 - 2s - loss: 0.1099
Epoch 11/80
 - 2s - loss: 0.1025
Epoch 12/80
 - 2s - loss: 0.0956
Epoch 13/80
 - 2s - loss: 0.0895
Epoch 14/80
 - 2s - loss: 0.0841
Epoch 15/80
 - 2s - loss: 0.0795
Epoch 16/80
 - 2s - loss: 0.0755
Epoch 17/80
 - 2s - loss: 0.0720
Epoch 18/80
 - 2s - loss: 0.0689
Epoch 19/80
 - 2s - loss: 0.0663
Epoch 20/80
 - 2s - loss: 0.0641
Epoch 21/80
 - 2s - loss: 0.0623
Epoch 22/80
 - 2s - loss: 0.0607
Epoch 23/80
 - 2s - loss: 0.0594
Epoch 24/80
 - 2s - loss: 0.0583
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 04:48:50.524479: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:48:50.696232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:48:50.696279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:48:51.004274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:48:51.004330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:48:51.004339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:48:51.004600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1524
Epoch 2/80
 - 2s - loss: 0.2163
Epoch 3/80
 - 2s - loss: 0.1738
Epoch 4/80
 - 2s - loss: 0.1666
Epoch 5/80
 - 2s - loss: 0.1609
Epoch 6/80
 - 2s - loss: 0.1539
Epoch 7/80
 - 2s - loss: 0.1450
Epoch 8/80
 - 2s - loss: 0.1347
Epoch 9/80
 - 2s - loss: 0.1240
Epoch 10/80
 - 2s - loss: 0.1137
Epoch 11/80
 - 2s - loss: 0.1045
Epoch 12/80
 - 2s - loss: 0.0966
Epoch 13/80
 - 2s - loss: 0.0896
Epoch 14/80
 - 2s - loss: 0.0835
Epoch 15/80
 - 2s - loss: 0.0785
Epoch 16/80
 - 2s - loss: 0.0744
Epoch 17/80
 - 2s - loss: 0.0711
Epoch 18/80
 - 2s - loss: 0.0683
Epoch 19/80
 - 2s - loss: 0.0660
Epoch 20/80
 - 2s - loss: 0.0640
Epoch 21/80
 - 2s - loss: 0.0622
Epoch 22/80
 - 2s - loss: 0.0607
Epoch 23/80
 - 2s - loss: 0.0593
Epoch 24/80
 - 2s - loss: 0.0582
Epoch 25/80
 - 2s - loss: 0.0571
Epoch 26/80
 - 2s - loss: 0.0563
Epoch 27/80
 - 2s - loss: 0.0555
Epoch 28/80
 - 2s - loss: 0.0549
Epoch 29/80
 - 2s - loss: 0.0543
Epoch 30/80
 - 2s - loss: 0.0538
Epoch 31/80
 - 2s - loss: 0.0534
Epoch 32/80
 - 2s - loss: 0.0531
Epoch 33/80
 - 2s - loss: 0.0527
Epoch 34/80
 - 2s - loss: 0.0525
Epoch 35/80
 - 2s - loss: 0.0522
Epoch 36/80
 - 2s - loss: 0.0520
Epoch 37/80
 - 2s - loss: 0.0518
Epoch 38/80
 - 2s - loss: 0.0516
Epoch 39/80
 - 2s - loss: 0.0515
Epoch 40/80
 - 2s - loss: 0.0513
Epoch 41/80
 - 2s - loss: 0.0512
Epoch 42/80
 - 2s - loss: 0.0511
Epoch 43/80
 - 2s - loss: 0.0510
Epoch 44/80
 - 2s - loss: 0.0509
Epoch 45/80
 - 2s - loss: 0.0508
Epoch 46/80
 - 2s - loss: 0.0507
Epoch 47/80
 - 2s - loss: 0.0506
Epoch 48/80
 - 2s - loss: 0.0506
Epoch 49/80
 - 2s - loss: 0.0505
Epoch 50/80
 - 2s - loss: 0.0504
Epoch 51/80
 - 2s - loss: 0.0504
Epoch 52/80
 - 2s - loss: 0.0503
Epoch 53/80
 - 2s - loss: 0.0503
Epoch 54/80
 - 2s - loss: 0.0502
Epoch 55/80
 - 2s - loss: 0.0502
Epoch 56/80
 - 2s - loss: 0.0501
Epoch 57/80
 - 2s - loss: 0.0501
Epoch 58/80
 - 2s - loss: 0.0501
Epoch 59/80
 - 2s - loss: 0.0501
Epoch 60/80
 - 2s - loss: 0.0500
Epoch 61/80
 - 2s - loss: 0.0489
Epoch 62/80
 - 2s - loss: 0.0488
Epoch 63/80
 - 2s - loss: 0.0488
Epoch 64/80
 - 2s - loss: 0.0488
Epoch 65/80
 - 2s - loss: 0.0488
Epoch 66/80
 - 2s - loss: 0.0485
Epoch 67/80
 - 2s - loss: 0.0485
Epoch 68/80
 - 2s - loss: 0.0485
Epoch 69/80
 - 2s - loss: 0.0485
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 04:51:27.685886: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:51:27.856183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:51:27.856240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:51:28.164029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:51:28.164092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:51:28.164102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:51:28.164398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1484
Epoch 2/80
 - 2s - loss: 0.2158
Epoch 3/80
 - 2s - loss: 0.1730
Epoch 4/80
 - 2s - loss: 0.1640
Epoch 5/80
 - 2s - loss: 0.1534
Epoch 6/80
 - 2s - loss: 0.1408
Epoch 7/80
 - 2s - loss: 0.1300
Epoch 8/80
 - 2s - loss: 0.1213
Epoch 9/80
 - 2s - loss: 0.1135
Epoch 10/80
 - 2s - loss: 0.1065
Epoch 11/80
 - 2s - loss: 0.1003
Epoch 12/80
 - 2s - loss: 0.0945
Epoch 13/80
 - 2s - loss: 0.0891
Epoch 14/80
 - 2s - loss: 0.0840
Epoch 15/80
 - 2s - loss: 0.0795
Epoch 16/80
 - 2s - loss: 0.0757
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 04:52:17.998299: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:52:18.170926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:52:18.170969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:52:18.481424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:52:18.481480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:52:18.481490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:52:18.481783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.7032
Epoch 2/80
 - 2s - loss: 0.1397
Epoch 3/80
 - 2s - loss: 0.0719
Epoch 4/80
 - 2s - loss: 0.0651
Epoch 5/80
 - 2s - loss: 0.0610
Epoch 6/80
 - 2s - loss: 0.0569
Epoch 7/80
 - 2s - loss: 0.0530
Epoch 8/80
 - 2s - loss: 0.0495
Epoch 9/80
 - 2s - loss: 0.0464
Epoch 10/80
 - 2s - loss: 0.0434
Epoch 11/80
 - 2s - loss: 0.0405
Epoch 12/80
 - 2s - loss: 0.0378
Epoch 13/80
 - 2s - loss: 0.0355
Epoch 14/80
 - 2s - loss: 0.0335
Epoch 15/80
 - 2s - loss: 0.0317
Epoch 16/80
 - 2s - loss: 0.0301
Epoch 17/80
 - 2s - loss: 0.0286
Epoch 18/80
 - 2s - loss: 0.0272
Epoch 19/80
 - 2s - loss: 0.0259
Epoch 20/80
 - 2s - loss: 0.0247
Epoch 21/80
 - 2s - loss: 0.0237
Epoch 22/80
 - 2s - loss: 0.0228
Epoch 23/80
 - 2s - loss: 0.0220
Epoch 24/80
 - 2s - loss: 0.0213
Epoch 25/80
 - 2s - loss: 0.0207
Epoch 26/80
 - 2s - loss: 0.0202
Epoch 27/80
 - 2s - loss: 0.0197
Epoch 28/80
 - 2s - loss: 0.0193
Epoch 29/80
 - 2s - loss: 0.0190
Epoch 30/80
 - 2s - loss: 0.0187
Epoch 31/80
 - 2s - loss: 0.0184
Epoch 32/80
 - 2s - loss: 0.0182
Epoch 33/80
 - 2s - loss: 0.0180
Epoch 34/80
 - 2s - loss: 0.0178
Epoch 35/80
 - 2s - loss: 0.0177
Epoch 36/80
 - 2s - loss: 0.0175
Epoch 37/80
 - 2s - loss: 0.0174
Epoch 38/80
 - 2s - loss: 0.0173
Epoch 39/80
 - 2s - loss: 0.0172
Epoch 40/80
 - 2s - loss: 0.0171
Epoch 41/80
 - 2s - loss: 0.0171
Epoch 42/80
 - 2s - loss: 0.0170
Epoch 43/80
 - 2s - loss: 0.0169
Epoch 44/80
 - 2s - loss: 0.0169
Epoch 45/80
 - 2s - loss: 0.0168
Epoch 46/80
 - 2s - loss: 0.0168
Epoch 47/80
 - 2s - loss: 0.0167
Epoch 48/80
 - 2s - loss: 0.0167
Epoch 49/80
 - 2s - loss: 0.0166
Epoch 50/80
 - 2s - loss: 0.0166
Epoch 51/80
 - 2s - loss: 0.0166
Epoch 52/80
 - 2s - loss: 0.0165
Epoch 53/80
 - 2s - loss: 0.0161
Epoch 54/80
 - 2s - loss: 0.0161
Epoch 55/80
 - 2s - loss: 0.0160
Epoch 56/80
 - 2s - loss: 0.0160
Epoch 57/80
 - 2s - loss: 0.0159
Epoch 58/80
 - 2s - loss: 0.0159
Epoch 59/80
 - 2s - loss: 0.0159
Epoch 60/80
 - 2s - loss: 0.0159
Epoch 61/80
 - 2s - loss: 0.0159
Epoch 62/80
 - 2s - loss: 0.0159
Epoch 63/80
 - 2s - loss: 0.0159
Epoch 64/80
 - 2s - loss: 0.0159
Epoch 65/80
 - 2s - loss: 0.0159
Epoch 66/80
 - 2s - loss: 0.0159
Epoch 67/80
 - 2s - loss: 0.0159
Epoch 68/80
 - 2s - loss: 0.0159
Epoch 69/80
 - 2s - loss: 0.0159
Epoch 70/80
 - 2s - loss: 0.0159
Epoch 71/80
 - 2s - loss: 0.0159
Epoch 72/80
 - 2s - loss: 0.0159
Epoch 73/80
 - 2s - loss: 0.0159
Epoch 74/80
 - 2s - loss: 0.0159
Epoch 75/80
 - 2s - loss: 0.0159
Epoch 76/80
 - 2s - loss: 0.0159
Epoch 77/80
 - 2s - loss: 0.0159
Epoch 78/80
 - 2s - loss: 0.0159
Epoch 79/80
 - 2s - loss: 0.0159
Epoch 80/80
 - 2s - loss: 0.0159
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.1236 - val_loss: 1.1319
AUC: 0.8130

Epoch 2/80
 - 0s - loss: 1.8701 - val_loss: 0.8131
AUC: 0.8400

Epoch 3/80
 - 0s - loss: 1.3523 - val_loss: 0.6152
AUC: 0.8404

Epoch 4/80
 - 0s - loss: 1.1754 - val_loss: 0.7163
AUC: 0.8475

Epoch 5/80
 - 0s - loss: 1.1275 - val_loss: 0.8048
AUC: 0.8521

Epoch 6/80
 - 0s - loss: 1.0808 - val_loss: 0.5923
AUC: 0.8486

Epoch 7/80
 - 0s - loss: 1.0630 - val_loss: 0.6321
AUC: 0.8505

Epoch 8/80
 - 0s - loss: 1.0534 - val_loss: 0.7236
AUC: 0.8538

Epoch 9/80
 - 0s - loss: 1.0426 - val_loss: 0.5664
AUC: 0.8538

Epoch 10/80
 - 0s - loss: 1.0238 - val_loss: 0.7169
AUC: 0.8589

Epoch 11/80
 - 0s - loss: 1.0280 - val_loss: 0.6829
AUC: 0.8586

Epoch 12/80
 - 0s - loss: 1.0271 - val_loss: 0.6941
AUC: 0.8592

Epoch 13/80
 - 0s - loss: 1.0144 - val_loss: 0.5932
AUC: 0.8582

Epoch 14/80
 - 0s - loss: 1.0023 - val_loss: 0.6057
AUC: 0.8605

Epoch 15/80
 - 0s - loss: 0.9982 - val_loss: 0.6009
AUC: 0.8579

Epoch 16/80
 - 0s - loss: 0.9964 - val_loss: 0.5779
AUC: 0.8593

Epoch 17/80
 - 0s - loss: 1.0011 - val_loss: 0.5844
AUC: 0.8598

Epoch 18/80
 - 0s - loss: 0.9878 - val_loss: 0.6026
AUC: 0.8588

Epoch 19/80
 - 0s - loss: 0.9885 - val_loss: 0.6034
AUC: 0.8617

Epoch 20/80
 - 0s - loss: 0.9808 - val_loss: 0.6128
AUC: 0.8625

Epoch 21/80
 - 0s - loss: 0.9734 - val_loss: 0.5765
AUC: 0.8622

Epoch 22/80
 - 0s - loss: 0.9668 - val_loss: 0.6059
AUC: 0.8624

Epoch 23/80
 - 0s - loss: 0.9655 - val_loss: 0.6143
AUC: 0.8632

Epoch 24/80
 - 0s - loss: 0.9683 - val_loss: 0.6139
AUC: 0.8633

Epoch 25/80
 - 0s - loss: 0.9624 - val_loss: 0.6017
AUC: 0.8629

Epoch 26/80
 - 0s - loss: 0.9697 - val_loss: 0.5905
AUC: 0.8630

Epoch 27/80
 - 0s - loss: 0.9637 - val_loss: 0.5950
AUC: 0.8625

Epoch 28/80
 - 0s - loss: 0.9616 - val_loss: 0.6318
AUC: 0.8643

Epoch 29/80
 - 0s - loss: 0.9654 - val_loss: 0.6242
AUC: 0.8633

Epoch 30/80
 - 0s - loss: 0.9603 - val_loss: 0.6059
AUC: 0.8631

Epoch 31/80
 - 0s - loss: 0.9589 - val_loss: 0.6040
AUC: 0.8633

Epoch 32/80
 - 0s - loss: 0.9645 - val_loss: 0.6115
AUC: 0.8636

Epoch 33/80
 - 0s - loss: 0.9560 - val_loss: 0.6087
AUC: 0.8636

Epoch 34/80
 - 0s - loss: 0.9595 - val_loss: 0.6110
AUC: 0.8638

Epoch 35/80
 - 0s - loss: 0.9565 - val_loss: 0.6132
AUC: 0.8638

Epoch 36/80
 - 0s - loss: 0.9606 - val_loss: 0.6131
AUC: 0.8638

Epoch 37/80
 - 0s - loss: 0.9618 - val_loss: 0.6075
AUC: 0.8637

Epoch 38/80
 - 0s - loss: 0.9551 - val_loss: 0.6061
AUC: 0.8638

Epoch 39/80
 - 0s - loss: 0.9627 - val_loss: 0.5950
AUC: 0.8636

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9641 - val_loss: 0.6119
AUC: 0.8639

Epoch 2/30
 - 0s - loss: 0.9648 - val_loss: 0.6078
AUC: 0.8640

Epoch 3/30
 - 0s - loss: 0.9594 - val_loss: 0.6100
AUC: 0.8642

Epoch 4/30
 - 0s - loss: 0.9585 - val_loss: 0.6035
AUC: 0.8642

Epoch 5/30
 - 0s - loss: 0.9521 - val_loss: 0.6160
AUC: 0.8643

Epoch 6/30
 - 0s - loss: 0.9494 - val_loss: 0.6251
AUC: 0.8645

Epoch 7/30
 - 0s - loss: 0.9494 - val_loss: 0.6172
AUC: 0.8645

Epoch 8/30
 - 0s - loss: 0.9504 - val_loss: 0.6281
AUC: 0.8651

Epoch 9/30
 - 0s - loss: 0.9509 - val_loss: 0.5964
AUC: 0.8645

Epoch 10/30
 - 0s - loss: 0.9533 - val_loss: 0.5942
AUC: 0.8646

Epoch 11/30
 - 0s - loss: 0.9446 - val_loss: 0.5981
AUC: 0.8649

Epoch 12/30
 - 0s - loss: 0.9481 - val_loss: 0.5903
AUC: 0.8649

Epoch 13/30
 - 0s - loss: 0.9454 - val_loss: 0.6107
AUC: 0.8653

Epoch 14/30
 - 0s - loss: 0.9426 - val_loss: 0.6090
AUC: 0.8653

Epoch 15/30
 - 0s - loss: 0.9424 - val_loss: 0.5949
AUC: 0.8655

Epoch 16/30
 - 0s - loss: 0.9390 - val_loss: 0.6122
AUC: 0.8660

Epoch 17/30
 - 0s - loss: 0.9375 - val_loss: 0.6091
AUC: 0.8660

Epoch 18/30
 - 0s - loss: 0.9388 - val_loss: 0.6097
AUC: 0.8660

Epoch 19/30
 - 0s - loss: 0.9417 - val_loss: 0.5994
AUC: 0.8658

Epoch 20/30
 - 0s - loss: 0.9354 - val_loss: 0.5916
AUC: 0.8656

Epoch 21/30
 - 0s - loss: 0.9394 - val_loss: 0.5916
AUC: 0.8659

Epoch 22/30
 - 0s - loss: 0.9357 - val_loss: 0.6024
AUC: 0.8661

Epoch 23/30
 - 0s - loss: 0.9284 - val_loss: 0.5943
AUC: 0.8660

Epoch 24/30
 - 0s - loss: 0.9290 - val_loss: 0.5930
AUC: 0.8660

Epoch 25/30
 - 0s - loss: 0.9276 - val_loss: 0.5998
AUC: 0.8662

Epoch 26/30
 - 0s - loss: 0.9324 - val_loss: 0.5930
AUC: 0.8661

Epoch 27/30
 - 0s - loss: 0.9276 - val_loss: 0.5928
AUC: 0.8662

Epoch 28/30
 - 0s - loss: 0.9311 - val_loss: 0.5922
AUC: 0.8662

Epoch 29/30
 - 0s - loss: 0.9281 - val_loss: 0.5959
AUC: 0.8663

Epoch 30/30
 - 0s - loss: 0.9299 - val_loss: 0.5949
Using TensorFlow backend.
AUC: 0.8663

2019-03-08 04:56:08.140495: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:56:08.314146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:56:08.314197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:56:08.620166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:56:08.620221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:56:08.620230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:56:08.620493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6914
Epoch 2/80
 - 2s - loss: 0.1299
Epoch 3/80
 - 2s - loss: 0.0729
Epoch 4/80
 - 2s - loss: 0.0669
Epoch 5/80
 - 2s - loss: 0.0647
Epoch 6/80
 - 2s - loss: 0.0630
Epoch 7/80
 - 2s - loss: 0.0610
Epoch 8/80
 - 2s - loss: 0.0583
Epoch 9/80
 - 2s - loss: 0.0548
Epoch 10/80
 - 2s - loss: 0.0506
Epoch 11/80
 - 2s - loss: 0.0460
Epoch 12/80
 - 2s - loss: 0.0417
Epoch 13/80
 - 2s - loss: 0.0380
Epoch 14/80
 - 2s - loss: 0.0348
Epoch 15/80
 - 2s - loss: 0.0321
Epoch 16/80
 - 2s - loss: 0.0300
Epoch 17/80
 - 2s - loss: 0.0282
Epoch 18/80
 - 2s - loss: 0.0266
Epoch 19/80
 - 2s - loss: 0.0253
Epoch 20/80
 - 2s - loss: 0.0242
Epoch 21/80
 - 2s - loss: 0.0232
Epoch 22/80
 - 2s - loss: 0.0223
Epoch 23/80
 - 2s - loss: 0.0216
Epoch 24/80
 - 2s - loss: 0.0209
Epoch 25/80
 - 2s - loss: 0.0204
Epoch 26/80
 - 2s - loss: 0.0199
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 04:57:21.896554: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:57:22.066346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:57:22.066391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:57:22.372684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:57:22.372742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:57:22.372756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:57:22.373061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6842
Epoch 2/80
 - 2s - loss: 0.1297
Epoch 3/80
 - 2s - loss: 0.0731
Epoch 4/80
 - 2s - loss: 0.0665
Epoch 5/80
 - 2s - loss: 0.0638
Epoch 6/80
 - 2s - loss: 0.0616
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 04:57:52.298568: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 04:57:52.470253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 04:57:52.470298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 04:57:52.782277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 04:57:52.782325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 04:57:52.782334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 04:57:52.782598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3754
Epoch 2/80
 - 2s - loss: 0.3503
Epoch 3/80
 - 2s - loss: 0.3078
Epoch 4/80
 - 2s - loss: 0.2946
Epoch 5/80
 - 2s - loss: 0.2798
Epoch 6/80
 - 2s - loss: 0.2633
Epoch 7/80
 - 2s - loss: 0.2451
Epoch 8/80
 - 2s - loss: 0.2243
Epoch 9/80
 - 2s - loss: 0.2045
Epoch 10/80
 - 2s - loss: 0.1894
Epoch 11/80
 - 2s - loss: 0.1784
Epoch 12/80
 - 2s - loss: 0.1699
Epoch 13/80
 - 2s - loss: 0.1627
Epoch 14/80
 - 2s - loss: 0.1562
Epoch 15/80
 - 2s - loss: 0.1504
Epoch 16/80
 - 2s - loss: 0.1453
Epoch 17/80
 - 2s - loss: 0.1409
Epoch 18/80
 - 2s - loss: 0.1371
Epoch 19/80
 - 2s - loss: 0.1338
Epoch 20/80
 - 2s - loss: 0.1310
Epoch 21/80
 - 2s - loss: 0.1287
Epoch 22/80
 - 2s - loss: 0.1268
Epoch 23/80
 - 2s - loss: 0.1251
Epoch 24/80
 - 2s - loss: 0.1237
Epoch 25/80
 - 2s - loss: 0.1225
Epoch 26/80
 - 2s - loss: 0.1214
Epoch 27/80
 - 2s - loss: 0.1206
Epoch 28/80
 - 2s - loss: 0.1199
Epoch 29/80
 - 2s - loss: 0.1192
Epoch 30/80
 - 2s - loss: 0.1187
Epoch 31/80
 - 2s - loss: 0.1182
Epoch 32/80
 - 2s - loss: 0.1178
Epoch 33/80
 - 2s - loss: 0.1175
Epoch 34/80
 - 2s - loss: 0.1172
Epoch 35/80
 - 2s - loss: 0.1169
Epoch 36/80
 - 2s - loss: 0.1167
Epoch 37/80
 - 2s - loss: 0.1164
Epoch 38/80
 - 2s - loss: 0.1163
Epoch 39/80
 - 2s - loss: 0.1161
Epoch 40/80
 - 2s - loss: 0.1159
Epoch 41/80
 - 2s - loss: 0.1158
Epoch 42/80
 - 2s - loss: 0.1156
Epoch 43/80
 - 2s - loss: 0.1155
Epoch 44/80
 - 2s - loss: 0.1154
Epoch 45/80
 - 2s - loss: 0.1153
Epoch 46/80
 - 2s - loss: 0.1152
Epoch 47/80
 - 2s - loss: 0.1151
Epoch 48/80
 - 2s - loss: 0.1150
Epoch 49/80
 - 2s - loss: 0.1149
Epoch 50/80
 - 2s - loss: 0.1148
Epoch 51/80
 - 2s - loss: 0.1148
Epoch 52/80
 - 2s - loss: 0.1147
Epoch 53/80
 - 2s - loss: 0.1147
Epoch 54/80
 - 2s - loss: 0.1146
Epoch 55/80
 - 2s - loss: 0.1146
Epoch 56/80
 - 2s - loss: 0.1145
Epoch 57/80
 - 2s - loss: 0.1144
Epoch 58/80
 - 2s - loss: 0.1144
Epoch 59/80
 - 2s - loss: 0.1144
Epoch 60/80
 - 2s - loss: 0.1143
Epoch 61/80
 - 2s - loss: 0.1143
Epoch 62/80
 - 2s - loss: 0.1142
Epoch 63/80
 - 2s - loss: 0.1142
Epoch 64/80
 - 2s - loss: 0.1120
Epoch 65/80
 - 2s - loss: 0.1117
Epoch 66/80
 - 2s - loss: 0.1117
Epoch 67/80
 - 2s - loss: 0.1117
Epoch 68/80
 - 2s - loss: 0.1117
Epoch 69/80
 - 2s - loss: 0.1111
Epoch 70/80
 - 2s - loss: 0.1111
Epoch 71/80
 - 2s - loss: 0.1111
Epoch 72/80
 - 2s - loss: 0.1111
Epoch 73/80
 - 2s - loss: 0.1110
Epoch 74/80
 - 2s - loss: 0.1110
Epoch 75/80
 - 2s - loss: 0.1110
Epoch 76/80
 - 2s - loss: 0.1110
Epoch 77/80
 - 2s - loss: 0.1109
Epoch 78/80
 - 2s - loss: 0.1109
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:00:47.882213: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:00:48.047968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:00:48.048013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:00:48.361083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:00:48.361148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:00:48.361158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:00:48.361425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3672
Epoch 2/80
 - 2s - loss: 0.3520
Epoch 3/80
 - 2s - loss: 0.3036
Epoch 4/80
 - 2s - loss: 0.2815
Epoch 5/80
 - 2s - loss: 0.2615
Epoch 6/80
 - 2s - loss: 0.2471
Epoch 7/80
 - 2s - loss: 0.2353
Epoch 8/80
 - 2s - loss: 0.2239
Epoch 9/80
 - 2s - loss: 0.2120
Epoch 10/80
 - 2s - loss: 0.1997
Epoch 11/80
 - 2s - loss: 0.1874
Epoch 12/80
 - 2s - loss: 0.1758
Epoch 13/80
 - 2s - loss: 0.1658
Epoch 14/80
 - 2s - loss: 0.1577
Epoch 15/80
 - 2s - loss: 0.1512
Epoch 16/80
 - 2s - loss: 0.1460
Epoch 17/80
 - 2s - loss: 0.1415
Epoch 18/80
 - 2s - loss: 0.1378
Epoch 19/80
 - 2s - loss: 0.1345
Epoch 20/80
 - 2s - loss: 0.1317
Epoch 21/80
 - 2s - loss: 0.1294
Epoch 22/80
 - 2s - loss: 0.1274
Epoch 23/80
 - 2s - loss: 0.1257
Epoch 24/80
 - 2s - loss: 0.1242
Epoch 25/80
 - 2s - loss: 0.1229
Epoch 26/80
 - 2s - loss: 0.1219
Epoch 27/80
 - 2s - loss: 0.1209
Epoch 28/80
 - 2s - loss: 0.1201
Epoch 29/80
 - 2s - loss: 0.1193
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:02:07.279090: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:02:07.449219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:02:07.449264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:02:07.755335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:02:07.755392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:02:07.755401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:02:07.755664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3674
Epoch 2/80
 - 2s - loss: 0.3525
Epoch 3/80
 - 2s - loss: 0.3028
Epoch 4/80
 - 2s - loss: 0.2815
Epoch 5/80
 - 2s - loss: 0.2612
Epoch 6/80
 - 2s - loss: 0.2413
Epoch 7/80
 - 2s - loss: 0.2244
Epoch 8/80
 - 2s - loss: 0.2115
Epoch 9/80
 - 2s - loss: 0.2007
Epoch 10/80
 - 2s - loss: 0.1908
Epoch 11/80
 - 2s - loss: 0.1817
Epoch 12/80
 - 2s - loss: 0.1729
Epoch 13/80
 - 2s - loss: 0.1647
Epoch 14/80
 - 2s - loss: 0.1572
Epoch 15/80
 - 2s - loss: 0.1508
Epoch 16/80
 - 2s - loss: 0.1456
Epoch 17/80
 - 2s - loss: 0.1412
Epoch 18/80
 - 2s - loss: 0.1376
Epoch 19/80
 - 2s - loss: 0.1345
Epoch 20/80
 - 2s - loss: 0.1320
Epoch 21/80
 - 2s - loss: 0.1298
Epoch 22/80
 - 2s - loss: 0.1280
Epoch 23/80
 - 2s - loss: 0.1263
Epoch 24/80
 - 2s - loss: 0.1250
Epoch 25/80
 - 2s - loss: 0.1238
Epoch 26/80
 - 2s - loss: 0.1228
Epoch 27/80
 - 2s - loss: 0.1219
Epoch 28/80
 - 2s - loss: 0.1211
Epoch 29/80
 - 2s - loss: 0.1205
Epoch 30/80
 - 2s - loss: 0.1198
Epoch 31/80
 - 2s - loss: 0.1193
Epoch 32/80
 - 2s - loss: 0.1189
Epoch 33/80
 - 2s - loss: 0.1185
Epoch 34/80
 - 2s - loss: 0.1181
Epoch 35/80
 - 2s - loss: 0.1178
Epoch 36/80
 - 2s - loss: 0.1175
Epoch 37/80
 - 2s - loss: 0.1173
Epoch 38/80
 - 2s - loss: 0.1170
Epoch 39/80
 - 2s - loss: 0.1168
Epoch 40/80
 - 2s - loss: 0.1166
Epoch 41/80
 - 2s - loss: 0.1165
Epoch 42/80
 - 2s - loss: 0.1163
Epoch 43/80
 - 2s - loss: 0.1162
Epoch 44/80
 - 2s - loss: 0.1160
Epoch 45/80
 - 2s - loss: 0.1159
Epoch 46/80
 - 2s - loss: 0.1158
Epoch 47/80
 - 2s - loss: 0.1157
Epoch 48/80
 - 2s - loss: 0.1156
Epoch 49/80
 - 2s - loss: 0.1155
Epoch 50/80
 - 2s - loss: 0.1154
Epoch 51/80
 - 2s - loss: 0.1153
Epoch 52/80
 - 2s - loss: 0.1152
Epoch 53/80
 - 2s - loss: 0.1151
Epoch 54/80
 - 2s - loss: 0.1151
Epoch 55/80
 - 2s - loss: 0.1150
Epoch 56/80
 - 2s - loss: 0.1150
Epoch 57/80
 - 2s - loss: 0.1149
Epoch 58/80
 - 2s - loss: 0.1149
Epoch 59/80
 - 2s - loss: 0.1148
Epoch 60/80
 - 2s - loss: 0.1148
Epoch 61/80
 - 2s - loss: 0.1147
Epoch 62/80
 - 2s - loss: 0.1146
Epoch 63/80
 - 2s - loss: 0.1146
Epoch 64/80
 - 2s - loss: 0.1146
Epoch 65/80
 - 2s - loss: 0.1145
Epoch 66/80
 - 2s - loss: 0.1145
Epoch 67/80
 - 2s - loss: 0.1144
Epoch 68/80
 - 2s - loss: 0.1144
Epoch 69/80
 - 2s - loss: 0.1122
Epoch 70/80
 - 2s - loss: 0.1120
Epoch 71/80
 - 2s - loss: 0.1119
Epoch 72/80
 - 2s - loss: 0.1119
Epoch 73/80
 - 2s - loss: 0.1119
Epoch 74/80
 - 2s - loss: 0.1113
Epoch 75/80
 - 2s - loss: 0.1113
Epoch 76/80
 - 2s - loss: 0.1113
Epoch 77/80
 - 2s - loss: 0.1113
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:05:00.825124: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:05:00.996204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:05:00.996252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:05:01.303328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:05:01.303384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:05:01.303394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:05:01.303663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1431
Epoch 2/80
 - 2s - loss: 0.2148
Epoch 3/80
 - 2s - loss: 0.1719
Epoch 4/80
 - 2s - loss: 0.1645
Epoch 5/80
 - 2s - loss: 0.1590
Epoch 6/80
 - 2s - loss: 0.1524
Epoch 7/80
 - 2s - loss: 0.1435
Epoch 8/80
 - 2s - loss: 0.1319
Epoch 9/80
 - 2s - loss: 0.1196
Epoch 10/80
 - 2s - loss: 0.1089
Epoch 11/80
 - 2s - loss: 0.1003
Epoch 12/80
 - 2s - loss: 0.0931
Epoch 13/80
 - 2s - loss: 0.0870
Epoch 14/80
 - 2s - loss: 0.0817
Epoch 15/80
 - 2s - loss: 0.0772
Epoch 16/80
 - 2s - loss: 0.0734
Epoch 17/80
 - 2s - loss: 0.0701
Epoch 18/80
 - 2s - loss: 0.0673
Epoch 19/80
 - 2s - loss: 0.0648
Epoch 20/80
 - 2s - loss: 0.0627
Epoch 21/80
 - 2s - loss: 0.0610
Epoch 22/80
 - 2s - loss: 0.0594
Epoch 23/80
 - 2s - loss: 0.0582
Epoch 24/80
 - 2s - loss: 0.0571
Epoch 25/80
 - 2s - loss: 0.0562
Epoch 26/80
 - 2s - loss: 0.0555
Epoch 27/80
 - 2s - loss: 0.0548
Epoch 28/80
 - 2s - loss: 0.0543
Epoch 29/80
 - 2s - loss: 0.0538
Epoch 30/80
 - 2s - loss: 0.0534
Epoch 31/80
 - 2s - loss: 0.0530
Epoch 32/80
 - 2s - loss: 0.0527
Epoch 33/80
 - 2s - loss: 0.0524
Epoch 34/80
 - 2s - loss: 0.0522
Epoch 35/80
 - 2s - loss: 0.0519
Epoch 36/80
 - 2s - loss: 0.0518
Epoch 37/80
 - 2s - loss: 0.0516
Epoch 38/80
 - 2s - loss: 0.0514
Epoch 39/80
 - 2s - loss: 0.0513
Epoch 40/80
 - 2s - loss: 0.0512
Epoch 41/80
 - 2s - loss: 0.0510
Epoch 42/80
 - 2s - loss: 0.0509
Epoch 43/80
 - 2s - loss: 0.0508
Epoch 44/80
 - 2s - loss: 0.0508
Epoch 45/80
 - 2s - loss: 0.0506
Epoch 46/80
 - 2s - loss: 0.0506
Epoch 47/80
 - 2s - loss: 0.0505
Epoch 48/80
 - 2s - loss: 0.0505
Epoch 49/80
 - 2s - loss: 0.0504
Epoch 50/80
 - 2s - loss: 0.0503
Epoch 51/80
 - 2s - loss: 0.0503
Epoch 52/80
 - 2s - loss: 0.0502
Epoch 53/80
 - 2s - loss: 0.0502
Epoch 54/80
 - 2s - loss: 0.0501
Epoch 55/80
 - 2s - loss: 0.0501
Epoch 56/80
 - 2s - loss: 0.0501
Epoch 57/80
 - 2s - loss: 0.0500
Epoch 58/80
 - 2s - loss: 0.0500
Epoch 59/80
 - 2s - loss: 0.0500
Epoch 60/80
 - 2s - loss: 0.0499
Epoch 61/80
 - 2s - loss: 0.0488
Epoch 62/80
 - 2s - loss: 0.0487
Epoch 63/80
 - 2s - loss: 0.0487
Epoch 64/80
 - 2s - loss: 0.0487
Epoch 65/80
 - 2s - loss: 0.0487
Epoch 66/80
 - 2s - loss: 0.0484
Epoch 67/80
 - 2s - loss: 0.0484
Epoch 68/80
 - 2s - loss: 0.0484
Epoch 69/80
 - 2s - loss: 0.0484
Epoch 70/80
 - 2s - loss: 0.0483
Epoch 71/80
 - 2s - loss: 0.0483
Epoch 72/80
 - 2s - loss: 0.0483
Epoch 73/80
 - 2s - loss: 0.0483
Epoch 74/80
 - 2s - loss: 0.0483
Epoch 75/80
 - 2s - loss: 0.0483
Epoch 76/80
 - 2s - loss: 0.0483
Epoch 77/80
 - 2s - loss: 0.0483
Epoch 78/80
 - 2s - loss: 0.0483
Epoch 79/80
 - 2s - loss: 0.0483
Epoch 80/80
 - 2s - loss: 0.0483
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.1762 - val_loss: 0.7710
AUC: 0.8459

Epoch 2/80
 - 0s - loss: 1.3373 - val_loss: 0.7114
AUC: 0.8536

Epoch 3/80
 - 0s - loss: 1.1608 - val_loss: 0.7165
AUC: 0.8590

Epoch 4/80
 - 0s - loss: 1.1134 - val_loss: 0.6452
AUC: 0.8598

Epoch 5/80
 - 0s - loss: 1.0823 - val_loss: 0.6134
AUC: 0.8642

Epoch 6/80
 - 0s - loss: 1.0755 - val_loss: 0.7426
AUC: 0.8623

Epoch 7/80
 - 0s - loss: 1.0527 - val_loss: 0.6157
AUC: 0.8646

Epoch 8/80
 - 0s - loss: 1.0489 - val_loss: 0.6428
AUC: 0.8670

Epoch 9/80
 - 0s - loss: 1.0348 - val_loss: 0.6660
AUC: 0.8678

Epoch 10/80
 - 0s - loss: 1.0337 - val_loss: 0.6115
AUC: 0.8684

Epoch 11/80
 - 0s - loss: 1.0222 - val_loss: 0.5878
AUC: 0.8682

Epoch 12/80
 - 0s - loss: 1.0183 - val_loss: 0.6167
AUC: 0.8700

Epoch 13/80
 - 0s - loss: 1.0128 - val_loss: 0.6441
AUC: 0.8719

Epoch 14/80
 - 0s - loss: 1.0112 - val_loss: 0.6210
AUC: 0.8722

Epoch 15/80
 - 0s - loss: 1.0064 - val_loss: 0.5970
AUC: 0.8722

Epoch 16/80
 - 0s - loss: 1.0047 - val_loss: 0.5980
AUC: 0.8719

Epoch 17/80
 - 0s - loss: 0.9940 - val_loss: 0.6471
AUC: 0.8723

Epoch 18/80
 - 0s - loss: 0.9977 - val_loss: 0.5892
AUC: 0.8727

Epoch 19/80
 - 0s - loss: 0.9884 - val_loss: 0.5851
AUC: 0.8730

Epoch 20/80
 - 0s - loss: 0.9824 - val_loss: 0.6097
AUC: 0.8734

Epoch 21/80
 - 0s - loss: 0.9824 - val_loss: 0.5875
AUC: 0.8739

Epoch 22/80
 - 0s - loss: 0.9813 - val_loss: 0.5792
AUC: 0.8735

Epoch 23/80
 - 0s - loss: 0.9735 - val_loss: 0.5771
AUC: 0.8735

Epoch 24/80
 - 0s - loss: 0.9678 - val_loss: 0.5937
AUC: 0.8749

Epoch 25/80
 - 0s - loss: 0.9642 - val_loss: 0.5347
AUC: 0.8736

Epoch 26/80
 - 0s - loss: 0.9672 - val_loss: 0.6998
AUC: 0.8763

Epoch 27/80
 - 0s - loss: 0.9608 - val_loss: 0.6076
AUC: 0.8757

Epoch 28/80
 - 0s - loss: 0.9605 - val_loss: 0.5708
AUC: 0.8744

Epoch 29/80
 - 0s - loss: 0.9556 - val_loss: 0.5624
AUC: 0.8746

Epoch 30/80
 - 0s - loss: 0.9627 - val_loss: 0.6142
AUC: 0.8750

Epoch 31/80
 - 0s - loss: 0.9564 - val_loss: 0.5653
AUC: 0.8753

Epoch 32/80
 - 0s - loss: 0.9485 - val_loss: 0.6445
AUC: 0.8768

Epoch 33/80
 - 0s - loss: 0.9466 - val_loss: 0.5831
AUC: 0.8760

Epoch 34/80
 - 0s - loss: 0.9441 - val_loss: 0.5908
AUC: 0.8756

Epoch 35/80
 - 0s - loss: 0.9436 - val_loss: 0.6134
AUC: 0.8764

Epoch 36/80
 - 0s - loss: 0.9289 - val_loss: 0.6055
AUC: 0.8761

Epoch 37/80
 - 0s - loss: 0.9196 - val_loss: 0.5757
AUC: 0.8761

Epoch 38/80
 - 0s - loss: 0.9149 - val_loss: 0.5854
AUC: 0.8764

Epoch 39/80
 - 0s - loss: 0.9139 - val_loss: 0.5731
AUC: 0.8752

Epoch 40/80
 - 0s - loss: 0.9154 - val_loss: 0.5791
AUC: 0.8757

Epoch 41/80
 - 0s - loss: 0.9136 - val_loss: 0.5938
AUC: 0.8756

Epoch 42/80
 - 0s - loss: 0.9124 - val_loss: 0.5614
AUC: 0.8754

Epoch 43/80
 - 0s - loss: 0.9160 - val_loss: 0.5451
AUC: 0.8751

Epoch 44/80
 - 0s - loss: 0.9144 - val_loss: 0.5728
AUC: 0.8756

Epoch 45/80
 - 0s - loss: 0.9122 - val_loss: 0.5895
AUC: 0.8762

Epoch 46/80
 - 0s - loss: 0.9070 - val_loss: 0.5808
AUC: 0.8760

Epoch 47/80
 - 0s - loss: 0.9111 - val_loss: 0.5752
AUC: 0.8758

Epoch 48/80
 - 0s - loss: 0.9078 - val_loss: 0.5775
AUC: 0.8757

Epoch 49/80
 - 0s - loss: 0.9046 - val_loss: 0.5700
AUC: 0.8756

Epoch 50/80
 - 0s - loss: 0.9059 - val_loss: 0.5716
AUC: 0.8757

Epoch 51/80
 - 0s - loss: 0.9059 - val_loss: 0.5649
AUC: 0.8757

Epoch 52/80
 - 0s - loss: 0.9043 - val_loss: 0.5674
AUC: 0.8756

Epoch 53/80
 - 0s - loss: 0.8999 - val_loss: 0.5773
AUC: 0.8756

Epoch 54/80
 - 0s - loss: 0.9049 - val_loss: 0.5748
AUC: 0.8758

Epoch 55/80
 - 0s - loss: 0.9053 - val_loss: 0.5716
AUC: 0.8757

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9358 - val_loss: 0.5857
AUC: 0.8760

Epoch 2/30
 - 0s - loss: 0.9290 - val_loss: 0.5630
AUC: 0.8756

Epoch 3/30
 - 0s - loss: 0.9220 - val_loss: 0.5656
AUC: 0.8756

Epoch 4/30
 - 0s - loss: 0.9216 - val_loss: 0.6016
AUC: 0.8763

Epoch 5/30
 - 0s - loss: 0.9246 - val_loss: 0.5425
AUC: 0.8759

Epoch 6/30
 - 0s - loss: 0.9171 - val_loss: 0.5819
AUC: 0.8760

Epoch 7/30
 - 0s - loss: 0.9209 - val_loss: 0.5701
AUC: 0.8761

Epoch 8/30
 - 0s - loss: 0.9146 - val_loss: 0.5815
AUC: 0.8762

Epoch 9/30
 - 0s - loss: 0.9172 - val_loss: 0.5673
AUC: 0.8761

Epoch 10/30
 - 0s - loss: 0.9156 - val_loss: 0.5835
AUC: 0.8765

Epoch 11/30
 - 0s - loss: 0.9134 - val_loss: 0.5880
AUC: 0.8763

Epoch 12/30
 - 0s - loss: 0.9132 - val_loss: 0.5903
AUC: 0.8764

Epoch 13/30
 - 0s - loss: 0.9094 - val_loss: 0.5875
AUC: 0.8761

Epoch 14/30
 - 0s - loss: 0.9086 - val_loss: 0.5727
AUC: 0.8762

Epoch 15/30
 - 0s - loss: 0.9020 - val_loss: 0.6003
AUC: 0.8763

Epoch 16/30
 - 0s - loss: 0.9040 - val_loss: 0.5676
AUC: 0.8759

Epoch 17/30
 - 0s - loss: 0.9017 - val_loss: 0.5766
AUC: 0.8761

Epoch 18/30
 - 0s - loss: 0.9045 - val_loss: 0.5713
AUC: 0.8761

Epoch 19/30
 - 0s - loss: 0.9045 - val_loss: 0.5782
AUC: 0.8762

Epoch 20/30
 - 0s - loss: 0.9015 - val_loss: 0.5759
AUC: 0.8761

Epoch 21/30
 - 0s - loss: 0.9050 - val_loss: 0.5763
AUC: 0.8762

Epoch 22/30
 - 0s - loss: 0.9020 - val_loss: 0.5701
AUC: 0.8762

Epoch 23/30
 - 0s - loss: 0.9032 - val_loss: 0.5787
AUC: 0.8763

Epoch 24/30
 - 0s - loss: 0.8995 - val_loss: 0.5667
AUC: 0.8762

Epoch 25/30
 - 0s - loss: 0.9021 - val_loss: 0.5727
AUC: 0.8762

Epoch 26/30
 - 0s - loss: 0.8965 - val_loss: 0.5731
AUC: 0.8762

Epoch 27/30
 - 0s - loss: 0.8986 - val_loss: 0.5728
AUC: 0.8762

Epoch 28/30
 - 0s - loss: 0.9025 - val_loss: 0.5741
AUC: 0.8762

Epoch 29/30
 - 0s - loss: 0.9014 - val_loss: 0.5730
AUC: 0.8762

Epoch 30/30
 - 0s - loss: 0.8956 - val_loss: 0.5736
Using TensorFlow backend.
AUC: 0.8762

2019-03-08 05:09:03.652532: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:09:03.824000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:09:03.824061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:09:04.134797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:09:04.134853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:09:04.134863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:09:04.135152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1421
Epoch 2/80
 - 2s - loss: 0.2149
Epoch 3/80
 - 2s - loss: 0.1717
Epoch 4/80
 - 2s - loss: 0.1635
Epoch 5/80
 - 2s - loss: 0.1550
Epoch 6/80
 - 2s - loss: 0.1444
Epoch 7/80
 - 2s - loss: 0.1333
Epoch 8/80
 - 2s - loss: 0.1241
Epoch 9/80
 - 2s - loss: 0.1166
Epoch 10/80
 - 2s - loss: 0.1097
Epoch 11/80
 - 2s - loss: 0.1030
Epoch 12/80
 - 2s - loss: 0.0962
Epoch 13/80
 - 2s - loss: 0.0898
Epoch 14/80
 - 2s - loss: 0.0841
Epoch 15/80
 - 2s - loss: 0.0792
Epoch 16/80
 - 2s - loss: 0.0751
Epoch 17/80
 - 2s - loss: 0.0716
Epoch 18/80
 - 2s - loss: 0.0688
Epoch 19/80
 - 2s - loss: 0.0663
Epoch 20/80
 - 2s - loss: 0.0642
Epoch 21/80
 - 2s - loss: 0.0625
Epoch 22/80
 - 2s - loss: 0.0610
Epoch 23/80
 - 2s - loss: 0.0597
Epoch 24/80
 - 2s - loss: 0.0585
Epoch 25/80
 - 2s - loss: 0.0576
Epoch 26/80
 - 2s - loss: 0.0567
Epoch 27/80
 - 2s - loss: 0.0559
Epoch 28/80
 - 2s - loss: 0.0553
Epoch 29/80
 - 2s - loss: 0.0547
Epoch 30/80
 - 2s - loss: 0.0542
Epoch 31/80
 - 2s - loss: 0.0538
Epoch 32/80
 - 2s - loss: 0.0534
Epoch 33/80
 - 2s - loss: 0.0531
Epoch 34/80
 - 2s - loss: 0.0528
Epoch 35/80
 - 2s - loss: 0.0525
Epoch 36/80
 - 2s - loss: 0.0523
Epoch 37/80
 - 2s - loss: 0.0521
Epoch 38/80
 - 2s - loss: 0.0519
Epoch 39/80
 - 2s - loss: 0.0517
Epoch 40/80
 - 2s - loss: 0.0516
Epoch 41/80
 - 2s - loss: 0.0514
Epoch 42/80
 - 2s - loss: 0.0513
Epoch 43/80
 - 2s - loss: 0.0512
Epoch 44/80
 - 2s - loss: 0.0511
Epoch 45/80
 - 2s - loss: 0.0510
Epoch 46/80
 - 2s - loss: 0.0509
Epoch 47/80
 - 2s - loss: 0.0508
Epoch 48/80
 - 2s - loss: 0.0508
Epoch 49/80
 - 2s - loss: 0.0507
Epoch 50/80
 - 2s - loss: 0.0506
Epoch 51/80
 - 2s - loss: 0.0506
Epoch 52/80
 - 2s - loss: 0.0505
Epoch 53/80
 - 2s - loss: 0.0505
Epoch 54/80
 - 2s - loss: 0.0504
Epoch 55/80
 - 2s - loss: 0.0504
Epoch 56/80
 - 2s - loss: 0.0503
Epoch 57/80
 - 2s - loss: 0.0503
Epoch 58/80
 - 2s - loss: 0.0503
Epoch 59/80
 - 2s - loss: 0.0502
Epoch 60/80
 - 2s - loss: 0.0502
Epoch 61/80
 - 2s - loss: 0.0502
Epoch 62/80
 - 2s - loss: 0.0501
Epoch 63/80
 - 2s - loss: 0.0501
Epoch 64/80
 - 2s - loss: 0.0501
Epoch 65/80
 - 2s - loss: 0.0490
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:11:29.269314: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:11:29.437906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:11:29.437951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:11:29.754279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:11:29.754324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:11:29.754333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:11:29.754621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1569
Epoch 2/80
 - 2s - loss: 0.2175
Epoch 3/80
 - 2s - loss: 0.1738
Epoch 4/80
 - 2s - loss: 0.1664
Epoch 5/80
 - 2s - loss: 0.1609
Epoch 6/80
 - 2s - loss: 0.1541
Epoch 7/80
 - 2s - loss: 0.1443
Epoch 8/80
 - 2s - loss: 0.1324
Epoch 9/80
 - 2s - loss: 0.1216
Epoch 10/80
 - 2s - loss: 0.1128
Epoch 11/80
 - 2s - loss: 0.1049
Epoch 12/80
 - 2s - loss: 0.0974
Epoch 13/80
 - 2s - loss: 0.0902
Epoch 14/80
 - 2s - loss: 0.0840
Epoch 15/80
 - 2s - loss: 0.0788
Epoch 16/80
 - 2s - loss: 0.0747
Epoch 17/80
 - 2s - loss: 0.0712
Epoch 18/80
 - 2s - loss: 0.0683
Epoch 19/80
 - 2s - loss: 0.0658
Epoch 20/80
 - 2s - loss: 0.0637
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:12:31.127524: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:12:31.300310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:12:31.300356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:12:31.604796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:12:31.604852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:12:31.604862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:12:31.605126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1108
Epoch 2/80
 - 2s - loss: 0.2102
Epoch 3/80
 - 2s - loss: 0.1735
Epoch 4/80
 - 2s - loss: 0.1678
Epoch 5/80
 - 2s - loss: 0.1633
Epoch 6/80
 - 2s - loss: 0.1572
Epoch 7/80
 - 2s - loss: 0.1486
Epoch 8/80
 - 2s - loss: 0.1374
Epoch 9/80
 - 2s - loss: 0.1248
Epoch 10/80
 - 2s - loss: 0.1133
Epoch 11/80
 - 2s - loss: 0.1039
Epoch 12/80
 - 2s - loss: 0.0964
Epoch 13/80
 - 2s - loss: 0.0901
Epoch 14/80
 - 2s - loss: 0.0847
Epoch 15/80
 - 2s - loss: 0.0800
Epoch 16/80
 - 2s - loss: 0.0760
Epoch 17/80
 - 2s - loss: 0.0726
Epoch 18/80
 - 2s - loss: 0.0697
Epoch 19/80
 - 2s - loss: 0.0671
Epoch 20/80
 - 2s - loss: 0.0648
Epoch 21/80
 - 2s - loss: 0.0629
Epoch 22/80
 - 2s - loss: 0.0612
Epoch 23/80
 - 2s - loss: 0.0598
Epoch 24/80
 - 2s - loss: 0.0586
Epoch 25/80
 - 2s - loss: 0.0575
Epoch 26/80
 - 2s - loss: 0.0567
Epoch 27/80
 - 2s - loss: 0.0559
Epoch 28/80
 - 2s - loss: 0.0553
Epoch 29/80
 - 2s - loss: 0.0548
Epoch 30/80
 - 2s - loss: 0.0543
Epoch 31/80
 - 2s - loss: 0.0539
Epoch 32/80
 - 2s - loss: 0.0535
Epoch 33/80
 - 2s - loss: 0.0532
Epoch 34/80
 - 2s - loss: 0.0530
Epoch 35/80
 - 2s - loss: 0.0527
Epoch 36/80
 - 2s - loss: 0.0525
Epoch 37/80
 - 2s - loss: 0.0523
Epoch 38/80
 - 2s - loss: 0.0521
Epoch 39/80
 - 2s - loss: 0.0520
Epoch 40/80
 - 2s - loss: 0.0518
Epoch 41/80
 - 2s - loss: 0.0517
Epoch 42/80
 - 2s - loss: 0.0516
Epoch 43/80
 - 2s - loss: 0.0514
Epoch 44/80
 - 2s - loss: 0.0514
Epoch 45/80
 - 2s - loss: 0.0513
Epoch 46/80
 - 2s - loss: 0.0512
Epoch 47/80
 - 2s - loss: 0.0511
Epoch 48/80
 - 2s - loss: 0.0510
Epoch 49/80
 - 2s - loss: 0.0510
Epoch 50/80
 - 2s - loss: 0.0509
Epoch 51/80
 - 2s - loss: 0.0508
Epoch 52/80
 - 2s - loss: 0.0508
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:14:35.316144: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:14:35.487828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:14:35.487884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:14:35.795498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:14:35.795555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:14:35.795564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:14:35.795860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.3 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6888
Epoch 2/80
 - 2s - loss: 0.1340
Epoch 3/80
 - 2s - loss: 0.0738
Epoch 4/80
 - 2s - loss: 0.0658
Epoch 5/80
 - 2s - loss: 0.0626
Epoch 6/80
 - 2s - loss: 0.0604
Epoch 7/80
 - 2s - loss: 0.0580
Epoch 8/80
 - 2s - loss: 0.0550
Epoch 9/80
 - 2s - loss: 0.0514
Epoch 10/80
 - 2s - loss: 0.0474
Epoch 11/80
 - 2s - loss: 0.0435
Epoch 12/80
 - 2s - loss: 0.0398
Epoch 13/80
 - 2s - loss: 0.0365
Epoch 14/80
 - 2s - loss: 0.0338
Epoch 15/80
 - 2s - loss: 0.0316
Epoch 16/80
 - 2s - loss: 0.0298
Epoch 17/80
 - 2s - loss: 0.0281
Epoch 18/80
 - 2s - loss: 0.0266
Epoch 19/80
 - 2s - loss: 0.0253
Epoch 20/80
 - 2s - loss: 0.0241
Epoch 21/80
 - 2s - loss: 0.0230
Epoch 22/80
 - 2s - loss: 0.0221
Epoch 23/80
 - 2s - loss: 0.0213
Epoch 24/80
 - 2s - loss: 0.0207
Epoch 25/80
 - 2s - loss: 0.0201
Epoch 26/80
 - 2s - loss: 0.0197
Epoch 27/80
 - 2s - loss: 0.0193
Epoch 28/80
 - 2s - loss: 0.0190
Epoch 29/80
 - 2s - loss: 0.0187
Epoch 30/80
 - 2s - loss: 0.0184
Epoch 31/80
 - 2s - loss: 0.0182
Epoch 32/80
 - 2s - loss: 0.0180
Epoch 33/80
 - 2s - loss: 0.0178
Epoch 34/80
 - 2s - loss: 0.0177
Epoch 35/80
 - 2s - loss: 0.0175
Epoch 36/80
 - 2s - loss: 0.0174
Epoch 37/80
 - 2s - loss: 0.0173
Epoch 38/80
 - 2s - loss: 0.0172
Epoch 39/80
 - 2s - loss: 0.0171
Epoch 40/80
 - 2s - loss: 0.0170
Epoch 41/80
 - 2s - loss: 0.0170
Epoch 42/80
 - 2s - loss: 0.0169
Epoch 43/80
 - 2s - loss: 0.0169
Epoch 44/80
 - 2s - loss: 0.0168
Epoch 45/80
 - 2s - loss: 0.0168
Epoch 46/80
 - 2s - loss: 0.0167
Epoch 47/80
 - 2s - loss: 0.0167
Epoch 48/80
 - 2s - loss: 0.0166
Epoch 49/80
 - 2s - loss: 0.0166
Epoch 50/80
 - 2s - loss: 0.0166
Epoch 51/80
 - 2s - loss: 0.0165
Epoch 52/80
 - 2s - loss: 0.0165
Epoch 53/80
 - 2s - loss: 0.0161
Epoch 54/80
 - 2s - loss: 0.0161
Epoch 55/80
 - 2s - loss: 0.0161
Epoch 56/80
 - 2s - loss: 0.0160
Epoch 57/80
 - 2s - loss: 0.0159
Epoch 58/80
 - 2s - loss: 0.0159
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:16:51.336404: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:16:51.507398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:16:51.507443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:16:51.815008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:16:51.815064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:16:51.815073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:16:51.815340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6870
Epoch 2/80
 - 2s - loss: 0.1300
Epoch 3/80
 - 2s - loss: 0.0719
Epoch 4/80
 - 2s - loss: 0.0659
Epoch 5/80
 - 2s - loss: 0.0632
Epoch 6/80
 - 2s - loss: 0.0607
Epoch 7/80
 - 2s - loss: 0.0577
Epoch 8/80
 - 2s - loss: 0.0546
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:17:26.018254: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:17:26.187064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:17:26.187124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:17:26.490772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:17:26.490828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:17:26.490838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:17:26.491105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6890
Epoch 2/80
 - 2s - loss: 0.1305
Epoch 3/80
 - 2s - loss: 0.0722
Epoch 4/80
 - 2s - loss: 0.0664
Epoch 5/80
 - 2s - loss: 0.0640
Epoch 6/80
 - 2s - loss: 0.0615
Epoch 7/80
 - 2s - loss: 0.0581
Epoch 8/80
 - 2s - loss: 0.0542
Epoch 9/80
 - 2s - loss: 0.0505
Epoch 10/80
 - 2s - loss: 0.0472
Epoch 11/80
 - 2s - loss: 0.0442
Epoch 12/80
 - 2s - loss: 0.0412
Epoch 13/80
 - 2s - loss: 0.0383
Epoch 14/80
 - 2s - loss: 0.0356
Epoch 15/80
 - 2s - loss: 0.0331
Epoch 16/80
 - 2s - loss: 0.0309
Epoch 17/80
 - 2s - loss: 0.0290
Epoch 18/80
 - 2s - loss: 0.0273
Epoch 19/80
 - 2s - loss: 0.0258
Epoch 20/80
 - 2s - loss: 0.0246
Epoch 21/80
 - 2s - loss: 0.0235
Epoch 22/80
 - 2s - loss: 0.0226
Epoch 23/80
 - 2s - loss: 0.0218
Epoch 24/80
 - 2s - loss: 0.0211
Epoch 25/80
 - 2s - loss: 0.0206
Epoch 26/80
 - 2s - loss: 0.0201
Epoch 27/80
 - 2s - loss: 0.0196
Epoch 28/80
 - 2s - loss: 0.0192
Epoch 29/80
 - 2s - loss: 0.0189
Epoch 30/80
 - 2s - loss: 0.0186
Epoch 31/80
 - 2s - loss: 0.0183
Epoch 32/80
 - 2s - loss: 0.0181
Epoch 33/80
 - 2s - loss: 0.0179
Epoch 34/80
 - 2s - loss: 0.0177
Epoch 35/80
 - 2s - loss: 0.0176
Epoch 36/80
 - 2s - loss: 0.0175
Epoch 37/80
 - 2s - loss: 0.0173
Epoch 38/80
 - 2s - loss: 0.0172
Epoch 39/80
 - 2s - loss: 0.0171
Epoch 40/80
 - 2s - loss: 0.0171
Epoch 41/80
 - 2s - loss: 0.0170
Epoch 42/80
 - 2s - loss: 0.0169
Epoch 43/80
 - 2s - loss: 0.0169
Epoch 44/80
 - 2s - loss: 0.0168
Epoch 45/80
 - 2s - loss: 0.0168
Epoch 46/80
 - 2s - loss: 0.0167
Epoch 47/80
 - 2s - loss: 0.0167
Epoch 48/80
 - 2s - loss: 0.0166
Epoch 49/80
 - 2s - loss: 0.0166
Epoch 50/80
 - 2s - loss: 0.0166
Epoch 51/80
 - 2s - loss: 0.0165
Epoch 52/80
 - 2s - loss: 0.0165
Epoch 53/80
 - 2s - loss: 0.0165
Epoch 54/80
 - 2s - loss: 0.0164
Epoch 55/80
 - 2s - loss: 0.0161
Epoch 56/80
 - 2s - loss: 0.0160
Epoch 57/80
 - 2s - loss: 0.0160
Epoch 58/80
 - 2s - loss: 0.0160
Epoch 59/80
 - 2s - loss: 0.0159
Epoch 60/80
 - 2s - loss: 0.0159
Epoch 61/80
 - 2s - loss: 0.0159
Epoch 62/80
 - 2s - loss: 0.0159
Epoch 63/80
 - 2s - loss: 0.0158
Epoch 64/80
 - 2s - loss: 0.0158
Epoch 65/80
 - 2s - loss: 0.0158
Epoch 66/80
 - 2s - loss: 0.0158
Epoch 67/80
 - 2s - loss: 0.0158
Epoch 68/80
 - 2s - loss: 0.0158
Epoch 69/80
 - 2s - loss: 0.0158
Epoch 70/80
 - 2s - loss: 0.0158
Epoch 71/80
 - 2s - loss: 0.0158
Epoch 72/80
 - 2s - loss: 0.0158
Epoch 73/80
 - 2s - loss: 0.0158
Epoch 74/80
 - 2s - loss: 0.0158
Epoch 75/80
 - 2s - loss: 0.0158
Epoch 76/80
 - 2s - loss: 0.0158
Epoch 77/80
 - 2s - loss: 0.0158
Epoch 78/80
 - 2s - loss: 0.0158
Epoch 79/80
 - 2s - loss: 0.0158
Epoch 80/80
 - 2s - loss: 0.0158
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.1341 - val_loss: 1.3964
AUC: 0.8290

Epoch 2/80
 - 0s - loss: 1.9112 - val_loss: 0.8849
AUC: 0.8487

Epoch 3/80
 - 0s - loss: 1.4767 - val_loss: 0.6507
AUC: 0.8530

Epoch 4/80
 - 0s - loss: 1.2476 - val_loss: 0.6869
AUC: 0.8560

Epoch 5/80
 - 0s - loss: 1.1499 - val_loss: 0.6490
AUC: 0.8595

Epoch 6/80
 - 0s - loss: 1.1030 - val_loss: 0.7301
AUC: 0.8623

Epoch 7/80
 - 0s - loss: 1.0766 - val_loss: 0.7009
AUC: 0.8641

Epoch 8/80
 - 0s - loss: 1.0653 - val_loss: 0.5783
AUC: 0.8630

Epoch 9/80
 - 0s - loss: 1.0482 - val_loss: 0.5542
AUC: 0.8630

Epoch 10/80
 - 0s - loss: 1.0421 - val_loss: 0.6135
AUC: 0.8667

Epoch 11/80
 - 0s - loss: 1.0303 - val_loss: 0.5869
AUC: 0.8649

Epoch 12/80
 - 0s - loss: 1.0190 - val_loss: 0.6083
AUC: 0.8690

Epoch 13/80
 - 0s - loss: 1.0133 - val_loss: 0.6499
AUC: 0.8687

Epoch 14/80
 - 0s - loss: 1.0070 - val_loss: 0.6041
AUC: 0.8688

Epoch 15/80
 - 0s - loss: 1.0028 - val_loss: 0.5592
AUC: 0.8696

Epoch 16/80
 - 0s - loss: 1.0018 - val_loss: 0.6486
AUC: 0.8716

Epoch 17/80
 - 0s - loss: 0.9913 - val_loss: 0.6945
AUC: 0.8729

Epoch 18/80
 - 0s - loss: 0.9850 - val_loss: 0.6740
AUC: 0.8721

Epoch 19/80
 - 0s - loss: 0.9934 - val_loss: 0.6321
AUC: 0.8702

Epoch 20/80
 - 0s - loss: 0.9712 - val_loss: 0.6206
AUC: 0.8724

Epoch 21/80
 - 0s - loss: 0.9680 - val_loss: 0.5805
AUC: 0.8726

Epoch 22/80
 - 0s - loss: 0.9646 - val_loss: 0.6158
AUC: 0.8733

Epoch 23/80
 - 0s - loss: 0.9716 - val_loss: 0.5791
AUC: 0.8727

Epoch 24/80
 - 0s - loss: 0.9634 - val_loss: 0.6017
AUC: 0.8731

Epoch 25/80
 - 0s - loss: 0.9664 - val_loss: 0.6229
AUC: 0.8738

Epoch 26/80
 - 0s - loss: 0.9631 - val_loss: 0.5899
AUC: 0.8738

Epoch 27/80
 - 0s - loss: 0.9616 - val_loss: 0.5933
AUC: 0.8732

Epoch 28/80
 - 0s - loss: 0.9568 - val_loss: 0.5910
AUC: 0.8733

Epoch 29/80
 - 0s - loss: 0.9581 - val_loss: 0.6101
AUC: 0.8740

Epoch 30/80
 - 0s - loss: 0.9611 - val_loss: 0.6054
AUC: 0.8741

Epoch 31/80
 - 0s - loss: 0.9529 - val_loss: 0.5846
AUC: 0.8738

Epoch 32/80
 - 0s - loss: 0.9499 - val_loss: 0.6029
AUC: 0.8740

Epoch 33/80
 - 0s - loss: 0.9563 - val_loss: 0.5961
AUC: 0.8739

Epoch 34/80
 - 0s - loss: 0.9512 - val_loss: 0.5950
AUC: 0.8739

Epoch 35/80
 - 0s - loss: 0.9537 - val_loss: 0.5975
AUC: 0.8740

Epoch 36/80
 - 0s - loss: 0.9515 - val_loss: 0.6000
AUC: 0.8738

Epoch 37/80
 - 0s - loss: 0.9512 - val_loss: 0.5888
AUC: 0.8738

Epoch 38/80
 - 0s - loss: 0.9527 - val_loss: 0.5886
AUC: 0.8738

Epoch 39/80
 - 0s - loss: 0.9514 - val_loss: 0.5938
AUC: 0.8738

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9575 - val_loss: 0.5853
AUC: 0.8737

Epoch 2/30
 - 0s - loss: 0.9538 - val_loss: 0.6158
AUC: 0.8742

Epoch 3/30
 - 0s - loss: 0.9541 - val_loss: 0.5969
AUC: 0.8742

Epoch 4/30
 - 0s - loss: 0.9489 - val_loss: 0.6055
AUC: 0.8745

Epoch 5/30
 - 0s - loss: 0.9476 - val_loss: 0.5706
AUC: 0.8742

Epoch 6/30
 - 0s - loss: 0.9410 - val_loss: 0.5703
AUC: 0.8743

Epoch 7/30
 - 0s - loss: 0.9453 - val_loss: 0.5884
AUC: 0.8746

Epoch 8/30
 - 0s - loss: 0.9386 - val_loss: 0.5798
AUC: 0.8745

Epoch 9/30
 - 0s - loss: 0.9416 - val_loss: 0.5778
AUC: 0.8745

Epoch 10/30
 - 0s - loss: 0.9410 - val_loss: 0.6020
AUC: 0.8751

Epoch 11/30
 - 0s - loss: 0.9397 - val_loss: 0.6257
AUC: 0.8755

Epoch 12/30
 - 0s - loss: 0.9291 - val_loss: 0.6061
AUC: 0.8752

Epoch 13/30
 - 0s - loss: 0.9367 - val_loss: 0.5866
AUC: 0.8754

Epoch 14/30
 - 0s - loss: 0.9322 - val_loss: 0.6058
AUC: 0.8756

Epoch 15/30
 - 0s - loss: 0.9350 - val_loss: 0.5645
AUC: 0.8753

Epoch 16/30
 - 0s - loss: 0.9351 - val_loss: 0.6048
AUC: 0.8759

Epoch 17/30
 - 0s - loss: 0.9292 - val_loss: 0.5999
AUC: 0.8759

Epoch 18/30
 - 0s - loss: 0.9252 - val_loss: 0.5725
AUC: 0.8756

Epoch 19/30
 - 0s - loss: 0.9273 - val_loss: 0.5868
AUC: 0.8760

Epoch 20/30
 - 0s - loss: 0.9266 - val_loss: 0.5907
AUC: 0.8760

Epoch 21/30
 - 0s - loss: 0.9222 - val_loss: 0.5960
AUC: 0.8764

Epoch 22/30
 - 0s - loss: 0.9202 - val_loss: 0.6024
AUC: 0.8766

Epoch 23/30
 - 0s - loss: 0.9215 - val_loss: 0.6056
AUC: 0.8767

Epoch 24/30
 - 0s - loss: 0.9211 - val_loss: 0.5714
AUC: 0.8762

Epoch 25/30
 - 0s - loss: 0.9177 - val_loss: 0.5721
AUC: 0.8764

Epoch 26/30
 - 0s - loss: 0.9152 - val_loss: 0.5746
AUC: 0.8765

Epoch 27/30
 - 0s - loss: 0.9136 - val_loss: 0.5786
AUC: 0.8766

Epoch 28/30
 - 0s - loss: 0.9135 - val_loss: 0.5782
AUC: 0.8766

Epoch 29/30
 - 0s - loss: 0.9151 - val_loss: 0.5811
AUC: 0.8767

Epoch 30/30
 - 0s - loss: 0.9114 - val_loss: 0.5748
Using TensorFlow backend.
AUC: 0.8766

2019-03-08 05:21:19.529687: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:21:19.698063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:21:19.698109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:21:20.001688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:21:20.001740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:21:20.001750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:21:20.002089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2963
Epoch 2/80
 - 2s - loss: 0.3330
Epoch 3/80
 - 2s - loss: 0.3009
Epoch 4/80
 - 2s - loss: 0.2759
Epoch 5/80
 - 2s - loss: 0.2467
Epoch 6/80
 - 2s - loss: 0.2231
Epoch 7/80
 - 2s - loss: 0.2029
Epoch 8/80
 - 2s - loss: 0.1860
Epoch 9/80
 - 2s - loss: 0.1734
Epoch 10/80
 - 2s - loss: 0.1637
Epoch 11/80
 - 2s - loss: 0.1555
Epoch 12/80
 - 2s - loss: 0.1481
Epoch 13/80
 - 2s - loss: 0.1413
Epoch 14/80
 - 2s - loss: 0.1354
Epoch 15/80
 - 2s - loss: 0.1305
Epoch 16/80
 - 2s - loss: 0.1266
Epoch 17/80
 - 2s - loss: 0.1232
Epoch 18/80
 - 2s - loss: 0.1205
Epoch 19/80
 - 2s - loss: 0.1180
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:22:20.237582: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:22:20.406852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:22:20.406904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:22:20.712850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:22:20.712906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:22:20.712915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:22:20.713185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.4 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2955
Epoch 2/80
 - 2s - loss: 0.3342
Epoch 3/80
 - 2s - loss: 0.3034
Epoch 4/80
 - 2s - loss: 0.2828
Epoch 5/80
 - 2s - loss: 0.2572
Epoch 6/80
 - 2s - loss: 0.2312
Epoch 7/80
 - 2s - loss: 0.2083
Epoch 8/80
 - 2s - loss: 0.1908
Epoch 9/80
 - 2s - loss: 0.1770
Epoch 10/80
 - 2s - loss: 0.1651
Epoch 11/80
 - 2s - loss: 0.1548
Epoch 12/80
 - 2s - loss: 0.1463
Epoch 13/80
 - 2s - loss: 0.1394
Epoch 14/80
 - 2s - loss: 0.1340
Epoch 15/80
 - 2s - loss: 0.1296
Epoch 16/80
 - 2s - loss: 0.1259
Epoch 17/80
 - 2s - loss: 0.1228
Epoch 18/80
 - 2s - loss: 0.1202
Epoch 19/80
 - 2s - loss: 0.1178
Epoch 20/80
 - 2s - loss: 0.1158
Epoch 21/80
 - 2s - loss: 0.1141
Epoch 22/80
 - 2s - loss: 0.1126
Epoch 23/80
 - 2s - loss: 0.1113
Epoch 24/80
 - 2s - loss: 0.1102
Epoch 25/80
 - 2s - loss: 0.1092
Epoch 26/80
 - 2s - loss: 0.1084
Epoch 27/80
 - 2s - loss: 0.1076
Epoch 28/80
 - 2s - loss: 0.1069
Epoch 29/80
 - 2s - loss: 0.1064
Epoch 30/80
 - 2s - loss: 0.1058
Epoch 31/80
 - 2s - loss: 0.1054
Epoch 32/80
 - 2s - loss: 0.1051
Epoch 33/80
 - 2s - loss: 0.1047
Epoch 34/80
 - 2s - loss: 0.1044
Epoch 35/80
 - 2s - loss: 0.1041
Epoch 36/80
 - 2s - loss: 0.1039
Epoch 37/80
 - 2s - loss: 0.1036
Epoch 38/80
 - 2s - loss: 0.1034
Epoch 39/80
 - 2s - loss: 0.1032
Epoch 40/80
 - 2s - loss: 0.1031
Epoch 41/80
 - 2s - loss: 0.1029
Epoch 42/80
 - 2s - loss: 0.1028
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:24:04.959349: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:24:05.130293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:24:05.130339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:24:05.436316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:24:05.436369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:24:05.436378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:24:05.436644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3059
Epoch 2/80
 - 2s - loss: 0.3343
Epoch 3/80
 - 2s - loss: 0.3022
Epoch 4/80
 - 2s - loss: 0.2764
Epoch 5/80
 - 2s - loss: 0.2469
Epoch 6/80
 - 2s - loss: 0.2224
Epoch 7/80
 - 2s - loss: 0.2032
Epoch 8/80
 - 2s - loss: 0.1880
Epoch 9/80
 - 2s - loss: 0.1754
Epoch 10/80
 - 2s - loss: 0.1650
Epoch 11/80
 - 2s - loss: 0.1563
Epoch 12/80
 - 2s - loss: 0.1489
Epoch 13/80
 - 2s - loss: 0.1423
Epoch 14/80
 - 2s - loss: 0.1367
Epoch 15/80
 - 2s - loss: 0.1318
Epoch 16/80
 - 2s - loss: 0.1276
Epoch 17/80
 - 2s - loss: 0.1243
Epoch 18/80
 - 2s - loss: 0.1214
Epoch 19/80
 - 2s - loss: 0.1189
Epoch 20/80
 - 2s - loss: 0.1169
Epoch 21/80
 - 2s - loss: 0.1151
Epoch 22/80
 - 2s - loss: 0.1135
Epoch 23/80
 - 2s - loss: 0.1122
Epoch 24/80
 - 2s - loss: 0.1110
Epoch 25/80
 - 2s - loss: 0.1099
Epoch 26/80
 - 2s - loss: 0.1091
Epoch 27/80
 - 2s - loss: 0.1083
Epoch 28/80
 - 2s - loss: 0.1076
Epoch 29/80
 - 2s - loss: 0.1070
Epoch 30/80
 - 2s - loss: 0.1065
Epoch 31/80
 - 2s - loss: 0.1060
Epoch 32/80
 - 2s - loss: 0.1056
Epoch 33/80
 - 2s - loss: 0.1052
Epoch 34/80
 - 2s - loss: 0.1049
Epoch 35/80
 - 2s - loss: 0.1046
Epoch 36/80
 - 2s - loss: 0.1043
Epoch 37/80
 - 2s - loss: 0.1041
Epoch 38/80
 - 2s - loss: 0.1039
Epoch 39/80
 - 2s - loss: 0.1037
Epoch 40/80
 - 2s - loss: 0.1035
Epoch 41/80
 - 2s - loss: 0.1033
Epoch 42/80
 - 2s - loss: 0.1032
Epoch 43/80
 - 2s - loss: 0.1030
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2ba31e0ae198>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 05:25:48.508049: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:25:48.674292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:25:48.674353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:25:48.973975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:25:48.974030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:25:48.974039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:25:48.974303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0912
Epoch 2/80
 - 2s - loss: 0.1951
Epoch 3/80
 - 2s - loss: 0.1677
Epoch 4/80
 - 2s - loss: 0.1551
Epoch 5/80
 - 2s - loss: 0.1389
Epoch 6/80
 - 2s - loss: 0.1236
Epoch 7/80
 - 2s - loss: 0.1126
Epoch 8/80
 - 2s - loss: 0.1042
Epoch 9/80
 - 2s - loss: 0.0962
Epoch 10/80
 - 2s - loss: 0.0886
Epoch 11/80
 - 2s - loss: 0.0818
Epoch 12/80
 - 2s - loss: 0.0761
Epoch 13/80
 - 2s - loss: 0.0713
Epoch 14/80
 - 2s - loss: 0.0674
Epoch 15/80
 - 2s - loss: 0.0640
Epoch 16/80
 - 2s - loss: 0.0613
Epoch 17/80
 - 2s - loss: 0.0589
Epoch 18/80
 - 2s - loss: 0.0570
Epoch 19/80
 - 2s - loss: 0.0553
Epoch 20/80
 - 2s - loss: 0.0538
Epoch 21/80
 - 2s - loss: 0.0526
Epoch 22/80
 - 2s - loss: 0.0515
Epoch 23/80
 - 2s - loss: 0.0505
Epoch 24/80
 - 2s - loss: 0.0496
Epoch 25/80
 - 2s - loss: 0.0489
Epoch 26/80
 - 2s - loss: 0.0483
Epoch 27/80
 - 2s - loss: 0.0477
Epoch 28/80
 - 2s - loss: 0.0472
Epoch 29/80
 - 2s - loss: 0.0468
Epoch 30/80
 - 2s - loss: 0.0464
Epoch 31/80
 - 2s - loss: 0.0461
Epoch 32/80
 - 2s - loss: 0.0458
Epoch 33/80
 - 2s - loss: 0.0456
Epoch 34/80
 - 2s - loss: 0.0454
Epoch 35/80
 - 2s - loss: 0.0452
Epoch 36/80
 - 2s - loss: 0.0450
Epoch 37/80
 - 2s - loss: 0.0449
Epoch 38/80
 - 2s - loss: 0.0448
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:27:25.455778: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:27:25.626438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:27:25.626485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:27:25.930073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:27:25.930130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:27:25.930139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:27:25.930406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0736
Epoch 2/80
 - 2s - loss: 0.1956
Epoch 3/80
 - 2s - loss: 0.1697
Epoch 4/80
 - 2s - loss: 0.1614
Epoch 5/80
 - 2s - loss: 0.1499
Epoch 6/80
 - 2s - loss: 0.1347
Epoch 7/80
 - 2s - loss: 0.1209
Epoch 8/80
 - 2s - loss: 0.1095
Epoch 9/80
 - 2s - loss: 0.0996
Epoch 10/80
 - 2s - loss: 0.0911
Epoch 11/80
 - 2s - loss: 0.0840
Epoch 12/80
 - 2s - loss: 0.0783
Epoch 13/80
 - 2s - loss: 0.0736
Epoch 14/80
 - 2s - loss: 0.0696
Epoch 15/80
 - 2s - loss: 0.0662
Epoch 16/80
 - 2s - loss: 0.0632
Epoch 17/80
 - 2s - loss: 0.0606
Epoch 18/80
 - 2s - loss: 0.0585
Epoch 19/80
 - 2s - loss: 0.0566
Epoch 20/80
 - 2s - loss: 0.0551
Epoch 21/80
 - 2s - loss: 0.0537
Epoch 22/80
 - 2s - loss: 0.0525
Epoch 23/80
 - 2s - loss: 0.0515
Epoch 24/80
 - 2s - loss: 0.0506
Epoch 25/80
 - 2s - loss: 0.0498
Epoch 26/80
 - 2s - loss: 0.0492
Epoch 27/80
 - 2s - loss: 0.0485
Epoch 28/80
 - 2s - loss: 0.0480
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:28:43.344102: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:28:43.517210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:28:43.517258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:28:43.816771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:28:43.816826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:28:43.816835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:28:43.817104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0678
Epoch 2/80
 - 2s - loss: 0.1969
Epoch 3/80
 - 2s - loss: 0.1693
Epoch 4/80
 - 2s - loss: 0.1603
Epoch 5/80
 - 2s - loss: 0.1499
Epoch 6/80
 - 2s - loss: 0.1373
Epoch 7/80
 - 2s - loss: 0.1251
Epoch 8/80
 - 2s - loss: 0.1141
Epoch 9/80
 - 2s - loss: 0.1042
Epoch 10/80
 - 2s - loss: 0.0949
Epoch 11/80
 - 2s - loss: 0.0864
Epoch 12/80
 - 2s - loss: 0.0792
Epoch 13/80
 - 2s - loss: 0.0733
Epoch 14/80
 - 2s - loss: 0.0686
Epoch 15/80
 - 2s - loss: 0.0648
Epoch 16/80
 - 2s - loss: 0.0617
Epoch 17/80
 - 2s - loss: 0.0592
Epoch 18/80
 - 2s - loss: 0.0571
Epoch 19/80
 - 2s - loss: 0.0553
Epoch 20/80
 - 2s - loss: 0.0538
Epoch 21/80
 - 2s - loss: 0.0525
Epoch 22/80
 - 2s - loss: 0.0514
Epoch 23/80
 - 2s - loss: 0.0504
Epoch 24/80
 - 2s - loss: 0.0495
Epoch 25/80
 - 2s - loss: 0.0488
Epoch 26/80
 - 2s - loss: 0.0481
Epoch 27/80
 - 2s - loss: 0.0476
Epoch 28/80
 - 2s - loss: 0.0471
Epoch 29/80
 - 2s - loss: 0.0467
Epoch 30/80
 - 2s - loss: 0.0463
Epoch 31/80
 - 2s - loss: 0.0460
Epoch 32/80
 - 2s - loss: 0.0457
Epoch 33/80
 - 2s - loss: 0.0455
Epoch 34/80
 - 2s - loss: 0.0453
Epoch 35/80
 - 2s - loss: 0.0451
Epoch 36/80
 - 2s - loss: 0.0450
Epoch 37/80
 - 2s - loss: 0.0448
Epoch 38/80
 - 2s - loss: 0.0447
Epoch 39/80
 - 2s - loss: 0.0445
Epoch 40/80
 - 2s - loss: 0.0444
Epoch 41/80
 - 2s - loss: 0.0443
Epoch 42/80
 - 2s - loss: 0.0443
Epoch 43/80
 - 2s - loss: 0.0441
Epoch 44/80
 - 2s - loss: 0.0441
Epoch 45/80
 - 2s - loss: 0.0440
Epoch 46/80
 - 2s - loss: 0.0440
Epoch 47/80
 - 2s - loss: 0.0439
Epoch 48/80
 - 2s - loss: 0.0438
Epoch 49/80
 - 2s - loss: 0.0438
Epoch 50/80
 - 2s - loss: 0.0437
Epoch 51/80
 - 2s - loss: 0.0437
Epoch 52/80
 - 2s - loss: 0.0436
Epoch 53/80
 - 2s - loss: 0.0436
Epoch 54/80
 - 2s - loss: 0.0435
Epoch 55/80
 - 2s - loss: 0.0435
Epoch 56/80
 - 2s - loss: 0.0435
Epoch 57/80
 - 2s - loss: 0.0435
Epoch 58/80
 - 2s - loss: 0.0434
Epoch 59/80
 - 2s - loss: 0.0422
Epoch 60/80
 - 2s - loss: 0.0420
Epoch 61/80
 - 2s - loss: 0.0420
Epoch 62/80
 - 2s - loss: 0.0420
Epoch 63/80
 - 2s - loss: 0.0420
Epoch 64/80
 - 2s - loss: 0.0417
Epoch 65/80
 - 2s - loss: 0.0417
Epoch 66/80
 - 2s - loss: 0.0417
Epoch 67/80
 - 2s - loss: 0.0417
Epoch 68/80
 - 2s - loss: 0.0416
Epoch 69/80
 - 2s - loss: 0.0416
Epoch 70/80
 - 2s - loss: 0.0416
Epoch 71/80
 - 2s - loss: 0.0416
Epoch 72/80
 - 2s - loss: 0.0416
Epoch 73/80
 - 2s - loss: 0.0416
Epoch 74/80
 - 2s - loss: 0.0416
Epoch 75/80
 - 2s - loss: 0.0416
Epoch 76/80
 - 2s - loss: 0.0416
Epoch 77/80
 - 2s - loss: 0.0416
Epoch 78/80
 - 2s - loss: 0.0416
Epoch 79/80
 - 2s - loss: 0.0416
Epoch 80/80
 - 2s - loss: 0.0416
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 5.5691 - val_loss: 1.6187
AUC: 0.7719

Epoch 2/80
 - 0s - loss: 3.4192 - val_loss: 1.1186
AUC: 0.8023

Epoch 3/80
 - 0s - loss: 2.0644 - val_loss: 0.7783
AUC: 0.8114

Epoch 4/80
 - 0s - loss: 1.4623 - val_loss: 0.7726
AUC: 0.8176

Epoch 5/80
 - 0s - loss: 1.2811 - val_loss: 0.7292
AUC: 0.8231

Epoch 6/80
 - 0s - loss: 1.2187 - val_loss: 0.6985
AUC: 0.8292

Epoch 7/80
 - 0s - loss: 1.1785 - val_loss: 0.6765
AUC: 0.8339

Epoch 8/80
 - 0s - loss: 1.1562 - val_loss: 0.6811
AUC: 0.8402

Epoch 9/80
 - 0s - loss: 1.1409 - val_loss: 0.7816
AUC: 0.8449

Epoch 10/80
 - 0s - loss: 1.1235 - val_loss: 0.6518
AUC: 0.8452

Epoch 11/80
 - 0s - loss: 1.1092 - val_loss: 0.6156
AUC: 0.8478

Epoch 12/80
 - 0s - loss: 1.0945 - val_loss: 0.6773
AUC: 0.8504

Epoch 13/80
 - 0s - loss: 1.0899 - val_loss: 0.6636
AUC: 0.8517

Epoch 14/80
 - 0s - loss: 1.0768 - val_loss: 0.6299
AUC: 0.8526

Epoch 15/80
 - 0s - loss: 1.0820 - val_loss: 0.6529
AUC: 0.8549

Epoch 16/80
 - 0s - loss: 1.0687 - val_loss: 0.6305
AUC: 0.8560

Epoch 17/80
 - 0s - loss: 1.0607 - val_loss: 0.6501
AUC: 0.8563

Epoch 18/80
 - 0s - loss: 1.0589 - val_loss: 0.6210
AUC: 0.8568

Epoch 19/80
 - 0s - loss: 1.0579 - val_loss: 0.6152
AUC: 0.8575

Epoch 20/80
 - 0s - loss: 1.0518 - val_loss: 0.6739
AUC: 0.8588

Epoch 21/80
 - 0s - loss: 1.0442 - val_loss: 0.7066
AUC: 0.8594

Epoch 22/80
 - 0s - loss: 1.0482 - val_loss: 0.6127
AUC: 0.8592

Epoch 23/80
 - 0s - loss: 1.0385 - val_loss: 0.6410
AUC: 0.8599

Epoch 24/80
 - 0s - loss: 1.0343 - val_loss: 0.6577
AUC: 0.8612

Epoch 25/80
 - 0s - loss: 1.0353 - val_loss: 0.6202
AUC: 0.8610

Epoch 26/80
 - 0s - loss: 1.0314 - val_loss: 0.6728
AUC: 0.8615

Epoch 27/80
 - 0s - loss: 1.0294 - val_loss: 0.6374
AUC: 0.8624

Epoch 28/80
 - 0s - loss: 1.0363 - val_loss: 0.6441
AUC: 0.8626

Epoch 29/80
 - 0s - loss: 1.0246 - val_loss: 0.5994
AUC: 0.8621

Epoch 30/80
 - 0s - loss: 1.0226 - val_loss: 0.6406
AUC: 0.8636

Epoch 31/80
 - 0s - loss: 1.0194 - val_loss: 0.6501
AUC: 0.8643

Epoch 32/80
 - 0s - loss: 1.0157 - val_loss: 0.6579
AUC: 0.8640

Epoch 33/80
 - 0s - loss: 1.0176 - val_loss: 0.6126
AUC: 0.8631

Epoch 34/80
 - 0s - loss: 1.0115 - val_loss: 0.5830
AUC: 0.8637

Epoch 35/80
 - 0s - loss: 1.0118 - val_loss: 0.6571
AUC: 0.8655

Epoch 36/80
 - 0s - loss: 1.0076 - val_loss: 0.6130
AUC: 0.8644

Epoch 37/80
 - 0s - loss: 1.0078 - val_loss: 0.6249
AUC: 0.8655

Epoch 38/80
 - 0s - loss: 1.0038 - val_loss: 0.6484
AUC: 0.8657

Epoch 39/80
 - 0s - loss: 1.0012 - val_loss: 0.6027
AUC: 0.8662

Epoch 40/80
 - 0s - loss: 1.0082 - val_loss: 0.6487
AUC: 0.8662

Epoch 41/80
 - 0s - loss: 1.0068 - val_loss: 0.6048
AUC: 0.8660

Epoch 42/80
 - 0s - loss: 0.9997 - val_loss: 0.6093
AUC: 0.8668

Epoch 43/80
 - 0s - loss: 0.9953 - val_loss: 0.6104
AUC: 0.8669

Epoch 44/80
 - 0s - loss: 0.9992 - val_loss: 0.6567
AUC: 0.8664

Epoch 45/80
 - 0s - loss: 0.9902 - val_loss: 0.6183
AUC: 0.8668

Epoch 46/80
 - 0s - loss: 0.9847 - val_loss: 0.6186
AUC: 0.8669

Epoch 47/80
 - 0s - loss: 0.9846 - val_loss: 0.6107
AUC: 0.8668

Epoch 48/80
 - 0s - loss: 0.9872 - val_loss: 0.6150
AUC: 0.8669

Epoch 49/80
 - 0s - loss: 0.9889 - val_loss: 0.6136
AUC: 0.8672

Epoch 50/80
 - 0s - loss: 0.9873 - val_loss: 0.6185
AUC: 0.8673

Epoch 51/80
 - 0s - loss: 0.9891 - val_loss: 0.6025
AUC: 0.8670

Epoch 52/80
 - 0s - loss: 0.9877 - val_loss: 0.6160
AUC: 0.8671

Epoch 53/80
 - 0s - loss: 0.9865 - val_loss: 0.6183
AUC: 0.8674

Epoch 54/80
 - 0s - loss: 0.9900 - val_loss: 0.5987
AUC: 0.8673

Epoch 55/80
 - 0s - loss: 0.9875 - val_loss: 0.6144
AUC: 0.8674

Epoch 56/80
 - 0s - loss: 0.9848 - val_loss: 0.6095
AUC: 0.8673

Epoch 57/80
 - 0s - loss: 0.9828 - val_loss: 0.6105
AUC: 0.8673

Epoch 58/80
 - 0s - loss: 0.9836 - val_loss: 0.6139
AUC: 0.8674

Epoch 59/80
 - 0s - loss: 0.9820 - val_loss: 0.6075
AUC: 0.8674

Epoch 60/80
 - 0s - loss: 0.9865 - val_loss: 0.6126
AUC: 0.8674

Epoch 61/80
 - 0s - loss: 0.9860 - val_loss: 0.6090
AUC: 0.8674

Epoch 62/80
 - 0s - loss: 0.9871 - val_loss: 0.6098
AUC: 0.8673

Epoch 63/80
 - 0s - loss: 0.9826 - val_loss: 0.6081
AUC: 0.8673

Epoch 64/80
 - 0s - loss: 0.9814 - val_loss: 0.6107
AUC: 0.8674

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9868 - val_loss: 0.6198
AUC: 0.8674

Epoch 2/30
 - 0s - loss: 0.9840 - val_loss: 0.6016
AUC: 0.8675

Epoch 3/30
 - 0s - loss: 0.9848 - val_loss: 0.6238
AUC: 0.8677

Epoch 4/30
 - 0s - loss: 0.9815 - val_loss: 0.6130
AUC: 0.8676

Epoch 5/30
 - 0s - loss: 0.9823 - val_loss: 0.6141
AUC: 0.8677

Epoch 6/30
 - 0s - loss: 0.9785 - val_loss: 0.6063
AUC: 0.8678

Epoch 7/30
 - 0s - loss: 0.9773 - val_loss: 0.6021
AUC: 0.8679

Epoch 8/30
 - 0s - loss: 0.9780 - val_loss: 0.5907
AUC: 0.8680

Epoch 9/30
 - 0s - loss: 0.9717 - val_loss: 0.6149
AUC: 0.8684

Epoch 10/30
 - 0s - loss: 0.9754 - val_loss: 0.5960
AUC: 0.8682

Epoch 11/30
 - 0s - loss: 0.9750 - val_loss: 0.5928
AUC: 0.8682

Epoch 12/30
 - 0s - loss: 0.9743 - val_loss: 0.6075
AUC: 0.8685

Epoch 13/30
 - 0s - loss: 0.9700 - val_loss: 0.6039
AUC: 0.8686

Epoch 14/30
 - 0s - loss: 0.9639 - val_loss: 0.6016
AUC: 0.8686

Epoch 15/30
 - 0s - loss: 0.9704 - val_loss: 0.6051
AUC: 0.8689

Epoch 16/30
 - 0s - loss: 0.9688 - val_loss: 0.6029
AUC: 0.8689

Epoch 17/30
 - 0s - loss: 0.9598 - val_loss: 0.6076
AUC: 0.8691

Epoch 18/30
 - 0s - loss: 0.9670 - val_loss: 0.5943
AUC: 0.8690

Epoch 19/30
 - 0s - loss: 0.9633 - val_loss: 0.5999
AUC: 0.8691

Epoch 20/30
 - 0s - loss: 0.9627 - val_loss: 0.5997
AUC: 0.8691

Epoch 21/30
 - 0s - loss: 0.9609 - val_loss: 0.6009
AUC: 0.8692

Epoch 22/30
 - 0s - loss: 0.9643 - val_loss: 0.6014
AUC: 0.8693

Epoch 23/30
 - 0s - loss: 0.9628 - val_loss: 0.5971
AUC: 0.8692

Epoch 24/30
 - 0s - loss: 0.9629 - val_loss: 0.5986
AUC: 0.8693

Epoch 25/30
 - 0s - loss: 0.9558 - val_loss: 0.5954
AUC: 0.8692

Epoch 26/30
 - 0s - loss: 0.9617 - val_loss: 0.5990
AUC: 0.8692

Epoch 27/30
 - 0s - loss: 0.9610 - val_loss: 0.5989
AUC: 0.8693

Epoch 28/30
 - 0s - loss: 0.9609 - val_loss: 0.6019
AUC: 0.8694

Epoch 29/30
 - 0s - loss: 0.9583 - val_loss: 0.6016
AUC: 0.8694

Epoch 30/30
 - 0s - loss: 0.9595 - val_loss: 0.6017
Using TensorFlow backend.
AUC: 0.8694

2019-03-08 05:32:48.395091: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:32:48.571836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:32:48.571884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:32:48.873646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:32:48.873699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:32:48.873708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:32:48.874075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0716
Epoch 2/80
 - 2s - loss: 0.1953
Epoch 3/80
 - 2s - loss: 0.1699
Epoch 4/80
 - 2s - loss: 0.1612
Epoch 5/80
 - 2s - loss: 0.1498
Epoch 6/80
 - 2s - loss: 0.1365
Epoch 7/80
 - 2s - loss: 0.1245
Epoch 8/80
 - 2s - loss: 0.1137
Epoch 9/80
 - 2s - loss: 0.1033
Epoch 10/80
 - 2s - loss: 0.0936
Epoch 11/80
 - 2s - loss: 0.0856
Epoch 12/80
 - 2s - loss: 0.0791
Epoch 13/80
 - 2s - loss: 0.0737
Epoch 14/80
 - 2s - loss: 0.0693
Epoch 15/80
 - 2s - loss: 0.0655
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:33:37.473889: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:33:37.644422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:33:37.644467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:33:37.945674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:33:37.945729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:33:37.945739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:33:37.946011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6479
Epoch 2/80
 - 2s - loss: 0.1001
Epoch 3/80
 - 2s - loss: 0.0669
Epoch 4/80
 - 2s - loss: 0.0602
Epoch 5/80
 - 2s - loss: 0.0556
Epoch 6/80
 - 2s - loss: 0.0518
Epoch 7/80
 - 2s - loss: 0.0484
Epoch 8/80
 - 2s - loss: 0.0453
Epoch 9/80
 - 2s - loss: 0.0422
Epoch 10/80
 - 2s - loss: 0.0391
Epoch 11/80
 - 2s - loss: 0.0359
Epoch 12/80
 - 2s - loss: 0.0331
Epoch 13/80
 - 2s - loss: 0.0305
Epoch 14/80
 - 2s - loss: 0.0283
Epoch 15/80
 - 2s - loss: 0.0263
Epoch 16/80
 - 2s - loss: 0.0245
Epoch 17/80
 - 2s - loss: 0.0231
Epoch 18/80
 - 2s - loss: 0.0219
Epoch 19/80
 - 2s - loss: 0.0209
Epoch 20/80
 - 2s - loss: 0.0200
Epoch 21/80
 - 2s - loss: 0.0193
Epoch 22/80
 - 2s - loss: 0.0187
Epoch 23/80
 - 2s - loss: 0.0181
Epoch 24/80
 - 2s - loss: 0.0176
Epoch 25/80
 - 2s - loss: 0.0172
Epoch 26/80
 - 2s - loss: 0.0168
Epoch 27/80
 - 2s - loss: 0.0165
Epoch 28/80
 - 2s - loss: 0.0162
Epoch 29/80
 - 2s - loss: 0.0160
Epoch 30/80
 - 2s - loss: 0.0158
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:34:59.019933: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:34:59.188895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:34:59.188943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:34:59.492043: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:34:59.492119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:34:59.492128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:34:59.492394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6587
Epoch 2/80
 - 2s - loss: 0.1043
Epoch 3/80
 - 2s - loss: 0.0701
Epoch 4/80
 - 2s - loss: 0.0649
Epoch 5/80
 - 2s - loss: 0.0623
Epoch 6/80
 - 2s - loss: 0.0589
Epoch 7/80
 - 2s - loss: 0.0543
Epoch 8/80
 - 2s - loss: 0.0488
Epoch 9/80
 - 2s - loss: 0.0437
Epoch 10/80
 - 2s - loss: 0.0395
Epoch 11/80
 - 2s - loss: 0.0359
Epoch 12/80
 - 2s - loss: 0.0327
Epoch 13/80
 - 2s - loss: 0.0299
Epoch 14/80
 - 2s - loss: 0.0275
Epoch 15/80
 - 2s - loss: 0.0256
Epoch 16/80
 - 2s - loss: 0.0240
Epoch 17/80
 - 2s - loss: 0.0227
Epoch 18/80
 - 2s - loss: 0.0216
Epoch 19/80
 - 2s - loss: 0.0206
Epoch 20/80
 - 2s - loss: 0.0198
Epoch 21/80
 - 2s - loss: 0.0191
Epoch 22/80
 - 2s - loss: 0.0185
Epoch 23/80
 - 2s - loss: 0.0180
Epoch 24/80
 - 2s - loss: 0.0175
Epoch 25/80
 - 2s - loss: 0.0171
Epoch 26/80
 - 2s - loss: 0.0167
Epoch 27/80
 - 2s - loss: 0.0164
Epoch 28/80
 - 2s - loss: 0.0162
Epoch 29/80
 - 2s - loss: 0.0159
Epoch 30/80
 - 2s - loss: 0.0157
Epoch 31/80
 - 2s - loss: 0.0155
Epoch 32/80
 - 2s - loss: 0.0154
Epoch 33/80
 - 2s - loss: 0.0152
Epoch 34/80
 - 2s - loss: 0.0151
Epoch 35/80
 - 2s - loss: 0.0150
Epoch 36/80
 - 2s - loss: 0.0149
Epoch 37/80
 - 2s - loss: 0.0148
Epoch 38/80
 - 2s - loss: 0.0148
Epoch 39/80
 - 2s - loss: 0.0147
Epoch 40/80
 - 2s - loss: 0.0146
Epoch 41/80
 - 2s - loss: 0.0146
Epoch 42/80
 - 2s - loss: 0.0145
Epoch 43/80
 - 2s - loss: 0.0145
Epoch 44/80
 - 2s - loss: 0.0144
Epoch 45/80
 - 2s - loss: 0.0144
Epoch 46/80
 - 2s - loss: 0.0144
Epoch 47/80
 - 2s - loss: 0.0143
Epoch 48/80
 - 2s - loss: 0.0139
Epoch 49/80
 - 2s - loss: 0.0138
Epoch 50/80
 - 2s - loss: 0.0138
Epoch 51/80
 - 2s - loss: 0.0138
Epoch 52/80
 - 2s - loss: 0.0137
Epoch 53/80
 - 2s - loss: 0.0137
Epoch 54/80
 - 2s - loss: 0.0137
Epoch 55/80
 - 2s - loss: 0.0137
Epoch 56/80
 - 2s - loss: 0.0137
Epoch 57/80
 - 2s - loss: 0.0137
Epoch 58/80
 - 2s - loss: 0.0137
Epoch 59/80
 - 2s - loss: 0.0137
Epoch 60/80
 - 2s - loss: 0.0137
Epoch 61/80
 - 2s - loss: 0.0137
Epoch 62/80
 - 2s - loss: 0.0137
Epoch 63/80
 - 2s - loss: 0.0137
Epoch 64/80
 - 2s - loss: 0.0137
Epoch 65/80
 - 2s - loss: 0.0137
Epoch 66/80
 - 2s - loss: 0.0137
Epoch 67/80
 - 2s - loss: 0.0137
Epoch 68/80
 - 2s - loss: 0.0137
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:37:31.047010: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:37:31.219665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:37:31.219711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:37:31.520030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:37:31.520085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:37:31.520094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:37:31.520381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6664
Epoch 2/80
 - 2s - loss: 0.1066
Epoch 3/80
 - 2s - loss: 0.0682
Epoch 4/80
 - 2s - loss: 0.0629
Epoch 5/80
 - 2s - loss: 0.0592
Epoch 6/80
 - 2s - loss: 0.0547
Epoch 7/80
 - 2s - loss: 0.0494
Epoch 8/80
 - 2s - loss: 0.0440
Epoch 9/80
 - 2s - loss: 0.0395
Epoch 10/80
 - 2s - loss: 0.0359
Epoch 11/80
 - 2s - loss: 0.0330
Epoch 12/80
 - 2s - loss: 0.0307
Epoch 13/80
 - 2s - loss: 0.0287
Epoch 14/80
 - 2s - loss: 0.0269
Epoch 15/80
 - 2s - loss: 0.0253
Epoch 16/80
 - 2s - loss: 0.0240
Epoch 17/80
 - 2s - loss: 0.0227
Epoch 18/80
 - 2s - loss: 0.0216
Epoch 19/80
 - 2s - loss: 0.0207
Epoch 20/80
 - 2s - loss: 0.0198
Epoch 21/80
 - 2s - loss: 0.0191
Epoch 22/80
 - 2s - loss: 0.0185
Epoch 23/80
 - 2s - loss: 0.0179
Epoch 24/80
 - 2s - loss: 0.0175
Epoch 25/80
 - 2s - loss: 0.0170
Epoch 26/80
 - 2s - loss: 0.0167
Epoch 27/80
 - 2s - loss: 0.0164
Epoch 28/80
 - 2s - loss: 0.0161
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:38:48.571392: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:38:48.738880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:38:48.738928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:38:49.041542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:38:49.041598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:38:49.041607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:38:49.041879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3031
Epoch 2/80
 - 2s - loss: 0.3333
Epoch 3/80
 - 2s - loss: 0.3026
Epoch 4/80
 - 2s - loss: 0.2803
Epoch 5/80
 - 2s - loss: 0.2545
Epoch 6/80
 - 2s - loss: 0.2307
Epoch 7/80
 - 2s - loss: 0.2104
Epoch 8/80
 - 2s - loss: 0.1933
Epoch 9/80
 - 2s - loss: 0.1787
Epoch 10/80
 - 2s - loss: 0.1663
Epoch 11/80
 - 2s - loss: 0.1559
Epoch 12/80
 - 2s - loss: 0.1473
Epoch 13/80
 - 2s - loss: 0.1403
Epoch 14/80
 - 2s - loss: 0.1347
Epoch 15/80
 - 2s - loss: 0.1300
Epoch 16/80
 - 2s - loss: 0.1262
Epoch 17/80
 - 2s - loss: 0.1231
Epoch 18/80
 - 2s - loss: 0.1204
Epoch 19/80
 - 2s - loss: 0.1181
Epoch 20/80
 - 2s - loss: 0.1161
Epoch 21/80
 - 2s - loss: 0.1144
Epoch 22/80
 - 2s - loss: 0.1128
Epoch 23/80
 - 2s - loss: 0.1115
Epoch 24/80
 - 2s - loss: 0.1104
Epoch 25/80
 - 2s - loss: 0.1093
Epoch 26/80
 - 2s - loss: 0.1085
Epoch 27/80
 - 2s - loss: 0.1077
Epoch 28/80
 - 2s - loss: 0.1070
Epoch 29/80
 - 2s - loss: 0.1065
Epoch 30/80
 - 2s - loss: 0.1060
Epoch 31/80
 - 2s - loss: 0.1055
Epoch 32/80
 - 2s - loss: 0.1051
Epoch 33/80
 - 2s - loss: 0.1048
Epoch 34/80
 - 2s - loss: 0.1045
Epoch 35/80
 - 2s - loss: 0.1042
Epoch 36/80
 - 2s - loss: 0.1040
Epoch 37/80
 - 2s - loss: 0.1037
Epoch 38/80
 - 2s - loss: 0.1035
Epoch 39/80
 - 2s - loss: 0.1033
Epoch 40/80
 - 2s - loss: 0.1032
Epoch 41/80
 - 2s - loss: 0.1030
Epoch 42/80
 - 2s - loss: 0.1028
Epoch 43/80
 - 2s - loss: 0.1027
Epoch 44/80
 - 2s - loss: 0.1026
Epoch 45/80
 - 2s - loss: 0.1025
Epoch 46/80
 - 2s - loss: 0.1023
Epoch 47/80
 - 2s - loss: 0.1023
Epoch 48/80
 - 2s - loss: 0.1021
Epoch 49/80
 - 2s - loss: 0.1021
Epoch 50/80
 - 2s - loss: 0.1020
Epoch 51/80
 - 2s - loss: 0.1019
Epoch 52/80
 - 2s - loss: 0.1018
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:40:48.661943: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:40:48.834559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:40:48.834605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:40:49.136857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:40:49.136911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:40:49.136921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:40:49.137185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3083
Epoch 2/80
 - 2s - loss: 0.3337
Epoch 3/80
 - 2s - loss: 0.3041
Epoch 4/80
 - 2s - loss: 0.2841
Epoch 5/80
 - 2s - loss: 0.2595
Epoch 6/80
 - 2s - loss: 0.2345
Epoch 7/80
 - 2s - loss: 0.2119
Epoch 8/80
 - 2s - loss: 0.1932
Epoch 9/80
 - 2s - loss: 0.1781
Epoch 10/80
 - 2s - loss: 0.1659
Epoch 11/80
 - 2s - loss: 0.1558
Epoch 12/80
 - 2s - loss: 0.1474
Epoch 13/80
 - 2s - loss: 0.1405
Epoch 14/80
 - 2s - loss: 0.1348
Epoch 15/80
 - 2s - loss: 0.1300
Epoch 16/80
 - 2s - loss: 0.1262
Epoch 17/80
 - 2s - loss: 0.1229
Epoch 18/80
 - 2s - loss: 0.1200
Epoch 19/80
 - 2s - loss: 0.1176
Epoch 20/80
 - 2s - loss: 0.1156
Epoch 21/80
 - 2s - loss: 0.1137
Epoch 22/80
 - 2s - loss: 0.1122
Epoch 23/80
 - 2s - loss: 0.1109
Epoch 24/80
 - 2s - loss: 0.1098
Epoch 25/80
 - 2s - loss: 0.1088
Epoch 26/80
 - 2s - loss: 0.1080
Epoch 27/80
 - 2s - loss: 0.1072
Epoch 28/80
 - 2s - loss: 0.1066
Epoch 29/80
 - 2s - loss: 0.1060
Epoch 30/80
 - 2s - loss: 0.1056
Epoch 31/80
 - 2s - loss: 0.1052
Epoch 32/80
 - 2s - loss: 0.1047
Epoch 33/80
 - 2s - loss: 0.1044
Epoch 34/80
 - 2s - loss: 0.1041
Epoch 35/80
 - 2s - loss: 0.1039
Epoch 36/80
 - 2s - loss: 0.1036
Epoch 37/80
 - 2s - loss: 0.1034
Epoch 38/80
 - 2s - loss: 0.1032
Epoch 39/80
 - 2s - loss: 0.1030
Epoch 40/80
 - 2s - loss: 0.1028
Epoch 41/80
 - 2s - loss: 0.1027
Epoch 42/80
 - 2s - loss: 0.1025
Epoch 43/80
 - 2s - loss: 0.1024
Epoch 44/80
 - 2s - loss: 0.1023
Epoch 45/80
 - 2s - loss: 0.1022
Epoch 46/80
 - 2s - loss: 0.1021
Epoch 47/80
 - 2s - loss: 0.1020
Epoch 48/80
 - 2s - loss: 0.1019
Epoch 49/80
 - 2s - loss: 0.1018
Epoch 50/80
 - 2s - loss: 0.1017
Epoch 51/80
 - 2s - loss: 0.1016
Epoch 52/80
 - 2s - loss: 0.1016
Epoch 53/80
 - 2s - loss: 0.1015
Epoch 54/80
 - 2s - loss: 0.1014
Epoch 55/80
 - 2s - loss: 0.1014
Epoch 56/80
 - 2s - loss: 0.1013
Epoch 57/80
 - 2s - loss: 0.1013
Epoch 58/80
 - 2s - loss: 0.1012
Epoch 59/80
 - 2s - loss: 0.1012
Epoch 60/80
 - 2s - loss: 0.1012
Epoch 61/80
 - 2s - loss: 0.1011
Epoch 62/80
 - 2s - loss: 0.1011
Epoch 63/80
 - 2s - loss: 0.1011
Epoch 64/80
 - 2s - loss: 0.1010
Epoch 65/80
 - 2s - loss: 0.1009
Epoch 66/80
 - 2s - loss: 0.1009
Epoch 67/80
 - 2s - loss: 0.1009
Epoch 68/80
 - 2s - loss: 0.1009
Epoch 69/80
 - 2s - loss: 0.0982
Epoch 70/80
 - 2s - loss: 0.0980
Epoch 71/80
 - 2s - loss: 0.0979
Epoch 72/80
 - 2s - loss: 0.0979
Epoch 73/80
 - 2s - loss: 0.0979
Epoch 74/80
 - 2s - loss: 0.0972
Epoch 75/80
 - 2s - loss: 0.0972
Epoch 76/80
 - 2s - loss: 0.0972
Epoch 77/80
 - 2s - loss: 0.0972
Epoch 78/80
 - 2s - loss: 0.0971
Epoch 79/80
 - 2s - loss: 0.0971
Epoch 80/80
 - 2s - loss: 0.0971
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.0409 - val_loss: 1.2183
AUC: 0.8092

Epoch 2/80
 - 0s - loss: 1.8956 - val_loss: 0.7796
AUC: 0.8193

Epoch 3/80
 - 0s - loss: 1.3436 - val_loss: 0.7290
AUC: 0.8314

Epoch 4/80
 - 0s - loss: 1.2305 - val_loss: 0.6702
AUC: 0.8404

Epoch 5/80
 - 0s - loss: 1.1752 - val_loss: 0.7583
AUC: 0.8478

Epoch 6/80
 - 0s - loss: 1.1538 - val_loss: 0.6766
AUC: 0.8512

Epoch 7/80
 - 0s - loss: 1.1211 - val_loss: 0.6877
AUC: 0.8565

Epoch 8/80
 - 0s - loss: 1.0993 - val_loss: 0.6435
AUC: 0.8575

Epoch 9/80
 - 0s - loss: 1.0874 - val_loss: 0.6534
AUC: 0.8584

Epoch 10/80
 - 0s - loss: 1.0742 - val_loss: 0.6791
AUC: 0.8601

Epoch 11/80
 - 0s - loss: 1.0642 - val_loss: 0.6156
AUC: 0.8602

Epoch 12/80
 - 0s - loss: 1.0598 - val_loss: 0.6622
AUC: 0.8611

Epoch 13/80
 - 0s - loss: 1.0531 - val_loss: 0.5915
AUC: 0.8615

Epoch 14/80
 - 0s - loss: 1.0477 - val_loss: 0.6271
AUC: 0.8635

Epoch 15/80
 - 0s - loss: 1.0398 - val_loss: 0.6576
AUC: 0.8643

Epoch 16/80
 - 0s - loss: 1.0432 - val_loss: 0.6037
AUC: 0.8639

Epoch 17/80
 - 0s - loss: 1.0419 - val_loss: 0.6562
AUC: 0.8644

Epoch 18/80
 - 0s - loss: 1.0312 - val_loss: 0.6396
AUC: 0.8652

Epoch 19/80
 - 0s - loss: 1.0312 - val_loss: 0.6251
AUC: 0.8654

Epoch 20/80
 - 0s - loss: 1.0260 - val_loss: 0.6442
AUC: 0.8666

Epoch 21/80
 - 0s - loss: 1.0187 - val_loss: 0.6247
AUC: 0.8658

Epoch 22/80
 - 0s - loss: 1.0151 - val_loss: 0.6669
AUC: 0.8675

Epoch 23/80
 - 0s - loss: 1.0133 - val_loss: 0.6221
AUC: 0.8671

Epoch 24/80
 - 0s - loss: 1.0081 - val_loss: 0.6264
AUC: 0.8674

Epoch 25/80
 - 0s - loss: 1.0073 - val_loss: 0.6032
AUC: 0.8674

Epoch 26/80
 - 0s - loss: 1.0049 - val_loss: 0.6061
AUC: 0.8673

Epoch 27/80
 - 0s - loss: 1.0064 - val_loss: 0.6197
AUC: 0.8676

Epoch 28/80
 - 0s - loss: 1.0087 - val_loss: 0.6338
AUC: 0.8679

Epoch 29/80
 - 0s - loss: 1.0031 - val_loss: 0.6107
AUC: 0.8678

Epoch 30/80
 - 0s - loss: 1.0061 - val_loss: 0.6188
AUC: 0.8681

Epoch 31/80
 - 0s - loss: 1.0061 - val_loss: 0.6183
AUC: 0.8682

Epoch 32/80
 - 0s - loss: 1.0042 - val_loss: 0.6072
AUC: 0.8679

Epoch 33/80
 - 0s - loss: 1.0051 - val_loss: 0.6549
AUC: 0.8684

Epoch 34/80
 - 0s - loss: 0.9997 - val_loss: 0.6147
AUC: 0.8681

Epoch 35/80
 - 0s - loss: 1.0001 - val_loss: 0.6112
AUC: 0.8681

Epoch 36/80
 - 0s - loss: 0.9999 - val_loss: 0.6182
AUC: 0.8681

Epoch 37/80
 - 0s - loss: 0.9974 - val_loss: 0.6189
AUC: 0.8682

Epoch 38/80
 - 0s - loss: 0.9982 - val_loss: 0.6219
AUC: 0.8682

Epoch 39/80
 - 0s - loss: 0.9997 - val_loss: 0.6142
AUC: 0.8682

Epoch 40/80
 - 0s - loss: 1.0033 - val_loss: 0.6176
AUC: 0.8683

Epoch 41/80
 - 0s - loss: 1.0049 - val_loss: 0.6139
AUC: 0.8683

Epoch 42/80
 - 0s - loss: 0.9972 - val_loss: 0.6130
AUC: 0.8683

Epoch 43/80
 - 0s - loss: 0.9992 - val_loss: 0.6081
AUC: 0.8682

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0041 - val_loss: 0.6177
AUC: 0.8682

Epoch 2/30
 - 0s - loss: 1.0039 - val_loss: 0.6259
AUC: 0.8685

Epoch 3/30
 - 0s - loss: 0.9948 - val_loss: 0.5958
AUC: 0.8683

Epoch 4/30
 - 0s - loss: 0.9959 - val_loss: 0.6011
AUC: 0.8685

Epoch 5/30
 - 0s - loss: 0.9934 - val_loss: 0.6017
AUC: 0.8687

Epoch 6/30
 - 0s - loss: 0.9954 - val_loss: 0.6191
AUC: 0.8690

Epoch 7/30
 - 0s - loss: 0.9950 - val_loss: 0.6210
AUC: 0.8691

Epoch 8/30
 - 0s - loss: 0.9899 - val_loss: 0.6202
AUC: 0.8692

Epoch 9/30
 - 0s - loss: 0.9914 - val_loss: 0.6102
AUC: 0.8692

Epoch 10/30
 - 0s - loss: 0.9907 - val_loss: 0.5984
AUC: 0.8691

Epoch 11/30
 - 1s - loss: 0.9910 - val_loss: 0.6271
AUC: 0.8694

Epoch 12/30
 - 0s - loss: 0.9856 - val_loss: 0.6131
AUC: 0.8695

Epoch 13/30
 - 0s - loss: 0.9849 - val_loss: 0.6188
AUC: 0.8699

Epoch 14/30
 - 0s - loss: 0.9822 - val_loss: 0.6063
AUC: 0.8697

Epoch 15/30
 - 0s - loss: 0.9854 - val_loss: 0.6068
AUC: 0.8697

Epoch 16/30
 - 0s - loss: 0.9843 - val_loss: 0.6070
AUC: 0.8698

Epoch 17/30
 - 0s - loss: 0.9837 - val_loss: 0.6059
AUC: 0.8698

Epoch 18/30
 - 0s - loss: 0.9818 - val_loss: 0.6077
AUC: 0.8698

Epoch 19/30
 - 0s - loss: 0.9835 - val_loss: 0.6044
AUC: 0.8698

Epoch 20/30
 - 0s - loss: 0.9809 - val_loss: 0.6074
AUC: 0.8698

Epoch 21/30
 - 0s - loss: 0.9758 - val_loss: 0.6090
AUC: 0.8699

Epoch 22/30
 - 0s - loss: 0.9808 - val_loss: 0.6097
AUC: 0.8699

Epoch 23/30
 - 0s - loss: 0.9807 - val_loss: 0.6068
AUC: 0.8699

Epoch 24/30
 - 0s - loss: 0.9791 - val_loss: 0.6074
AUC: 0.8699

Epoch 25/30
 - 0s - loss: 0.9832 - val_loss: 0.6075
AUC: 0.8699

Epoch 26/30
 - 0s - loss: 0.9817 - val_loss: 0.6059
AUC: 0.8699

Epoch 27/30
 - 0s - loss: 0.9790 - val_loss: 0.6058
AUC: 0.8699

Epoch 28/30
 - 0s - loss: 0.9780 - val_loss: 0.6054
AUC: 0.8699

Epoch 29/30
 - 0s - loss: 0.9775 - val_loss: 0.6051
AUC: 0.8699

Epoch 30/30
 - 0s - loss: 0.9833 - val_loss: 0.6054
Using TensorFlow backend.
AUC: 0.8699

2019-03-08 05:44:36.388970: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:44:36.556760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:44:36.556831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:44:36.858052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:44:36.858104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:44:36.858113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:44:36.858377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3363
Epoch 2/80
 - 2s - loss: 0.3315
Epoch 3/80
 - 2s - loss: 0.2877
Epoch 4/80
 - 2s - loss: 0.2577
Epoch 5/80
 - 2s - loss: 0.2354
Epoch 6/80
 - 2s - loss: 0.2171
Epoch 7/80
 - 2s - loss: 0.2004
Epoch 8/80
 - 2s - loss: 0.1855
Epoch 9/80
 - 2s - loss: 0.1728
Epoch 10/80
 - 2s - loss: 0.1620
Epoch 11/80
 - 2s - loss: 0.1530
Epoch 12/80
 - 2s - loss: 0.1456
Epoch 13/80
 - 2s - loss: 0.1394
Epoch 14/80
 - 2s - loss: 0.1342
Epoch 15/80
 - 2s - loss: 0.1299
Epoch 16/80
 - 2s - loss: 0.1262
Epoch 17/80
 - 2s - loss: 0.1231
Epoch 18/80
 - 2s - loss: 0.1204
Epoch 19/80
 - 2s - loss: 0.1182
Epoch 20/80
 - 2s - loss: 0.1162
Epoch 21/80
 - 2s - loss: 0.1144
Epoch 22/80
 - 2s - loss: 0.1129
Epoch 23/80
 - 2s - loss: 0.1116
Epoch 24/80
 - 2s - loss: 0.1105
Epoch 25/80
 - 2s - loss: 0.1096
Epoch 26/80
 - 2s - loss: 0.1087
Epoch 27/80
 - 2s - loss: 0.1080
Epoch 28/80
 - 2s - loss: 0.1073
Epoch 29/80
 - 2s - loss: 0.1068
Epoch 30/80
 - 2s - loss: 0.1063
Epoch 31/80
 - 2s - loss: 0.1059
Epoch 32/80
 - 2s - loss: 0.1055
Epoch 33/80
 - 2s - loss: 0.1051
Epoch 34/80
 - 2s - loss: 0.1049
Epoch 35/80
 - 2s - loss: 0.1046
Epoch 36/80
 - 2s - loss: 0.1044
Epoch 37/80
 - 2s - loss: 0.1041
Epoch 38/80
 - 2s - loss: 0.1039
Epoch 39/80
 - 2s - loss: 0.1037
Epoch 40/80
 - 2s - loss: 0.1036
Epoch 41/80
 - 2s - loss: 0.1034
Epoch 42/80
 - 2s - loss: 0.1033
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:46:18.086321: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:46:18.253516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:46:18.253564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:46:18.553486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:46:18.553537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:46:18.553546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:46:18.553809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0732
Epoch 2/80
 - 2s - loss: 0.1955
Epoch 3/80
 - 2s - loss: 0.1694
Epoch 4/80
 - 2s - loss: 0.1607
Epoch 5/80
 - 2s - loss: 0.1503
Epoch 6/80
 - 2s - loss: 0.1373
Epoch 7/80
 - 2s - loss: 0.1240
Epoch 8/80
 - 2s - loss: 0.1115
Epoch 9/80
 - 2s - loss: 0.1004
Epoch 10/80
 - 2s - loss: 0.0910
Epoch 11/80
 - 2s - loss: 0.0835
Epoch 12/80
 - 2s - loss: 0.0776
Epoch 13/80
 - 2s - loss: 0.0726
Epoch 14/80
 - 2s - loss: 0.0684
Epoch 15/80
 - 2s - loss: 0.0649
Epoch 16/80
 - 2s - loss: 0.0619
Epoch 17/80
 - 2s - loss: 0.0594
Epoch 18/80
 - 2s - loss: 0.0572
Epoch 19/80
 - 2s - loss: 0.0554
Epoch 20/80
 - 2s - loss: 0.0539
Epoch 21/80
 - 2s - loss: 0.0526
Epoch 22/80
 - 2s - loss: 0.0515
Epoch 23/80
 - 2s - loss: 0.0505
Epoch 24/80
 - 2s - loss: 0.0497
Epoch 25/80
 - 2s - loss: 0.0489
Epoch 26/80
 - 2s - loss: 0.0483
Epoch 27/80
 - 2s - loss: 0.0478
Epoch 28/80
 - 2s - loss: 0.0473
Epoch 29/80
 - 2s - loss: 0.0469
Epoch 30/80
 - 2s - loss: 0.0465
Epoch 31/80
 - 2s - loss: 0.0462
Epoch 32/80
 - 2s - loss: 0.0459
Epoch 33/80
 - 2s - loss: 0.0457
Epoch 34/80
 - 2s - loss: 0.0455
Epoch 35/80
 - 2s - loss: 0.0453
Epoch 36/80
 - 2s - loss: 0.0451
Epoch 37/80
 - 2s - loss: 0.0450
Epoch 38/80
 - 2s - loss: 0.0448
Epoch 39/80
 - 2s - loss: 0.0447
Epoch 40/80
 - 2s - loss: 0.0446
Epoch 41/80
 - 2s - loss: 0.0444
Epoch 42/80
 - 2s - loss: 0.0444
Epoch 43/80
 - 2s - loss: 0.0443
Epoch 44/80
 - 2s - loss: 0.0442
Epoch 45/80
 - 2s - loss: 0.0441
Epoch 46/80
 - 2s - loss: 0.0440
Epoch 47/80
 - 2s - loss: 0.0440
Epoch 48/80
 - 2s - loss: 0.0439
Epoch 49/80
 - 2s - loss: 0.0439
Epoch 50/80
 - 2s - loss: 0.0438
Epoch 51/80
 - 2s - loss: 0.0438
Epoch 52/80
 - 2s - loss: 0.0437
Epoch 53/80
 - 2s - loss: 0.0437
Epoch 54/80
 - 2s - loss: 0.0436
Epoch 55/80
 - 2s - loss: 0.0436
Epoch 56/80
 - 2s - loss: 0.0436
Epoch 57/80
 - 2s - loss: 0.0435
Epoch 58/80
 - 2s - loss: 0.0435
Epoch 59/80
 - 2s - loss: 0.0422
Epoch 60/80
 - 2s - loss: 0.0421
Epoch 61/80
 - 2s - loss: 0.0421
Epoch 62/80
 - 2s - loss: 0.0421
Epoch 63/80
 - 2s - loss: 0.0421
Epoch 64/80
 - 2s - loss: 0.0418
Epoch 65/80
 - 2s - loss: 0.0417
Epoch 66/80
 - 2s - loss: 0.0417
Epoch 67/80
 - 2s - loss: 0.0417
Epoch 68/80
 - 2s - loss: 0.0417
Epoch 69/80
 - 2s - loss: 0.0417
Epoch 70/80
 - 2s - loss: 0.0417
Epoch 71/80
 - 2s - loss: 0.0417
Epoch 72/80
 - 2s - loss: 0.0417
Epoch 73/80
 - 2s - loss: 0.0417
Epoch 74/80
 - 2s - loss: 0.0417
Epoch 75/80
 - 2s - loss: 0.0417
Epoch 76/80
 - 2s - loss: 0.0417
Epoch 77/80
 - 2s - loss: 0.0417
Epoch 78/80
 - 2s - loss: 0.0417
Epoch 79/80
 - 2s - loss: 0.0417
Epoch 80/80
 - 2s - loss: 0.0417
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 6.7153 - val_loss: 1.3385
AUC: 0.7407

Epoch 2/80
 - 0s - loss: 3.4276 - val_loss: 1.0735
AUC: 0.7899

Epoch 3/80
 - 0s - loss: 2.0050 - val_loss: 0.8659
AUC: 0.8137

Epoch 4/80
 - 0s - loss: 1.4437 - val_loss: 0.7419
AUC: 0.8228

Epoch 5/80
 - 0s - loss: 1.2872 - val_loss: 0.7177
AUC: 0.8329

Epoch 6/80
 - 0s - loss: 1.2183 - val_loss: 0.7072
AUC: 0.8415

Epoch 7/80
 - 0s - loss: 1.1850 - val_loss: 0.6653
AUC: 0.8445

Epoch 8/80
 - 0s - loss: 1.1591 - val_loss: 0.6868
AUC: 0.8489

Epoch 9/80
 - 0s - loss: 1.1346 - val_loss: 0.6628
AUC: 0.8511

Epoch 10/80
 - 0s - loss: 1.1197 - val_loss: 0.7160
AUC: 0.8556

Epoch 11/80
 - 0s - loss: 1.1026 - val_loss: 0.6477
AUC: 0.8564

Epoch 12/80
 - 0s - loss: 1.0958 - val_loss: 0.6753
AUC: 0.8578

Epoch 13/80
 - 0s - loss: 1.0826 - val_loss: 0.6380
AUC: 0.8585

Epoch 14/80
 - 0s - loss: 1.0810 - val_loss: 0.5922
AUC: 0.8581

Epoch 15/80
 - 0s - loss: 1.0789 - val_loss: 0.6931
AUC: 0.8612

Epoch 16/80
 - 0s - loss: 1.0781 - val_loss: 0.6688
AUC: 0.8600

Epoch 17/80
 - 0s - loss: 1.0651 - val_loss: 0.6130
AUC: 0.8608

Epoch 18/80
 - 0s - loss: 1.0638 - val_loss: 0.6839
AUC: 0.8629

Epoch 19/80
 - 0s - loss: 1.0632 - val_loss: 0.6323
AUC: 0.8630

Epoch 20/80
 - 0s - loss: 1.0547 - val_loss: 0.6597
AUC: 0.8636

Epoch 21/80
 - 0s - loss: 1.0469 - val_loss: 0.6474
AUC: 0.8646

Epoch 22/80
 - 0s - loss: 1.0432 - val_loss: 0.6026
AUC: 0.8640

Epoch 23/80
 - 0s - loss: 1.0465 - val_loss: 0.6288
AUC: 0.8654

Epoch 24/80
 - 0s - loss: 1.0347 - val_loss: 0.6696
AUC: 0.8666

Epoch 25/80
 - 0s - loss: 1.0365 - val_loss: 0.6216
AUC: 0.8660

Epoch 26/80
 - 0s - loss: 1.0348 - val_loss: 0.6190
AUC: 0.8659

Epoch 27/80
 - 0s - loss: 1.0294 - val_loss: 0.6310
AUC: 0.8661

Epoch 28/80
 - 0s - loss: 1.0321 - val_loss: 0.6073
AUC: 0.8659

Epoch 29/80
 - 0s - loss: 1.0275 - val_loss: 0.6188
AUC: 0.8660

Epoch 30/80
 - 0s - loss: 1.0269 - val_loss: 0.6397
AUC: 0.8665

Epoch 31/80
 - 0s - loss: 1.0254 - val_loss: 0.6277
AUC: 0.8662

Epoch 32/80
 - 0s - loss: 1.0223 - val_loss: 0.6387
AUC: 0.8667

Epoch 33/80
 - 0s - loss: 1.0248 - val_loss: 0.6359
AUC: 0.8665

Epoch 34/80
 - 0s - loss: 1.0225 - val_loss: 0.6170
AUC: 0.8665

Epoch 35/80
 - 0s - loss: 1.0256 - val_loss: 0.6294
AUC: 0.8668

Epoch 36/80
 - 0s - loss: 1.0234 - val_loss: 0.6276
AUC: 0.8667

Epoch 37/80
 - 0s - loss: 1.0238 - val_loss: 0.6280
AUC: 0.8667

Epoch 38/80
 - 0s - loss: 1.0296 - val_loss: 0.6270
AUC: 0.8667

Epoch 39/80
 - 0s - loss: 1.0211 - val_loss: 0.6224
AUC: 0.8666

Epoch 40/80
 - 0s - loss: 1.0216 - val_loss: 0.6239
AUC: 0.8667

Epoch 41/80
 - 0s - loss: 1.0242 - val_loss: 0.6326
AUC: 0.8668

Epoch 42/80
 - 0s - loss: 1.0305 - val_loss: 0.6208
AUC: 0.8667

Epoch 43/80
 - 0s - loss: 1.0213 - val_loss: 0.6209
AUC: 0.8666

Epoch 44/80
 - 0s - loss: 1.0204 - val_loss: 0.6259
AUC: 0.8668

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0227 - val_loss: 0.6370
AUC: 0.8671

Epoch 2/30
 - 0s - loss: 1.0206 - val_loss: 0.6114
AUC: 0.8667

Epoch 3/30
 - 0s - loss: 1.0120 - val_loss: 0.6303
AUC: 0.8671

Epoch 4/30
 - 0s - loss: 1.0210 - val_loss: 0.6055
AUC: 0.8669

Epoch 5/30
 - 0s - loss: 1.0142 - val_loss: 0.6057
AUC: 0.8670

Epoch 6/30
 - 0s - loss: 1.0113 - val_loss: 0.6154
AUC: 0.8674

Epoch 7/30
 - 0s - loss: 1.0064 - val_loss: 0.6417
AUC: 0.8680

Epoch 8/30
 - 0s - loss: 1.0123 - val_loss: 0.6329
AUC: 0.8680

Epoch 9/30
 - 0s - loss: 1.0102 - val_loss: 0.6213
AUC: 0.8680

Epoch 10/30
 - 0s - loss: 1.0070 - val_loss: 0.6144
AUC: 0.8678

Epoch 11/30
 - 0s - loss: 1.0109 - val_loss: 0.6264
AUC: 0.8682

Epoch 12/30
 - 0s - loss: 1.0051 - val_loss: 0.6098
AUC: 0.8682

Epoch 13/30
 - 0s - loss: 1.0119 - val_loss: 0.6111
AUC: 0.8683

Epoch 14/30
 - 0s - loss: 0.9984 - val_loss: 0.6070
AUC: 0.8683

Epoch 15/30
 - 0s - loss: 0.9979 - val_loss: 0.6134
AUC: 0.8684

Epoch 16/30
 - 0s - loss: 1.0084 - val_loss: 0.6155
AUC: 0.8684

Epoch 17/30
 - 0s - loss: 1.0035 - val_loss: 0.6157
AUC: 0.8684

Epoch 18/30
 - 0s - loss: 1.0030 - val_loss: 0.6176
AUC: 0.8685

Epoch 19/30
 - 0s - loss: 0.9990 - val_loss: 0.6179
AUC: 0.8685

Epoch 20/30
 - 0s - loss: 0.9994 - val_loss: 0.6146
AUC: 0.8685

Epoch 21/30
 - 0s - loss: 0.9982 - val_loss: 0.6158
AUC: 0.8685

Epoch 22/30
 - 0s - loss: 1.0011 - val_loss: 0.6160
AUC: 0.8686

Epoch 23/30
 - 0s - loss: 0.9963 - val_loss: 0.6118
AUC: 0.8686

Epoch 24/30
 - 0s - loss: 0.9963 - val_loss: 0.6131
AUC: 0.8686

Epoch 25/30
 - 0s - loss: 0.9982 - val_loss: 0.6134
AUC: 0.8686

Epoch 26/30
 - 0s - loss: 1.0005 - val_loss: 0.6138
AUC: 0.8686

Epoch 27/30
 - 0s - loss: 0.9960 - val_loss: 0.6144
AUC: 0.8686

Epoch 28/30
 - 0s - loss: 1.0015 - val_loss: 0.6146
AUC: 0.8687

Epoch 29/30
 - 0s - loss: 0.9969 - val_loss: 0.6150
AUC: 0.8687

Epoch 30/30
 - 0s - loss: 0.9988 - val_loss: 0.6147
Using TensorFlow backend.
AUC: 0.8687

2019-03-08 05:50:07.606171: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:50:07.777596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:50:07.777643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:50:08.081511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:50:08.081566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:50:08.081576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:50:08.081854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.2 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0866
Epoch 2/80
 - 2s - loss: 0.1955
Epoch 3/80
 - 2s - loss: 0.1675
Epoch 4/80
 - 2s - loss: 0.1566
Epoch 5/80
 - 2s - loss: 0.1434
Epoch 6/80
 - 2s - loss: 0.1278
Epoch 7/80
 - 2s - loss: 0.1137
Epoch 8/80
 - 2s - loss: 0.1029
Epoch 9/80
 - 2s - loss: 0.0944
Epoch 10/80
 - 2s - loss: 0.0878
Epoch 11/80
 - 2s - loss: 0.0824
Epoch 12/80
 - 2s - loss: 0.0776
Epoch 13/80
 - 2s - loss: 0.0733
Epoch 14/80
 - 2s - loss: 0.0693
Epoch 15/80
 - 2s - loss: 0.0658
Epoch 16/80
 - 2s - loss: 0.0627
Epoch 17/80
 - 2s - loss: 0.0600
Epoch 18/80
 - 2s - loss: 0.0578
Epoch 19/80
 - 2s - loss: 0.0559
Epoch 20/80
 - 2s - loss: 0.0543
Epoch 21/80
 - 2s - loss: 0.0529
Epoch 22/80
 - 2s - loss: 0.0518
Epoch 23/80
 - 2s - loss: 0.0508
Epoch 24/80
 - 2s - loss: 0.0499
Epoch 25/80
 - 2s - loss: 0.0492
Epoch 26/80
 - 2s - loss: 0.0486
Epoch 27/80
 - 2s - loss: 0.0480
Epoch 28/80
 - 2s - loss: 0.0475
Epoch 29/80
 - 2s - loss: 0.0471
Epoch 30/80
 - 2s - loss: 0.0467
Epoch 31/80
 - 2s - loss: 0.0464
Epoch 32/80
 - 2s - loss: 0.0461
Epoch 33/80
 - 2s - loss: 0.0459
Epoch 34/80
 - 2s - loss: 0.0457
Epoch 35/80
 - 2s - loss: 0.0455
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:51:38.404917: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:51:38.575959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:51:38.576008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:51:38.881976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:51:38.882031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:51:38.882040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:51:38.882299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1053
Epoch 2/80
 - 2s - loss: 0.1968
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:52:01.739113: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:52:01.907687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:52:01.907734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:52:02.214069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:52:02.214126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:52:02.214135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:52:02.214402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0791
Epoch 2/80
 - 2s - loss: 0.1956
Epoch 3/80
 - 2s - loss: 0.1714
Epoch 4/80
 - 2s - loss: 0.1641
Epoch 5/80
 - 2s - loss: 0.1538
Epoch 6/80
 - 2s - loss: 0.1389
Epoch 7/80
 - 2s - loss: 0.1240
Epoch 8/80
 - 2s - loss: 0.1121
Epoch 9/80
 - 2s - loss: 0.1022
Epoch 10/80
 - 2s - loss: 0.0932
Epoch 11/80
 - 2s - loss: 0.0854
Epoch 12/80
 - 2s - loss: 0.0789
Epoch 13/80
 - 2s - loss: 0.0735
Epoch 14/80
 - 2s - loss: 0.0691
Epoch 15/80
 - 2s - loss: 0.0654
Epoch 16/80
 - 2s - loss: 0.0624
Epoch 17/80
 - 2s - loss: 0.0598
Epoch 18/80
 - 2s - loss: 0.0577
Epoch 19/80
 - 2s - loss: 0.0559
Epoch 20/80
 - 2s - loss: 0.0543
Epoch 21/80
 - 2s - loss: 0.0530
Epoch 22/80
 - 2s - loss: 0.0519
Epoch 23/80
 - 2s - loss: 0.0509
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:53:10.062273: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:53:10.234864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:53:10.234917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:53:10.539442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:53:10.539513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:53:10.539523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:53:10.539815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6419
Epoch 2/80
 - 2s - loss: 0.1017
Epoch 3/80
 - 2s - loss: 0.0663
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 05:53:35.103919: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:53:35.271641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:53:35.271686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:53:35.575486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:53:35.575540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:53:35.575549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:53:35.575838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6621
Epoch 2/80
 - 2s - loss: 0.1031
Epoch 3/80
 - 2s - loss: 0.0689
Epoch 4/80
 - 2s - loss: 0.0639
Epoch 5/80
 - 2s - loss: 0.0596
Epoch 6/80
 - 2s - loss: 0.0542
Epoch 7/80
 - 2s - loss: 0.0490
Epoch 8/80
 - 2s - loss: 0.0448
Epoch 9/80
 - 2s - loss: 0.0412
Epoch 10/80
 - 2s - loss: 0.0379
Epoch 11/80
 - 2s - loss: 0.0349
Epoch 12/80
 - 2s - loss: 0.0322
Epoch 13/80
 - 2s - loss: 0.0298
Epoch 14/80
 - 2s - loss: 0.0276
Epoch 15/80
 - 2s - loss: 0.0257
Epoch 16/80
 - 2s - loss: 0.0241
Epoch 17/80
 - 2s - loss: 0.0228
Epoch 18/80
 - 2s - loss: 0.0216
Epoch 19/80
 - 2s - loss: 0.0207
Epoch 20/80
 - 2s - loss: 0.0199
Epoch 21/80
 - 2s - loss: 0.0192
Epoch 22/80
 - 2s - loss: 0.0186
Epoch 23/80
 - 2s - loss: 0.0180
Epoch 24/80
 - 2s - loss: 0.0176
Epoch 25/80
 - 2s - loss: 0.0172
Epoch 26/80
 - 2s - loss: 0.0168
Epoch 27/80
 - 2s - loss: 0.0165
Epoch 28/80
 - 2s - loss: 0.0162
Epoch 29/80
 - 2s - loss: 0.0160
Epoch 30/80
 - 2s - loss: 0.0158
Epoch 31/80
 - 2s - loss: 0.0156
Epoch 32/80
 - 2s - loss: 0.0155
Epoch 33/80
 - 2s - loss: 0.0153
Epoch 34/80
 - 2s - loss: 0.0152
Epoch 35/80
 - 2s - loss: 0.0151
Epoch 36/80
 - 2s - loss: 0.0150
Epoch 37/80
 - 2s - loss: 0.0149
Epoch 38/80
 - 2s - loss: 0.0148
Epoch 39/80
 - 2s - loss: 0.0148
Epoch 40/80
 - 2s - loss: 0.0147
Epoch 41/80
 - 2s - loss: 0.0147
Epoch 42/80
 - 2s - loss: 0.0146
Epoch 43/80
 - 2s - loss: 0.0146
Epoch 44/80
 - 2s - loss: 0.0145
Epoch 45/80
 - 2s - loss: 0.0145
Epoch 46/80
 - 2s - loss: 0.0144
Epoch 47/80
 - 2s - loss: 0.0144
Epoch 48/80
 - 2s - loss: 0.0144
Epoch 49/80
 - 2s - loss: 0.0143
Epoch 50/80
 - 2s - loss: 0.0143
Epoch 51/80
 - 2s - loss: 0.0139
Epoch 52/80
 - 2s - loss: 0.0138
Epoch 53/80
 - 2s - loss: 0.0138
Epoch 54/80
 - 2s - loss: 0.0138
Epoch 55/80
 - 2s - loss: 0.0137
Epoch 56/80
 - 2s - loss: 0.0137
Epoch 57/80
 - 2s - loss: 0.0137
Epoch 58/80
 - 2s - loss: 0.0137
Epoch 59/80
 - 2s - loss: 0.0137
Epoch 60/80
 - 2s - loss: 0.0137
Epoch 61/80
 - 2s - loss: 0.0137
Epoch 62/80
 - 2s - loss: 0.0136
Epoch 63/80
 - 2s - loss: 0.0136
Epoch 64/80
 - 2s - loss: 0.0136
Epoch 65/80
 - 2s - loss: 0.0136
Epoch 66/80
 - 2s - loss: 0.0136
Epoch 67/80
 - 2s - loss: 0.0136
Epoch 68/80
 - 2s - loss: 0.0136
Epoch 69/80
 - 2s - loss: 0.0136
Epoch 70/80
 - 2s - loss: 0.0136
Epoch 71/80
 - 2s - loss: 0.0136
Epoch 72/80
 - 2s - loss: 0.0136
Epoch 73/80
 - 2s - loss: 0.0136
Epoch 74/80
 - 2s - loss: 0.0136
Epoch 75/80
 - 2s - loss: 0.0136
Epoch 76/80
 - 2s - loss: 0.0136
Epoch 77/80
 - 2s - loss: 0.0136
Epoch 78/80
 - 2s - loss: 0.0136
Epoch 79/80
 - 2s - loss: 0.0136
Epoch 80/80
 - 2s - loss: 0.0136
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.3413 - val_loss: 1.3582
AUC: 0.8066

Epoch 2/80
 - 0s - loss: 2.0924 - val_loss: 0.8906
AUC: 0.8242

Epoch 3/80
 - 0s - loss: 1.4082 - val_loss: 0.7173
AUC: 0.8338

Epoch 4/80
 - 0s - loss: 1.2449 - val_loss: 0.6964
AUC: 0.8412

Epoch 5/80
 - 0s - loss: 1.2010 - val_loss: 0.7555
AUC: 0.8525

Epoch 6/80
 - 0s - loss: 1.1672 - val_loss: 0.6629
AUC: 0.8565

Epoch 7/80
 - 0s - loss: 1.1413 - val_loss: 0.7395
AUC: 0.8604

Epoch 8/80
 - 0s - loss: 1.1325 - val_loss: 0.6462
AUC: 0.8622

Epoch 9/80
 - 0s - loss: 1.1174 - val_loss: 0.6047
AUC: 0.8629

Epoch 10/80
 - 0s - loss: 1.0891 - val_loss: 0.6521
AUC: 0.8655

Epoch 11/80
 - 0s - loss: 1.0916 - val_loss: 0.6158
AUC: 0.8665

Epoch 12/80
 - 0s - loss: 1.0784 - val_loss: 0.5978
AUC: 0.8677

Epoch 13/80
 - 0s - loss: 1.0669 - val_loss: 0.6697
AUC: 0.8699

Epoch 14/80
 - 0s - loss: 1.0599 - val_loss: 0.6264
AUC: 0.8696

Epoch 15/80
 - 0s - loss: 1.0630 - val_loss: 0.6469
AUC: 0.8705

Epoch 16/80
 - 0s - loss: 1.0568 - val_loss: 0.6139
AUC: 0.8699

Epoch 17/80
 - 0s - loss: 1.0484 - val_loss: 0.6475
AUC: 0.8719

Epoch 18/80
 - 0s - loss: 1.0473 - val_loss: 0.6372
AUC: 0.8715

Epoch 19/80
 - 0s - loss: 1.0473 - val_loss: 0.6193
AUC: 0.8719

Epoch 20/80
 - 0s - loss: 1.0441 - val_loss: 0.6162
AUC: 0.8715

Epoch 21/80
 - 0s - loss: 1.0344 - val_loss: 0.5918
AUC: 0.8723

Epoch 22/80
 - 0s - loss: 1.0352 - val_loss: 0.5973
AUC: 0.8725

Epoch 23/80
 - 0s - loss: 1.0316 - val_loss: 0.5569
AUC: 0.8707

Epoch 24/80
 - 0s - loss: 1.0250 - val_loss: 0.5557
AUC: 0.8722

Epoch 25/80
 - 0s - loss: 1.0297 - val_loss: 0.6509
AUC: 0.8743

Epoch 26/80
 - 0s - loss: 1.0183 - val_loss: 0.5657
AUC: 0.8730

Epoch 27/80
 - 0s - loss: 1.0228 - val_loss: 0.5879
AUC: 0.8736

Epoch 28/80
 - 0s - loss: 1.0195 - val_loss: 0.7035
AUC: 0.8756

Epoch 29/80
 - 0s - loss: 1.0168 - val_loss: 0.5736
AUC: 0.8744

Epoch 30/80
 - 0s - loss: 1.0185 - val_loss: 0.6095
AUC: 0.8746

Epoch 31/80
 - 0s - loss: 1.0066 - val_loss: 0.5740
AUC: 0.8741

Epoch 32/80
 - 0s - loss: 1.0109 - val_loss: 0.6079
AUC: 0.8744

Epoch 33/80
 - 0s - loss: 1.0080 - val_loss: 0.6611
AUC: 0.8766

Epoch 34/80
 - 0s - loss: 1.0056 - val_loss: 0.6048
AUC: 0.8747

Epoch 35/80
 - 0s - loss: 0.9955 - val_loss: 0.6112
AUC: 0.8760

Epoch 36/80
 - 0s - loss: 0.9925 - val_loss: 0.6218
AUC: 0.8766

Epoch 37/80
 - 0s - loss: 0.9979 - val_loss: 0.6134
AUC: 0.8766

Epoch 38/80
 - 0s - loss: 0.9914 - val_loss: 0.6178
AUC: 0.8768

Epoch 39/80
 - 0s - loss: 0.9919 - val_loss: 0.6122
AUC: 0.8766

Epoch 40/80
 - 0s - loss: 0.9917 - val_loss: 0.5975
AUC: 0.8766

Epoch 41/80
 - 0s - loss: 0.9955 - val_loss: 0.5967
AUC: 0.8765

Epoch 42/80
 - 0s - loss: 0.9915 - val_loss: 0.6166
AUC: 0.8768

Epoch 43/80
 - 0s - loss: 0.9972 - val_loss: 0.6072
AUC: 0.8767

Epoch 44/80
 - 0s - loss: 0.9891 - val_loss: 0.6146
AUC: 0.8769

Epoch 45/80
 - 0s - loss: 0.9879 - val_loss: 0.5947
AUC: 0.8767

Epoch 46/80
 - 0s - loss: 0.9865 - val_loss: 0.5971
AUC: 0.8768

Epoch 47/80
 - 0s - loss: 0.9890 - val_loss: 0.6083
AUC: 0.8769

Epoch 48/80
 - 0s - loss: 0.9893 - val_loss: 0.5979
AUC: 0.8768

Epoch 49/80
 - 0s - loss: 0.9927 - val_loss: 0.6038
AUC: 0.8768

Epoch 50/80
 - 0s - loss: 0.9912 - val_loss: 0.5899
AUC: 0.8767

Epoch 51/80
 - 0s - loss: 0.9928 - val_loss: 0.5997
AUC: 0.8769

Epoch 52/80
 - 0s - loss: 0.9855 - val_loss: 0.5992
AUC: 0.8768

Epoch 53/80
 - 0s - loss: 0.9900 - val_loss: 0.5984
AUC: 0.8768

Epoch 54/80
 - 0s - loss: 0.9924 - val_loss: 0.6070
AUC: 0.8769

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9882 - val_loss: 0.5897
AUC: 0.8766

Epoch 2/30
 - 0s - loss: 0.9908 - val_loss: 0.5874
AUC: 0.8767

Epoch 3/30
 - 0s - loss: 0.9891 - val_loss: 0.6052
AUC: 0.8771

Epoch 4/30
 - 0s - loss: 0.9869 - val_loss: 0.6009
AUC: 0.8772

Epoch 5/30
 - 0s - loss: 0.9831 - val_loss: 0.6051
AUC: 0.8772

Epoch 6/30
 - 0s - loss: 0.9843 - val_loss: 0.5851
AUC: 0.8773

Epoch 7/30
 - 0s - loss: 0.9812 - val_loss: 0.5956
AUC: 0.8774

Epoch 8/30
 - 0s - loss: 0.9744 - val_loss: 0.5753
AUC: 0.8774

Epoch 9/30
 - 0s - loss: 0.9817 - val_loss: 0.6024
AUC: 0.8779

Epoch 10/30
 - 0s - loss: 0.9809 - val_loss: 0.6207
AUC: 0.8780

Epoch 11/30
 - 0s - loss: 0.9771 - val_loss: 0.5934
AUC: 0.8777

Epoch 12/30
 - 0s - loss: 0.9742 - val_loss: 0.5810
AUC: 0.8779

Epoch 13/30
 - 0s - loss: 0.9754 - val_loss: 0.5925
AUC: 0.8781

Epoch 14/30
 - 0s - loss: 0.9734 - val_loss: 0.5972
AUC: 0.8782

Epoch 15/30
 - 0s - loss: 0.9707 - val_loss: 0.5992
AUC: 0.8782

Epoch 16/30
 - 0s - loss: 0.9715 - val_loss: 0.5657
AUC: 0.8780

Epoch 17/30
 - 0s - loss: 0.9651 - val_loss: 0.5923
AUC: 0.8783

Epoch 18/30
 - 0s - loss: 0.9716 - val_loss: 0.5934
AUC: 0.8784

Epoch 19/30
 - 0s - loss: 0.9639 - val_loss: 0.5973
AUC: 0.8786

Epoch 20/30
 - 0s - loss: 0.9664 - val_loss: 0.5908
AUC: 0.8786

Epoch 21/30
 - 0s - loss: 0.9686 - val_loss: 0.5873
AUC: 0.8786

Epoch 22/30
 - 0s - loss: 0.9667 - val_loss: 0.5820
AUC: 0.8786

Epoch 23/30
 - 0s - loss: 0.9649 - val_loss: 0.5965
AUC: 0.8788

Epoch 24/30
 - 0s - loss: 0.9631 - val_loss: 0.5846
AUC: 0.8788

Epoch 25/30
 - 0s - loss: 0.9642 - val_loss: 0.5890
AUC: 0.8791

Epoch 26/30
 - 0s - loss: 0.9543 - val_loss: 0.6025
AUC: 0.8792

Epoch 27/30
 - 0s - loss: 0.9561 - val_loss: 0.5856
AUC: 0.8791

Epoch 28/30
 - 0s - loss: 0.9597 - val_loss: 0.5877
AUC: 0.8791

Epoch 29/30
 - 0s - loss: 0.9592 - val_loss: 0.5867
AUC: 0.8791

Epoch 30/30
 - 0s - loss: 0.9563 - val_loss: 0.5862
Using TensorFlow backend.
AUC: 0.8791

2019-03-08 05:57:33.044722: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 05:57:33.219833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 05:57:33.219879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 05:57:33.522716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 05:57:33.522791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 05:57:33.522802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 05:57:33.523095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6287
Epoch 2/80
 - 2s - loss: 0.0987
Epoch 3/80
 - 2s - loss: 0.0697
Epoch 4/80
 - 2s - loss: 0.0656
Epoch 5/80
 - 2s - loss: 0.0633
Epoch 6/80
 - 2s - loss: 0.0603
Epoch 7/80
 - 2s - loss: 0.0559
Epoch 8/80
 - 2s - loss: 0.0506
Epoch 9/80
 - 2s - loss: 0.0456
Epoch 10/80
 - 2s - loss: 0.0411
Epoch 11/80
 - 2s - loss: 0.0373
Epoch 12/80
 - 2s - loss: 0.0339
Epoch 13/80
 - 2s - loss: 0.0312
Epoch 14/80
 - 2s - loss: 0.0288
Epoch 15/80
 - 2s - loss: 0.0268
Epoch 16/80
 - 2s - loss: 0.0250
Epoch 17/80
 - 2s - loss: 0.0235
Epoch 18/80
 - 2s - loss: 0.0222
Epoch 19/80
 - 2s - loss: 0.0211
Epoch 20/80
 - 2s - loss: 0.0202
Epoch 21/80
 - 2s - loss: 0.0195
Epoch 22/80
 - 2s - loss: 0.0188
Epoch 23/80
 - 2s - loss: 0.0182
Epoch 24/80
 - 2s - loss: 0.0178
Epoch 25/80
 - 2s - loss: 0.0173
Epoch 26/80
 - 2s - loss: 0.0170
Epoch 27/80
 - 2s - loss: 0.0166
Epoch 28/80
 - 2s - loss: 0.0163
Epoch 29/80
 - 2s - loss: 0.0161
Epoch 30/80
 - 2s - loss: 0.0159
Epoch 31/80
 - 2s - loss: 0.0157
Epoch 32/80
 - 2s - loss: 0.0155
Epoch 33/80
 - 2s - loss: 0.0153
Epoch 34/80
 - 2s - loss: 0.0152
Epoch 35/80
 - 2s - loss: 0.0151
Epoch 36/80
 - 2s - loss: 0.0150
Epoch 37/80
 - 2s - loss: 0.0149
Epoch 38/80
 - 2s - loss: 0.0148
Epoch 39/80
 - 2s - loss: 0.0147
Epoch 40/80
 - 2s - loss: 0.0146
Epoch 41/80
 - 2s - loss: 0.0146
Epoch 42/80
 - 2s - loss: 0.0145
Epoch 43/80
 - 2s - loss: 0.0145
Epoch 44/80
 - 2s - loss: 0.0144
Epoch 45/80
 - 2s - loss: 0.0144
Epoch 46/80
 - 2s - loss: 0.0144
Epoch 47/80
 - 2s - loss: 0.0143
Epoch 48/80
 - 2s - loss: 0.0143
Epoch 49/80
 - 2s - loss: 0.0143
Epoch 50/80
 - 2s - loss: 0.0142
Epoch 51/80
 - 2s - loss: 0.0138
Epoch 52/80
 - 2s - loss: 0.0137
Epoch 53/80
 - 2s - loss: 0.0137
Epoch 54/80
 - 2s - loss: 0.0137
Epoch 55/80
 - 2s - loss: 0.0136
Epoch 56/80
 - 2s - loss: 0.0136
Epoch 57/80
 - 2s - loss: 0.0136
Epoch 58/80
 - 2s - loss: 0.0136
Epoch 59/80
 - 2s - loss: 0.0136
Epoch 60/80
 - 2s - loss: 0.0136
Epoch 61/80
 - 2s - loss: 0.0136
Epoch 62/80
 - 2s - loss: 0.0136
Epoch 63/80
 - 2s - loss: 0.0136
Epoch 64/80
 - 2s - loss: 0.0136
Epoch 65/80
 - 2s - loss: 0.0136
Epoch 66/80
 - 2s - loss: 0.0136
Epoch 67/80
 - 2s - loss: 0.0136
Epoch 68/80
 - 2s - loss: 0.0136
Epoch 69/80
 - 2s - loss: 0.0136
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 06:00:06.730019: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:00:06.897637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:00:06.897683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:00:07.196183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:00:07.196238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:00:07.196247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:00:07.196511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2909
Epoch 2/80
 - 2s - loss: 0.3297
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2ac844a500f0>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 06:00:29.572950: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:00:29.740137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:00:29.740183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:00:30.037121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:00:30.037177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:00:30.037186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:00:30.037446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3023
Epoch 2/80
 - 2s - loss: 0.3335
Epoch 3/80
 - 2s - loss: 0.2998
Epoch 4/80
 - 2s - loss: 0.2746
Epoch 5/80
 - 2s - loss: 0.2482
Epoch 6/80
 - 2s - loss: 0.2252
Epoch 7/80
 - 2s - loss: 0.2066
Epoch 8/80
 - 2s - loss: 0.1905
Epoch 9/80
 - 2s - loss: 0.1766
Epoch 10/80
 - 2s - loss: 0.1650
Epoch 11/80
 - 2s - loss: 0.1557
Epoch 12/80
 - 2s - loss: 0.1478
Epoch 13/80
 - 2s - loss: 0.1412
Epoch 14/80
 - 2s - loss: 0.1355
Epoch 15/80
 - 2s - loss: 0.1307
Epoch 16/80
 - 2s - loss: 0.1266
Epoch 17/80
 - 2s - loss: 0.1233
Epoch 18/80
 - 2s - loss: 0.1204
Epoch 19/80
 - 2s - loss: 0.1180
Epoch 20/80
 - 2s - loss: 0.1159
Epoch 21/80
 - 2s - loss: 0.1141
Epoch 22/80
 - 2s - loss: 0.1126
Epoch 23/80
 - 2s - loss: 0.1113
Epoch 24/80
 - 2s - loss: 0.1100
Epoch 25/80
 - 2s - loss: 0.1091
Epoch 26/80
 - 2s - loss: 0.1081
Epoch 27/80
 - 2s - loss: 0.1074
Epoch 28/80
 - 2s - loss: 0.1067
Epoch 29/80
 - 2s - loss: 0.1061
Epoch 30/80
 - 2s - loss: 0.1056
Epoch 31/80
 - 2s - loss: 0.1051
Epoch 32/80
 - 2s - loss: 0.1048
Epoch 33/80
 - 2s - loss: 0.1044
Epoch 34/80
 - 2s - loss: 0.1041
Epoch 35/80
 - 2s - loss: 0.1038
Epoch 36/80
 - 2s - loss: 0.1036
Epoch 37/80
 - 2s - loss: 0.1033
Epoch 38/80
 - 2s - loss: 0.1031
Epoch 39/80
 - 2s - loss: 0.1029
Epoch 40/80
 - 2s - loss: 0.1028
Epoch 41/80
 - 2s - loss: 0.1026
Epoch 42/80
 - 2s - loss: 0.1025
Epoch 43/80
 - 2s - loss: 0.1023
Epoch 44/80
 - 2s - loss: 0.1022
Epoch 45/80
 - 2s - loss: 0.1021
Epoch 46/80
 - 2s - loss: 0.1020
Epoch 47/80
 - 2s - loss: 0.1019
Epoch 48/80
 - 2s - loss: 0.1018
Epoch 49/80
 - 2s - loss: 0.1017
Epoch 50/80
 - 2s - loss: 0.1016
Epoch 51/80
 - 2s - loss: 0.1016
Epoch 52/80
 - 2s - loss: 0.1015
Epoch 53/80
 - 2s - loss: 0.1014
Epoch 54/80
 - 2s - loss: 0.1014
Epoch 55/80
 - 2s - loss: 0.1013
Epoch 56/80
 - 2s - loss: 0.1013
Epoch 57/80
 - 2s - loss: 0.1012
Epoch 58/80
 - 2s - loss: 0.1011
Epoch 59/80
 - 2s - loss: 0.1011
Epoch 60/80
 - 2s - loss: 0.1011
Epoch 61/80
 - 2s - loss: 0.1011
Epoch 62/80
 - 2s - loss: 0.0984
Epoch 63/80
 - 2s - loss: 0.0981
Epoch 64/80
 - 2s - loss: 0.0981
Epoch 65/80
 - 2s - loss: 0.0981
Epoch 66/80
 - 2s - loss: 0.0981
Epoch 67/80
 - 2s - loss: 0.0974
Epoch 68/80
 - 2s - loss: 0.0974
Epoch 69/80
 - 2s - loss: 0.0974
Epoch 70/80
 - 2s - loss: 0.0974
Epoch 71/80
 - 2s - loss: 0.0972
Epoch 72/80
 - 2s - loss: 0.0972
Epoch 73/80
 - 2s - loss: 0.0972
Epoch 74/80
 - 2s - loss: 0.0972
Epoch 75/80
 - 2s - loss: 0.0972
Epoch 76/80
 - 2s - loss: 0.0972
Epoch 77/80
 - 2s - loss: 0.0972
Epoch 78/80
 - 2s - loss: 0.0972
Epoch 79/80
 - 2s - loss: 0.0972
Epoch 80/80
 - 2s - loss: 0.0972
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.4804 - val_loss: 0.7485
AUC: 0.8026

Epoch 2/80
 - 0s - loss: 1.3086 - val_loss: 0.7232
AUC: 0.8373

Epoch 3/80
 - 0s - loss: 1.1715 - val_loss: 0.7192
AUC: 0.8518

Epoch 4/80
 - 0s - loss: 1.1130 - val_loss: 0.6899
AUC: 0.8560

Epoch 5/80
 - 0s - loss: 1.0910 - val_loss: 0.6912
AUC: 0.8596

Epoch 6/80
 - 0s - loss: 1.0789 - val_loss: 0.6793
AUC: 0.8605

Epoch 7/80
 - 0s - loss: 1.0648 - val_loss: 0.7271
AUC: 0.8622

Epoch 8/80
 - 0s - loss: 1.0557 - val_loss: 0.7276
AUC: 0.8627

Epoch 9/80
 - 0s - loss: 1.0431 - val_loss: 0.6067
AUC: 0.8623

Epoch 10/80
 - 0s - loss: 1.0392 - val_loss: 0.6247
AUC: 0.8638

Epoch 11/80
 - 0s - loss: 1.0347 - val_loss: 0.6260
AUC: 0.8651

Epoch 12/80
 - 0s - loss: 1.0243 - val_loss: 0.6855
AUC: 0.8668

Epoch 13/80
 - 0s - loss: 1.0195 - val_loss: 0.6251
AUC: 0.8662

Epoch 14/80
 - 0s - loss: 1.0136 - val_loss: 0.6314
AUC: 0.8651

Epoch 15/80
 - 0s - loss: 1.0174 - val_loss: 0.6648
AUC: 0.8685

Epoch 16/80
 - 0s - loss: 1.0106 - val_loss: 0.5478
AUC: 0.8662

Epoch 17/80
 - 0s - loss: 1.0081 - val_loss: 0.6223
AUC: 0.8658

Epoch 18/80
 - 0s - loss: 0.9969 - val_loss: 0.6280
AUC: 0.8681

Epoch 19/80
 - 0s - loss: 0.9977 - val_loss: 0.5682
AUC: 0.8680

Epoch 20/80
 - 0s - loss: 0.9932 - val_loss: 0.6044
AUC: 0.8690

Epoch 21/80
 - 0s - loss: 0.9953 - val_loss: 0.6330
AUC: 0.8690

Epoch 22/80
 - 0s - loss: 0.9900 - val_loss: 0.6455
AUC: 0.8686

Epoch 23/80
 - 0s - loss: 0.9868 - val_loss: 0.6016
AUC: 0.8693

Epoch 24/80
 - 0s - loss: 0.9870 - val_loss: 0.6454
AUC: 0.8702

Epoch 25/80
 - 0s - loss: 0.9820 - val_loss: 0.6194
AUC: 0.8701

Epoch 26/80
 - 0s - loss: 0.9821 - val_loss: 0.5805
AUC: 0.8698

Epoch 27/80
 - 0s - loss: 0.9696 - val_loss: 0.5984
AUC: 0.8707

Epoch 28/80
 - 0s - loss: 0.9697 - val_loss: 0.6100
AUC: 0.8709

Epoch 29/80
 - 0s - loss: 0.9668 - val_loss: 0.5835
AUC: 0.8704

Epoch 30/80
 - 0s - loss: 0.9648 - val_loss: 0.5827
AUC: 0.8704

Epoch 31/80
 - 0s - loss: 0.9598 - val_loss: 0.5952
AUC: 0.8709

Epoch 32/80
 - 0s - loss: 0.9603 - val_loss: 0.5854
AUC: 0.8709

Epoch 33/80
 - 0s - loss: 0.9597 - val_loss: 0.6011
AUC: 0.8710

Epoch 34/80
 - 0s - loss: 0.9575 - val_loss: 0.6014
AUC: 0.8710

Epoch 35/80
 - 0s - loss: 0.9573 - val_loss: 0.5940
AUC: 0.8713

Epoch 36/80
 - 0s - loss: 0.9533 - val_loss: 0.6044
AUC: 0.8713

Epoch 37/80
 - 0s - loss: 0.9618 - val_loss: 0.5880
AUC: 0.8711

Epoch 38/80
 - 0s - loss: 0.9554 - val_loss: 0.5994
AUC: 0.8713

Epoch 39/80
 - 0s - loss: 0.9531 - val_loss: 0.5905
AUC: 0.8712

Epoch 40/80
 - 0s - loss: 0.9564 - val_loss: 0.6034
AUC: 0.8713

Epoch 41/80
 - 0s - loss: 0.9541 - val_loss: 0.6015
AUC: 0.8713

Epoch 42/80
 - 0s - loss: 0.9579 - val_loss: 0.5999
AUC: 0.8713

Epoch 43/80
 - 0s - loss: 0.9520 - val_loss: 0.5953
AUC: 0.8712

Epoch 44/80
 - 0s - loss: 0.9553 - val_loss: 0.5943
AUC: 0.8712

Epoch 45/80
 - 0s - loss: 0.9521 - val_loss: 0.5976
AUC: 0.8713

Epoch 46/80
 - 0s - loss: 0.9540 - val_loss: 0.5905
AUC: 0.8712

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9518 - val_loss: 0.5784
AUC: 0.8709

Epoch 2/30
 - 0s - loss: 0.9590 - val_loss: 0.6085
AUC: 0.8716

Epoch 3/30
 - 0s - loss: 0.9553 - val_loss: 0.5810
AUC: 0.8713

Epoch 4/30
 - 0s - loss: 0.9492 - val_loss: 0.5906
AUC: 0.8715

Epoch 5/30
 - 0s - loss: 0.9508 - val_loss: 0.6121
AUC: 0.8718

Epoch 6/30
 - 0s - loss: 0.9529 - val_loss: 0.6035
AUC: 0.8717

Epoch 7/30
 - 0s - loss: 0.9473 - val_loss: 0.5898
AUC: 0.8716

Epoch 8/30
 - 0s - loss: 0.9451 - val_loss: 0.5766
AUC: 0.8714

Epoch 9/30
 - 0s - loss: 0.9498 - val_loss: 0.6097
AUC: 0.8720

Epoch 10/30
 - 0s - loss: 0.9444 - val_loss: 0.5791
AUC: 0.8716

Epoch 11/30
 - 0s - loss: 0.9447 - val_loss: 0.5800
AUC: 0.8717

Epoch 12/30
 - 0s - loss: 0.9457 - val_loss: 0.5825
AUC: 0.8720

Epoch 13/30
 - 0s - loss: 0.9401 - val_loss: 0.5941
AUC: 0.8724

Epoch 14/30
 - 0s - loss: 0.9414 - val_loss: 0.5731
AUC: 0.8721

Epoch 15/30
 - 0s - loss: 0.9376 - val_loss: 0.5627
AUC: 0.8718

Epoch 16/30
 - 0s - loss: 0.9369 - val_loss: 0.5849
AUC: 0.8723

Epoch 17/30
 - 0s - loss: 0.9391 - val_loss: 0.5773
AUC: 0.8723

Epoch 18/30
 - 0s - loss: 0.9373 - val_loss: 0.5852
AUC: 0.8724

Epoch 19/30
 - 0s - loss: 0.9310 - val_loss: 0.5730
AUC: 0.8723

Epoch 20/30
 - 0s - loss: 0.9344 - val_loss: 0.6022
AUC: 0.8729

Epoch 21/30
 - 1s - loss: 0.9341 - val_loss: 0.5839
AUC: 0.8727

Epoch 22/30
 - 0s - loss: 0.9289 - val_loss: 0.5772
AUC: 0.8724

Epoch 23/30
 - 1s - loss: 0.9257 - val_loss: 0.5852
AUC: 0.8726

Epoch 24/30
 - 1s - loss: 0.9304 - val_loss: 0.5889
AUC: 0.8727

Epoch 25/30
 - 1s - loss: 0.9242 - val_loss: 0.5713
AUC: 0.8724

Epoch 26/30
 - 0s - loss: 0.9192 - val_loss: 0.5795
AUC: 0.8725

Epoch 27/30
 - 0s - loss: 0.9167 - val_loss: 0.5809
AUC: 0.8726

Epoch 28/30
 - 0s - loss: 0.9237 - val_loss: 0.5820
AUC: 0.8727

Epoch 29/30
 - 0s - loss: 0.9214 - val_loss: 0.5817
AUC: 0.8726

Epoch 30/30
 - 0s - loss: 0.9211 - val_loss: 0.5810
Using TensorFlow backend.
AUC: 0.8726

2019-03-08 06:04:24.777200: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:04:24.946624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:04:24.946672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:04:25.246196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:04:25.246264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:04:25.246274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:04:25.246558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2959
Epoch 2/80
 - 2s - loss: 0.3327
Epoch 3/80
 - 2s - loss: 0.3038
Epoch 4/80
 - 2s - loss: 0.2832
Epoch 5/80
 - 2s - loss: 0.2535
Epoch 6/80
 - 2s - loss: 0.2245
Epoch 7/80
 - 2s - loss: 0.2047
Epoch 8/80
 - 2s - loss: 0.1904
Epoch 9/80
 - 2s - loss: 0.1781
Epoch 10/80
 - 2s - loss: 0.1670
Epoch 11/80
 - 2s - loss: 0.1574
Epoch 12/80
 - 2s - loss: 0.1490
Epoch 13/80
 - 2s - loss: 0.1421
Epoch 14/80
 - 2s - loss: 0.1362
Epoch 15/80
 - 2s - loss: 0.1314
Epoch 16/80
 - 2s - loss: 0.1273
Epoch 17/80
 - 2s - loss: 0.1240
Epoch 18/80
 - 2s - loss: 0.1211
Epoch 19/80
 - 2s - loss: 0.1187
Epoch 20/80
 - 2s - loss: 0.1165
Epoch 21/80
 - 2s - loss: 0.1146
Epoch 22/80
 - 2s - loss: 0.1130
Epoch 23/80
 - 2s - loss: 0.1116
Epoch 24/80
 - 2s - loss: 0.1104
Epoch 25/80
 - 2s - loss: 0.1094
Epoch 26/80
 - 2s - loss: 0.1085
Epoch 27/80
 - 2s - loss: 0.1078
Epoch 28/80
 - 2s - loss: 0.1071
Epoch 29/80
 - 2s - loss: 0.1065
Epoch 30/80
 - 2s - loss: 0.1061
Epoch 31/80
 - 2s - loss: 0.1056
Epoch 32/80
 - 2s - loss: 0.1052
Epoch 33/80
 - 2s - loss: 0.1049
Epoch 34/80
 - 2s - loss: 0.1046
Epoch 35/80
 - 2s - loss: 0.1043
Epoch 36/80
 - 2s - loss: 0.1041
Epoch 37/80
 - 2s - loss: 0.1039
Epoch 38/80
 - 2s - loss: 0.1037
Epoch 39/80
 - 2s - loss: 0.1035
Epoch 40/80
 - 2s - loss: 0.1033
Epoch 41/80
 - 2s - loss: 0.1032
Epoch 42/80
 - 2s - loss: 0.1030
Epoch 43/80
 - 2s - loss: 0.1029
Epoch 44/80
 - 2s - loss: 0.1028
Epoch 45/80
 - 2s - loss: 0.1027
Epoch 46/80
 - 2s - loss: 0.1026
Epoch 47/80
 - 2s - loss: 0.1025
Epoch 48/80
 - 2s - loss: 0.1024
Epoch 49/80
 - 2s - loss: 0.1023
Epoch 50/80
 - 2s - loss: 0.1022
Epoch 51/80
 - 2s - loss: 0.1021
Epoch 52/80
 - 2s - loss: 0.1021
Epoch 53/80
 - 2s - loss: 0.1020
Epoch 54/80
 - 2s - loss: 0.1019
Epoch 55/80
 - 2s - loss: 0.1019
Epoch 56/80
 - 2s - loss: 0.1018
Epoch 57/80
 - 2s - loss: 0.1018
Epoch 58/80
 - 2s - loss: 0.1018
Epoch 59/80
 - 2s - loss: 0.1017
Epoch 60/80
 - 2s - loss: 0.1016
Epoch 61/80
 - 2s - loss: 0.1016
Epoch 62/80
 - 2s - loss: 0.1015
Epoch 63/80
 - 2s - loss: 0.1015
Epoch 64/80
 - 2s - loss: 0.1015
Epoch 65/80
 - 2s - loss: 0.1014
Epoch 66/80
 - 2s - loss: 0.1015
Epoch 67/80
 - 2s - loss: 0.1014
Epoch 68/80
 - 2s - loss: 0.1013
Epoch 69/80
 - 2s - loss: 0.0987
Epoch 70/80
 - 2s - loss: 0.0984
Epoch 71/80
 - 2s - loss: 0.0984
Epoch 72/80
 - 2s - loss: 0.0984
Epoch 73/80
 - 2s - loss: 0.0984
Epoch 74/80
 - 2s - loss: 0.0977
Epoch 75/80
 - 2s - loss: 0.0977
Epoch 76/80
 - 2s - loss: 0.0977
Epoch 77/80
 - 2s - loss: 0.0977
Epoch 78/80
 - 2s - loss: 0.0975
Epoch 79/80
 - 2s - loss: 0.0975
Epoch 80/80
 - 2s - loss: 0.0975
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.9713 - val_loss: 1.0158
AUC: 0.7975

Epoch 2/80
 - 0s - loss: 1.8605 - val_loss: 0.8771
AUC: 0.8353

Epoch 3/80
 - 0s - loss: 1.2892 - val_loss: 0.7306
AUC: 0.8365

Epoch 4/80
 - 0s - loss: 1.1876 - val_loss: 0.6777
AUC: 0.8417

Epoch 5/80
 - 0s - loss: 1.1484 - val_loss: 0.6581
AUC: 0.8450

Epoch 6/80
 - 0s - loss: 1.1071 - val_loss: 0.7392
AUC: 0.8517

Epoch 7/80
 - 0s - loss: 1.0941 - val_loss: 0.6478
AUC: 0.8516

Epoch 8/80
 - 0s - loss: 1.0805 - val_loss: 0.6400
AUC: 0.8524

Epoch 9/80
 - 0s - loss: 1.0754 - val_loss: 0.7566
AUC: 0.8572

Epoch 10/80
 - 0s - loss: 1.0553 - val_loss: 0.6710
AUC: 0.8559

Epoch 11/80
 - 0s - loss: 1.0556 - val_loss: 0.6148
AUC: 0.8555

Epoch 12/80
 - 0s - loss: 1.0409 - val_loss: 0.6696
AUC: 0.8576

Epoch 13/80
 - 0s - loss: 1.0375 - val_loss: 0.6119
AUC: 0.8576

Epoch 14/80
 - 0s - loss: 1.0365 - val_loss: 0.6240
AUC: 0.8581

Epoch 15/80
 - 0s - loss: 1.0357 - val_loss: 0.6114
AUC: 0.8588

Epoch 16/80
 - 0s - loss: 1.0290 - val_loss: 0.5881
AUC: 0.8590

Epoch 17/80
 - 0s - loss: 1.0255 - val_loss: 0.5906
AUC: 0.8593

Epoch 18/80
 - 0s - loss: 1.0140 - val_loss: 0.6648
AUC: 0.8598

Epoch 19/80
 - 0s - loss: 1.0127 - val_loss: 0.6128
AUC: 0.8615

Epoch 20/80
 - 0s - loss: 1.0107 - val_loss: 0.6516
AUC: 0.8621

Epoch 21/80
 - 0s - loss: 1.0063 - val_loss: 0.6130
AUC: 0.8620

Epoch 22/80
 - 0s - loss: 0.9960 - val_loss: 0.6483
AUC: 0.8639

Epoch 23/80
 - 0s - loss: 1.0024 - val_loss: 0.6206
AUC: 0.8621

Epoch 24/80
 - 0s - loss: 1.0026 - val_loss: 0.5592
AUC: 0.8627

Epoch 25/80
 - 0s - loss: 0.9917 - val_loss: 0.6514
AUC: 0.8626

Epoch 26/80
 - 0s - loss: 0.9917 - val_loss: 0.5789
AUC: 0.8646

Epoch 27/80
 - 0s - loss: 0.9877 - val_loss: 0.6499
AUC: 0.8648

Epoch 28/80
 - 0s - loss: 0.9957 - val_loss: 0.5832
AUC: 0.8642

Epoch 29/80
 - 0s - loss: 0.9795 - val_loss: 0.5473
AUC: 0.8640

Epoch 30/80
 - 0s - loss: 0.9931 - val_loss: 0.6457
AUC: 0.8652

Epoch 31/80
 - 0s - loss: 0.9793 - val_loss: 0.5902
AUC: 0.8651

Epoch 32/80
 - 0s - loss: 0.9788 - val_loss: 0.5848
AUC: 0.8642

Epoch 33/80
 - 0s - loss: 0.9792 - val_loss: 0.5946
AUC: 0.8654

Epoch 34/80
 - 0s - loss: 0.9701 - val_loss: 0.5698
AUC: 0.8656

Epoch 35/80
 - 0s - loss: 0.9702 - val_loss: 0.6769
AUC: 0.8665

Epoch 36/80
 - 0s - loss: 0.9735 - val_loss: 0.5699
AUC: 0.8661

Epoch 37/80
 - 0s - loss: 0.9656 - val_loss: 0.5793
AUC: 0.8669

Epoch 38/80
 - 0s - loss: 0.9647 - val_loss: 0.5610
AUC: 0.8669

Epoch 39/80
 - 0s - loss: 0.9697 - val_loss: 0.6506
AUC: 0.8680

Epoch 40/80
 - 0s - loss: 0.9534 - val_loss: 0.5889
AUC: 0.8672

Epoch 41/80
 - 0s - loss: 0.9522 - val_loss: 0.5990
AUC: 0.8675

Epoch 42/80
 - 0s - loss: 0.9442 - val_loss: 0.5857
AUC: 0.8675

Epoch 43/80
 - 0s - loss: 0.9468 - val_loss: 0.5880
AUC: 0.8675

Epoch 44/80
 - 0s - loss: 0.9464 - val_loss: 0.6348
AUC: 0.8675

Epoch 45/80
 - 0s - loss: 0.9432 - val_loss: 0.5729
AUC: 0.8673

Epoch 46/80
 - 0s - loss: 0.9445 - val_loss: 0.5771
AUC: 0.8675

Epoch 47/80
 - 0s - loss: 0.9443 - val_loss: 0.6154
AUC: 0.8674

Epoch 48/80
 - 0s - loss: 0.9477 - val_loss: 0.5863
AUC: 0.8672

Epoch 49/80
 - 0s - loss: 0.9451 - val_loss: 0.6012
AUC: 0.8676

Epoch 50/80
 - 0s - loss: 0.9462 - val_loss: 0.5847
AUC: 0.8674

Epoch 51/80
 - 0s - loss: 0.9402 - val_loss: 0.5938
AUC: 0.8674

Epoch 52/80
 - 0s - loss: 0.9397 - val_loss: 0.5955
AUC: 0.8675

Epoch 53/80
 - 0s - loss: 0.9405 - val_loss: 0.5815
AUC: 0.8675

Epoch 54/80
 - 0s - loss: 0.9361 - val_loss: 0.5833
AUC: 0.8674

Epoch 55/80
 - 0s - loss: 0.9400 - val_loss: 0.5903
AUC: 0.8674

Epoch 56/80
 - 0s - loss: 0.9424 - val_loss: 0.5825
AUC: 0.8675

Epoch 57/80
 - 0s - loss: 0.9384 - val_loss: 0.5815
AUC: 0.8675

Epoch 58/80
 - 0s - loss: 0.9361 - val_loss: 0.5844
AUC: 0.8675

Epoch 59/80
 - 0s - loss: 0.9414 - val_loss: 0.5854
AUC: 0.8675

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9513 - val_loss: 0.6048
AUC: 0.8676

Epoch 2/30
 - 0s - loss: 0.9405 - val_loss: 0.5890
AUC: 0.8673

Epoch 3/30
 - 0s - loss: 0.9499 - val_loss: 0.5865
AUC: 0.8675

Epoch 4/30
 - 0s - loss: 0.9415 - val_loss: 0.5841
AUC: 0.8674

Epoch 5/30
 - 0s - loss: 0.9438 - val_loss: 0.5605
AUC: 0.8672

Epoch 6/30
 - 0s - loss: 0.9415 - val_loss: 0.5817
AUC: 0.8675

Epoch 7/30
 - 0s - loss: 0.9460 - val_loss: 0.5837
AUC: 0.8675

Epoch 8/30
 - 0s - loss: 0.9368 - val_loss: 0.6002
AUC: 0.8677

Epoch 9/30
 - 0s - loss: 0.9347 - val_loss: 0.5713
AUC: 0.8675

Epoch 10/30
 - 0s - loss: 0.9375 - val_loss: 0.6043
AUC: 0.8679

Epoch 11/30
 - 0s - loss: 0.9362 - val_loss: 0.5828
AUC: 0.8675

Epoch 12/30
 - 0s - loss: 0.9332 - val_loss: 0.5885
AUC: 0.8676

Epoch 13/30
 - 0s - loss: 0.9380 - val_loss: 0.5720
AUC: 0.8678

Epoch 14/30
 - 0s - loss: 0.9250 - val_loss: 0.5823
AUC: 0.8679

Epoch 15/30
 - 0s - loss: 0.9307 - val_loss: 0.5781
AUC: 0.8677

Epoch 16/30
 - 0s - loss: 0.9289 - val_loss: 0.5819
AUC: 0.8678

Epoch 17/30
 - 0s - loss: 0.9253 - val_loss: 0.5813
AUC: 0.8678

Epoch 18/30
 - 0s - loss: 0.9260 - val_loss: 0.5828
AUC: 0.8679

Epoch 19/30
 - 0s - loss: 0.9268 - val_loss: 0.5816
AUC: 0.8679

Epoch 20/30
 - 0s - loss: 0.9285 - val_loss: 0.5834
AUC: 0.8679

Epoch 21/30
 - 0s - loss: 0.9276 - val_loss: 0.5782
AUC: 0.8678

Epoch 22/30
 - 0s - loss: 0.9191 - val_loss: 0.5797
AUC: 0.8678

Epoch 23/30
 - 0s - loss: 0.9300 - val_loss: 0.5828
AUC: 0.8679

Epoch 24/30
 - 0s - loss: 0.9226 - val_loss: 0.5781
AUC: 0.8678

Epoch 25/30
 - 0s - loss: 0.9292 - val_loss: 0.5790
AUC: 0.8678

Epoch 26/30
 - 0s - loss: 0.9231 - val_loss: 0.5790
AUC: 0.8678

Epoch 27/30
 - 0s - loss: 0.9205 - val_loss: 0.5796
AUC: 0.8678

Epoch 28/30
 - 0s - loss: 0.9253 - val_loss: 0.5795
AUC: 0.8678

Epoch 29/30
 - 0s - loss: 0.9210 - val_loss: 0.5782
AUC: 0.8678

Epoch 30/30
 - 0s - loss: 0.9305 - val_loss: 0.5809
Using TensorFlow backend.
AUC: 0.8678

2019-03-08 06:08:28.483725: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:08:28.649708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:08:28.649760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:08:28.946344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:08:28.946398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:08:28.946407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:08:28.946672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0879
Epoch 2/80
 - 2s - loss: 0.1938
Epoch 3/80
 - 2s - loss: 0.1577
Epoch 4/80
 - 2s - loss: 0.1397
Epoch 5/80
 - 2s - loss: 0.1271
Epoch 6/80
 - 2s - loss: 0.1173
Epoch 7/80
 - 2s - loss: 0.1090
Epoch 8/80
 - 2s - loss: 0.1014
Epoch 9/80
 - 2s - loss: 0.0941
Epoch 10/80
 - 2s - loss: 0.0872
Epoch 11/80
 - 2s - loss: 0.0810
Epoch 12/80
 - 2s - loss: 0.0760
Epoch 13/80
 - 2s - loss: 0.0717
Epoch 14/80
 - 2s - loss: 0.0680
Epoch 15/80
 - 2s - loss: 0.0648
Epoch 16/80
 - 2s - loss: 0.0619
Epoch 17/80
 - 2s - loss: 0.0594
Epoch 18/80
 - 2s - loss: 0.0573
Epoch 19/80
 - 2s - loss: 0.0555
Epoch 20/80
 - 2s - loss: 0.0540
Epoch 21/80
 - 2s - loss: 0.0526
Epoch 22/80
 - 2s - loss: 0.0515
Epoch 23/80
 - 2s - loss: 0.0505
Epoch 24/80
 - 2s - loss: 0.0496
Epoch 25/80
 - 2s - loss: 0.0489
Epoch 26/80
 - 2s - loss: 0.0483
Epoch 27/80
 - 2s - loss: 0.0477
Epoch 28/80
 - 2s - loss: 0.0473
Epoch 29/80
 - 2s - loss: 0.0468
Epoch 30/80
 - 2s - loss: 0.0465
Epoch 31/80
 - 2s - loss: 0.0462
Epoch 32/80
 - 2s - loss: 0.0459
Epoch 33/80
 - 2s - loss: 0.0457
Epoch 34/80
 - 2s - loss: 0.0454
Epoch 35/80
 - 2s - loss: 0.0452
Epoch 36/80
 - 2s - loss: 0.0451
Epoch 37/80
 - 2s - loss: 0.0449
Epoch 38/80
 - 2s - loss: 0.0448
Epoch 39/80
 - 2s - loss: 0.0446
Epoch 40/80
 - 2s - loss: 0.0445
Epoch 41/80
 - 2s - loss: 0.0444
Epoch 42/80
 - 2s - loss: 0.0443
Epoch 43/80
 - 2s - loss: 0.0442
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2ad1a6cc31d0>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 06:10:11.220535: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:10:11.385248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:10:11.385294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:10:11.683221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:10:11.683275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:10:11.683284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:10:11.683549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0972
Epoch 2/80
 - 2s - loss: 0.1954
Epoch 3/80
 - 2s - loss: 0.1678
Epoch 4/80
 - 2s - loss: 0.1578
Epoch 5/80
 - 2s - loss: 0.1440
Epoch 6/80
 - 2s - loss: 0.1272
Epoch 7/80
 - 2s - loss: 0.1128
Epoch 8/80
 - 2s - loss: 0.1022
Epoch 9/80
 - 2s - loss: 0.0939
Epoch 10/80
 - 2s - loss: 0.0869
Epoch 11/80
 - 2s - loss: 0.0807
Epoch 12/80
 - 2s - loss: 0.0754
Epoch 13/80
 - 2s - loss: 0.0708
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 06:10:56.461511: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:10:56.628229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:10:56.628274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:10:56.926617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:10:56.926675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:10:56.926685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:10:56.926957: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0882
Epoch 2/80
 - 2s - loss: 0.1965
Epoch 3/80
 - 2s - loss: 0.1674
Epoch 4/80
 - 2s - loss: 0.1534
Epoch 5/80
 - 2s - loss: 0.1383
Epoch 6/80
 - 2s - loss: 0.1256
Epoch 7/80
 - 2s - loss: 0.1146
Epoch 8/80
 - 2s - loss: 0.1046
Epoch 9/80
 - 2s - loss: 0.0956
Epoch 10/80
 - 2s - loss: 0.0882
Epoch 11/80
 - 2s - loss: 0.0821
Epoch 12/80
 - 2s - loss: 0.0769
Epoch 13/80
 - 2s - loss: 0.0723
Epoch 14/80
 - 2s - loss: 0.0684
Epoch 15/80
 - 2s - loss: 0.0650
Epoch 16/80
 - 2s - loss: 0.0621
Epoch 17/80
 - 2s - loss: 0.0596
Epoch 18/80
 - 2s - loss: 0.0575
Epoch 19/80
 - 2s - loss: 0.0557
Epoch 20/80
 - 2s - loss: 0.0542
Epoch 21/80
 - 2s - loss: 0.0529
Epoch 22/80
 - 2s - loss: 0.0517
Epoch 23/80
 - 2s - loss: 0.0508
Epoch 24/80
 - 2s - loss: 0.0499
Epoch 25/80
 - 2s - loss: 0.0492
Epoch 26/80
 - 2s - loss: 0.0485
Epoch 27/80
 - 2s - loss: 0.0480
Epoch 28/80
 - 2s - loss: 0.0475
Epoch 29/80
 - 2s - loss: 0.0471
Epoch 30/80
 - 2s - loss: 0.0467
Epoch 31/80
 - 2s - loss: 0.0464
Epoch 32/80
 - 2s - loss: 0.0461
Epoch 33/80
 - 2s - loss: 0.0459
Epoch 34/80
 - 2s - loss: 0.0456
Epoch 35/80
 - 2s - loss: 0.0455
Epoch 36/80
 - 2s - loss: 0.0452
Epoch 37/80
 - 2s - loss: 0.0451
Epoch 38/80
 - 2s - loss: 0.0450
Epoch 39/80
 - 2s - loss: 0.0448
Epoch 40/80
 - 2s - loss: 0.0447
Epoch 41/80
 - 2s - loss: 0.0446
Epoch 42/80
 - 2s - loss: 0.0445
Epoch 43/80
 - 2s - loss: 0.0444
Epoch 44/80
 - 2s - loss: 0.0443
Epoch 45/80
 - 2s - loss: 0.0442
Epoch 46/80
 - 2s - loss: 0.0442
Epoch 47/80
 - 2s - loss: 0.0441
Epoch 48/80
 - 2s - loss: 0.0440
Epoch 49/80
 - 2s - loss: 0.0440
Epoch 50/80
 - 2s - loss: 0.0439
Epoch 51/80
 - 2s - loss: 0.0439
Epoch 52/80
 - 2s - loss: 0.0438
Epoch 53/80
 - 2s - loss: 0.0438
Epoch 54/80
 - 2s - loss: 0.0437
Epoch 55/80
 - 2s - loss: 0.0437
Epoch 56/80
 - 2s - loss: 0.0437
Epoch 57/80
 - 2s - loss: 0.0436
Epoch 58/80
 - 2s - loss: 0.0436
Epoch 59/80
 - 2s - loss: 0.0436
Epoch 60/80
 - 2s - loss: 0.0435
Epoch 61/80
 - 2s - loss: 0.0435
Epoch 62/80
 - 2s - loss: 0.0435
Epoch 63/80
 - 2s - loss: 0.0435
Epoch 64/80
 - 2s - loss: 0.0422
Epoch 65/80
 - 2s - loss: 0.0421
Epoch 66/80
 - 2s - loss: 0.0421
Epoch 67/80
 - 2s - loss: 0.0420
Epoch 68/80
 - 2s - loss: 0.0420
Epoch 69/80
 - 2s - loss: 0.0417
Epoch 70/80
 - 2s - loss: 0.0417
Epoch 71/80
 - 2s - loss: 0.0417
Epoch 72/80
 - 2s - loss: 0.0417
Epoch 73/80
 - 2s - loss: 0.0416
Epoch 74/80
 - 2s - loss: 0.0416
Epoch 75/80
 - 2s - loss: 0.0416
Epoch 76/80
 - 2s - loss: 0.0416
Epoch 77/80
 - 2s - loss: 0.0416
Epoch 78/80
 - 2s - loss: 0.0416
Epoch 79/80
 - 2s - loss: 0.0416
Epoch 80/80
 - 2s - loss: 0.0416
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.1623 - val_loss: 0.8615
AUC: 0.8190

Epoch 2/80
 - 0s - loss: 1.2645 - val_loss: 0.6945
AUC: 0.8365

Epoch 3/80
 - 0s - loss: 1.1666 - val_loss: 0.7097
AUC: 0.8495

Epoch 4/80
 - 0s - loss: 1.1171 - val_loss: 0.6363
AUC: 0.8517

Epoch 5/80
 - 0s - loss: 1.0939 - val_loss: 0.7353
AUC: 0.8583

Epoch 6/80
 - 0s - loss: 1.0720 - val_loss: 0.6385
AUC: 0.8577

Epoch 7/80
 - 0s - loss: 1.0621 - val_loss: 0.6006
AUC: 0.8596

Epoch 8/80
 - 0s - loss: 1.0546 - val_loss: 0.6423
AUC: 0.8607

Epoch 9/80
 - 0s - loss: 1.0465 - val_loss: 0.5835
AUC: 0.8623

Epoch 10/80
 - 0s - loss: 1.0436 - val_loss: 0.7083
AUC: 0.8626

Epoch 11/80
 - 0s - loss: 1.0361 - val_loss: 0.5977
AUC: 0.8625

Epoch 12/80
 - 0s - loss: 1.0259 - val_loss: 0.6290
AUC: 0.8632

Epoch 13/80
 - 0s - loss: 1.0253 - val_loss: 0.5979
AUC: 0.8637

Epoch 14/80
 - 0s - loss: 1.0194 - val_loss: 0.6637
AUC: 0.8661

Epoch 15/80
 - 0s - loss: 1.0084 - val_loss: 0.6144
AUC: 0.8645

Epoch 16/80
 - 0s - loss: 1.0019 - val_loss: 0.6247
AUC: 0.8666

Epoch 17/80
 - 0s - loss: 0.9972 - val_loss: 0.6181
AUC: 0.8663

Epoch 18/80
 - 0s - loss: 1.0000 - val_loss: 0.6406
AUC: 0.8668

Epoch 19/80
 - 0s - loss: 0.9921 - val_loss: 0.6074
AUC: 0.8664

Epoch 20/80
 - 0s - loss: 0.9796 - val_loss: 0.6206
AUC: 0.8674

Epoch 21/80
 - 0s - loss: 0.9792 - val_loss: 0.6390
AUC: 0.8678

Epoch 22/80
 - 0s - loss: 0.9782 - val_loss: 0.6234
AUC: 0.8676

Epoch 23/80
 - 0s - loss: 0.9791 - val_loss: 0.6016
AUC: 0.8669

Epoch 24/80
 - 0s - loss: 0.9800 - val_loss: 0.6060
AUC: 0.8676

Epoch 25/80
 - 0s - loss: 0.9785 - val_loss: 0.5927
AUC: 0.8668

Epoch 26/80
 - 0s - loss: 0.9773 - val_loss: 0.6470
AUC: 0.8682

Epoch 27/80
 - 0s - loss: 0.9728 - val_loss: 0.6183
AUC: 0.8679

Epoch 28/80
 - 0s - loss: 0.9730 - val_loss: 0.6161
AUC: 0.8678

Epoch 29/80
 - 0s - loss: 0.9760 - val_loss: 0.6156
AUC: 0.8677

Epoch 30/80
 - 0s - loss: 0.9690 - val_loss: 0.6089
AUC: 0.8676

Epoch 31/80
 - 0s - loss: 0.9674 - val_loss: 0.6038
AUC: 0.8678

Epoch 32/80
 - 0s - loss: 0.9729 - val_loss: 0.6117
AUC: 0.8679

Epoch 33/80
 - 0s - loss: 0.9728 - val_loss: 0.6076
AUC: 0.8676

Epoch 34/80
 - 0s - loss: 0.9679 - val_loss: 0.6060
AUC: 0.8676

Epoch 35/80
 - 0s - loss: 0.9677 - val_loss: 0.6134
AUC: 0.8677

Epoch 36/80
 - 0s - loss: 0.9665 - val_loss: 0.5978
AUC: 0.8675

Epoch 37/80
 - 0s - loss: 0.9663 - val_loss: 0.6131
AUC: 0.8680

Epoch 38/80
 - 0s - loss: 0.9645 - val_loss: 0.6055
AUC: 0.8678

Epoch 39/80
 - 0s - loss: 0.9642 - val_loss: 0.6057
AUC: 0.8679

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9758 - val_loss: 0.6136
AUC: 0.8678

Epoch 2/30
 - 1s - loss: 0.9707 - val_loss: 0.6067
AUC: 0.8678

Epoch 3/30
 - 1s - loss: 0.9705 - val_loss: 0.5926
AUC: 0.8676

Epoch 4/30
 - 0s - loss: 0.9719 - val_loss: 0.5957
AUC: 0.8677

Epoch 5/30
 - 0s - loss: 0.9649 - val_loss: 0.6155
AUC: 0.8676

Epoch 6/30
 - 0s - loss: 0.9706 - val_loss: 0.5957
AUC: 0.8675

Epoch 7/30
 - 0s - loss: 0.9629 - val_loss: 0.5797
AUC: 0.8677

Epoch 8/30
 - 0s - loss: 0.9640 - val_loss: 0.6140
AUC: 0.8683

Epoch 9/30
 - 0s - loss: 0.9618 - val_loss: 0.6200
AUC: 0.8685

Epoch 10/30
 - 1s - loss: 0.9632 - val_loss: 0.5939
AUC: 0.8684

Epoch 11/30
 - 0s - loss: 0.9572 - val_loss: 0.5909
AUC: 0.8683

Epoch 12/30
 - 0s - loss: 0.9556 - val_loss: 0.5925
AUC: 0.8687

Epoch 13/30
 - 0s - loss: 0.9559 - val_loss: 0.5819
AUC: 0.8682

Epoch 14/30
 - 0s - loss: 0.9592 - val_loss: 0.6007
AUC: 0.8688

Epoch 15/30
 - 0s - loss: 0.9503 - val_loss: 0.5927
AUC: 0.8686

Epoch 16/30
 - 1s - loss: 0.9512 - val_loss: 0.5841
AUC: 0.8689

Epoch 17/30
 - 0s - loss: 0.9522 - val_loss: 0.5909
AUC: 0.8686

Epoch 18/30
 - 0s - loss: 0.9464 - val_loss: 0.5952
AUC: 0.8688

Epoch 19/30
 - 0s - loss: 0.9527 - val_loss: 0.6003
AUC: 0.8689

Epoch 20/30
 - 0s - loss: 0.9489 - val_loss: 0.5978
AUC: 0.8690

Epoch 21/30
 - 0s - loss: 0.9493 - val_loss: 0.6026
AUC: 0.8691

Epoch 22/30
 - 0s - loss: 0.9467 - val_loss: 0.5934
AUC: 0.8689

Epoch 23/30
 - 0s - loss: 0.9455 - val_loss: 0.5937
AUC: 0.8690

Epoch 24/30
 - 0s - loss: 0.9443 - val_loss: 0.5913
AUC: 0.8690

Epoch 25/30
 - 0s - loss: 0.9427 - val_loss: 0.5953
AUC: 0.8691

Epoch 26/30
 - 0s - loss: 0.9444 - val_loss: 0.5988
AUC: 0.8690

Epoch 27/30
 - 0s - loss: 0.9402 - val_loss: 0.5973
AUC: 0.8689

Epoch 28/30
 - 0s - loss: 0.9425 - val_loss: 0.5966
AUC: 0.8689

Epoch 29/30
 - 0s - loss: 0.9435 - val_loss: 0.5959
AUC: 0.8689

Epoch 30/30
 - 0s - loss: 0.9449 - val_loss: 0.5956
Using TensorFlow backend.
AUC: 0.8689

2019-03-08 06:14:42.448803: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:14:42.613216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:14:42.613263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:14:42.911785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:14:42.911840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:14:42.911850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:14:42.912118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0908
Epoch 2/80
 - 2s - loss: 0.1947
Epoch 3/80
 - 2s - loss: 0.1653
Epoch 4/80
 - 2s - loss: 0.1522
Epoch 5/80
 - 2s - loss: 0.1398
Epoch 6/80
 - 2s - loss: 0.1286
Epoch 7/80
 - 2s - loss: 0.1177
Epoch 8/80
 - 2s - loss: 0.1069
Epoch 9/80
 - 2s - loss: 0.0974
Epoch 10/80
 - 2s - loss: 0.0893
Epoch 11/80
 - 2s - loss: 0.0825
Epoch 12/80
 - 2s - loss: 0.0769
Epoch 13/80
 - 2s - loss: 0.0722
Epoch 14/80
 - 2s - loss: 0.0683
Epoch 15/80
 - 2s - loss: 0.0650
Epoch 16/80
 - 2s - loss: 0.0622
Epoch 17/80
 - 2s - loss: 0.0598
Epoch 18/80
 - 2s - loss: 0.0578
Epoch 19/80
 - 2s - loss: 0.0560
Epoch 20/80
 - 2s - loss: 0.0544
Epoch 21/80
 - 2s - loss: 0.0531
Epoch 22/80
 - 2s - loss: 0.0519
Epoch 23/80
 - 2s - loss: 0.0509
Epoch 24/80
 - 2s - loss: 0.0501
Epoch 25/80
 - 2s - loss: 0.0494
Epoch 26/80
 - 2s - loss: 0.0487
Epoch 27/80
 - 2s - loss: 0.0482
Epoch 28/80
 - 2s - loss: 0.0477
Epoch 29/80
 - 2s - loss: 0.0473
Epoch 30/80
 - 2s - loss: 0.0469
Epoch 31/80
 - 2s - loss: 0.0466
Epoch 32/80
 - 2s - loss: 0.0463
Epoch 33/80
 - 2s - loss: 0.0460
Epoch 34/80
 - 2s - loss: 0.0458
Epoch 35/80
 - 2s - loss: 0.0456
Epoch 36/80
 - 2s - loss: 0.0454
Epoch 37/80
 - 2s - loss: 0.0453
Epoch 38/80
 - 2s - loss: 0.0451
Epoch 39/80
 - 2s - loss: 0.0450
Epoch 40/80
 - 2s - loss: 0.0448
Epoch 41/80
 - 2s - loss: 0.0448
Epoch 42/80
 - 2s - loss: 0.0446
Epoch 43/80
 - 2s - loss: 0.0446
Epoch 44/80
 - 2s - loss: 0.0445
Epoch 45/80
 - 2s - loss: 0.0444
Epoch 46/80
 - 2s - loss: 0.0443
Epoch 47/80
 - 2s - loss: 0.0442
Epoch 48/80
 - 2s - loss: 0.0442
Epoch 49/80
 - 2s - loss: 0.0441
Epoch 50/80
 - 2s - loss: 0.0441
Epoch 51/80
 - 2s - loss: 0.0440
Epoch 52/80
 - 2s - loss: 0.0440
Epoch 53/80
 - 2s - loss: 0.0439
Epoch 54/80
 - 2s - loss: 0.0439
Epoch 55/80
 - 2s - loss: 0.0439
Epoch 56/80
 - 2s - loss: 0.0438
Epoch 57/80
 - 2s - loss: 0.0438
Epoch 58/80
 - 2s - loss: 0.0437
Epoch 59/80
 - 2s - loss: 0.0437
Epoch 60/80
 - 2s - loss: 0.0437
Epoch 61/80
 - 2s - loss: 0.0424
Epoch 62/80
 - 2s - loss: 0.0423
Epoch 63/80
 - 2s - loss: 0.0423
Epoch 64/80
 - 2s - loss: 0.0423
Epoch 65/80
 - 2s - loss: 0.0423
Epoch 66/80
 - 2s - loss: 0.0419
Epoch 67/80
 - 2s - loss: 0.0419
Epoch 68/80
 - 2s - loss: 0.0419
Epoch 69/80
 - 2s - loss: 0.0419
Epoch 70/80
 - 2s - loss: 0.0419
Epoch 71/80
 - 2s - loss: 0.0419
Epoch 72/80
 - 2s - loss: 0.0419
Epoch 73/80
 - 2s - loss: 0.0418
Epoch 74/80
 - 2s - loss: 0.0418
Epoch 75/80
 - 2s - loss: 0.0418
Epoch 76/80
 - 2s - loss: 0.0418
Epoch 77/80
 - 2s - loss: 0.0418
Epoch 78/80
 - 2s - loss: 0.0418
Epoch 79/80
 - 2s - loss: 0.0418
Epoch 80/80
 - 2s - loss: 0.0418
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.9613 - val_loss: 0.9507
AUC: 0.8193

Epoch 2/80
 - 0s - loss: 1.3698 - val_loss: 0.7037
AUC: 0.8392

Epoch 3/80
 - 0s - loss: 1.1789 - val_loss: 0.6392
AUC: 0.8481

Epoch 4/80
 - 0s - loss: 1.1323 - val_loss: 0.7133
AUC: 0.8551

Epoch 5/80
 - 0s - loss: 1.0999 - val_loss: 0.6438
AUC: 0.8548

Epoch 6/80
 - 0s - loss: 1.0870 - val_loss: 0.6995
AUC: 0.8583

Epoch 7/80
 - 0s - loss: 1.0724 - val_loss: 0.5924
AUC: 0.8566

Epoch 8/80
 - 0s - loss: 1.0656 - val_loss: 0.6253
AUC: 0.8603

Epoch 9/80
 - 0s - loss: 1.0541 - val_loss: 0.6122
AUC: 0.8615

Epoch 10/80
 - 0s - loss: 1.0438 - val_loss: 0.6748
AUC: 0.8627

Epoch 11/80
 - 0s - loss: 1.0349 - val_loss: 0.6328
AUC: 0.8624

Epoch 12/80
 - 0s - loss: 1.0330 - val_loss: 0.6384
AUC: 0.8637

Epoch 13/80
 - 0s - loss: 1.0244 - val_loss: 0.5561
AUC: 0.8644

Epoch 14/80
 - 0s - loss: 1.0278 - val_loss: 0.5973
AUC: 0.8641

Epoch 15/80
 - 0s - loss: 1.0196 - val_loss: 0.6006
AUC: 0.8651

Epoch 16/80
 - 0s - loss: 1.0114 - val_loss: 0.6270
AUC: 0.8666

Epoch 17/80
 - 0s - loss: 1.0031 - val_loss: 0.6703
AUC: 0.8670

Epoch 18/80
 - 0s - loss: 1.0004 - val_loss: 0.5887
AUC: 0.8669

Epoch 19/80
 - 0s - loss: 0.9938 - val_loss: 0.6601
AUC: 0.8684

Epoch 20/80
 - 0s - loss: 0.9982 - val_loss: 0.6142
AUC: 0.8648

Epoch 21/80
 - 0s - loss: 0.9980 - val_loss: 0.6334
AUC: 0.8689

Epoch 22/80
 - 0s - loss: 0.9933 - val_loss: 0.6043
AUC: 0.8672

Epoch 23/80
 - 0s - loss: 0.9863 - val_loss: 0.6946
AUC: 0.8694

Epoch 24/80
 - 0s - loss: 0.9838 - val_loss: 0.6272
AUC: 0.8691

Epoch 25/80
 - 0s - loss: 0.9733 - val_loss: 0.5850
AUC: 0.8690

Epoch 26/80
 - 0s - loss: 0.9742 - val_loss: 0.6214
AUC: 0.8693

Epoch 27/80
 - 0s - loss: 0.9732 - val_loss: 0.5865
AUC: 0.8693

Epoch 28/80
 - 0s - loss: 0.9720 - val_loss: 0.6116
AUC: 0.8694

Epoch 29/80
 - 0s - loss: 0.9637 - val_loss: 0.5967
AUC: 0.8693

Epoch 30/80
 - 0s - loss: 0.9735 - val_loss: 0.6001
AUC: 0.8691

Epoch 31/80
 - 0s - loss: 0.9622 - val_loss: 0.6356
AUC: 0.8695

Epoch 32/80
 - 0s - loss: 0.9690 - val_loss: 0.6112
AUC: 0.8695

Epoch 33/80
 - 0s - loss: 0.9670 - val_loss: 0.5709
AUC: 0.8696

Epoch 34/80
 - 0s - loss: 0.9682 - val_loss: 0.6076
AUC: 0.8697

Epoch 35/80
 - 0s - loss: 0.9644 - val_loss: 0.6014
AUC: 0.8696

Epoch 36/80
 - 0s - loss: 0.9603 - val_loss: 0.5964
AUC: 0.8695

Epoch 37/80
 - 0s - loss: 0.9664 - val_loss: 0.5972
AUC: 0.8696

Epoch 38/80
 - 0s - loss: 0.9592 - val_loss: 0.6075
AUC: 0.8696

Epoch 39/80
 - 0s - loss: 0.9613 - val_loss: 0.6083
AUC: 0.8697

Epoch 40/80
 - 0s - loss: 0.9593 - val_loss: 0.5967
AUC: 0.8696

Epoch 41/80
 - 0s - loss: 0.9611 - val_loss: 0.5921
AUC: 0.8696

Epoch 42/80
 - 0s - loss: 0.9589 - val_loss: 0.6003
AUC: 0.8697

Epoch 43/80
 - 0s - loss: 0.9611 - val_loss: 0.5922
AUC: 0.8698

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9607 - val_loss: 0.5843
AUC: 0.8695

Epoch 2/30
 - 0s - loss: 0.9687 - val_loss: 0.6012
AUC: 0.8698

Epoch 3/30
 - 0s - loss: 0.9643 - val_loss: 0.6158
AUC: 0.8700

Epoch 4/30
 - 0s - loss: 0.9613 - val_loss: 0.5996
AUC: 0.8699

Epoch 5/30
 - 0s - loss: 0.9549 - val_loss: 0.6073
AUC: 0.8701

Epoch 6/30
 - 0s - loss: 0.9564 - val_loss: 0.5909
AUC: 0.8699

Epoch 7/30
 - 1s - loss: 0.9594 - val_loss: 0.6052
AUC: 0.8702

Epoch 8/30
 - 0s - loss: 0.9550 - val_loss: 0.6165
AUC: 0.8702

Epoch 9/30
 - 0s - loss: 0.9613 - val_loss: 0.5981
AUC: 0.8702

Epoch 10/30
 - 0s - loss: 0.9510 - val_loss: 0.6001
AUC: 0.8701

Epoch 11/30
 - 0s - loss: 0.9447 - val_loss: 0.5970
AUC: 0.8703

Epoch 12/30
 - 1s - loss: 0.9463 - val_loss: 0.5946
AUC: 0.8703

Epoch 13/30
 - 0s - loss: 0.9461 - val_loss: 0.5950
AUC: 0.8703

Epoch 14/30
 - 0s - loss: 0.9484 - val_loss: 0.5920
AUC: 0.8703

Epoch 15/30
 - 0s - loss: 0.9453 - val_loss: 0.5929
AUC: 0.8703

Epoch 16/30
 - 0s - loss: 0.9474 - val_loss: 0.5953
AUC: 0.8704

Epoch 17/30
 - 0s - loss: 0.9440 - val_loss: 0.5913
AUC: 0.8703

Epoch 18/30
 - 0s - loss: 0.9433 - val_loss: 0.5914
AUC: 0.8703

Epoch 19/30
 - 0s - loss: 0.9447 - val_loss: 0.5900
AUC: 0.8703

Epoch 20/30
 - 0s - loss: 0.9496 - val_loss: 0.5931
AUC: 0.8704

Epoch 21/30
 - 0s - loss: 0.9464 - val_loss: 0.5916
AUC: 0.8704

Epoch 22/30
 - 0s - loss: 0.9414 - val_loss: 0.5913
AUC: 0.8704

Epoch 23/30
 - 0s - loss: 0.9485 - val_loss: 0.5920
AUC: 0.8704

Epoch 24/30
 - 0s - loss: 0.9434 - val_loss: 0.5927
AUC: 0.8704

Epoch 25/30
 - 0s - loss: 0.9429 - val_loss: 0.5928
AUC: 0.8704

Epoch 26/30
 - 0s - loss: 0.9451 - val_loss: 0.5923
AUC: 0.8704

Epoch 27/30
 - 0s - loss: 0.9447 - val_loss: 0.5931
AUC: 0.8704

Epoch 28/30
 - 0s - loss: 0.9473 - val_loss: 0.5927
AUC: 0.8704

Epoch 29/30
 - 0s - loss: 0.9458 - val_loss: 0.5924
AUC: 0.8704

Epoch 30/30
 - 0s - loss: 0.9491 - val_loss: 0.5932
Using TensorFlow backend.
AUC: 0.8704

2019-03-08 06:18:31.186184: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:18:31.354577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:18:31.354624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:18:31.658084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:18:31.658127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:18:31.658136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:18:31.658400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6470
Epoch 2/80
 - 2s - loss: 0.1016
Epoch 3/80
 - 2s - loss: 0.0685
Epoch 4/80
 - 2s - loss: 0.0635
Epoch 5/80
 - 2s - loss: 0.0599
Epoch 6/80
 - 2s - loss: 0.0558
Epoch 7/80
 - 2s - loss: 0.0513
Epoch 8/80
 - 2s - loss: 0.0470
Epoch 9/80
 - 2s - loss: 0.0429
Epoch 10/80
 - 2s - loss: 0.0389
Epoch 11/80
 - 2s - loss: 0.0353
Epoch 12/80
 - 2s - loss: 0.0323
Epoch 13/80
 - 2s - loss: 0.0298
Epoch 14/80
 - 2s - loss: 0.0277
Epoch 15/80
 - 2s - loss: 0.0260
Epoch 16/80
 - 2s - loss: 0.0245
Epoch 17/80
 - 2s - loss: 0.0232
Epoch 18/80
 - 2s - loss: 0.0220
Epoch 19/80
 - 2s - loss: 0.0210
Epoch 20/80
 - 2s - loss: 0.0202
Epoch 21/80
 - 2s - loss: 0.0194
Epoch 22/80
 - 2s - loss: 0.0188
Epoch 23/80
 - 2s - loss: 0.0182
Epoch 24/80
 - 2s - loss: 0.0177
Epoch 25/80
 - 2s - loss: 0.0173
Epoch 26/80
 - 2s - loss: 0.0169
Epoch 27/80
 - 2s - loss: 0.0165
Epoch 28/80
 - 2s - loss: 0.0163
Epoch 29/80
 - 2s - loss: 0.0160
Epoch 30/80
 - 2s - loss: 0.0158
Epoch 31/80
 - 2s - loss: 0.0156
Epoch 32/80
 - 2s - loss: 0.0154
Epoch 33/80
 - 2s - loss: 0.0153
Epoch 34/80
 - 2s - loss: 0.0151
Epoch 35/80
 - 2s - loss: 0.0150
Epoch 36/80
 - 2s - loss: 0.0149
Epoch 37/80
 - 2s - loss: 0.0148
Epoch 38/80
 - 2s - loss: 0.0148
Epoch 39/80
 - 2s - loss: 0.0147
Epoch 40/80
 - 2s - loss: 0.0146
Epoch 41/80
 - 2s - loss: 0.0146
Epoch 42/80
 - 2s - loss: 0.0145
Epoch 43/80
 - 2s - loss: 0.0145
Epoch 44/80
 - 2s - loss: 0.0144
Epoch 45/80
 - 2s - loss: 0.0144
Epoch 46/80
 - 2s - loss: 0.0143
Epoch 47/80
 - 2s - loss: 0.0143
Epoch 48/80
 - 2s - loss: 0.0143
Epoch 49/80
 - 2s - loss: 0.0142
Epoch 50/80
 - 2s - loss: 0.0142
Epoch 51/80
 - 2s - loss: 0.0142
Epoch 52/80
 - 2s - loss: 0.0138
Epoch 53/80
 - 2s - loss: 0.0137
Epoch 54/80
 - 2s - loss: 0.0137
Epoch 55/80
 - 2s - loss: 0.0137
Epoch 56/80
 - 2s - loss: 0.0136
Epoch 57/80
 - 2s - loss: 0.0136
Epoch 58/80
 - 2s - loss: 0.0136
Epoch 59/80
 - 2s - loss: 0.0136
Epoch 60/80
 - 2s - loss: 0.0135
Epoch 61/80
 - 2s - loss: 0.0135
Epoch 62/80
 - 2s - loss: 0.0135
Epoch 63/80
 - 2s - loss: 0.0135
Epoch 64/80
 - 2s - loss: 0.0135
Epoch 65/80
 - 2s - loss: 0.0135
Epoch 66/80
 - 2s - loss: 0.0135
Epoch 67/80
 - 2s - loss: 0.0135
Epoch 68/80
 - 2s - loss: 0.0135
Epoch 69/80
 - 2s - loss: 0.0135
Epoch 70/80
 - 2s - loss: 0.0135
Epoch 71/80
 - 2s - loss: 0.0135
Epoch 72/80
 - 2s - loss: 0.0135
Epoch 73/80
 - 2s - loss: 0.0135
Epoch 74/80
 - 2s - loss: 0.0135
Epoch 75/80
 - 2s - loss: 0.0135
Epoch 76/80
 - 2s - loss: 0.0135
Epoch 77/80
 - 2s - loss: 0.0135
Epoch 78/80
 - 2s - loss: 0.0135
Epoch 79/80
 - 2s - loss: 0.0135
Epoch 80/80
 - 2s - loss: 0.0135
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.5218 - val_loss: 0.8205
AUC: 0.7970

Epoch 2/80
 - 0s - loss: 1.3428 - val_loss: 0.7450
AUC: 0.8292

Epoch 3/80
 - 0s - loss: 1.1770 - val_loss: 0.6560
AUC: 0.8410

Epoch 4/80
 - 0s - loss: 1.1376 - val_loss: 0.7547
AUC: 0.8502

Epoch 5/80
 - 0s - loss: 1.0894 - val_loss: 0.6473
AUC: 0.8523

Epoch 6/80
 - 0s - loss: 1.0730 - val_loss: 0.6138
AUC: 0.8556

Epoch 7/80
 - 0s - loss: 1.0747 - val_loss: 0.6306
AUC: 0.8592

Epoch 8/80
 - 0s - loss: 1.0553 - val_loss: 0.7078
AUC: 0.8612

Epoch 9/80
 - 0s - loss: 1.0367 - val_loss: 0.6224
AUC: 0.8595

Epoch 10/80
 - 0s - loss: 1.0470 - val_loss: 0.7361
AUC: 0.8629

Epoch 11/80
 - 0s - loss: 1.0345 - val_loss: 0.6592
AUC: 0.8636

Epoch 12/80
 - 0s - loss: 1.0318 - val_loss: 0.6726
AUC: 0.8637

Epoch 13/80
 - 0s - loss: 1.0271 - val_loss: 0.5878
AUC: 0.8631

Epoch 14/80
 - 0s - loss: 1.0161 - val_loss: 0.6397
AUC: 0.8624

Epoch 15/80
 - 0s - loss: 1.0149 - val_loss: 0.6502
AUC: 0.8650

Epoch 16/80
 - 0s - loss: 1.0171 - val_loss: 0.6246
AUC: 0.8666

Epoch 17/80
 - 0s - loss: 1.0046 - val_loss: 0.6030
AUC: 0.8642

Epoch 18/80
 - 0s - loss: 0.9999 - val_loss: 0.6156
AUC: 0.8649

Epoch 19/80
 - 0s - loss: 1.0007 - val_loss: 0.6372
AUC: 0.8647

Epoch 20/80
 - 0s - loss: 0.9977 - val_loss: 0.5938
AUC: 0.8663

Epoch 21/80
 - 0s - loss: 0.9976 - val_loss: 0.6065
AUC: 0.8669

Epoch 22/80
 - 0s - loss: 0.9917 - val_loss: 0.6076
AUC: 0.8660

Epoch 23/80
 - 0s - loss: 0.9849 - val_loss: 0.6059
AUC: 0.8665

Epoch 24/80
 - 0s - loss: 0.9718 - val_loss: 0.6095
AUC: 0.8663

Epoch 25/80
 - 0s - loss: 0.9738 - val_loss: 0.6147
AUC: 0.8665

Epoch 26/80
 - 0s - loss: 0.9716 - val_loss: 0.5958
AUC: 0.8657

Epoch 27/80
 - 0s - loss: 0.9765 - val_loss: 0.6082
AUC: 0.8667

Epoch 28/80
 - 0s - loss: 0.9687 - val_loss: 0.5775
AUC: 0.8660

Epoch 29/80
 - 0s - loss: 0.9684 - val_loss: 0.6326
AUC: 0.8668

Epoch 30/80
 - 0s - loss: 0.9665 - val_loss: 0.6191
AUC: 0.8664

Epoch 31/80
 - 0s - loss: 0.9681 - val_loss: 0.5974
AUC: 0.8662

Epoch 32/80
 - 0s - loss: 0.9681 - val_loss: 0.6308
AUC: 0.8667

Epoch 33/80
 - 0s - loss: 0.9720 - val_loss: 0.5980
AUC: 0.8664

Epoch 34/80
 - 0s - loss: 0.9671 - val_loss: 0.5949
AUC: 0.8664

Epoch 35/80
 - 0s - loss: 0.9634 - val_loss: 0.6177
AUC: 0.8669

Epoch 36/80
 - 0s - loss: 0.9672 - val_loss: 0.6054
AUC: 0.8667

Epoch 37/80
 - 0s - loss: 0.9660 - val_loss: 0.6022
AUC: 0.8665

Epoch 38/80
 - 0s - loss: 0.9597 - val_loss: 0.6317
AUC: 0.8667

Epoch 39/80
 - 0s - loss: 0.9595 - val_loss: 0.5922
AUC: 0.8663

Epoch 40/80
 - 0s - loss: 0.9594 - val_loss: 0.6014
AUC: 0.8665

Epoch 41/80
 - 0s - loss: 0.9587 - val_loss: 0.5877
AUC: 0.8662

Epoch 42/80
 - 0s - loss: 0.9576 - val_loss: 0.6006
AUC: 0.8665

Epoch 43/80
 - 0s - loss: 0.9597 - val_loss: 0.6016
AUC: 0.8665

Epoch 44/80
 - 0s - loss: 0.9590 - val_loss: 0.5951
AUC: 0.8664

Epoch 45/80
 - 0s - loss: 0.9553 - val_loss: 0.5955
AUC: 0.8664

Epoch 46/80
 - 0s - loss: 0.9562 - val_loss: 0.5937
AUC: 0.8663

Epoch 47/80
 - 0s - loss: 0.9508 - val_loss: 0.5947
AUC: 0.8665

Epoch 48/80
 - 0s - loss: 0.9608 - val_loss: 0.6069
AUC: 0.8667

Epoch 49/80
 - 0s - loss: 0.9505 - val_loss: 0.6002
AUC: 0.8666

Epoch 50/80
 - 0s - loss: 0.9522 - val_loss: 0.5987
AUC: 0.8666

Epoch 51/80
 - 0s - loss: 0.9580 - val_loss: 0.5975
AUC: 0.8666

Epoch 52/80
 - 0s - loss: 0.9590 - val_loss: 0.5979
AUC: 0.8666

Epoch 53/80
 - 0s - loss: 0.9566 - val_loss: 0.5972
AUC: 0.8666

Epoch 54/80
 - 0s - loss: 0.9545 - val_loss: 0.5973
AUC: 0.8665

Epoch 55/80
 - 0s - loss: 0.9547 - val_loss: 0.5972
AUC: 0.8666

Epoch 56/80
 - 0s - loss: 0.9473 - val_loss: 0.5972
AUC: 0.8665

Epoch 57/80
 - 0s - loss: 0.9561 - val_loss: 0.5972
AUC: 0.8665

Epoch 58/80
 - 0s - loss: 0.9526 - val_loss: 0.5975
AUC: 0.8665

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9790 - val_loss: 0.6065
AUC: 0.8665

Epoch 2/30
 - 0s - loss: 0.9806 - val_loss: 0.6046
AUC: 0.8666

Epoch 3/30
 - 0s - loss: 0.9801 - val_loss: 0.5933
AUC: 0.8664

Epoch 4/30
 - 0s - loss: 0.9766 - val_loss: 0.5999
AUC: 0.8664

Epoch 5/30
 - 0s - loss: 0.9721 - val_loss: 0.6362
AUC: 0.8670

Epoch 6/30
 - 0s - loss: 0.9711 - val_loss: 0.6056
AUC: 0.8668

Epoch 7/30
 - 0s - loss: 0.9711 - val_loss: 0.5962
AUC: 0.8667

Epoch 8/30
 - 0s - loss: 0.9626 - val_loss: 0.5815
AUC: 0.8666

Epoch 9/30
 - 0s - loss: 0.9650 - val_loss: 0.5947
AUC: 0.8667

Epoch 10/30
 - 1s - loss: 0.9628 - val_loss: 0.6100
AUC: 0.8671

Epoch 11/30
 - 1s - loss: 0.9588 - val_loss: 0.6036
AUC: 0.8669

Epoch 12/30
 - 1s - loss: 0.9574 - val_loss: 0.5967
AUC: 0.8669

Epoch 13/30
 - 1s - loss: 0.9596 - val_loss: 0.6163
AUC: 0.8672

Epoch 14/30
 - 1s - loss: 0.9568 - val_loss: 0.6028
AUC: 0.8672

Epoch 15/30
 - 0s - loss: 0.9537 - val_loss: 0.6168
AUC: 0.8675

Epoch 16/30
 - 0s - loss: 0.9576 - val_loss: 0.5908
AUC: 0.8671

Epoch 17/30
 - 0s - loss: 0.9543 - val_loss: 0.6052
AUC: 0.8672

Epoch 18/30
 - 0s - loss: 0.9589 - val_loss: 0.5948
AUC: 0.8672

Epoch 19/30
 - 0s - loss: 0.9469 - val_loss: 0.5987
AUC: 0.8672

Epoch 20/30
 - 0s - loss: 0.9509 - val_loss: 0.5927
AUC: 0.8671

Epoch 21/30
 - 0s - loss: 0.9484 - val_loss: 0.5978
AUC: 0.8672

Epoch 22/30
 - 0s - loss: 0.9480 - val_loss: 0.5924
AUC: 0.8671

Epoch 23/30
 - 0s - loss: 0.9475 - val_loss: 0.5913
AUC: 0.8672

Epoch 24/30
 - 0s - loss: 0.9430 - val_loss: 0.5944
AUC: 0.8673

Epoch 25/30
 - 0s - loss: 0.9498 - val_loss: 0.5941
AUC: 0.8673

Epoch 26/30
 - 0s - loss: 0.9492 - val_loss: 0.5931
AUC: 0.8674

Epoch 27/30
 - 0s - loss: 0.9504 - val_loss: 0.5913
AUC: 0.8673

Epoch 28/30
 - 0s - loss: 0.9511 - val_loss: 0.5915
AUC: 0.8673

Epoch 29/30
 - 0s - loss: 0.9526 - val_loss: 0.5923
AUC: 0.8674

Epoch 30/30
 - 0s - loss: 0.9485 - val_loss: 0.5922
Using TensorFlow backend.
AUC: 0.8674

2019-03-08 06:22:32.735413: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:22:32.902001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:22:32.902048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:22:33.207345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:22:33.207395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:22:33.207405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:22:33.207670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6605
Epoch 2/80
 - 2s - loss: 0.1039
Epoch 3/80
 - 2s - loss: 0.0693
Epoch 4/80
 - 2s - loss: 0.0633
Epoch 5/80
 - 2s - loss: 0.0591
Epoch 6/80
 - 2s - loss: 0.0548
Epoch 7/80
 - 2s - loss: 0.0508
Epoch 8/80
 - 2s - loss: 0.0469
Epoch 9/80
 - 2s - loss: 0.0429
Epoch 10/80
 - 2s - loss: 0.0389
Epoch 11/80
 - 2s - loss: 0.0353
Epoch 12/80
 - 2s - loss: 0.0322
Epoch 13/80
 - 2s - loss: 0.0296
Epoch 14/80
 - 2s - loss: 0.0275
Epoch 15/80
 - 2s - loss: 0.0256
Epoch 16/80
 - 2s - loss: 0.0241
Epoch 17/80
 - 2s - loss: 0.0228
Epoch 18/80
 - 2s - loss: 0.0217
Epoch 19/80
 - 2s - loss: 0.0208
Epoch 20/80
 - 2s - loss: 0.0199
Epoch 21/80
 - 2s - loss: 0.0192
Epoch 22/80
 - 2s - loss: 0.0186
Epoch 23/80
 - 2s - loss: 0.0181
Epoch 24/80
 - 2s - loss: 0.0176
Epoch 25/80
 - 2s - loss: 0.0172
Epoch 26/80
 - 2s - loss: 0.0169
Epoch 27/80
 - 2s - loss: 0.0165
Epoch 28/80
 - 2s - loss: 0.0163
Epoch 29/80
 - 2s - loss: 0.0160
Epoch 30/80
 - 2s - loss: 0.0158
Epoch 31/80
 - 2s - loss: 0.0156
Epoch 32/80
 - 2s - loss: 0.0154
Epoch 33/80
 - 2s - loss: 0.0153
Epoch 34/80
 - 2s - loss: 0.0152
Epoch 35/80
 - 2s - loss: 0.0151
Epoch 36/80
 - 2s - loss: 0.0150
Epoch 37/80
 - 2s - loss: 0.0149
Epoch 38/80
 - 2s - loss: 0.0148
Epoch 39/80
 - 2s - loss: 0.0147
Epoch 40/80
 - 2s - loss: 0.0147
Epoch 41/80
 - 2s - loss: 0.0146
Epoch 42/80
 - 2s - loss: 0.0145
Epoch 43/80
 - 2s - loss: 0.0145
Epoch 44/80
 - 2s - loss: 0.0144
Epoch 45/80
 - 2s - loss: 0.0144
Epoch 46/80
 - 2s - loss: 0.0144
Epoch 47/80
 - 2s - loss: 0.0143
Epoch 48/80
 - 2s - loss: 0.0143
Epoch 49/80
 - 2s - loss: 0.0143
Epoch 50/80
 - 2s - loss: 0.0142
Epoch 51/80
 - 2s - loss: 0.0142
Epoch 52/80
 - 2s - loss: 0.0138
Epoch 53/80
 - 2s - loss: 0.0137
Epoch 54/80
 - 2s - loss: 0.0137
Epoch 55/80
 - 2s - loss: 0.0137
Epoch 56/80
 - 2s - loss: 0.0136
Epoch 57/80
 - 2s - loss: 0.0136
Epoch 58/80
 - 2s - loss: 0.0136
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 06:24:49.059236: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:24:49.226703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:24:49.226747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:24:49.530297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:24:49.530379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:24:49.530389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:24:49.530684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6549
Epoch 2/80
 - 2s - loss: 0.1046
Epoch 3/80
 - 2s - loss: 0.0690
Epoch 4/80
 - 2s - loss: 0.0632
Epoch 5/80
 - 2s - loss: 0.0572
Epoch 6/80
 - 2s - loss: 0.0515
Epoch 7/80
 - 2s - loss: 0.0472
Epoch 8/80
 - 2s - loss: 0.0438
Epoch 9/80
 - 2s - loss: 0.0406
Epoch 10/80
 - 2s - loss: 0.0376
Epoch 11/80
 - 2s - loss: 0.0347
Epoch 12/80
 - 2s - loss: 0.0320
Epoch 13/80
 - 2s - loss: 0.0296
Epoch 14/80
 - 2s - loss: 0.0275
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 06:25:35.127780: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:25:35.297814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:25:35.297861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:25:35.596104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:25:35.596159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:25:35.596169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:25:35.596437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3025
Epoch 2/80
 - 2s - loss: 0.3338
Epoch 3/80
 - 2s - loss: 0.3007
Epoch 4/80
 - 2s - loss: 0.2783
Epoch 5/80
 - 2s - loss: 0.2496
Epoch 6/80
 - 2s - loss: 0.2210
Epoch 7/80
 - 2s - loss: 0.1999
Epoch 8/80
 - 2s - loss: 0.1844
Epoch 9/80
 - 2s - loss: 0.1723
Epoch 10/80
 - 2s - loss: 0.1623
Epoch 11/80
 - 2s - loss: 0.1540
Epoch 12/80
 - 2s - loss: 0.1470
Epoch 13/80
 - 2s - loss: 0.1409
Epoch 14/80
 - 2s - loss: 0.1356
Epoch 15/80
 - 2s - loss: 0.1312
Epoch 16/80
 - 2s - loss: 0.1273
Epoch 17/80
 - 2s - loss: 0.1240
Epoch 18/80
 - 2s - loss: 0.1211
Epoch 19/80
 - 2s - loss: 0.1186
Epoch 20/80
 - 2s - loss: 0.1164
Epoch 21/80
 - 2s - loss: 0.1145
Epoch 22/80
 - 2s - loss: 0.1129
Epoch 23/80
 - 2s - loss: 0.1115
Epoch 24/80
 - 2s - loss: 0.1103
Epoch 25/80
 - 2s - loss: 0.1092
Epoch 26/80
 - 2s - loss: 0.1083
Epoch 27/80
 - 2s - loss: 0.1075
Epoch 28/80
 - 2s - loss: 0.1069
Epoch 29/80
 - 2s - loss: 0.1063
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 06:26:55.090055: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:26:55.265606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:26:55.265655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:26:55.565092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:26:55.565149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:26:55.565159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:26:55.565439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2866
Epoch 2/80
 - 2s - loss: 0.3316
Epoch 3/80
 - 2s - loss: 0.2890
Epoch 4/80
 - 2s - loss: 0.2615
Epoch 5/80
 - 2s - loss: 0.2386
Epoch 6/80
 - 2s - loss: 0.2200
Epoch 7/80
 - 2s - loss: 0.2048
Epoch 8/80
 - 2s - loss: 0.1908
Epoch 9/80
 - 2s - loss: 0.1777
Epoch 10/80
 - 2s - loss: 0.1662
Epoch 11/80
 - 2s - loss: 0.1568
Epoch 12/80
 - 2s - loss: 0.1491
Epoch 13/80
 - 2s - loss: 0.1424
Epoch 14/80
 - 2s - loss: 0.1367
Epoch 15/80
 - 2s - loss: 0.1318
Epoch 16/80
 - 2s - loss: 0.1277
Epoch 17/80
 - 2s - loss: 0.1242
Epoch 18/80
 - 2s - loss: 0.1213
Epoch 19/80
 - 2s - loss: 0.1188
Epoch 20/80
 - 2s - loss: 0.1166
Epoch 21/80
 - 2s - loss: 0.1147
Epoch 22/80
 - 2s - loss: 0.1131
Epoch 23/80
 - 2s - loss: 0.1117
Epoch 24/80
 - 2s - loss: 0.1104
Epoch 25/80
 - 2s - loss: 0.1094
Epoch 26/80
 - 2s - loss: 0.1085
Epoch 27/80
 - 2s - loss: 0.1077
Epoch 28/80
 - 2s - loss: 0.1071
Epoch 29/80
 - 2s - loss: 0.1065
Epoch 30/80
 - 2s - loss: 0.1060
Epoch 31/80
 - 2s - loss: 0.1056
Epoch 32/80
 - 2s - loss: 0.1052
Epoch 33/80
 - 2s - loss: 0.1048
Epoch 34/80
 - 2s - loss: 0.1045
Epoch 35/80
 - 2s - loss: 0.1042
Epoch 36/80
 - 2s - loss: 0.1040
Epoch 37/80
 - 2s - loss: 0.1037
Epoch 38/80
 - 2s - loss: 0.1035
Epoch 39/80
 - 2s - loss: 0.1033
Epoch 40/80
 - 2s - loss: 0.1032
Epoch 41/80
 - 2s - loss: 0.1030
Epoch 42/80
 - 2s - loss: 0.1029
Epoch 43/80
 - 2s - loss: 0.1027
Epoch 44/80
 - 2s - loss: 0.1026
Epoch 45/80
 - 2s - loss: 0.1025
Epoch 46/80
 - 2s - loss: 0.1024
Epoch 47/80
 - 2s - loss: 0.1023
Epoch 48/80
 - 2s - loss: 0.1022
Epoch 49/80
 - 2s - loss: 0.1021
Epoch 50/80
 - 2s - loss: 0.1020
Epoch 51/80
 - 2s - loss: 0.1019
Epoch 52/80
 - 2s - loss: 0.1019
Epoch 53/80
 - 2s - loss: 0.1017
Epoch 54/80
 - 2s - loss: 0.1017
Epoch 55/80
 - 2s - loss: 0.1017
Epoch 56/80
 - 2s - loss: 0.1016
Epoch 57/80
 - 2s - loss: 0.1015
Epoch 58/80
 - 2s - loss: 0.1014
Epoch 59/80
 - 2s - loss: 0.1014
Epoch 60/80
 - 2s - loss: 0.1014
Epoch 61/80
 - 2s - loss: 0.1013
Epoch 62/80
 - 2s - loss: 0.0987
Epoch 63/80
 - 2s - loss: 0.0984
Epoch 64/80
 - 2s - loss: 0.0984
Epoch 65/80
 - 2s - loss: 0.0984
Epoch 66/80
 - 2s - loss: 0.0983
Epoch 67/80
 - 2s - loss: 0.0977
Epoch 68/80
 - 2s - loss: 0.0977
Epoch 69/80
 - 2s - loss: 0.0977
Epoch 70/80
 - 2s - loss: 0.0977
Epoch 71/80
 - 2s - loss: 0.0975
Epoch 72/80
 - 2s - loss: 0.0975
Epoch 73/80
 - 2s - loss: 0.0975
Epoch 74/80
 - 2s - loss: 0.0975
Epoch 75/80
 - 2s - loss: 0.0975
Epoch 76/80
 - 2s - loss: 0.0975
Epoch 77/80
 - 2s - loss: 0.0975
Epoch 78/80
 - 2s - loss: 0.0975
Epoch 79/80
 - 2s - loss: 0.0975
Epoch 80/80
 - 2s - loss: 0.0975
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 7.2699 - val_loss: 1.3215
AUC: 0.6944

Epoch 2/80
 - 0s - loss: 3.3960 - val_loss: 1.4348
AUC: 0.7741

Epoch 3/80
 - 0s - loss: 2.7961 - val_loss: 1.0741
AUC: 0.7996

Epoch 4/80
 - 0s - loss: 2.0661 - val_loss: 0.9353
AUC: 0.8233

Epoch 5/80
 - 0s - loss: 1.6662 - val_loss: 0.8059
AUC: 0.8319

Epoch 6/80
 - 0s - loss: 1.4316 - val_loss: 0.7786
AUC: 0.8390

Epoch 7/80
 - 0s - loss: 1.2931 - val_loss: 0.7205
AUC: 0.8424

Epoch 8/80
 - 0s - loss: 1.2216 - val_loss: 0.7061
AUC: 0.8465

Epoch 9/80
 - 0s - loss: 1.1730 - val_loss: 0.7515
AUC: 0.8489

Epoch 10/80
 - 0s - loss: 1.1436 - val_loss: 0.7481
AUC: 0.8516

Epoch 11/80
 - 0s - loss: 1.1214 - val_loss: 0.7021
AUC: 0.8542

Epoch 12/80
 - 0s - loss: 1.0997 - val_loss: 0.6613
AUC: 0.8542

Epoch 13/80
 - 0s - loss: 1.0897 - val_loss: 0.6386
AUC: 0.8544

Epoch 14/80
 - 0s - loss: 1.0799 - val_loss: 0.7132
AUC: 0.8580

Epoch 15/80
 - 0s - loss: 1.0782 - val_loss: 0.6735
AUC: 0.8579

Epoch 16/80
 - 0s - loss: 1.0713 - val_loss: 0.6071
AUC: 0.8581

Epoch 17/80
 - 0s - loss: 1.0612 - val_loss: 0.6057
AUC: 0.8581

Epoch 18/80
 - 0s - loss: 1.0589 - val_loss: 0.7197
AUC: 0.8615

Epoch 19/80
 - 0s - loss: 1.0527 - val_loss: 0.6023
AUC: 0.8602

Epoch 20/80
 - 0s - loss: 1.0497 - val_loss: 0.6370
AUC: 0.8622

Epoch 21/80
 - 0s - loss: 1.0419 - val_loss: 0.6577
AUC: 0.8624

Epoch 22/80
 - 0s - loss: 1.0441 - val_loss: 0.6883
AUC: 0.8634

Epoch 23/80
 - 0s - loss: 1.0376 - val_loss: 0.5873
AUC: 0.8624

Epoch 24/80
 - 0s - loss: 1.0383 - val_loss: 0.5824
AUC: 0.8639

Epoch 25/80
 - 0s - loss: 1.0257 - val_loss: 0.6263
AUC: 0.8641

Epoch 26/80
 - 0s - loss: 1.0232 - val_loss: 0.6610
AUC: 0.8651

Epoch 27/80
 - 0s - loss: 1.0208 - val_loss: 0.6126
AUC: 0.8650

Epoch 28/80
 - 0s - loss: 1.0140 - val_loss: 0.6377
AUC: 0.8660

Epoch 29/80
 - 0s - loss: 1.0169 - val_loss: 0.6141
AUC: 0.8663

Epoch 30/80
 - 0s - loss: 1.0101 - val_loss: 0.6304
AUC: 0.8662

Epoch 31/80
 - 0s - loss: 1.0090 - val_loss: 0.5968
AUC: 0.8666

Epoch 32/80
 - 0s - loss: 1.0083 - val_loss: 0.6318
AUC: 0.8674

Epoch 33/80
 - 0s - loss: 1.0073 - val_loss: 0.5843
AUC: 0.8670

Epoch 34/80
 - 0s - loss: 1.0111 - val_loss: 0.6772
AUC: 0.8679

Epoch 35/80
 - 0s - loss: 1.0010 - val_loss: 0.6220
AUC: 0.8677

Epoch 36/80
 - 0s - loss: 0.9925 - val_loss: 0.6229
AUC: 0.8675

Epoch 37/80
 - 0s - loss: 0.9933 - val_loss: 0.6200
AUC: 0.8677

Epoch 38/80
 - 0s - loss: 0.9989 - val_loss: 0.6118
AUC: 0.8677

Epoch 39/80
 - 0s - loss: 0.9901 - val_loss: 0.6113
AUC: 0.8676

Epoch 40/80
 - 0s - loss: 0.9946 - val_loss: 0.6216
AUC: 0.8676

Epoch 41/80
 - 0s - loss: 0.9910 - val_loss: 0.5914
AUC: 0.8676

Epoch 42/80
 - 0s - loss: 0.9858 - val_loss: 0.6166
AUC: 0.8676

Epoch 43/80
 - 0s - loss: 0.9884 - val_loss: 0.6114
AUC: 0.8677

Epoch 44/80
 - 0s - loss: 0.9930 - val_loss: 0.6089
AUC: 0.8678

Epoch 45/80
 - 0s - loss: 0.9932 - val_loss: 0.6117
AUC: 0.8678

Epoch 46/80
 - 0s - loss: 0.9901 - val_loss: 0.6099
AUC: 0.8678

Epoch 47/80
 - 0s - loss: 0.9894 - val_loss: 0.6078
AUC: 0.8678

Epoch 48/80
 - 0s - loss: 0.9952 - val_loss: 0.6137
AUC: 0.8678

Epoch 49/80
 - 0s - loss: 0.9896 - val_loss: 0.6115
AUC: 0.8678

Epoch 50/80
 - 0s - loss: 0.9885 - val_loss: 0.6063
AUC: 0.8677

Epoch 51/80
 - 0s - loss: 0.9887 - val_loss: 0.6134
AUC: 0.8678

Epoch 52/80
 - 0s - loss: 0.9851 - val_loss: 0.6058
AUC: 0.8678

Epoch 53/80
 - 0s - loss: 0.9868 - val_loss: 0.6124
AUC: 0.8678

Epoch 54/80
 - 0s - loss: 0.9899 - val_loss: 0.6096
AUC: 0.8678

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9954 - val_loss: 0.6269
AUC: 0.8676

Epoch 2/30
 - 0s - loss: 0.9974 - val_loss: 0.6175
AUC: 0.8678

Epoch 3/30
 - 0s - loss: 0.9902 - val_loss: 0.6199
AUC: 0.8679

Epoch 4/30
 - 0s - loss: 0.9921 - val_loss: 0.6365
AUC: 0.8682

Epoch 5/30
 - 0s - loss: 0.9911 - val_loss: 0.5972
AUC: 0.8681

Epoch 6/30
 - 0s - loss: 0.9805 - val_loss: 0.6156
AUC: 0.8684

Epoch 7/30
 - 0s - loss: 0.9881 - val_loss: 0.6035
AUC: 0.8684

Epoch 8/30
 - 0s - loss: 0.9841 - val_loss: 0.6058
AUC: 0.8685

Epoch 9/30
 - 0s - loss: 0.9831 - val_loss: 0.5994
AUC: 0.8687

Epoch 10/30
 - 0s - loss: 0.9831 - val_loss: 0.6112
AUC: 0.8690

Epoch 11/30
 - 0s - loss: 0.9800 - val_loss: 0.6181
AUC: 0.8692

Epoch 12/30
 - 0s - loss: 0.9719 - val_loss: 0.5986
AUC: 0.8690

Epoch 13/30
 - 0s - loss: 0.9778 - val_loss: 0.6127
AUC: 0.8692

Epoch 14/30
 - 0s - loss: 0.9745 - val_loss: 0.5948
AUC: 0.8692

Epoch 15/30
 - 0s - loss: 0.9739 - val_loss: 0.5980
AUC: 0.8694

Epoch 16/30
 - 0s - loss: 0.9759 - val_loss: 0.6130
AUC: 0.8697

Epoch 17/30
 - 0s - loss: 0.9724 - val_loss: 0.6239
AUC: 0.8699

Epoch 18/30
 - 0s - loss: 0.9637 - val_loss: 0.5938
AUC: 0.8697

Epoch 19/30
 - 0s - loss: 0.9682 - val_loss: 0.5943
AUC: 0.8698

Epoch 20/30
 - 0s - loss: 0.9656 - val_loss: 0.5923
AUC: 0.8699

Epoch 21/30
 - 0s - loss: 0.9630 - val_loss: 0.5855
AUC: 0.8699

Epoch 22/30
 - 0s - loss: 0.9616 - val_loss: 0.5920
AUC: 0.8699

Epoch 23/30
 - 0s - loss: 0.9647 - val_loss: 0.6029
AUC: 0.8704

Epoch 24/30
 - 0s - loss: 0.9597 - val_loss: 0.5968
AUC: 0.8704

Epoch 25/30
 - 0s - loss: 0.9606 - val_loss: 0.5783
AUC: 0.8702

Epoch 26/30
 - 0s - loss: 0.9568 - val_loss: 0.6113
AUC: 0.8706

Epoch 27/30
 - 0s - loss: 0.9657 - val_loss: 0.6084
AUC: 0.8706

Epoch 28/30
 - 0s - loss: 0.9577 - val_loss: 0.5861
AUC: 0.8707

Epoch 29/30
 - 0s - loss: 0.9577 - val_loss: 0.5905
AUC: 0.8707

Epoch 30/30
 - 0s - loss: 0.9564 - val_loss: 0.6077
Using TensorFlow backend.
AUC: 0.8709

2019-03-08 06:30:44.557767: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:30:44.723301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:30:44.723347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:30:45.023519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:30:45.023574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:30:45.023583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:30:45.023854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2935
Epoch 2/80
 - 2s - loss: 0.3320
Epoch 3/80
 - 2s - loss: 0.3008
Epoch 4/80
 - 2s - loss: 0.2782
Epoch 5/80
 - 2s - loss: 0.2535
Epoch 6/80
 - 2s - loss: 0.2303
Epoch 7/80
 - 2s - loss: 0.2097
Epoch 8/80
 - 2s - loss: 0.1928
Epoch 9/80
 - 2s - loss: 0.1784
Epoch 10/80
 - 2s - loss: 0.1661
Epoch 11/80
 - 2s - loss: 0.1560
Epoch 12/80
 - 2s - loss: 0.1478
Epoch 13/80
 - 2s - loss: 0.1411
Epoch 14/80
 - 2s - loss: 0.1357
Epoch 15/80
 - 2s - loss: 0.1313
Epoch 16/80
 - 2s - loss: 0.1276
Epoch 17/80
 - 2s - loss: 0.1245
Epoch 18/80
 - 2s - loss: 0.1217
Epoch 19/80
 - 2s - loss: 0.1192
Epoch 20/80
 - 2s - loss: 0.1171
Epoch 21/80
 - 2s - loss: 0.1152
Epoch 22/80
 - 2s - loss: 0.1136
Epoch 23/80
 - 2s - loss: 0.1121
Epoch 24/80
 - 2s - loss: 0.1109
Epoch 25/80
 - 2s - loss: 0.1098
Epoch 26/80
 - 2s - loss: 0.1089
Epoch 27/80
 - 2s - loss: 0.1082
Epoch 28/80
 - 2s - loss: 0.1074
Epoch 29/80
 - 2s - loss: 0.1069
Epoch 30/80
 - 2s - loss: 0.1063
Epoch 31/80
 - 2s - loss: 0.1059
Epoch 32/80
 - 2s - loss: 0.1055
Epoch 33/80
 - 2s - loss: 0.1051
Epoch 34/80
 - 2s - loss: 0.1048
Epoch 35/80
 - 2s - loss: 0.1045
Epoch 36/80
 - 2s - loss: 0.1043
Epoch 37/80
 - 2s - loss: 0.1040
Epoch 38/80
 - 2s - loss: 0.1038
Epoch 39/80
 - 2s - loss: 0.1036
Epoch 40/80
 - 2s - loss: 0.1035
Epoch 41/80
 - 2s - loss: 0.1033
Epoch 42/80
 - 2s - loss: 0.1032
Epoch 43/80
 - 2s - loss: 0.1030
Epoch 44/80
 - 2s - loss: 0.1029
Epoch 45/80
 - 2s - loss: 0.1027
Epoch 46/80
 - 2s - loss: 0.1027
Epoch 47/80
 - 2s - loss: 0.1026
Epoch 48/80
 - 2s - loss: 0.1025
Epoch 49/80
 - 2s - loss: 0.1024
Epoch 50/80
 - 2s - loss: 0.1023
Epoch 51/80
 - 2s - loss: 0.1022
Epoch 52/80
 - 2s - loss: 0.1021
Epoch 53/80
 - 2s - loss: 0.1021
Epoch 54/80
 - 2s - loss: 0.1020
Epoch 55/80
 - 2s - loss: 0.1020
Epoch 56/80
 - 2s - loss: 0.1019
Epoch 57/80
 - 2s - loss: 0.1019
Epoch 58/80
 - 2s - loss: 0.1018
Epoch 59/80
 - 2s - loss: 0.1017
Epoch 60/80
 - 2s - loss: 0.1017
Epoch 61/80
 - 2s - loss: 0.1016
Epoch 62/80
 - 2s - loss: 0.1016
Epoch 63/80
 - 2s - loss: 0.1015
Epoch 64/80
 - 2s - loss: 0.1015
Epoch 65/80
 - 2s - loss: 0.1014
Epoch 66/80
 - 2s - loss: 0.1014
Epoch 67/80
 - 2s - loss: 0.1014
Epoch 68/80
 - 2s - loss: 0.0987
Epoch 69/80
 - 2s - loss: 0.0985
Epoch 70/80
 - 2s - loss: 0.0984
Epoch 71/80
 - 2s - loss: 0.0984
Epoch 72/80
 - 2s - loss: 0.0984
Epoch 73/80
 - 2s - loss: 0.0977
Epoch 74/80
 - 2s - loss: 0.0977
Epoch 75/80
 - 2s - loss: 0.0977
Epoch 76/80
 - 2s - loss: 0.0977
Epoch 77/80
 - 2s - loss: 0.0976
Epoch 78/80
 - 2s - loss: 0.0976
Epoch 79/80
 - 2s - loss: 0.0976
Epoch 80/80
 - 2s - loss: 0.0976
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 6.6634 - val_loss: 1.4812
AUC: 0.7002

Epoch 2/80
 - 0s - loss: 3.8646 - val_loss: 1.4815
AUC: 0.7890

Epoch 3/80
 - 0s - loss: 2.9580 - val_loss: 1.1622
AUC: 0.8064

Epoch 4/80
 - 0s - loss: 2.3422 - val_loss: 0.9014
AUC: 0.8193

Epoch 5/80
 - 0s - loss: 1.8806 - val_loss: 0.8085
AUC: 0.8252

Epoch 6/80
 - 0s - loss: 1.5477 - val_loss: 0.7851
AUC: 0.8338

Epoch 7/80
 - 0s - loss: 1.3433 - val_loss: 0.7610
AUC: 0.8407

Epoch 8/80
 - 0s - loss: 1.2206 - val_loss: 0.7250
AUC: 0.8456

Epoch 9/80
 - 0s - loss: 1.1824 - val_loss: 0.7020
AUC: 0.8465

Epoch 10/80
 - 0s - loss: 1.1470 - val_loss: 0.7288
AUC: 0.8509

Epoch 11/80
 - 0s - loss: 1.1270 - val_loss: 0.6765
AUC: 0.8506

Epoch 12/80
 - 0s - loss: 1.1054 - val_loss: 0.6537
AUC: 0.8508

Epoch 13/80
 - 0s - loss: 1.0837 - val_loss: 0.6095
AUC: 0.8514

Epoch 14/80
 - 0s - loss: 1.0843 - val_loss: 0.6431
AUC: 0.8534

Epoch 15/80
 - 0s - loss: 1.0725 - val_loss: 0.6473
AUC: 0.8545

Epoch 16/80
 - 0s - loss: 1.0697 - val_loss: 0.6435
AUC: 0.8547

Epoch 17/80
 - 0s - loss: 1.0519 - val_loss: 0.6470
AUC: 0.8549

Epoch 18/80
 - 0s - loss: 1.0475 - val_loss: 0.6170
AUC: 0.8561

Epoch 19/80
 - 0s - loss: 1.0375 - val_loss: 0.6384
AUC: 0.8566

Epoch 20/80
 - 0s - loss: 1.0400 - val_loss: 0.6146
AUC: 0.8565

Epoch 21/80
 - 0s - loss: 1.0330 - val_loss: 0.6038
AUC: 0.8581

Epoch 22/80
 - 0s - loss: 1.0333 - val_loss: 0.6543
AUC: 0.8574

Epoch 23/80
 - 0s - loss: 1.0313 - val_loss: 0.6495
AUC: 0.8599

Epoch 24/80
 - 0s - loss: 1.0260 - val_loss: 0.6349
AUC: 0.8607

Epoch 25/80
 - 0s - loss: 1.0187 - val_loss: 0.6269
AUC: 0.8606

Epoch 26/80
 - 0s - loss: 1.0171 - val_loss: 0.6019
AUC: 0.8610

Epoch 27/80
 - 0s - loss: 1.0127 - val_loss: 0.5684
AUC: 0.8599

Epoch 28/80
 - 0s - loss: 1.0070 - val_loss: 0.6165
AUC: 0.8617

Epoch 29/80
 - 0s - loss: 1.0088 - val_loss: 0.6516
AUC: 0.8614

Epoch 30/80
 - 0s - loss: 1.0082 - val_loss: 0.6153
AUC: 0.8624

Epoch 31/80
 - 0s - loss: 0.9989 - val_loss: 0.6123
AUC: 0.8623

Epoch 32/80
 - 0s - loss: 1.0054 - val_loss: 0.6440
AUC: 0.8636

Epoch 33/80
 - 0s - loss: 0.9952 - val_loss: 0.6165
AUC: 0.8627

Epoch 34/80
 - 0s - loss: 0.9902 - val_loss: 0.6427
AUC: 0.8644

Epoch 35/80
 - 0s - loss: 0.9961 - val_loss: 0.6286
AUC: 0.8638

Epoch 36/80
 - 0s - loss: 0.9956 - val_loss: 0.6093
AUC: 0.8643

Epoch 37/80
 - 0s - loss: 0.9852 - val_loss: 0.6215
AUC: 0.8646

Epoch 38/80
 - 0s - loss: 0.9786 - val_loss: 0.5961
AUC: 0.8646

Epoch 39/80
 - 0s - loss: 0.9792 - val_loss: 0.6327
AUC: 0.8652

Epoch 40/80
 - 0s - loss: 0.9798 - val_loss: 0.5873
AUC: 0.8645

Epoch 41/80
 - 0s - loss: 0.9840 - val_loss: 0.6317
AUC: 0.8656

Epoch 42/80
 - 0s - loss: 0.9749 - val_loss: 0.5958
AUC: 0.8649

Epoch 43/80
 - 0s - loss: 0.9763 - val_loss: 0.5855
AUC: 0.8646

Epoch 44/80
 - 0s - loss: 0.9734 - val_loss: 0.6164
AUC: 0.8655

Epoch 45/80
 - 0s - loss: 0.9748 - val_loss: 0.5819
AUC: 0.8651

Epoch 46/80
 - 0s - loss: 0.9772 - val_loss: 0.6043
AUC: 0.8655

Epoch 47/80
 - 0s - loss: 0.9731 - val_loss: 0.6105
AUC: 0.8652

Epoch 48/80
 - 0s - loss: 0.9724 - val_loss: 0.5993
AUC: 0.8651

Epoch 49/80
 - 0s - loss: 0.9736 - val_loss: 0.6098
AUC: 0.8653

Epoch 50/80
 - 0s - loss: 0.9718 - val_loss: 0.6074
AUC: 0.8654

Epoch 51/80
 - 0s - loss: 0.9697 - val_loss: 0.6052
AUC: 0.8653

Epoch 52/80
 - 0s - loss: 0.9709 - val_loss: 0.6009
AUC: 0.8652

Epoch 53/80
 - 0s - loss: 0.9749 - val_loss: 0.6037
AUC: 0.8653

Epoch 54/80
 - 0s - loss: 0.9729 - val_loss: 0.6002
AUC: 0.8653

Epoch 55/80
 - 0s - loss: 0.9747 - val_loss: 0.6040
AUC: 0.8654

Epoch 56/80
 - 0s - loss: 0.9681 - val_loss: 0.6028
AUC: 0.8654

Epoch 57/80
 - 0s - loss: 0.9750 - val_loss: 0.6055
AUC: 0.8653

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9758 - val_loss: 0.6250
AUC: 0.8654

Epoch 2/30
 - 0s - loss: 0.9703 - val_loss: 0.5864
AUC: 0.8647

Epoch 3/30
 - 0s - loss: 0.9762 - val_loss: 0.5925
AUC: 0.8651

Epoch 4/30
 - 0s - loss: 0.9677 - val_loss: 0.6126
AUC: 0.8657

Epoch 5/30
 - 0s - loss: 0.9721 - val_loss: 0.6073
AUC: 0.8659

Epoch 6/30
 - 0s - loss: 0.9723 - val_loss: 0.6068
AUC: 0.8661

Epoch 7/30
 - 0s - loss: 0.9658 - val_loss: 0.6057
AUC: 0.8663

Epoch 8/30
 - 0s - loss: 0.9656 - val_loss: 0.6100
AUC: 0.8663

Epoch 9/30
 - 0s - loss: 0.9639 - val_loss: 0.5948
AUC: 0.8662

Epoch 10/30
 - 0s - loss: 0.9633 - val_loss: 0.5954
AUC: 0.8662

Epoch 11/30
 - 0s - loss: 0.9651 - val_loss: 0.5820
AUC: 0.8660

Epoch 12/30
 - 0s - loss: 0.9604 - val_loss: 0.6053
AUC: 0.8665

Epoch 13/30
 - 0s - loss: 0.9639 - val_loss: 0.5983
AUC: 0.8662

Epoch 14/30
 - 0s - loss: 0.9587 - val_loss: 0.5997
AUC: 0.8665

Epoch 15/30
 - 0s - loss: 0.9571 - val_loss: 0.6087
AUC: 0.8669

Epoch 16/30
 - 0s - loss: 0.9621 - val_loss: 0.6003
AUC: 0.8668

Epoch 17/30
 - 0s - loss: 0.9539 - val_loss: 0.6179
AUC: 0.8672

Epoch 18/30
 - 0s - loss: 0.9537 - val_loss: 0.6048
AUC: 0.8671

Epoch 19/30
 - 0s - loss: 0.9515 - val_loss: 0.5864
AUC: 0.8666

Epoch 20/30
 - 0s - loss: 0.9512 - val_loss: 0.6064
AUC: 0.8671

Epoch 21/30
 - 0s - loss: 0.9492 - val_loss: 0.5836
AUC: 0.8668

Epoch 22/30
 - 0s - loss: 0.9506 - val_loss: 0.5943
AUC: 0.8671

Epoch 23/30
 - 0s - loss: 0.9457 - val_loss: 0.5949
AUC: 0.8671

Epoch 24/30
 - 0s - loss: 0.9482 - val_loss: 0.5947
AUC: 0.8671

Epoch 25/30
 - 0s - loss: 0.9469 - val_loss: 0.5944
AUC: 0.8671

Epoch 26/30
 - 0s - loss: 0.9497 - val_loss: 0.5935
AUC: 0.8671

Epoch 27/30
 - 0s - loss: 0.9451 - val_loss: 0.5917
AUC: 0.8671

Epoch 28/30
 - 0s - loss: 0.9465 - val_loss: 0.5946
AUC: 0.8671

Epoch 29/30
 - 0s - loss: 0.9455 - val_loss: 0.5970
AUC: 0.8672

Epoch 30/30
 - 0s - loss: 0.9480 - val_loss: 0.5933
Using TensorFlow backend.
AUC: 0.8671

2019-03-08 06:34:44.619912: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:34:44.788307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:34:44.788354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:34:45.092026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:34:45.092083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:34:45.092093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:34:45.092357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0996
Epoch 2/80
 - 2s - loss: 0.1967
Epoch 3/80
 - 2s - loss: 0.1631
Epoch 4/80
 - 2s - loss: 0.1452
Epoch 5/80
 - 2s - loss: 0.1293
Epoch 6/80
 - 2s - loss: 0.1163
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2acaa4b4e6d8>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 06:35:15.394085: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:35:15.562971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:35:15.563018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:35:15.867140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:35:15.867211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:35:15.867222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:35:15.867504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0858
Epoch 2/80
 - 2s - loss: 0.1959
Epoch 3/80
 - 2s - loss: 0.1587
Epoch 4/80
 - 2s - loss: 0.1423
Epoch 5/80
 - 2s - loss: 0.1307
Epoch 6/80
 - 2s - loss: 0.1203
Epoch 7/80
 - 2s - loss: 0.1108
Epoch 8/80
 - 2s - loss: 0.1022
Epoch 9/80
 - 2s - loss: 0.0944
Epoch 10/80
 - 2s - loss: 0.0876
Epoch 11/80
 - 2s - loss: 0.0817
Epoch 12/80
 - 2s - loss: 0.0765
Epoch 13/80
 - 2s - loss: 0.0718
Epoch 14/80
 - 2s - loss: 0.0678
Epoch 15/80
 - 2s - loss: 0.0645
Epoch 16/80
 - 2s - loss: 0.0617
Epoch 17/80
 - 2s - loss: 0.0594
Epoch 18/80
 - 2s - loss: 0.0574
Epoch 19/80
 - 2s - loss: 0.0557
Epoch 20/80
 - 2s - loss: 0.0542
Epoch 21/80
 - 2s - loss: 0.0528
Epoch 22/80
 - 2s - loss: 0.0517
Epoch 23/80
 - 2s - loss: 0.0507
Epoch 24/80
 - 2s - loss: 0.0498
Epoch 25/80
 - 2s - loss: 0.0491
Epoch 26/80
 - 2s - loss: 0.0484
Epoch 27/80
 - 2s - loss: 0.0479
Epoch 28/80
 - 2s - loss: 0.0473
Epoch 29/80
 - 2s - loss: 0.0469
Epoch 30/80
 - 2s - loss: 0.0465
Epoch 31/80
 - 2s - loss: 0.0462
Epoch 32/80
 - 2s - loss: 0.0459
Epoch 33/80
 - 2s - loss: 0.0457
Epoch 34/80
 - 2s - loss: 0.0455
Epoch 35/80
 - 2s - loss: 0.0453
Epoch 36/80
 - 2s - loss: 0.0451
Epoch 37/80
 - 2s - loss: 0.0449
Epoch 38/80
 - 2s - loss: 0.0448
Epoch 39/80
 - 2s - loss: 0.0447
Epoch 40/80
 - 2s - loss: 0.0446
Epoch 41/80
 - 2s - loss: 0.0444
Epoch 42/80
 - 2s - loss: 0.0444
Epoch 43/80
 - 2s - loss: 0.0443
Epoch 44/80
 - 2s - loss: 0.0442
Epoch 45/80
 - 2s - loss: 0.0441
Epoch 46/80
 - 2s - loss: 0.0440
Epoch 47/80
 - 2s - loss: 0.0440
Epoch 48/80
 - 2s - loss: 0.0439
Epoch 49/80
 - 2s - loss: 0.0439
Epoch 50/80
 - 2s - loss: 0.0438
Epoch 51/80
 - 2s - loss: 0.0438
Epoch 52/80
 - 2s - loss: 0.0437
Epoch 53/80
 - 2s - loss: 0.0437
Epoch 54/80
 - 2s - loss: 0.0436
Epoch 55/80
 - 2s - loss: 0.0436
Epoch 56/80
 - 2s - loss: 0.0436
Epoch 57/80
 - 2s - loss: 0.0436
Epoch 58/80
 - 2s - loss: 0.0435
Epoch 59/80
 - 2s - loss: 0.0435
Epoch 60/80
 - 2s - loss: 0.0435
Epoch 61/80
 - 2s - loss: 0.0434
Epoch 62/80
 - 2s - loss: 0.0422
Epoch 63/80
 - 2s - loss: 0.0420
Epoch 64/80
 - 2s - loss: 0.0420
Epoch 65/80
 - 2s - loss: 0.0420
Epoch 66/80
 - 2s - loss: 0.0420
Epoch 67/80
 - 2s - loss: 0.0417
Epoch 68/80
 - 2s - loss: 0.0417
Epoch 69/80
 - 2s - loss: 0.0417
Epoch 70/80
 - 2s - loss: 0.0417
Epoch 71/80
 - 2s - loss: 0.0416
Epoch 72/80
 - 2s - loss: 0.0416
Epoch 73/80
 - 2s - loss: 0.0416
Epoch 74/80
 - 2s - loss: 0.0416
Epoch 75/80
 - 2s - loss: 0.0416
Epoch 76/80
 - 2s - loss: 0.0416
Epoch 77/80
 - 2s - loss: 0.0416
Epoch 78/80
 - 2s - loss: 0.0416
Epoch 79/80
 - 2s - loss: 0.0416
Epoch 80/80
 - 2s - loss: 0.0416
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 6.8886 - val_loss: 1.5873
AUC: 0.7479

Epoch 2/80
 - 0s - loss: 4.0248 - val_loss: 1.4572
AUC: 0.7967

Epoch 3/80
 - 0s - loss: 2.9701 - val_loss: 1.1085
AUC: 0.8262

Epoch 4/80
 - 0s - loss: 2.0425 - val_loss: 0.8252
AUC: 0.8336

Epoch 5/80
 - 0s - loss: 1.5767 - val_loss: 0.7731
AUC: 0.8398

Epoch 6/80
 - 0s - loss: 1.3495 - val_loss: 0.7667
AUC: 0.8426

Epoch 7/80
 - 0s - loss: 1.2504 - val_loss: 0.6472
AUC: 0.8493

Epoch 8/80
 - 0s - loss: 1.1721 - val_loss: 0.6553
AUC: 0.8523

Epoch 9/80
 - 0s - loss: 1.1477 - val_loss: 0.6234
AUC: 0.8533

Epoch 10/80
 - 0s - loss: 1.1244 - val_loss: 0.6555
AUC: 0.8570

Epoch 11/80
 - 0s - loss: 1.1076 - val_loss: 0.6935
AUC: 0.8587

Epoch 12/80
 - 0s - loss: 1.0923 - val_loss: 0.6275
AUC: 0.8595

Epoch 13/80
 - 0s - loss: 1.0880 - val_loss: 0.6554
AUC: 0.8605

Epoch 14/80
 - 0s - loss: 1.0795 - val_loss: 0.6070
AUC: 0.8594

Epoch 15/80
 - 0s - loss: 1.0764 - val_loss: 0.6024
AUC: 0.8613

Epoch 16/80
 - 0s - loss: 1.0723 - val_loss: 0.6368
AUC: 0.8633

Epoch 17/80
 - 0s - loss: 1.0518 - val_loss: 0.6523
AUC: 0.8640

Epoch 18/80
 - 0s - loss: 1.0529 - val_loss: 0.5958
AUC: 0.8629

Epoch 19/80
 - 0s - loss: 1.0417 - val_loss: 0.5676
AUC: 0.8637

Epoch 20/80
 - 0s - loss: 1.0392 - val_loss: 0.6248
AUC: 0.8646

Epoch 21/80
 - 0s - loss: 1.0285 - val_loss: 0.5818
AUC: 0.8656

Epoch 22/80
 - 0s - loss: 1.0265 - val_loss: 0.5622
AUC: 0.8648

Epoch 23/80
 - 0s - loss: 1.0291 - val_loss: 0.6178
AUC: 0.8667

Epoch 24/80
 - 0s - loss: 1.0225 - val_loss: 0.6130
AUC: 0.8665

Epoch 25/80
 - 0s - loss: 1.0241 - val_loss: 0.6211
AUC: 0.8659

Epoch 26/80
 - 0s - loss: 1.0196 - val_loss: 0.6115
AUC: 0.8674

Epoch 27/80
 - 0s - loss: 1.0207 - val_loss: 0.6315
AUC: 0.8677

Epoch 28/80
 - 0s - loss: 1.0130 - val_loss: 0.6617
AUC: 0.8681

Epoch 29/80
 - 0s - loss: 1.0128 - val_loss: 0.6106
AUC: 0.8679

Epoch 30/80
 - 0s - loss: 1.0072 - val_loss: 0.6172
AUC: 0.8685

Epoch 31/80
 - 0s - loss: 1.0077 - val_loss: 0.5888
AUC: 0.8681

Epoch 32/80
 - 0s - loss: 0.9999 - val_loss: 0.6369
AUC: 0.8690

Epoch 33/80
 - 0s - loss: 0.9990 - val_loss: 0.6079
AUC: 0.8688

Epoch 34/80
 - 0s - loss: 0.9988 - val_loss: 0.5966
AUC: 0.8685

Epoch 35/80
 - 0s - loss: 0.9955 - val_loss: 0.5955
AUC: 0.8685

Epoch 36/80
 - 0s - loss: 0.9890 - val_loss: 0.6015
AUC: 0.8688

Epoch 37/80
 - 0s - loss: 0.9936 - val_loss: 0.5903
AUC: 0.8686

Epoch 38/80
 - 0s - loss: 0.9929 - val_loss: 0.5988
AUC: 0.8689

Epoch 39/80
 - 0s - loss: 0.9949 - val_loss: 0.5954
AUC: 0.8688

Epoch 40/80
 - 0s - loss: 0.9892 - val_loss: 0.6051
AUC: 0.8691

Epoch 41/80
 - 0s - loss: 0.9932 - val_loss: 0.5845
AUC: 0.8685

Epoch 42/80
 - 0s - loss: 0.9872 - val_loss: 0.5941
AUC: 0.8690

Epoch 43/80
 - 0s - loss: 0.9820 - val_loss: 0.5999
AUC: 0.8690

Epoch 44/80
 - 0s - loss: 0.9911 - val_loss: 0.5976
AUC: 0.8691

Epoch 45/80
 - 0s - loss: 0.9927 - val_loss: 0.6001
AUC: 0.8691

Epoch 46/80
 - 0s - loss: 0.9900 - val_loss: 0.5996
AUC: 0.8690

Epoch 47/80
 - 0s - loss: 0.9882 - val_loss: 0.6009
AUC: 0.8691

Epoch 48/80
 - 0s - loss: 0.9874 - val_loss: 0.6006
AUC: 0.8691

Epoch 49/80
 - 0s - loss: 0.9871 - val_loss: 0.5930
AUC: 0.8690

Epoch 50/80
 - 0s - loss: 0.9865 - val_loss: 0.5993
AUC: 0.8691

Epoch 51/80
 - 0s - loss: 0.9882 - val_loss: 0.5940
AUC: 0.8690

Epoch 52/80
 - 0s - loss: 0.9865 - val_loss: 0.6050
AUC: 0.8691

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9912 - val_loss: 0.6106
AUC: 0.8694

Epoch 2/30
 - 0s - loss: 0.9881 - val_loss: 0.6130
AUC: 0.8695

Epoch 3/30
 - 0s - loss: 0.9889 - val_loss: 0.5885
AUC: 0.8692

Epoch 4/30
 - 0s - loss: 0.9856 - val_loss: 0.5974
AUC: 0.8695

Epoch 5/30
 - 0s - loss: 0.9827 - val_loss: 0.5998
AUC: 0.8698

Epoch 6/30
 - 0s - loss: 0.9841 - val_loss: 0.6037
AUC: 0.8698

Epoch 7/30
 - 0s - loss: 0.9803 - val_loss: 0.6000
AUC: 0.8698

Epoch 8/30
 - 0s - loss: 0.9778 - val_loss: 0.5739
AUC: 0.8696

Epoch 9/30
 - 0s - loss: 0.9715 - val_loss: 0.5767
AUC: 0.8697

Epoch 10/30
 - 0s - loss: 0.9762 - val_loss: 0.5888
AUC: 0.8701

Epoch 11/30
 - 0s - loss: 0.9743 - val_loss: 0.6066
AUC: 0.8703

Epoch 12/30
 - 0s - loss: 0.9741 - val_loss: 0.6011
AUC: 0.8703

Epoch 13/30
 - 0s - loss: 0.9700 - val_loss: 0.5916
AUC: 0.8704

Epoch 14/30
 - 0s - loss: 0.9627 - val_loss: 0.5852
AUC: 0.8703

Epoch 15/30
 - 0s - loss: 0.9722 - val_loss: 0.5844
AUC: 0.8704

Epoch 16/30
 - 0s - loss: 0.9704 - val_loss: 0.5732
AUC: 0.8704

Epoch 17/30
 - 0s - loss: 0.9649 - val_loss: 0.6002
AUC: 0.8708

Epoch 18/30
 - 0s - loss: 0.9655 - val_loss: 0.5803
AUC: 0.8706

Epoch 19/30
 - 0s - loss: 0.9665 - val_loss: 0.5891
AUC: 0.8708

Epoch 20/30
 - 0s - loss: 0.9607 - val_loss: 0.5841
AUC: 0.8707

Epoch 21/30
 - 0s - loss: 0.9586 - val_loss: 0.5949
AUC: 0.8711

Epoch 22/30
 - 0s - loss: 0.9575 - val_loss: 0.5857
AUC: 0.8711

Epoch 23/30
 - 0s - loss: 0.9600 - val_loss: 0.5879
AUC: 0.8711

Epoch 24/30
 - 0s - loss: 0.9553 - val_loss: 0.5891
AUC: 0.8710

Epoch 25/30
 - 0s - loss: 0.9616 - val_loss: 0.6125
AUC: 0.8715

Epoch 26/30
 - 0s - loss: 0.9571 - val_loss: 0.6029
AUC: 0.8716

Epoch 27/30
 - 0s - loss: 0.9487 - val_loss: 0.5835
AUC: 0.8714

Epoch 28/30
 - 0s - loss: 0.9560 - val_loss: 0.5838
AUC: 0.8714

Epoch 29/30
 - 0s - loss: 0.9528 - val_loss: 0.5824
AUC: 0.8714

Epoch 30/30
 - 0s - loss: 0.9518 - val_loss: 0.5840
Using TensorFlow backend.
AUC: 0.8714

2019-03-08 06:39:11.403508: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:39:11.571749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:39:11.571817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:39:11.878976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:39:11.879033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:39:11.879043: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:39:11.879325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0585
Epoch 2/80
 - 2s - loss: 0.1952
Epoch 3/80
 - 2s - loss: 0.1678
Epoch 4/80
 - 2s - loss: 0.1543
Epoch 5/80
 - 2s - loss: 0.1402
Epoch 6/80
 - 2s - loss: 0.1273
Epoch 7/80
 - 2s - loss: 0.1165
Epoch 8/80
 - 2s - loss: 0.1075
Epoch 9/80
 - 2s - loss: 0.0992
Epoch 10/80
 - 2s - loss: 0.0917
Epoch 11/80
 - 2s - loss: 0.0848
Epoch 12/80
 - 2s - loss: 0.0787
Epoch 13/80
 - 2s - loss: 0.0735
Epoch 14/80
 - 2s - loss: 0.0690
Epoch 15/80
 - 2s - loss: 0.0653
Epoch 16/80
 - 2s - loss: 0.0622
Epoch 17/80
 - 2s - loss: 0.0597
Epoch 18/80
 - 2s - loss: 0.0576
Epoch 19/80
 - 2s - loss: 0.0558
Epoch 20/80
 - 2s - loss: 0.0543
Epoch 21/80
 - 2s - loss: 0.0530
Epoch 22/80
 - 2s - loss: 0.0519
Epoch 23/80
 - 2s - loss: 0.0510
Epoch 24/80
 - 2s - loss: 0.0501
Epoch 25/80
 - 2s - loss: 0.0493
Epoch 26/80
 - 2s - loss: 0.0487
Epoch 27/80
 - 2s - loss: 0.0481
Epoch 28/80
 - 2s - loss: 0.0476
Epoch 29/80
 - 2s - loss: 0.0472
Epoch 30/80
 - 2s - loss: 0.0468
Epoch 31/80
 - 2s - loss: 0.0464
Epoch 32/80
 - 2s - loss: 0.0462
Epoch 33/80
 - 2s - loss: 0.0459
Epoch 34/80
 - 2s - loss: 0.0457
Epoch 35/80
 - 2s - loss: 0.0455
Epoch 36/80
 - 2s - loss: 0.0453
Epoch 37/80
 - 2s - loss: 0.0451
Epoch 38/80
 - 2s - loss: 0.0450
Epoch 39/80
 - 2s - loss: 0.0448
Epoch 40/80
 - 2s - loss: 0.0447
Epoch 41/80
 - 2s - loss: 0.0446
Epoch 42/80
 - 2s - loss: 0.0445
Epoch 43/80
 - 2s - loss: 0.0444
Epoch 44/80
 - 2s - loss: 0.0443
Epoch 45/80
 - 2s - loss: 0.0442
Epoch 46/80
 - 2s - loss: 0.0441
Epoch 47/80
 - 2s - loss: 0.0441
Epoch 48/80
 - 2s - loss: 0.0440
Epoch 49/80
 - 2s - loss: 0.0439
Epoch 50/80
 - 2s - loss: 0.0439
Epoch 51/80
 - 2s - loss: 0.0438
Epoch 52/80
 - 2s - loss: 0.0438
Epoch 53/80
 - 2s - loss: 0.0437
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 06:41:13.275377: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:41:13.445980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:41:13.446028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:41:13.750018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:41:13.750074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:41:13.750084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:41:13.750349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0717
Epoch 2/80
 - 2s - loss: 0.1943
Epoch 3/80
 - 2s - loss: 0.1682
Epoch 4/80
 - 2s - loss: 0.1578
Epoch 5/80
 - 2s - loss: 0.1453
Epoch 6/80
 - 2s - loss: 0.1325
Epoch 7/80
 - 2s - loss: 0.1209
Epoch 8/80
 - 2s - loss: 0.1106
Epoch 9/80
 - 2s - loss: 0.1012
Epoch 10/80
 - 2s - loss: 0.0928
Epoch 11/80
 - 2s - loss: 0.0852
Epoch 12/80
 - 2s - loss: 0.0786
Epoch 13/80
 - 2s - loss: 0.0729
Epoch 14/80
 - 2s - loss: 0.0681
Epoch 15/80
 - 2s - loss: 0.0642
Epoch 16/80
 - 2s - loss: 0.0610
Epoch 17/80
 - 2s - loss: 0.0585
Epoch 18/80
 - 2s - loss: 0.0564
Epoch 19/80
 - 2s - loss: 0.0547
Epoch 20/80
 - 2s - loss: 0.0533
Epoch 21/80
 - 2s - loss: 0.0520
Epoch 22/80
 - 2s - loss: 0.0510
Epoch 23/80
 - 2s - loss: 0.0501
Epoch 24/80
 - 2s - loss: 0.0493
Epoch 25/80
 - 2s - loss: 0.0487
Epoch 26/80
 - 2s - loss: 0.0481
Epoch 27/80
 - 2s - loss: 0.0476
Epoch 28/80
 - 2s - loss: 0.0472
Epoch 29/80
 - 2s - loss: 0.0468
Epoch 30/80
 - 2s - loss: 0.0464
Epoch 31/80
 - 2s - loss: 0.0461
Epoch 32/80
 - 2s - loss: 0.0459
Epoch 33/80
 - 2s - loss: 0.0456
Epoch 34/80
 - 2s - loss: 0.0455
Epoch 35/80
 - 2s - loss: 0.0453
Epoch 36/80
 - 2s - loss: 0.0451
Epoch 37/80
 - 2s - loss: 0.0449
Epoch 38/80
 - 2s - loss: 0.0448
Epoch 39/80
 - 2s - loss: 0.0447
Epoch 40/80
 - 2s - loss: 0.0446
Epoch 41/80
 - 2s - loss: 0.0445
Epoch 42/80
 - 2s - loss: 0.0444
Epoch 43/80
 - 2s - loss: 0.0443
Epoch 44/80
 - 2s - loss: 0.0442
Epoch 45/80
 - 2s - loss: 0.0441
Epoch 46/80
 - 2s - loss: 0.0441
Epoch 47/80
 - 2s - loss: 0.0440
Epoch 48/80
 - 2s - loss: 0.0440
Epoch 49/80
 - 2s - loss: 0.0439
Epoch 50/80
 - 2s - loss: 0.0439
Epoch 51/80
 - 2s - loss: 0.0438
Epoch 52/80
 - 2s - loss: 0.0438
Epoch 53/80
 - 2s - loss: 0.0437
Epoch 54/80
 - 2s - loss: 0.0437
Epoch 55/80
 - 2s - loss: 0.0437
Epoch 56/80
 - 2s - loss: 0.0436
Epoch 57/80
 - 2s - loss: 0.0436
Epoch 58/80
 - 2s - loss: 0.0436
Epoch 59/80
 - 2s - loss: 0.0435
Epoch 60/80
 - 2s - loss: 0.0423
Epoch 61/80
 - 2s - loss: 0.0422
Epoch 62/80
 - 2s - loss: 0.0421
Epoch 63/80
 - 2s - loss: 0.0421
Epoch 64/80
 - 2s - loss: 0.0421
Epoch 65/80
 - 2s - loss: 0.0418
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 06:43:40.860709: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:43:41.026433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:43:41.026488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:43:41.332199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:43:41.332254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:43:41.332263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:43:41.332531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6490
Epoch 2/80
 - 2s - loss: 0.1026
Epoch 3/80
 - 2s - loss: 0.0701
Epoch 4/80
 - 2s - loss: 0.0647
Epoch 5/80
 - 2s - loss: 0.0618
Epoch 6/80
 - 2s - loss: 0.0585
Epoch 7/80
 - 2s - loss: 0.0540
Epoch 8/80
 - 2s - loss: 0.0489
Epoch 9/80
 - 2s - loss: 0.0441
Epoch 10/80
 - 2s - loss: 0.0401
Epoch 11/80
 - 2s - loss: 0.0366
Epoch 12/80
 - 2s - loss: 0.0334
Epoch 13/80
 - 2s - loss: 0.0306
Epoch 14/80
 - 2s - loss: 0.0282
Epoch 15/80
 - 2s - loss: 0.0261
Epoch 16/80
 - 2s - loss: 0.0244
Epoch 17/80
 - 2s - loss: 0.0229
Epoch 18/80
 - 2s - loss: 0.0216
Epoch 19/80
 - 2s - loss: 0.0206
Epoch 20/80
 - 2s - loss: 0.0197
Epoch 21/80
 - 2s - loss: 0.0190
Epoch 22/80
 - 2s - loss: 0.0183
Epoch 23/80
 - 2s - loss: 0.0178
Epoch 24/80
 - 2s - loss: 0.0173
Epoch 25/80
 - 2s - loss: 0.0169
Epoch 26/80
 - 2s - loss: 0.0166
Epoch 27/80
 - 2s - loss: 0.0163
Epoch 28/80
 - 2s - loss: 0.0160
Epoch 29/80
 - 2s - loss: 0.0158
Epoch 30/80
 - 2s - loss: 0.0156
Epoch 31/80
 - 2s - loss: 0.0154
Epoch 32/80
 - 2s - loss: 0.0153
Epoch 33/80
 - 2s - loss: 0.0152
Epoch 34/80
 - 2s - loss: 0.0151
Epoch 35/80
 - 2s - loss: 0.0150
Epoch 36/80
 - 2s - loss: 0.0149
Epoch 37/80
 - 2s - loss: 0.0148
Epoch 38/80
 - 2s - loss: 0.0147
Epoch 39/80
 - 2s - loss: 0.0146
Epoch 40/80
 - 2s - loss: 0.0146
Epoch 41/80
 - 2s - loss: 0.0145
Epoch 42/80
 - 2s - loss: 0.0145
Epoch 43/80
 - 2s - loss: 0.0144
Epoch 44/80
 - 2s - loss: 0.0144
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2b9545f116a0>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 06:45:26.190337: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:45:26.361087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:45:26.361133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:45:26.664393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:45:26.664448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:45:26.664457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:45:26.664722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6489
Epoch 2/80
 - 2s - loss: 0.1016
Epoch 3/80
 - 2s - loss: 0.0697
Epoch 4/80
 - 2s - loss: 0.0649
Epoch 5/80
 - 2s - loss: 0.0619
Epoch 6/80
 - 2s - loss: 0.0578
Epoch 7/80
 - 2s - loss: 0.0526
Epoch 8/80
 - 2s - loss: 0.0473
Epoch 9/80
 - 2s - loss: 0.0430
Epoch 10/80
 - 2s - loss: 0.0394
Epoch 11/80
 - 2s - loss: 0.0363
Epoch 12/80
 - 2s - loss: 0.0336
Epoch 13/80
 - 2s - loss: 0.0310
Epoch 14/80
 - 2s - loss: 0.0287
Epoch 15/80
 - 2s - loss: 0.0267
Epoch 16/80
 - 2s - loss: 0.0249
Epoch 17/80
 - 2s - loss: 0.0235
Epoch 18/80
 - 2s - loss: 0.0222
Epoch 19/80
 - 2s - loss: 0.0211
Epoch 20/80
 - 2s - loss: 0.0202
Epoch 21/80
 - 2s - loss: 0.0195
Epoch 22/80
 - 2s - loss: 0.0188
Epoch 23/80
 - 2s - loss: 0.0183
Epoch 24/80
 - 2s - loss: 0.0178
Epoch 25/80
 - 2s - loss: 0.0174
Epoch 26/80
 - 2s - loss: 0.0171
Epoch 27/80
 - 2s - loss: 0.0167
Epoch 28/80
 - 2s - loss: 0.0164
Epoch 29/80
 - 2s - loss: 0.0162
Epoch 30/80
 - 2s - loss: 0.0160
Epoch 31/80
 - 2s - loss: 0.0158
Epoch 32/80
 - 2s - loss: 0.0156
Epoch 33/80
 - 2s - loss: 0.0154
Epoch 34/80
 - 2s - loss: 0.0153
Epoch 35/80
 - 2s - loss: 0.0152
Epoch 36/80
 - 2s - loss: 0.0151
Epoch 37/80
 - 2s - loss: 0.0150
Epoch 38/80
 - 2s - loss: 0.0149
Epoch 39/80
 - 2s - loss: 0.0148
Epoch 40/80
 - 2s - loss: 0.0147
Epoch 41/80
 - 2s - loss: 0.0147
Epoch 42/80
 - 2s - loss: 0.0146
Epoch 43/80
 - 2s - loss: 0.0146
Epoch 44/80
 - 2s - loss: 0.0145
Epoch 45/80
 - 2s - loss: 0.0145
Epoch 46/80
 - 2s - loss: 0.0144
Epoch 47/80
 - 2s - loss: 0.0144
Epoch 48/80
 - 2s - loss: 0.0144
Epoch 49/80
 - 2s - loss: 0.0143
Epoch 50/80
 - 2s - loss: 0.0143
Epoch 51/80
 - 2s - loss: 0.0143
Epoch 52/80
 - 2s - loss: 0.0138
Epoch 53/80
 - 2s - loss: 0.0138
Epoch 54/80
 - 2s - loss: 0.0138
Epoch 55/80
 - 2s - loss: 0.0138
Epoch 56/80
 - 2s - loss: 0.0137
Epoch 57/80
 - 2s - loss: 0.0137
Epoch 58/80
 - 2s - loss: 0.0137
Epoch 59/80
 - 2s - loss: 0.0137
Epoch 60/80
 - 2s - loss: 0.0136
Epoch 61/80
 - 2s - loss: 0.0136
Epoch 62/80
 - 2s - loss: 0.0136
Epoch 63/80
 - 2s - loss: 0.0136
Epoch 64/80
 - 2s - loss: 0.0136
Epoch 65/80
 - 2s - loss: 0.0136
Epoch 66/80
 - 2s - loss: 0.0136
Epoch 67/80
 - 2s - loss: 0.0136
Epoch 68/80
 - 2s - loss: 0.0136
Epoch 69/80
 - 2s - loss: 0.0136
Epoch 70/80
 - 2s - loss: 0.0136
Epoch 71/80
 - 2s - loss: 0.0136
Epoch 72/80
 - 2s - loss: 0.0136
Epoch 73/80
 - 2s - loss: 0.0136
Epoch 74/80
 - 2s - loss: 0.0136
Epoch 75/80
 - 2s - loss: 0.0136
Epoch 76/80
 - 2s - loss: 0.0136
Epoch 77/80
 - 2s - loss: 0.0136
Epoch 78/80
 - 2s - loss: 0.0136
Epoch 79/80
 - 2s - loss: 0.0136
Epoch 80/80
 - 2s - loss: 0.0136
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 5.0742 - val_loss: 1.4390
AUC: 0.8137

Epoch 2/80
 - 0s - loss: 3.3109 - val_loss: 1.4169
AUC: 0.8387

Epoch 3/80
 - 0s - loss: 2.1442 - val_loss: 0.7485
AUC: 0.8469

Epoch 4/80
 - 0s - loss: 1.5451 - val_loss: 0.7739
AUC: 0.8504

Epoch 5/80
 - 0s - loss: 1.3012 - val_loss: 0.7018
AUC: 0.8507

Epoch 6/80
 - 0s - loss: 1.2119 - val_loss: 0.7600
AUC: 0.8519

Epoch 7/80
 - 0s - loss: 1.1732 - val_loss: 0.6345
AUC: 0.8544

Epoch 8/80
 - 0s - loss: 1.1433 - val_loss: 0.7026
AUC: 0.8578

Epoch 9/80
 - 0s - loss: 1.1323 - val_loss: 0.6953
AUC: 0.8599

Epoch 10/80
 - 0s - loss: 1.1116 - val_loss: 0.6421
AUC: 0.8609

Epoch 11/80
 - 0s - loss: 1.0988 - val_loss: 0.6148
AUC: 0.8621

Epoch 12/80
 - 0s - loss: 1.0889 - val_loss: 0.6607
AUC: 0.8629

Epoch 13/80
 - 0s - loss: 1.0802 - val_loss: 0.6736
AUC: 0.8651

Epoch 14/80
 - 0s - loss: 1.0634 - val_loss: 0.6682
AUC: 0.8654

Epoch 15/80
 - 0s - loss: 1.0760 - val_loss: 0.6906
AUC: 0.8676

Epoch 16/80
 - 0s - loss: 1.0545 - val_loss: 0.6093
AUC: 0.8674

Epoch 17/80
 - 0s - loss: 1.0508 - val_loss: 0.6618
AUC: 0.8690

Epoch 18/80
 - 0s - loss: 1.0481 - val_loss: 0.6653
AUC: 0.8693

Epoch 19/80
 - 0s - loss: 1.0463 - val_loss: 0.6659
AUC: 0.8691

Epoch 20/80
 - 0s - loss: 1.0369 - val_loss: 0.6448
AUC: 0.8702

Epoch 21/80
 - 0s - loss: 1.0279 - val_loss: 0.6147
AUC: 0.8699

Epoch 22/80
 - 0s - loss: 1.0292 - val_loss: 0.5783
AUC: 0.8696

Epoch 23/80
 - 0s - loss: 1.0315 - val_loss: 0.6239
AUC: 0.8718

Epoch 24/80
 - 0s - loss: 1.0233 - val_loss: 0.6023
AUC: 0.8715

Epoch 25/80
 - 0s - loss: 1.0150 - val_loss: 0.6097
AUC: 0.8729

Epoch 26/80
 - 0s - loss: 1.0142 - val_loss: 0.6326
AUC: 0.8740

Epoch 27/80
 - 0s - loss: 1.0170 - val_loss: 0.5883
AUC: 0.8730

Epoch 28/80
 - 0s - loss: 1.0086 - val_loss: 0.5823
AUC: 0.8731

Epoch 29/80
 - 0s - loss: 1.0121 - val_loss: 0.6353
AUC: 0.8745

Epoch 30/80
 - 0s - loss: 1.0075 - val_loss: 0.6170
AUC: 0.8745

Epoch 31/80
 - 0s - loss: 1.0062 - val_loss: 0.5758
AUC: 0.8739

Epoch 32/80
 - 0s - loss: 1.0061 - val_loss: 0.6036
AUC: 0.8751

Epoch 33/80
 - 0s - loss: 1.0007 - val_loss: 0.6628
AUC: 0.8747

Epoch 34/80
 - 0s - loss: 1.0054 - val_loss: 0.6272
AUC: 0.8750

Epoch 35/80
 - 0s - loss: 0.9950 - val_loss: 0.6241
AUC: 0.8744

Epoch 36/80
 - 0s - loss: 0.9909 - val_loss: 0.6539
AUC: 0.8744

Epoch 37/80
 - 0s - loss: 0.9943 - val_loss: 0.6934
AUC: 0.8760

Epoch 38/80
 - 0s - loss: 0.9912 - val_loss: 0.6092
AUC: 0.8754

Epoch 39/80
 - 0s - loss: 0.9943 - val_loss: 0.6043
AUC: 0.8762

Epoch 40/80
 - 0s - loss: 0.9865 - val_loss: 0.5872
AUC: 0.8751

Epoch 41/80
 - 0s - loss: 0.9881 - val_loss: 0.5550
AUC: 0.8755

Epoch 42/80
 - 0s - loss: 0.9886 - val_loss: 0.6227
AUC: 0.8756

Epoch 43/80
 - 0s - loss: 0.9815 - val_loss: 0.5789
AUC: 0.8761

Epoch 44/80
 - 0s - loss: 0.9843 - val_loss: 0.6602
AUC: 0.8767

Epoch 45/80
 - 0s - loss: 0.9841 - val_loss: 0.6451
AUC: 0.8771

Epoch 46/80
 - 0s - loss: 0.9724 - val_loss: 0.6332
AUC: 0.8767

Epoch 47/80
 - 0s - loss: 0.9745 - val_loss: 0.4972
AUC: 0.8743

Epoch 48/80
 - 0s - loss: 0.9749 - val_loss: 0.6591
AUC: 0.8765

Epoch 49/80
 - 0s - loss: 0.9782 - val_loss: 0.5889
AUC: 0.8759

Epoch 50/80
 - 0s - loss: 0.9742 - val_loss: 0.5462
AUC: 0.8764

Epoch 51/80
 - 0s - loss: 0.9668 - val_loss: 0.5982
AUC: 0.8772

Epoch 52/80
 - 0s - loss: 0.9604 - val_loss: 0.5698
AUC: 0.8771

Epoch 53/80
 - 0s - loss: 0.9719 - val_loss: 0.6575
AUC: 0.8772

Epoch 54/80
 - 0s - loss: 0.9652 - val_loss: 0.6105
AUC: 0.8775

Epoch 55/80
 - 0s - loss: 0.9644 - val_loss: 0.6335
AUC: 0.8780

Epoch 56/80
 - 0s - loss: 0.9648 - val_loss: 0.5383
AUC: 0.8766

Epoch 57/80
 - 0s - loss: 0.9619 - val_loss: 0.5943
AUC: 0.8769

Epoch 58/80
 - 0s - loss: 0.9542 - val_loss: 0.6021
AUC: 0.8775

Epoch 59/80
 - 0s - loss: 0.9541 - val_loss: 0.5862
AUC: 0.8774

Epoch 60/80
 - 0s - loss: 0.9501 - val_loss: 0.5579
AUC: 0.8775

Epoch 61/80
 - 0s - loss: 0.9496 - val_loss: 0.6106
AUC: 0.8778

Epoch 62/80
 - 0s - loss: 0.9507 - val_loss: 0.5764
AUC: 0.8777

Epoch 63/80
 - 0s - loss: 0.9477 - val_loss: 0.5961
AUC: 0.8780

Epoch 64/80
 - 0s - loss: 0.9506 - val_loss: 0.5951
AUC: 0.8780

Epoch 65/80
 - 0s - loss: 0.9485 - val_loss: 0.5593
AUC: 0.8781

Epoch 66/80
 - 0s - loss: 0.9491 - val_loss: 0.5838
AUC: 0.8781

Epoch 67/80
 - 0s - loss: 0.9471 - val_loss: 0.5735
AUC: 0.8780

Epoch 68/80
 - 0s - loss: 0.9427 - val_loss: 0.5800
AUC: 0.8780

Epoch 69/80
 - 0s - loss: 0.9432 - val_loss: 0.5791
AUC: 0.8779

Epoch 70/80
 - 0s - loss: 0.9498 - val_loss: 0.5851
AUC: 0.8780

Epoch 71/80
 - 0s - loss: 0.9439 - val_loss: 0.5803
AUC: 0.8779

Epoch 72/80
 - 0s - loss: 0.9406 - val_loss: 0.5769
AUC: 0.8779

Epoch 73/80
 - 0s - loss: 0.9439 - val_loss: 0.5709
AUC: 0.8779

Epoch 74/80
 - 0s - loss: 0.9418 - val_loss: 0.5739
AUC: 0.8779

Epoch 75/80
 - 0s - loss: 0.9454 - val_loss: 0.5763
AUC: 0.8779

Epoch 76/80
 - 0s - loss: 0.9436 - val_loss: 0.5823
AUC: 0.8779

Epoch 77/80
 - 0s - loss: 0.9457 - val_loss: 0.5874
AUC: 0.8780

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9471 - val_loss: 0.5840
AUC: 0.8781

Epoch 2/30
 - 0s - loss: 0.9467 - val_loss: 0.5921
AUC: 0.8781

Epoch 3/30
 - 0s - loss: 0.9436 - val_loss: 0.5735
AUC: 0.8780

Epoch 4/30
 - 0s - loss: 0.9429 - val_loss: 0.5873
AUC: 0.8782

Epoch 5/30
 - 0s - loss: 0.9442 - val_loss: 0.5730
AUC: 0.8782

Epoch 6/30
 - 0s - loss: 0.9395 - val_loss: 0.5734
AUC: 0.8784

Epoch 7/30
 - 0s - loss: 0.9365 - val_loss: 0.5777
AUC: 0.8785

Epoch 8/30
 - 0s - loss: 0.9392 - val_loss: 0.5760
AUC: 0.8787

Epoch 9/30
 - 0s - loss: 0.9320 - val_loss: 0.5559
AUC: 0.8785

Epoch 10/30
 - 0s - loss: 0.9373 - val_loss: 0.5977
AUC: 0.8789

Epoch 11/30
 - 0s - loss: 0.9377 - val_loss: 0.5789
AUC: 0.8788

Epoch 12/30
 - 0s - loss: 0.9286 - val_loss: 0.5616
AUC: 0.8788

Epoch 13/30
 - 0s - loss: 0.9314 - val_loss: 0.5593
AUC: 0.8788

Epoch 14/30
 - 0s - loss: 0.9272 - val_loss: 0.5772
AUC: 0.8790

Epoch 15/30
 - 0s - loss: 0.9259 - val_loss: 0.5820
AUC: 0.8791

Epoch 16/30
 - 0s - loss: 0.9295 - val_loss: 0.5781
AUC: 0.8791

Epoch 17/30
 - 0s - loss: 0.9236 - val_loss: 0.5820
AUC: 0.8792

Epoch 18/30
 - 0s - loss: 0.9260 - val_loss: 0.5756
AUC: 0.8792

Epoch 19/30
 - 0s - loss: 0.9256 - val_loss: 0.5641
AUC: 0.8793

Epoch 20/30
 - 0s - loss: 0.9213 - val_loss: 0.5686
AUC: 0.8793

Epoch 21/30
 - 0s - loss: 0.9227 - val_loss: 0.5706
AUC: 0.8793

Epoch 22/30
 - 0s - loss: 0.9212 - val_loss: 0.5752
AUC: 0.8794

Epoch 23/30
 - 0s - loss: 0.9182 - val_loss: 0.5698
AUC: 0.8793

Epoch 24/30
 - 0s - loss: 0.9153 - val_loss: 0.5712
AUC: 0.8794

Epoch 25/30
 - 0s - loss: 0.9191 - val_loss: 0.5717
AUC: 0.8793

Epoch 26/30
 - 0s - loss: 0.9199 - val_loss: 0.5728
AUC: 0.8793

Epoch 27/30
 - 0s - loss: 0.9236 - val_loss: 0.5699
AUC: 0.8793

Epoch 28/30
 - 0s - loss: 0.9188 - val_loss: 0.5716
AUC: 0.8793

Epoch 29/30
 - 0s - loss: 0.9208 - val_loss: 0.5717
AUC: 0.8793

Epoch 30/30
 - 0s - loss: 0.9191 - val_loss: 0.5720
Using TensorFlow backend.
AUC: 0.8794

2019-03-08 06:49:38.322215: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:49:38.492196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:49:38.492242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:49:38.796585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:49:38.796647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:49:38.796656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:49:38.796927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6468
Epoch 2/80
 - 2s - loss: 0.1003
Epoch 3/80
 - 2s - loss: 0.0690
Epoch 4/80
 - 2s - loss: 0.0652
Epoch 5/80
 - 2s - loss: 0.0628
Epoch 6/80
 - 2s - loss: 0.0590
Epoch 7/80
 - 2s - loss: 0.0538
Epoch 8/80
 - 2s - loss: 0.0484
Epoch 9/80
 - 2s - loss: 0.0438
Epoch 10/80
 - 2s - loss: 0.0398
Epoch 11/80
 - 2s - loss: 0.0361
Epoch 12/80
 - 2s - loss: 0.0329
Epoch 13/80
 - 2s - loss: 0.0302
Epoch 14/80
 - 2s - loss: 0.0280
Epoch 15/80
 - 2s - loss: 0.0261
Epoch 16/80
 - 2s - loss: 0.0245
Epoch 17/80
 - 2s - loss: 0.0231
Epoch 18/80
 - 2s - loss: 0.0219
Epoch 19/80
 - 2s - loss: 0.0208
Epoch 20/80
 - 2s - loss: 0.0199
Epoch 21/80
 - 2s - loss: 0.0192
Epoch 22/80
 - 2s - loss: 0.0185
Epoch 23/80
 - 2s - loss: 0.0180
Epoch 24/80
 - 2s - loss: 0.0175
Epoch 25/80
 - 2s - loss: 0.0171
Epoch 26/80
 - 2s - loss: 0.0167
Epoch 27/80
 - 2s - loss: 0.0164
Epoch 28/80
 - 2s - loss: 0.0161
Epoch 29/80
 - 2s - loss: 0.0159
Epoch 30/80
 - 2s - loss: 0.0157
Epoch 31/80
 - 2s - loss: 0.0155
Epoch 32/80
 - 2s - loss: 0.0154
Epoch 33/80
 - 2s - loss: 0.0152
Epoch 34/80
 - 2s - loss: 0.0151
Epoch 35/80
 - 2s - loss: 0.0150
Epoch 36/80
 - 2s - loss: 0.0149
Epoch 37/80
 - 2s - loss: 0.0148
Epoch 38/80
 - 2s - loss: 0.0147
Epoch 39/80
 - 2s - loss: 0.0146
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2ac50243c1d0>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 06:51:13.982681: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:51:14.150182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:51:14.150228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:51:14.449013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:51:14.449085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:51:14.449094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:51:14.449360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3143
Epoch 2/80
 - 2s - loss: 0.3329
Epoch 3/80
 - 2s - loss: 0.2947
Epoch 4/80
 - 2s - loss: 0.2636
Epoch 5/80
 - 2s - loss: 0.2372
Epoch 6/80
 - 2s - loss: 0.2182
Epoch 7/80
 - 2s - loss: 0.2033
Epoch 8/80
 - 2s - loss: 0.1899
Epoch 9/80
 - 2s - loss: 0.1772
Epoch 10/80
 - 2s - loss: 0.1654
Epoch 11/80
 - 2s - loss: 0.1554
Epoch 12/80
 - 2s - loss: 0.1474
Epoch 13/80
 - 2s - loss: 0.1410
Epoch 14/80
 - 2s - loss: 0.1357
Epoch 15/80
 - 2s - loss: 0.1312
Epoch 16/80
 - 2s - loss: 0.1273
Epoch 17/80
 - 2s - loss: 0.1240
Epoch 18/80
 - 2s - loss: 0.1212
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2b7504607668>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 06:52:11.133412: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:52:11.301469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:52:11.301515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:52:11.601591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:52:11.601645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:52:11.601655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:52:11.601928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2972
Epoch 2/80
 - 2s - loss: 0.3318
Epoch 3/80
 - 2s - loss: 0.2996
Epoch 4/80
 - 2s - loss: 0.2784
Epoch 5/80
 - 2s - loss: 0.2537
Epoch 6/80
 - 2s - loss: 0.2263
Epoch 7/80
 - 2s - loss: 0.2031
Epoch 8/80
 - 2s - loss: 0.1864
Epoch 9/80
 - 2s - loss: 0.1739
Epoch 10/80
 - 2s - loss: 0.1637
Epoch 11/80
 - 2s - loss: 0.1549
Epoch 12/80
 - 2s - loss: 0.1472
Epoch 13/80
 - 2s - loss: 0.1404
Epoch 14/80
 - 2s - loss: 0.1348
Epoch 15/80
 - 2s - loss: 0.1301
Epoch 16/80
 - 2s - loss: 0.1262
Epoch 17/80
 - 2s - loss: 0.1229
Epoch 18/80
 - 2s - loss: 0.1200
Epoch 19/80
 - 2s - loss: 0.1176
Epoch 20/80
 - 2s - loss: 0.1155
Epoch 21/80
 - 2s - loss: 0.1137
Epoch 22/80
 - 2s - loss: 0.1121
Epoch 23/80
 - 2s - loss: 0.1107
Epoch 24/80
 - 2s - loss: 0.1096
Epoch 25/80
 - 2s - loss: 0.1086
Epoch 26/80
 - 2s - loss: 0.1077
Epoch 27/80
 - 2s - loss: 0.1069
Epoch 28/80
 - 2s - loss: 0.1063
Epoch 29/80
 - 2s - loss: 0.1058
Epoch 30/80
 - 2s - loss: 0.1053
Epoch 31/80
 - 2s - loss: 0.1049
Epoch 32/80
 - 2s - loss: 0.1045
Epoch 33/80
 - 2s - loss: 0.1042
Epoch 34/80
 - 2s - loss: 0.1039
Epoch 35/80
 - 2s - loss: 0.1036
Epoch 36/80
 - 2s - loss: 0.1034
Epoch 37/80
 - 2s - loss: 0.1032
Epoch 38/80
 - 2s - loss: 0.1030
Epoch 39/80
 - 2s - loss: 0.1028
Epoch 40/80
 - 2s - loss: 0.1027
Epoch 41/80
 - 2s - loss: 0.1026
Epoch 42/80
 - 2s - loss: 0.1024
Epoch 43/80
 - 2s - loss: 0.1023
Epoch 44/80
 - 2s - loss: 0.1022
Epoch 45/80
 - 2s - loss: 0.1021
Epoch 46/80
 - 2s - loss: 0.1020
Epoch 47/80
 - 2s - loss: 0.1019
Epoch 48/80
 - 2s - loss: 0.1018
Epoch 49/80
 - 2s - loss: 0.1017
Epoch 50/80
 - 2s - loss: 0.1016
Epoch 51/80
 - 2s - loss: 0.1016
Epoch 52/80
 - 2s - loss: 0.1015
Epoch 53/80
 - 2s - loss: 0.1014
Epoch 54/80
 - 2s - loss: 0.1014
Epoch 55/80
 - 2s - loss: 0.1013
Epoch 56/80
 - 2s - loss: 0.1013
Epoch 57/80
 - 2s - loss: 0.1012
Epoch 58/80
 - 2s - loss: 0.1012
Epoch 59/80
 - 2s - loss: 0.1012
Epoch 60/80
 - 2s - loss: 0.1011
Epoch 61/80
 - 2s - loss: 0.1011
Epoch 62/80
 - 2s - loss: 0.1010
Epoch 63/80
 - 2s - loss: 0.1010
Epoch 64/80
 - 2s - loss: 0.1009
Epoch 65/80
 - 2s - loss: 0.1009
Epoch 66/80
 - 2s - loss: 0.1009
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 06:54:41.617839: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:54:41.787361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:54:41.787408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:54:42.087233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:54:42.087289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:54:42.087298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:54:42.087563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2913
Epoch 2/80
 - 2s - loss: 0.3322
Epoch 3/80
 - 2s - loss: 0.3023
Epoch 4/80
 - 2s - loss: 0.2808
Epoch 5/80
 - 2s - loss: 0.2531
Epoch 6/80
 - 2s - loss: 0.2276
Epoch 7/80
 - 2s - loss: 0.2084
Epoch 8/80
 - 2s - loss: 0.1926
Epoch 9/80
 - 2s - loss: 0.1790
Epoch 10/80
 - 2s - loss: 0.1674
Epoch 11/80
 - 2s - loss: 0.1575
Epoch 12/80
 - 2s - loss: 0.1491
Epoch 13/80
 - 2s - loss: 0.1419
Epoch 14/80
 - 2s - loss: 0.1360
Epoch 15/80
 - 2s - loss: 0.1311
Epoch 16/80
 - 2s - loss: 0.1270
Epoch 17/80
 - 2s - loss: 0.1236
Epoch 18/80
 - 2s - loss: 0.1208
Epoch 19/80
 - 2s - loss: 0.1184
Epoch 20/80
 - 2s - loss: 0.1163
Epoch 21/80
 - 2s - loss: 0.1145
Epoch 22/80
 - 2s - loss: 0.1130
Epoch 23/80
 - 2s - loss: 0.1117
Epoch 24/80
 - 2s - loss: 0.1105
Epoch 25/80
 - 2s - loss: 0.1095
Epoch 26/80
 - 2s - loss: 0.1086
Epoch 27/80
 - 2s - loss: 0.1079
Epoch 28/80
 - 2s - loss: 0.1072
Epoch 29/80
 - 2s - loss: 0.1066
Epoch 30/80
 - 2s - loss: 0.1061
Epoch 31/80
 - 2s - loss: 0.1057
Epoch 32/80
 - 2s - loss: 0.1053
Epoch 33/80
 - 2s - loss: 0.1049
Epoch 34/80
 - 2s - loss: 0.1046
Epoch 35/80
 - 2s - loss: 0.1043
Epoch 36/80
 - 2s - loss: 0.1041
Epoch 37/80
 - 2s - loss: 0.1038
Epoch 38/80
 - 2s - loss: 0.1036
Epoch 39/80
 - 2s - loss: 0.1034
Epoch 40/80
 - 2s - loss: 0.1033
Epoch 41/80
 - 2s - loss: 0.1031
Epoch 42/80
 - 2s - loss: 0.1029
Epoch 43/80
 - 2s - loss: 0.1029
Epoch 44/80
 - 2s - loss: 0.1027
Epoch 45/80
 - 2s - loss: 0.1026
Epoch 46/80
 - 2s - loss: 0.1025
Epoch 47/80
 - 2s - loss: 0.1024
Epoch 48/80
 - 2s - loss: 0.1023
Epoch 49/80
 - 2s - loss: 0.1022
Epoch 50/80
 - 2s - loss: 0.1021
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 06:56:41.733246: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 06:56:41.907354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 06:56:41.907404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 06:56:42.231947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 06:56:42.232008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 06:56:42.232018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 06:56:42.232296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0901
Epoch 2/80
 - 2s - loss: 0.1979
Epoch 3/80
 - 2s - loss: 0.1656
Epoch 4/80
 - 2s - loss: 0.1472
Epoch 5/80
 - 2s - loss: 0.1295
Epoch 6/80
 - 2s - loss: 0.1165
Epoch 7/80
 - 2s - loss: 0.1067
Epoch 8/80
 - 2s - loss: 0.0989
Epoch 9/80
 - 2s - loss: 0.0922
Epoch 10/80
 - 2s - loss: 0.0861
Epoch 11/80
 - 2s - loss: 0.0806
Epoch 12/80
 - 2s - loss: 0.0756
Epoch 13/80
 - 2s - loss: 0.0713
Epoch 14/80
 - 2s - loss: 0.0676
Epoch 15/80
 - 2s - loss: 0.0644
Epoch 16/80
 - 2s - loss: 0.0616
Epoch 17/80
 - 2s - loss: 0.0593
Epoch 18/80
 - 2s - loss: 0.0573
Epoch 19/80
 - 2s - loss: 0.0555
Epoch 20/80
 - 2s - loss: 0.0540
Epoch 21/80
 - 2s - loss: 0.0527
Epoch 22/80
 - 2s - loss: 0.0516
Epoch 23/80
 - 2s - loss: 0.0506
Epoch 24/80
 - 2s - loss: 0.0498
Epoch 25/80
 - 2s - loss: 0.0490
Epoch 26/80
 - 2s - loss: 0.0484
Epoch 27/80
 - 2s - loss: 0.0478
Epoch 28/80
 - 2s - loss: 0.0473
Epoch 29/80
 - 2s - loss: 0.0469
Epoch 30/80
 - 2s - loss: 0.0465
Epoch 31/80
 - 2s - loss: 0.0462
Epoch 32/80
 - 2s - loss: 0.0459
Epoch 33/80
 - 2s - loss: 0.0457
Epoch 34/80
 - 2s - loss: 0.0454
Epoch 35/80
 - 2s - loss: 0.0452
Epoch 36/80
 - 2s - loss: 0.0450
Epoch 37/80
 - 2s - loss: 0.0449
Epoch 38/80
 - 2s - loss: 0.0447
Epoch 39/80
 - 2s - loss: 0.0446
Epoch 40/80
 - 2s - loss: 0.0445
Epoch 41/80
 - 2s - loss: 0.0444
Epoch 42/80
 - 2s - loss: 0.0443
Epoch 43/80
 - 2s - loss: 0.0442
Epoch 44/80
 - 2s - loss: 0.0441
Epoch 45/80
 - 2s - loss: 0.0440
Epoch 46/80
 - 2s - loss: 0.0440
Epoch 47/80
 - 2s - loss: 0.0439
Epoch 48/80
 - 2s - loss: 0.0438
Epoch 49/80
 - 2s - loss: 0.0438
Epoch 50/80
 - 2s - loss: 0.0437
Epoch 51/80
 - 2s - loss: 0.0437
Epoch 52/80
 - 2s - loss: 0.0436
Epoch 53/80
 - 2s - loss: 0.0436
Epoch 54/80
 - 2s - loss: 0.0436
Epoch 55/80
 - 2s - loss: 0.0435
Epoch 56/80
 - 2s - loss: 0.0435
Epoch 57/80
 - 2s - loss: 0.0422
Epoch 58/80
 - 2s - loss: 0.0421
Epoch 59/80
 - 2s - loss: 0.0421
Epoch 60/80
 - 2s - loss: 0.0421
Epoch 61/80
 - 2s - loss: 0.0421
Epoch 62/80
 - 2s - loss: 0.0417
Epoch 63/80
 - 2s - loss: 0.0417
Epoch 64/80
 - 2s - loss: 0.0417
Epoch 65/80
 - 2s - loss: 0.0417
Epoch 66/80
 - 2s - loss: 0.0417
Epoch 67/80
 - 2s - loss: 0.0417
Epoch 68/80
 - 2s - loss: 0.0417
Epoch 69/80
 - 2s - loss: 0.0416
Epoch 70/80
 - 2s - loss: 0.0416
Epoch 71/80
 - 2s - loss: 0.0416
Epoch 72/80
 - 2s - loss: 0.0416
Epoch 73/80
 - 2s - loss: 0.0416
Epoch 74/80
 - 2s - loss: 0.0416
Epoch 75/80
 - 2s - loss: 0.0416
Epoch 76/80
 - 2s - loss: 0.0416
Epoch 77/80
 - 2s - loss: 0.0416
Epoch 78/80
 - 2s - loss: 0.0416
Epoch 79/80
 - 2s - loss: 0.0416
Epoch 80/80
 - 2s - loss: 0.0416
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 6.1131 - val_loss: 2.2703
AUC: 0.7720

Epoch 2/80
 - 0s - loss: 3.5886 - val_loss: 1.5126
AUC: 0.8117

Epoch 3/80
 - 0s - loss: 2.2103 - val_loss: 0.9713
AUC: 0.8317

Epoch 4/80
 - 0s - loss: 1.4533 - val_loss: 0.8467
AUC: 0.8373

Epoch 5/80
 - 0s - loss: 1.2787 - val_loss: 0.7047
AUC: 0.8451

Epoch 6/80
 - 0s - loss: 1.2038 - val_loss: 0.6219
AUC: 0.8488

Epoch 7/80
 - 0s - loss: 1.1714 - val_loss: 0.6798
AUC: 0.8534

Epoch 8/80
 - 0s - loss: 1.1419 - val_loss: 0.6458
AUC: 0.8550

Epoch 9/80
 - 0s - loss: 1.1309 - val_loss: 0.6467
AUC: 0.8573

Epoch 10/80
 - 0s - loss: 1.1041 - val_loss: 0.6458
AUC: 0.8597

Epoch 11/80
 - 0s - loss: 1.0978 - val_loss: 0.6432
AUC: 0.8610

Epoch 12/80
 - 0s - loss: 1.0860 - val_loss: 0.6200
AUC: 0.8640

Epoch 13/80
 - 0s - loss: 1.0762 - val_loss: 0.6248
AUC: 0.8643

Epoch 14/80
 - 0s - loss: 1.0776 - val_loss: 0.6727
AUC: 0.8668

Epoch 15/80
 - 0s - loss: 1.0697 - val_loss: 0.6428
AUC: 0.8676

Epoch 16/80
 - 0s - loss: 1.0634 - val_loss: 0.6779
AUC: 0.8678

Epoch 17/80
 - 0s - loss: 1.0568 - val_loss: 0.5682
AUC: 0.8670

Epoch 18/80
 - 0s - loss: 1.0568 - val_loss: 0.6843
AUC: 0.8686

Epoch 19/80
 - 0s - loss: 1.0573 - val_loss: 0.6080
AUC: 0.8681

Epoch 20/80
 - 0s - loss: 1.0483 - val_loss: 0.6716
AUC: 0.8704

Epoch 21/80
 - 0s - loss: 1.0476 - val_loss: 0.6823
AUC: 0.8704

Epoch 22/80
 - 0s - loss: 1.0503 - val_loss: 0.6244
AUC: 0.8700

Epoch 23/80
 - 0s - loss: 1.0297 - val_loss: 0.6449
AUC: 0.8700

Epoch 24/80
 - 0s - loss: 1.0272 - val_loss: 0.5967
AUC: 0.8709

Epoch 25/80
 - 0s - loss: 1.0224 - val_loss: 0.5744
AUC: 0.8683

Epoch 26/80
 - 0s - loss: 1.0278 - val_loss: 0.6295
AUC: 0.8713

Epoch 27/80
 - 0s - loss: 1.0266 - val_loss: 0.6113
AUC: 0.8707

Epoch 28/80
 - 0s - loss: 1.0114 - val_loss: 0.6178
AUC: 0.8725

Epoch 29/80
 - 0s - loss: 1.0159 - val_loss: 0.6256
AUC: 0.8729

Epoch 30/80
 - 0s - loss: 1.0113 - val_loss: 0.6259
AUC: 0.8731

Epoch 31/80
 - 0s - loss: 1.0136 - val_loss: 0.6414
AUC: 0.8733

Epoch 32/80
 - 0s - loss: 1.0035 - val_loss: 0.6061
AUC: 0.8729

Epoch 33/80
 - 0s - loss: 1.0076 - val_loss: 0.6113
AUC: 0.8733

Epoch 34/80
 - 0s - loss: 1.0051 - val_loss: 0.6210
AUC: 0.8729

Epoch 35/80
 - 0s - loss: 1.0108 - val_loss: 0.6331
AUC: 0.8733

Epoch 36/80
 - 0s - loss: 1.0070 - val_loss: 0.6098
AUC: 0.8734

Epoch 37/80
 - 0s - loss: 1.0085 - val_loss: 0.6408
AUC: 0.8735

Epoch 38/80
 - 0s - loss: 1.0058 - val_loss: 0.6124
AUC: 0.8733

Epoch 39/80
 - 0s - loss: 1.0032 - val_loss: 0.6105
AUC: 0.8733

Epoch 40/80
 - 0s - loss: 0.9982 - val_loss: 0.6129
AUC: 0.8733

Epoch 41/80
 - 0s - loss: 1.0006 - val_loss: 0.6150
AUC: 0.8733

Epoch 42/80
 - 0s - loss: 1.0050 - val_loss: 0.6124
AUC: 0.8733

Epoch 43/80
 - 0s - loss: 0.9954 - val_loss: 0.6094
AUC: 0.8733

Epoch 44/80
 - 0s - loss: 1.0052 - val_loss: 0.6016
AUC: 0.8733

Epoch 45/80
 - 0s - loss: 1.0017 - val_loss: 0.6124
AUC: 0.8734

Epoch 46/80
 - 0s - loss: 1.0008 - val_loss: 0.6100
AUC: 0.8733

Epoch 47/80
 - 0s - loss: 1.0056 - val_loss: 0.6145
AUC: 0.8734

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0029 - val_loss: 0.6174
AUC: 0.8733

Epoch 2/30
 - 0s - loss: 1.0033 - val_loss: 0.6355
AUC: 0.8736

Epoch 3/30
 - 0s - loss: 0.9983 - val_loss: 0.6102
AUC: 0.8733

Epoch 4/30
 - 0s - loss: 1.0014 - val_loss: 0.6335
AUC: 0.8738

Epoch 5/30
 - 0s - loss: 1.0012 - val_loss: 0.6186
AUC: 0.8743

Epoch 6/30
 - 0s - loss: 1.0000 - val_loss: 0.6028
AUC: 0.8739

Epoch 7/30
 - 0s - loss: 0.9916 - val_loss: 0.6143
AUC: 0.8740

Epoch 8/30
 - 0s - loss: 0.9942 - val_loss: 0.6173
AUC: 0.8744

Epoch 9/30
 - 0s - loss: 0.9964 - val_loss: 0.5991
AUC: 0.8739

Epoch 10/30
 - 0s - loss: 0.9885 - val_loss: 0.6054
AUC: 0.8744

Epoch 11/30
 - 0s - loss: 0.9891 - val_loss: 0.6121
AUC: 0.8747

Epoch 12/30
 - 0s - loss: 0.9898 - val_loss: 0.6088
AUC: 0.8749

Epoch 13/30
 - 0s - loss: 0.9866 - val_loss: 0.6030
AUC: 0.8746

Epoch 14/30
 - 0s - loss: 0.9780 - val_loss: 0.5783
AUC: 0.8745

Epoch 15/30
 - 0s - loss: 0.9860 - val_loss: 0.5939
AUC: 0.8749

Epoch 16/30
 - 0s - loss: 0.9862 - val_loss: 0.6109
AUC: 0.8752

Epoch 17/30
 - 0s - loss: 0.9791 - val_loss: 0.6178
AUC: 0.8751

Epoch 18/30
 - 0s - loss: 0.9781 - val_loss: 0.6140
AUC: 0.8755

Epoch 19/30
 - 0s - loss: 0.9767 - val_loss: 0.6128
AUC: 0.8752

Epoch 20/30
 - 0s - loss: 0.9710 - val_loss: 0.6104
AUC: 0.8753

Epoch 21/30
 - 0s - loss: 0.9763 - val_loss: 0.5823
AUC: 0.8750

Epoch 22/30
 - 0s - loss: 0.9701 - val_loss: 0.6168
AUC: 0.8753

Epoch 23/30
 - 0s - loss: 0.9715 - val_loss: 0.6021
AUC: 0.8751

Epoch 24/30
 - 0s - loss: 0.9652 - val_loss: 0.6144
AUC: 0.8753

Epoch 25/30
 - 0s - loss: 0.9670 - val_loss: 0.6001
AUC: 0.8753

Epoch 26/30
 - 0s - loss: 0.9684 - val_loss: 0.5922
AUC: 0.8753

Epoch 27/30
 - 0s - loss: 0.9633 - val_loss: 0.5979
AUC: 0.8755

Epoch 28/30
 - 0s - loss: 0.9677 - val_loss: 0.6000
AUC: 0.8755

Epoch 29/30
 - 0s - loss: 0.9673 - val_loss: 0.5968
AUC: 0.8755

Epoch 30/30
 - 0s - loss: 0.9664 - val_loss: 0.6000
Using TensorFlow backend.
AUC: 0.8755

2019-03-08 07:00:32.213963: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:00:32.387092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:00:32.387153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:00:32.723337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:00:32.723387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:00:32.723396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:00:32.723691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0852
Epoch 2/80
 - 2s - loss: 0.1962
Epoch 3/80
 - 2s - loss: 0.1690
Epoch 4/80
 - 2s - loss: 0.1581
Epoch 5/80
 - 2s - loss: 0.1451
Epoch 6/80
 - 2s - loss: 0.1327
Epoch 7/80
 - 2s - loss: 0.1212
Epoch 8/80
 - 2s - loss: 0.1100
Epoch 9/80
 - 2s - loss: 0.0998
Epoch 10/80
 - 2s - loss: 0.0911
Epoch 11/80
 - 2s - loss: 0.0838
Epoch 12/80
 - 2s - loss: 0.0776
Epoch 13/80
 - 2s - loss: 0.0724
Epoch 14/80
 - 2s - loss: 0.0682
Epoch 15/80
 - 2s - loss: 0.0648
Epoch 16/80
 - 2s - loss: 0.0620
Epoch 17/80
 - 2s - loss: 0.0597
Epoch 18/80
 - 2s - loss: 0.0577
Epoch 19/80
 - 2s - loss: 0.0559
Epoch 20/80
 - 2s - loss: 0.0544
Epoch 21/80
 - 2s - loss: 0.0531
Epoch 22/80
 - 2s - loss: 0.0519
Epoch 23/80
 - 2s - loss: 0.0509
Epoch 24/80
 - 2s - loss: 0.0500
Epoch 25/80
 - 2s - loss: 0.0493
Epoch 26/80
 - 2s - loss: 0.0486
Epoch 27/80
 - 2s - loss: 0.0480
Epoch 28/80
 - 2s - loss: 0.0476
Epoch 29/80
 - 2s - loss: 0.0471
Epoch 30/80
 - 2s - loss: 0.0468
Epoch 31/80
 - 2s - loss: 0.0464
Epoch 32/80
 - 2s - loss: 0.0461
Epoch 33/80
 - 2s - loss: 0.0459
Epoch 34/80
 - 2s - loss: 0.0457
Epoch 35/80
 - 2s - loss: 0.0454
Epoch 36/80
 - 2s - loss: 0.0453
Epoch 37/80
 - 2s - loss: 0.0451
Epoch 38/80
 - 2s - loss: 0.0450
Epoch 39/80
 - 2s - loss: 0.0448
Epoch 40/80
 - 2s - loss: 0.0447
Epoch 41/80
 - 2s - loss: 0.0446
Epoch 42/80
 - 2s - loss: 0.0445
Epoch 43/80
 - 2s - loss: 0.0444
Epoch 44/80
 - 2s - loss: 0.0443
Epoch 45/80
 - 2s - loss: 0.0442
Epoch 46/80
 - 2s - loss: 0.0441
Epoch 47/80
 - 2s - loss: 0.0441
Epoch 48/80
 - 2s - loss: 0.0440
Epoch 49/80
 - 2s - loss: 0.0440
Epoch 50/80
 - 2s - loss: 0.0439
Epoch 51/80
 - 2s - loss: 0.0439
Epoch 52/80
 - 2s - loss: 0.0438
Epoch 53/80
 - 2s - loss: 0.0438
Epoch 54/80
 - 2s - loss: 0.0437
Epoch 55/80
 - 2s - loss: 0.0437
Epoch 56/80
 - 2s - loss: 0.0437
Epoch 57/80
 - 2s - loss: 0.0436
Epoch 58/80
 - 2s - loss: 0.0436
Epoch 59/80
 - 2s - loss: 0.0435
Epoch 60/80
 - 2s - loss: 0.0435
Epoch 61/80
 - 2s - loss: 0.0435
Epoch 62/80
 - 2s - loss: 0.0422
Epoch 63/80
 - 2s - loss: 0.0421
Epoch 64/80
 - 2s - loss: 0.0421
Epoch 65/80
 - 2s - loss: 0.0421
Epoch 66/80
 - 2s - loss: 0.0421
Epoch 67/80
 - 2s - loss: 0.0417
Epoch 68/80
 - 2s - loss: 0.0417
Epoch 69/80
 - 2s - loss: 0.0417
Epoch 70/80
 - 2s - loss: 0.0417
Epoch 71/80
 - 2s - loss: 0.0417
Epoch 72/80
 - 2s - loss: 0.0417
Epoch 73/80
 - 2s - loss: 0.0417
Epoch 74/80
 - 2s - loss: 0.0416
Epoch 75/80
 - 2s - loss: 0.0416
Epoch 76/80
 - 2s - loss: 0.0416
Epoch 77/80
 - 2s - loss: 0.0416
Epoch 78/80
 - 2s - loss: 0.0416
Epoch 79/80
 - 2s - loss: 0.0416
Epoch 80/80
 - 2s - loss: 0.0416
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.6511 - val_loss: 1.2751
AUC: 0.8037

Epoch 2/80
 - 0s - loss: 2.0641 - val_loss: 0.8618
AUC: 0.8357

Epoch 3/80
 - 0s - loss: 1.4470 - val_loss: 0.7134
AUC: 0.8412

Epoch 4/80
 - 0s - loss: 1.2492 - val_loss: 0.7313
AUC: 0.8480

Epoch 5/80
 - 0s - loss: 1.1631 - val_loss: 0.7066
AUC: 0.8523

Epoch 6/80
 - 0s - loss: 1.1352 - val_loss: 0.7232
AUC: 0.8566

Epoch 7/80
 - 0s - loss: 1.1009 - val_loss: 0.6747
AUC: 0.8571

Epoch 8/80
 - 0s - loss: 1.0955 - val_loss: 0.6727
AUC: 0.8596

Epoch 9/80
 - 0s - loss: 1.0772 - val_loss: 0.6115
AUC: 0.8607

Epoch 10/80
 - 0s - loss: 1.0599 - val_loss: 0.6707
AUC: 0.8628

Epoch 11/80
 - 0s - loss: 1.0478 - val_loss: 0.6789
AUC: 0.8624

Epoch 12/80
 - 0s - loss: 1.0452 - val_loss: 0.6125
AUC: 0.8634

Epoch 13/80
 - 0s - loss: 1.0421 - val_loss: 0.6160
AUC: 0.8652

Epoch 14/80
 - 0s - loss: 1.0368 - val_loss: 0.6248
AUC: 0.8654

Epoch 15/80
 - 0s - loss: 1.0346 - val_loss: 0.6267
AUC: 0.8654

Epoch 16/80
 - 0s - loss: 1.0220 - val_loss: 0.5990
AUC: 0.8650

Epoch 17/80
 - 0s - loss: 1.0206 - val_loss: 0.6489
AUC: 0.8669

Epoch 18/80
 - 0s - loss: 1.0214 - val_loss: 0.5498
AUC: 0.8671

Epoch 19/80
 - 0s - loss: 1.0147 - val_loss: 0.5848
AUC: 0.8672

Epoch 20/80
 - 0s - loss: 1.0121 - val_loss: 0.7149
AUC: 0.8680

Epoch 21/80
 - 0s - loss: 1.0095 - val_loss: 0.6105
AUC: 0.8680

Epoch 22/80
 - 0s - loss: 1.0064 - val_loss: 0.5906
AUC: 0.8663

Epoch 23/80
 - 0s - loss: 1.0062 - val_loss: 0.5306
AUC: 0.8659

Epoch 24/80
 - 0s - loss: 0.9966 - val_loss: 0.6443
AUC: 0.8687

Epoch 25/80
 - 0s - loss: 0.9946 - val_loss: 0.6110
AUC: 0.8695

Epoch 26/80
 - 0s - loss: 0.9910 - val_loss: 0.5683
AUC: 0.8687

Epoch 27/80
 - 0s - loss: 0.9933 - val_loss: 0.6407
AUC: 0.8693

Epoch 28/80
 - 0s - loss: 0.9897 - val_loss: 0.5752
AUC: 0.8691

Epoch 29/80
 - 0s - loss: 0.9852 - val_loss: 0.5896
AUC: 0.8693

Epoch 30/80
 - 0s - loss: 0.9804 - val_loss: 0.6069
AUC: 0.8678

Epoch 31/80
 - 0s - loss: 0.9783 - val_loss: 0.5258
AUC: 0.8693

Epoch 32/80
 - 0s - loss: 0.9794 - val_loss: 0.6073
AUC: 0.8695

Epoch 33/80
 - 0s - loss: 0.9746 - val_loss: 0.5931
AUC: 0.8694

Epoch 34/80
 - 0s - loss: 0.9704 - val_loss: 0.6211
AUC: 0.8697

Epoch 35/80
 - 0s - loss: 0.9756 - val_loss: 0.5700
AUC: 0.8696

Epoch 36/80
 - 0s - loss: 0.9704 - val_loss: 0.5942
AUC: 0.8702

Epoch 37/80
 - 0s - loss: 0.9667 - val_loss: 0.6368
AUC: 0.8714

Epoch 38/80
 - 0s - loss: 0.9649 - val_loss: 0.5926
AUC: 0.8705

Epoch 39/80
 - 0s - loss: 0.9622 - val_loss: 0.5712
AUC: 0.8708

Epoch 40/80
 - 0s - loss: 0.9606 - val_loss: 0.5634
AUC: 0.8705

Epoch 41/80
 - 0s - loss: 0.9665 - val_loss: 0.5613
AUC: 0.8695

Epoch 42/80
 - 0s - loss: 0.9526 - val_loss: 0.5718
AUC: 0.8712

Epoch 43/80
 - 0s - loss: 0.9460 - val_loss: 0.5536
AUC: 0.8715

Epoch 44/80
 - 0s - loss: 0.9461 - val_loss: 0.5835
AUC: 0.8718

Epoch 45/80
 - 0s - loss: 0.9451 - val_loss: 0.5763
AUC: 0.8717

Epoch 46/80
 - 0s - loss: 0.9391 - val_loss: 0.6086
AUC: 0.8720

Epoch 47/80
 - 0s - loss: 0.9428 - val_loss: 0.5836
AUC: 0.8718

Epoch 48/80
 - 0s - loss: 0.9433 - val_loss: 0.5893
AUC: 0.8717

Epoch 49/80
 - 0s - loss: 0.9403 - val_loss: 0.5643
AUC: 0.8716

Epoch 50/80
 - 0s - loss: 0.9408 - val_loss: 0.5386
AUC: 0.8712

Epoch 51/80
 - 0s - loss: 0.9453 - val_loss: 0.5693
AUC: 0.8714

Epoch 52/80
 - 0s - loss: 0.9433 - val_loss: 0.5808
AUC: 0.8717

Epoch 53/80
 - 0s - loss: 0.9383 - val_loss: 0.5725
AUC: 0.8716

Epoch 54/80
 - 0s - loss: 0.9452 - val_loss: 0.5741
AUC: 0.8717

Epoch 55/80
 - 0s - loss: 0.9348 - val_loss: 0.5726
AUC: 0.8716

Epoch 56/80
 - 0s - loss: 0.9312 - val_loss: 0.5720
AUC: 0.8716

Epoch 57/80
 - 0s - loss: 0.9361 - val_loss: 0.5764
AUC: 0.8717

Epoch 58/80
 - 0s - loss: 0.9400 - val_loss: 0.5788
AUC: 0.8717

Epoch 59/80
 - 0s - loss: 0.9381 - val_loss: 0.5800
AUC: 0.8717

Epoch 60/80
 - 0s - loss: 0.9382 - val_loss: 0.5808
AUC: 0.8717

Epoch 61/80
 - 0s - loss: 0.9386 - val_loss: 0.5826
AUC: 0.8718

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9418 - val_loss: 0.5988
AUC: 0.8721

Epoch 2/30
 - 0s - loss: 0.9401 - val_loss: 0.5671
AUC: 0.8717

Epoch 3/30
 - 0s - loss: 0.9409 - val_loss: 0.5636
AUC: 0.8717

Epoch 4/30
 - 0s - loss: 0.9377 - val_loss: 0.5706
AUC: 0.8718

Epoch 5/30
 - 0s - loss: 0.9312 - val_loss: 0.5824
AUC: 0.8720

Epoch 6/30
 - 0s - loss: 0.9365 - val_loss: 0.5796
AUC: 0.8719

Epoch 7/30
 - 0s - loss: 0.9321 - val_loss: 0.5961
AUC: 0.8722

Epoch 8/30
 - 0s - loss: 0.9316 - val_loss: 0.5745
AUC: 0.8721

Epoch 9/30
 - 0s - loss: 0.9325 - val_loss: 0.5597
AUC: 0.8719

Epoch 10/30
 - 0s - loss: 0.9262 - val_loss: 0.5670
AUC: 0.8721

Epoch 11/30
 - 0s - loss: 0.9266 - val_loss: 0.5728
AUC: 0.8723

Epoch 12/30
 - 0s - loss: 0.9248 - val_loss: 0.5650
AUC: 0.8723

Epoch 13/30
 - 0s - loss: 0.9208 - val_loss: 0.5604
AUC: 0.8723

Epoch 14/30
 - 0s - loss: 0.9227 - val_loss: 0.5749
AUC: 0.8724

Epoch 15/30
 - 0s - loss: 0.9195 - val_loss: 0.5736
AUC: 0.8727

Epoch 16/30
 - 0s - loss: 0.9178 - val_loss: 0.5597
AUC: 0.8725

Epoch 17/30
 - 0s - loss: 0.9173 - val_loss: 0.5670
AUC: 0.8727

Epoch 18/30
 - 0s - loss: 0.9150 - val_loss: 0.5708
AUC: 0.8729

Epoch 19/30
 - 0s - loss: 0.9178 - val_loss: 0.5831
AUC: 0.8729

Epoch 20/30
 - 0s - loss: 0.9169 - val_loss: 0.5705
AUC: 0.8728

Epoch 21/30
 - 0s - loss: 0.9199 - val_loss: 0.5702
AUC: 0.8728

Epoch 22/30
 - 0s - loss: 0.9140 - val_loss: 0.5724
AUC: 0.8728

Epoch 23/30
 - 0s - loss: 0.9200 - val_loss: 0.5686
AUC: 0.8728

Epoch 24/30
 - 0s - loss: 0.9122 - val_loss: 0.5683
AUC: 0.8727

Epoch 25/30
 - 0s - loss: 0.9133 - val_loss: 0.5674
AUC: 0.8728

Epoch 26/30
 - 0s - loss: 0.9164 - val_loss: 0.5666
AUC: 0.8727

Epoch 27/30
 - 0s - loss: 0.9159 - val_loss: 0.5671
AUC: 0.8728

Epoch 28/30
 - 0s - loss: 0.9095 - val_loss: 0.5637
AUC: 0.8728

Epoch 29/30
 - 0s - loss: 0.9127 - val_loss: 0.5708
AUC: 0.8729

Epoch 30/30
 - 0s - loss: 0.9118 - val_loss: 0.5688
Using TensorFlow backend.
AUC: 0.8729

2019-03-08 07:04:31.474149: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:04:31.648412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:04:31.648465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:04:31.971847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:04:31.971912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:04:31.971923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:04:31.972231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0772
Epoch 2/80
 - 2s - loss: 0.1957
Epoch 3/80
 - 2s - loss: 0.1635
Epoch 4/80
 - 2s - loss: 0.1491
Epoch 5/80
 - 2s - loss: 0.1375
Epoch 6/80
 - 2s - loss: 0.1273
Epoch 7/80
 - 2s - loss: 0.1171
Epoch 8/80
 - 2s - loss: 0.1071
Epoch 9/80
 - 2s - loss: 0.0982
Epoch 10/80
 - 2s - loss: 0.0901
Epoch 11/80
 - 2s - loss: 0.0831
Epoch 12/80
 - 2s - loss: 0.0773
Epoch 13/80
 - 2s - loss: 0.0725
Epoch 14/80
 - 2s - loss: 0.0685
Epoch 15/80
 - 2s - loss: 0.0652
Epoch 16/80
 - 2s - loss: 0.0624
Epoch 17/80
 - 2s - loss: 0.0600
Epoch 18/80
 - 2s - loss: 0.0579
Epoch 19/80
 - 2s - loss: 0.0561
Epoch 20/80
 - 2s - loss: 0.0546
Epoch 21/80
 - 2s - loss: 0.0532
Epoch 22/80
 - 2s - loss: 0.0520
Epoch 23/80
 - 2s - loss: 0.0510
Epoch 24/80
 - 2s - loss: 0.0501
Epoch 25/80
 - 2s - loss: 0.0494
Epoch 26/80
 - 2s - loss: 0.0487
Epoch 27/80
 - 2s - loss: 0.0481
Epoch 28/80
 - 2s - loss: 0.0476
Epoch 29/80
 - 2s - loss: 0.0472
Epoch 30/80
 - 2s - loss: 0.0468
Epoch 31/80
 - 2s - loss: 0.0465
Epoch 32/80
 - 2s - loss: 0.0462
Epoch 33/80
 - 2s - loss: 0.0459
Epoch 34/80
 - 2s - loss: 0.0457
Epoch 35/80
 - 2s - loss: 0.0455
Epoch 36/80
 - 2s - loss: 0.0453
Epoch 37/80
 - 2s - loss: 0.0452
Epoch 38/80
 - 2s - loss: 0.0450
Epoch 39/80
 - 2s - loss: 0.0449
Epoch 40/80
 - 2s - loss: 0.0448
Epoch 41/80
 - 2s - loss: 0.0446
Epoch 42/80
 - 2s - loss: 0.0446
Epoch 43/80
 - 2s - loss: 0.0445
Epoch 44/80
 - 2s - loss: 0.0444
Epoch 45/80
 - 2s - loss: 0.0443
Epoch 46/80
 - 2s - loss: 0.0442
Epoch 47/80
 - 2s - loss: 0.0442
Epoch 48/80
 - 2s - loss: 0.0441
Epoch 49/80
 - 2s - loss: 0.0440
Epoch 50/80
 - 2s - loss: 0.0440
Epoch 51/80
 - 2s - loss: 0.0439
Epoch 52/80
 - 2s - loss: 0.0439
Epoch 53/80
 - 2s - loss: 0.0438
Epoch 54/80
 - 2s - loss: 0.0438
Epoch 55/80
 - 2s - loss: 0.0437
Epoch 56/80
 - 2s - loss: 0.0437
Epoch 57/80
 - 2s - loss: 0.0437
Epoch 58/80
 - 2s - loss: 0.0436
Epoch 59/80
 - 2s - loss: 0.0436
Epoch 60/80
 - 2s - loss: 0.0436
Epoch 61/80
 - 2s - loss: 0.0423
Epoch 62/80
 - 2s - loss: 0.0422
Epoch 63/80
 - 2s - loss: 0.0421
Epoch 64/80
 - 2s - loss: 0.0421
Epoch 65/80
 - 2s - loss: 0.0421
Epoch 66/80
 - 2s - loss: 0.0418
Epoch 67/80
 - 2s - loss: 0.0418
Epoch 68/80
 - 2s - loss: 0.0418
Epoch 69/80
 - 2s - loss: 0.0418
Epoch 70/80
 - 2s - loss: 0.0417
Epoch 71/80
 - 2s - loss: 0.0417
Epoch 72/80
 - 2s - loss: 0.0417
Epoch 73/80
 - 2s - loss: 0.0417
Epoch 74/80
 - 2s - loss: 0.0417
Epoch 75/80
 - 2s - loss: 0.0417
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:07:19.372883: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:07:19.540747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:07:19.540800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:07:19.848627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:07:19.848682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:07:19.848691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:07:19.848965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0843
Epoch 2/80
 - 2s - loss: 0.1940
Epoch 3/80
 - 2s - loss: 0.1582
Epoch 4/80
 - 2s - loss: 0.1423
Epoch 5/80
 - 2s - loss: 0.1323
Epoch 6/80
 - 2s - loss: 0.1238
Epoch 7/80
 - 2s - loss: 0.1154
Epoch 8/80
 - 2s - loss: 0.1068
Epoch 9/80
 - 2s - loss: 0.0984
Epoch 10/80
 - 2s - loss: 0.0907
Epoch 11/80
 - 2s - loss: 0.0842
Epoch 12/80
 - 2s - loss: 0.0787
Epoch 13/80
 - 2s - loss: 0.0740
Epoch 14/80
 - 2s - loss: 0.0698
Epoch 15/80
 - 2s - loss: 0.0660
Epoch 16/80
 - 2s - loss: 0.0628
Epoch 17/80
 - 2s - loss: 0.0600
Epoch 18/80
 - 2s - loss: 0.0577
Epoch 19/80
 - 2s - loss: 0.0558
Epoch 20/80
 - 2s - loss: 0.0541
Epoch 21/80
 - 2s - loss: 0.0528
Epoch 22/80
 - 2s - loss: 0.0517
Epoch 23/80
 - 2s - loss: 0.0507
Epoch 24/80
 - 2s - loss: 0.0498
Epoch 25/80
 - 2s - loss: 0.0491
Epoch 26/80
 - 2s - loss: 0.0485
Epoch 27/80
 - 2s - loss: 0.0479
Epoch 28/80
 - 2s - loss: 0.0475
Epoch 29/80
 - 2s - loss: 0.0470
Epoch 30/80
 - 2s - loss: 0.0467
Epoch 31/80
 - 2s - loss: 0.0464
Epoch 32/80
 - 2s - loss: 0.0461
Epoch 33/80
 - 2s - loss: 0.0458
Epoch 34/80
 - 2s - loss: 0.0456
Epoch 35/80
 - 2s - loss: 0.0454
Epoch 36/80
 - 2s - loss: 0.0453
Epoch 37/80
 - 2s - loss: 0.0451
Epoch 38/80
 - 2s - loss: 0.0450
Epoch 39/80
 - 2s - loss: 0.0448
Epoch 40/80
 - 2s - loss: 0.0447
Epoch 41/80
 - 2s - loss: 0.0446
Epoch 42/80
 - 2s - loss: 0.0445
Epoch 43/80
 - 2s - loss: 0.0444
Epoch 44/80
 - 2s - loss: 0.0444
Epoch 45/80
 - 2s - loss: 0.0443
Epoch 46/80
 - 2s - loss: 0.0442
Epoch 47/80
 - 2s - loss: 0.0442
Epoch 48/80
 - 2s - loss: 0.0441
Epoch 49/80
 - 2s - loss: 0.0440
Epoch 50/80
 - 2s - loss: 0.0440
Epoch 51/80
 - 2s - loss: 0.0439
Epoch 52/80
 - 2s - loss: 0.0439
Epoch 53/80
 - 2s - loss: 0.0439
Epoch 54/80
 - 2s - loss: 0.0438
Epoch 55/80
 - 2s - loss: 0.0438
Epoch 56/80
 - 2s - loss: 0.0437
Epoch 57/80
 - 2s - loss: 0.0437
Epoch 58/80
 - 2s - loss: 0.0425
Epoch 59/80
 - 2s - loss: 0.0423
Epoch 60/80
 - 2s - loss: 0.0423
Epoch 61/80
 - 2s - loss: 0.0423
Epoch 62/80
 - 2s - loss: 0.0423
Epoch 63/80
 - 2s - loss: 0.0420
Epoch 64/80
 - 2s - loss: 0.0420
Epoch 65/80
 - 2s - loss: 0.0420
Epoch 66/80
 - 2s - loss: 0.0420
Epoch 67/80
 - 2s - loss: 0.0419
Epoch 68/80
 - 2s - loss: 0.0419
Epoch 69/80
 - 2s - loss: 0.0419
Epoch 70/80
 - 2s - loss: 0.0419
Epoch 71/80
 - 2s - loss: 0.0419
Epoch 72/80
 - 2s - loss: 0.0419
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:09:57.612801: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:09:57.779725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:09:57.779774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:09:58.082347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:09:58.082401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:09:58.082410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:09:58.082676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6538
Epoch 2/80
 - 2s - loss: 0.1037
Epoch 3/80
 - 2s - loss: 0.0688
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:10:23.338224: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:10:23.502902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:10:23.502950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:10:23.802834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:10:23.802873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:10:23.802882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:10:23.803150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6636
Epoch 2/80
 - 2s - loss: 0.1032
Epoch 3/80
 - 2s - loss: 0.0692
Epoch 4/80
 - 2s - loss: 0.0646
Epoch 5/80
 - 2s - loss: 0.0617
Epoch 6/80
 - 2s - loss: 0.0575
Epoch 7/80
 - 2s - loss: 0.0521
Epoch 8/80
 - 2s - loss: 0.0468
Epoch 9/80
 - 2s - loss: 0.0425
Epoch 10/80
 - 2s - loss: 0.0388
Epoch 11/80
 - 2s - loss: 0.0356
Epoch 12/80
 - 2s - loss: 0.0327
Epoch 13/80
 - 2s - loss: 0.0301
Epoch 14/80
 - 2s - loss: 0.0278
Epoch 15/80
 - 2s - loss: 0.0259
Epoch 16/80
 - 2s - loss: 0.0242
Epoch 17/80
 - 2s - loss: 0.0229
Epoch 18/80
 - 2s - loss: 0.0217
Epoch 19/80
 - 2s - loss: 0.0207
Epoch 20/80
 - 2s - loss: 0.0199
Epoch 21/80
 - 2s - loss: 0.0191
Epoch 22/80
 - 2s - loss: 0.0185
Epoch 23/80
 - 2s - loss: 0.0180
Epoch 24/80
 - 2s - loss: 0.0175
Epoch 25/80
 - 2s - loss: 0.0171
Epoch 26/80
 - 2s - loss: 0.0168
Epoch 27/80
 - 2s - loss: 0.0165
Epoch 28/80
 - 2s - loss: 0.0162
Epoch 29/80
 - 2s - loss: 0.0160
Epoch 30/80
 - 2s - loss: 0.0158
Epoch 31/80
 - 2s - loss: 0.0156
Epoch 32/80
 - 2s - loss: 0.0154
Epoch 33/80
 - 2s - loss: 0.0153
Epoch 34/80
 - 2s - loss: 0.0152
Epoch 35/80
 - 2s - loss: 0.0151
Epoch 36/80
 - 2s - loss: 0.0150
Epoch 37/80
 - 2s - loss: 0.0149
Epoch 38/80
 - 2s - loss: 0.0148
Epoch 39/80
 - 2s - loss: 0.0147
Epoch 40/80
 - 2s - loss: 0.0147
Epoch 41/80
 - 2s - loss: 0.0146
Epoch 42/80
 - 2s - loss: 0.0146
Epoch 43/80
 - 2s - loss: 0.0145
Epoch 44/80
 - 2s - loss: 0.0145
Epoch 45/80
 - 2s - loss: 0.0144
Epoch 46/80
 - 2s - loss: 0.0144
Epoch 47/80
 - 2s - loss: 0.0144
Epoch 48/80
 - 2s - loss: 0.0143
Epoch 49/80
 - 2s - loss: 0.0143
Epoch 50/80
 - 2s - loss: 0.0139
Epoch 51/80
 - 2s - loss: 0.0138
Epoch 52/80
 - 2s - loss: 0.0138
Epoch 53/80
 - 2s - loss: 0.0138
Epoch 54/80
 - 2s - loss: 0.0137
Epoch 55/80
 - 2s - loss: 0.0137
Epoch 56/80
 - 2s - loss: 0.0137
Epoch 57/80
 - 2s - loss: 0.0137
Epoch 58/80
 - 2s - loss: 0.0137
Epoch 59/80
 - 2s - loss: 0.0137
Epoch 60/80
 - 2s - loss: 0.0137
Epoch 61/80
 - 2s - loss: 0.0136
Epoch 62/80
 - 2s - loss: 0.0136
Epoch 63/80
 - 2s - loss: 0.0136
Epoch 64/80
 - 2s - loss: 0.0136
Epoch 65/80
 - 2s - loss: 0.0136
Epoch 66/80
 - 2s - loss: 0.0136
Epoch 67/80
 - 2s - loss: 0.0136
Epoch 68/80
 - 2s - loss: 0.0136
Epoch 69/80
 - 2s - loss: 0.0136
Epoch 70/80
 - 2s - loss: 0.0136
Epoch 71/80
 - 2s - loss: 0.0136
Epoch 72/80
 - 2s - loss: 0.0136
Epoch 73/80
 - 2s - loss: 0.0136
Epoch 74/80
 - 2s - loss: 0.0136
Epoch 75/80
 - 2s - loss: 0.0136
Epoch 76/80
 - 2s - loss: 0.0136
Epoch 77/80
 - 2s - loss: 0.0136
Epoch 78/80
 - 2s - loss: 0.0136
Epoch 79/80
 - 2s - loss: 0.0136
Epoch 80/80
 - 2s - loss: 0.0136
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.6971 - val_loss: 0.9833
AUC: 0.8133

Epoch 2/80
 - 0s - loss: 1.5809 - val_loss: 0.8287
AUC: 0.8305

Epoch 3/80
 - 0s - loss: 1.2766 - val_loss: 0.6568
AUC: 0.8445

Epoch 4/80
 - 0s - loss: 1.1783 - val_loss: 0.6417
AUC: 0.8512

Epoch 5/80
 - 0s - loss: 1.1431 - val_loss: 0.6871
AUC: 0.8598

Epoch 6/80
 - 0s - loss: 1.1097 - val_loss: 0.6600
AUC: 0.8636

Epoch 7/80
 - 0s - loss: 1.0891 - val_loss: 0.6640
AUC: 0.8665

Epoch 8/80
 - 0s - loss: 1.0725 - val_loss: 0.6139
AUC: 0.8671

Epoch 9/80
 - 0s - loss: 1.0608 - val_loss: 0.6306
AUC: 0.8684

Epoch 10/80
 - 0s - loss: 1.0496 - val_loss: 0.6694
AUC: 0.8681

Epoch 11/80
 - 0s - loss: 1.0445 - val_loss: 0.6840
AUC: 0.8722

Epoch 12/80
 - 0s - loss: 1.0351 - val_loss: 0.6600
AUC: 0.8724

Epoch 13/80
 - 0s - loss: 1.0342 - val_loss: 0.5796
AUC: 0.8698

Epoch 14/80
 - 0s - loss: 1.0246 - val_loss: 0.6395
AUC: 0.8731

Epoch 15/80
 - 0s - loss: 1.0207 - val_loss: 0.6552
AUC: 0.8724

Epoch 16/80
 - 0s - loss: 1.0146 - val_loss: 0.5445
AUC: 0.8724

Epoch 17/80
 - 0s - loss: 1.0147 - val_loss: 0.7258
AUC: 0.8747

Epoch 18/80
 - 0s - loss: 1.0097 - val_loss: 0.6140
AUC: 0.8744

Epoch 19/80
 - 0s - loss: 1.0041 - val_loss: 0.6020
AUC: 0.8741

Epoch 20/80
 - 0s - loss: 0.9972 - val_loss: 0.5608
AUC: 0.8751

Epoch 21/80
 - 0s - loss: 1.0046 - val_loss: 0.6518
AUC: 0.8763

Epoch 22/80
 - 0s - loss: 0.9985 - val_loss: 0.5976
AUC: 0.8757

Epoch 23/80
 - 0s - loss: 0.9922 - val_loss: 0.5930
AUC: 0.8756

Epoch 24/80
 - 0s - loss: 0.9903 - val_loss: 0.5908
AUC: 0.8760

Epoch 25/80
 - 0s - loss: 0.9840 - val_loss: 0.5741
AUC: 0.8756

Epoch 26/80
 - 0s - loss: 0.9876 - val_loss: 0.5828
AUC: 0.8762

Epoch 27/80
 - 0s - loss: 0.9701 - val_loss: 0.5983
AUC: 0.8771

Epoch 28/80
 - 0s - loss: 0.9760 - val_loss: 0.5904
AUC: 0.8771

Epoch 29/80
 - 0s - loss: 0.9715 - val_loss: 0.6219
AUC: 0.8776

Epoch 30/80
 - 0s - loss: 0.9659 - val_loss: 0.5748
AUC: 0.8771

Epoch 31/80
 - 0s - loss: 0.9660 - val_loss: 0.5986
AUC: 0.8774

Epoch 32/80
 - 0s - loss: 0.9682 - val_loss: 0.5542
AUC: 0.8771

Epoch 33/80
 - 0s - loss: 0.9657 - val_loss: 0.6114
AUC: 0.8778

Epoch 34/80
 - 0s - loss: 0.9678 - val_loss: 0.6410
AUC: 0.8780

Epoch 35/80
 - 0s - loss: 0.9669 - val_loss: 0.5891
AUC: 0.8772

Epoch 36/80
 - 0s - loss: 0.9620 - val_loss: 0.6185
AUC: 0.8779

Epoch 37/80
 - 0s - loss: 0.9639 - val_loss: 0.5900
AUC: 0.8777

Epoch 38/80
 - 0s - loss: 0.9607 - val_loss: 0.5898
AUC: 0.8777

Epoch 39/80
 - 0s - loss: 0.9613 - val_loss: 0.5912
AUC: 0.8777

Epoch 40/80
 - 0s - loss: 0.9618 - val_loss: 0.5927
AUC: 0.8778

Epoch 41/80
 - 0s - loss: 0.9614 - val_loss: 0.5914
AUC: 0.8778

Epoch 42/80
 - 0s - loss: 0.9573 - val_loss: 0.5926
AUC: 0.8779

Epoch 43/80
 - 0s - loss: 0.9605 - val_loss: 0.5925
AUC: 0.8779

Epoch 44/80
 - 0s - loss: 0.9644 - val_loss: 0.5868
AUC: 0.8778

Epoch 45/80
 - 0s - loss: 0.9612 - val_loss: 0.5859
AUC: 0.8779

Epoch 46/80
 - 0s - loss: 0.9575 - val_loss: 0.5868
AUC: 0.8779

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9648 - val_loss: 0.5836
AUC: 0.8777

Epoch 2/30
 - 0s - loss: 0.9616 - val_loss: 0.5743
AUC: 0.8777

Epoch 3/30
 - 0s - loss: 0.9627 - val_loss: 0.6000
AUC: 0.8782

Epoch 4/30
 - 0s - loss: 0.9553 - val_loss: 0.5766
AUC: 0.8779

Epoch 5/30
 - 0s - loss: 0.9589 - val_loss: 0.5768
AUC: 0.8781

Epoch 6/30
 - 0s - loss: 0.9565 - val_loss: 0.5682
AUC: 0.8779

Epoch 7/30
 - 0s - loss: 0.9571 - val_loss: 0.5916
AUC: 0.8783

Epoch 8/30
 - 0s - loss: 0.9488 - val_loss: 0.5925
AUC: 0.8784

Epoch 9/30
 - 0s - loss: 0.9507 - val_loss: 0.5931
AUC: 0.8785

Epoch 10/30
 - 0s - loss: 0.9503 - val_loss: 0.5953
AUC: 0.8787

Epoch 11/30
 - 0s - loss: 0.9522 - val_loss: 0.5798
AUC: 0.8787

Epoch 12/30
 - 0s - loss: 0.9426 - val_loss: 0.5761
AUC: 0.8786

Epoch 13/30
 - 0s - loss: 0.9435 - val_loss: 0.5852
AUC: 0.8788

Epoch 14/30
 - 0s - loss: 0.9446 - val_loss: 0.6004
AUC: 0.8790

Epoch 15/30
 - 0s - loss: 0.9441 - val_loss: 0.5993
AUC: 0.8790

Epoch 16/30
 - 0s - loss: 0.9378 - val_loss: 0.5844
AUC: 0.8790

Epoch 17/30
 - 0s - loss: 0.9396 - val_loss: 0.5829
AUC: 0.8790

Epoch 18/30
 - 0s - loss: 0.9405 - val_loss: 0.5869
AUC: 0.8791

Epoch 19/30
 - 0s - loss: 0.9345 - val_loss: 0.5835
AUC: 0.8791

Epoch 20/30
 - 0s - loss: 0.9394 - val_loss: 0.5833
AUC: 0.8792

Epoch 21/30
 - 0s - loss: 0.9385 - val_loss: 0.5786
AUC: 0.8792

Epoch 22/30
 - 0s - loss: 0.9399 - val_loss: 0.5853
AUC: 0.8792

Epoch 23/30
 - 0s - loss: 0.9373 - val_loss: 0.5797
AUC: 0.8792

Epoch 24/30
 - 0s - loss: 0.9365 - val_loss: 0.5794
AUC: 0.8792

Epoch 25/30
 - 0s - loss: 0.9415 - val_loss: 0.5779
AUC: 0.8792

Epoch 26/30
 - 0s - loss: 0.9365 - val_loss: 0.5791
AUC: 0.8792

Epoch 27/30
 - 0s - loss: 0.9351 - val_loss: 0.5798
AUC: 0.8792

Epoch 28/30
 - 0s - loss: 0.9341 - val_loss: 0.5806
AUC: 0.8792

Epoch 29/30
 - 0s - loss: 0.9377 - val_loss: 0.5807
AUC: 0.8792

Epoch 30/30
 - 0s - loss: 0.9362 - val_loss: 0.5808
Using TensorFlow backend.
AUC: 0.8792

2019-03-08 07:14:16.829671: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:14:16.999309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:14:16.999355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:14:17.299192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:14:17.299248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:14:17.299258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:14:17.299546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6360
Epoch 2/80
 - 2s - loss: 0.0994
Epoch 3/80
 - 2s - loss: 0.0682
Epoch 4/80
 - 2s - loss: 0.0617
Epoch 5/80
 - 2s - loss: 0.0570
Epoch 6/80
 - 2s - loss: 0.0530
Epoch 7/80
 - 2s - loss: 0.0496
Epoch 8/80
 - 2s - loss: 0.0463
Epoch 9/80
 - 2s - loss: 0.0431
Epoch 10/80
 - 2s - loss: 0.0399
Epoch 11/80
 - 2s - loss: 0.0367
Epoch 12/80
 - 2s - loss: 0.0338
Epoch 13/80
 - 2s - loss: 0.0311
Epoch 14/80
 - 2s - loss: 0.0287
Epoch 15/80
 - 2s - loss: 0.0266
Epoch 16/80
 - 2s - loss: 0.0248
Epoch 17/80
 - 2s - loss: 0.0232
Epoch 18/80
 - 2s - loss: 0.0220
Epoch 19/80
 - 2s - loss: 0.0209
Epoch 20/80
 - 2s - loss: 0.0200
Epoch 21/80
 - 2s - loss: 0.0193
Epoch 22/80
 - 2s - loss: 0.0186
Epoch 23/80
 - 2s - loss: 0.0181
Epoch 24/80
 - 2s - loss: 0.0176
Epoch 25/80
 - 2s - loss: 0.0172
Epoch 26/80
 - 2s - loss: 0.0168
Epoch 27/80
 - 2s - loss: 0.0165
Epoch 28/80
 - 2s - loss: 0.0162
Epoch 29/80
 - 2s - loss: 0.0160
Epoch 30/80
 - 2s - loss: 0.0157
Epoch 31/80
 - 2s - loss: 0.0156
Epoch 32/80
 - 2s - loss: 0.0154
Epoch 33/80
 - 2s - loss: 0.0153
Epoch 34/80
 - 2s - loss: 0.0151
Epoch 35/80
 - 2s - loss: 0.0150
Epoch 36/80
 - 2s - loss: 0.0149
Epoch 37/80
 - 2s - loss: 0.0148
Epoch 38/80
 - 2s - loss: 0.0147
Epoch 39/80
 - 2s - loss: 0.0147
Epoch 40/80
 - 2s - loss: 0.0146
Epoch 41/80
 - 2s - loss: 0.0145
Epoch 42/80
 - 2s - loss: 0.0145
Epoch 43/80
 - 2s - loss: 0.0144
Epoch 44/80
 - 2s - loss: 0.0144
Epoch 45/80
 - 2s - loss: 0.0144
Epoch 46/80
 - 2s - loss: 0.0143
Epoch 47/80
 - 2s - loss: 0.0143
Epoch 48/80
 - 2s - loss: 0.0143
Epoch 49/80
 - 2s - loss: 0.0142
Epoch 50/80
 - 2s - loss: 0.0142
Epoch 51/80
 - 2s - loss: 0.0137
Epoch 52/80
 - 2s - loss: 0.0137
Epoch 53/80
 - 2s - loss: 0.0137
Epoch 54/80
 - 2s - loss: 0.0137
Epoch 55/80
 - 2s - loss: 0.0136
Epoch 56/80
 - 2s - loss: 0.0136
Epoch 57/80
 - 2s - loss: 0.0136
Epoch 58/80
 - 2s - loss: 0.0136
Epoch 59/80
 - 2s - loss: 0.0135
Epoch 60/80
 - 2s - loss: 0.0135
Epoch 61/80
 - 2s - loss: 0.0135
Epoch 62/80
 - 2s - loss: 0.0135
Epoch 63/80
 - 2s - loss: 0.0135
Epoch 64/80
 - 2s - loss: 0.0135
Epoch 65/80
 - 2s - loss: 0.0135
Epoch 66/80
 - 2s - loss: 0.0135
Epoch 67/80
 - 2s - loss: 0.0135
Epoch 68/80
 - 2s - loss: 0.0135
Epoch 69/80
 - 2s - loss: 0.0135
Epoch 70/80
 - 2s - loss: 0.0135
Epoch 71/80
 - 2s - loss: 0.0135
Epoch 72/80
 - 2s - loss: 0.0135
Epoch 73/80
 - 2s - loss: 0.0135
Epoch 74/80
 - 2s - loss: 0.0135
Epoch 75/80
 - 2s - loss: 0.0135
Epoch 76/80
 - 2s - loss: 0.0135
Epoch 77/80
 - 2s - loss: 0.0135
Epoch 78/80
 - 2s - loss: 0.0135
Epoch 79/80
 - 2s - loss: 0.0135
Epoch 80/80
 - 2s - loss: 0.0135
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 6.9333 - val_loss: 1.8724
AUC: 0.7375

Epoch 2/80
 - 0s - loss: 3.3183 - val_loss: 1.0100
AUC: 0.8059

Epoch 3/80
 - 0s - loss: 2.1628 - val_loss: 0.8602
AUC: 0.8330

Epoch 4/80
 - 0s - loss: 1.5222 - val_loss: 0.6482
AUC: 0.8356

Epoch 5/80
 - 0s - loss: 1.2726 - val_loss: 0.6756
AUC: 0.8484

Epoch 6/80
 - 0s - loss: 1.1731 - val_loss: 0.6352
AUC: 0.8504

Epoch 7/80
 - 0s - loss: 1.1387 - val_loss: 0.6820
AUC: 0.8532

Epoch 8/80
 - 0s - loss: 1.1033 - val_loss: 0.6758
AUC: 0.8564

Epoch 9/80
 - 0s - loss: 1.0964 - val_loss: 0.6648
AUC: 0.8581

Epoch 10/80
 - 0s - loss: 1.0745 - val_loss: 0.6798
AUC: 0.8597

Epoch 11/80
 - 0s - loss: 1.0606 - val_loss: 0.7088
AUC: 0.8616

Epoch 12/80
 - 0s - loss: 1.0526 - val_loss: 0.6387
AUC: 0.8612

Epoch 13/80
 - 0s - loss: 1.0508 - val_loss: 0.5879
AUC: 0.8621

Epoch 14/80
 - 0s - loss: 1.0394 - val_loss: 0.6865
AUC: 0.8651

Epoch 15/80
 - 0s - loss: 1.0324 - val_loss: 0.6456
AUC: 0.8639

Epoch 16/80
 - 0s - loss: 1.0205 - val_loss: 0.6797
AUC: 0.8664

Epoch 17/80
 - 0s - loss: 1.0246 - val_loss: 0.6275
AUC: 0.8651

Epoch 18/80
 - 0s - loss: 1.0228 - val_loss: 0.6652
AUC: 0.8664

Epoch 19/80
 - 0s - loss: 1.0093 - val_loss: 0.6112
AUC: 0.8664

Epoch 20/80
 - 0s - loss: 1.0070 - val_loss: 0.6167
AUC: 0.8672

Epoch 21/80
 - 0s - loss: 1.0065 - val_loss: 0.6363
AUC: 0.8681

Epoch 22/80
 - 0s - loss: 1.0024 - val_loss: 0.6474
AUC: 0.8678

Epoch 23/80
 - 0s - loss: 1.0013 - val_loss: 0.7091
AUC: 0.8694

Epoch 24/80
 - 0s - loss: 0.9928 - val_loss: 0.5915
AUC: 0.8687

Epoch 25/80
 - 0s - loss: 0.9894 - val_loss: 0.6128
AUC: 0.8692

Epoch 26/80
 - 0s - loss: 0.9906 - val_loss: 0.6032
AUC: 0.8691

Epoch 27/80
 - 0s - loss: 0.9888 - val_loss: 0.6004
AUC: 0.8693

Epoch 28/80
 - 0s - loss: 0.9855 - val_loss: 0.6064
AUC: 0.8694

Epoch 29/80
 - 0s - loss: 0.9861 - val_loss: 0.6051
AUC: 0.8696

Epoch 30/80
 - 0s - loss: 0.9832 - val_loss: 0.5921
AUC: 0.8695

Epoch 31/80
 - 0s - loss: 0.9854 - val_loss: 0.6066
AUC: 0.8696

Epoch 32/80
 - 0s - loss: 0.9870 - val_loss: 0.6103
AUC: 0.8699

Epoch 33/80
 - 0s - loss: 0.9780 - val_loss: 0.5757
AUC: 0.8694

Epoch 34/80
 - 0s - loss: 0.9878 - val_loss: 0.6213
AUC: 0.8705

Epoch 35/80
 - 0s - loss: 0.9894 - val_loss: 0.6234
AUC: 0.8705

Epoch 36/80
 - 0s - loss: 0.9786 - val_loss: 0.5951
AUC: 0.8701

Epoch 37/80
 - 0s - loss: 0.9839 - val_loss: 0.6350
AUC: 0.8708

Epoch 38/80
 - 0s - loss: 0.9815 - val_loss: 0.6151
AUC: 0.8708

Epoch 39/80
 - 0s - loss: 0.9779 - val_loss: 0.5945
AUC: 0.8706

Epoch 40/80
 - 0s - loss: 0.9781 - val_loss: 0.5999
AUC: 0.8707

Epoch 41/80
 - 0s - loss: 0.9770 - val_loss: 0.6171
AUC: 0.8708

Epoch 42/80
 - 0s - loss: 0.9744 - val_loss: 0.6329
AUC: 0.8710

Epoch 43/80
 - 0s - loss: 0.9760 - val_loss: 0.6027
AUC: 0.8709

Epoch 44/80
 - 0s - loss: 0.9715 - val_loss: 0.6001
AUC: 0.8710

Epoch 45/80
 - 0s - loss: 0.9784 - val_loss: 0.6082
AUC: 0.8711

Epoch 46/80
 - 0s - loss: 0.9725 - val_loss: 0.6030
AUC: 0.8710

Epoch 47/80
 - 0s - loss: 0.9728 - val_loss: 0.6023
AUC: 0.8710

Epoch 48/80
 - 0s - loss: 0.9749 - val_loss: 0.6074
AUC: 0.8711

Epoch 49/80
 - 0s - loss: 0.9650 - val_loss: 0.6023
AUC: 0.8710

Epoch 50/80
 - 0s - loss: 0.9704 - val_loss: 0.6010
AUC: 0.8710

Epoch 51/80
 - 0s - loss: 0.9728 - val_loss: 0.6045
AUC: 0.8710

Epoch 52/80
 - 0s - loss: 0.9650 - val_loss: 0.6003
AUC: 0.8711

Epoch 53/80
 - 0s - loss: 0.9736 - val_loss: 0.5956
AUC: 0.8710

Epoch 54/80
 - 0s - loss: 0.9726 - val_loss: 0.5991
AUC: 0.8710

Epoch 55/80
 - 0s - loss: 0.9721 - val_loss: 0.5994
AUC: 0.8710

Epoch 56/80
 - 0s - loss: 0.9721 - val_loss: 0.5998
AUC: 0.8711

Epoch 57/80
 - 0s - loss: 0.9715 - val_loss: 0.6003
AUC: 0.8711

Epoch 58/80
 - 0s - loss: 0.9664 - val_loss: 0.6010
AUC: 0.8711

Epoch 59/80
 - 0s - loss: 0.9751 - val_loss: 0.6027
AUC: 0.8711

Epoch 60/80
 - 0s - loss: 0.9665 - val_loss: 0.6010
AUC: 0.8711

Epoch 61/80
 - 0s - loss: 0.9762 - val_loss: 0.6003
AUC: 0.8711

Epoch 62/80
 - 0s - loss: 0.9724 - val_loss: 0.6014
AUC: 0.8711

Epoch 63/80
 - 0s - loss: 0.9778 - val_loss: 0.6001
AUC: 0.8711

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9774 - val_loss: 0.5841
AUC: 0.8707

Epoch 2/30
 - 0s - loss: 0.9667 - val_loss: 0.5880
AUC: 0.8713

Epoch 3/30
 - 0s - loss: 0.9674 - val_loss: 0.5846
AUC: 0.8713

Epoch 4/30
 - 0s - loss: 0.9729 - val_loss: 0.5958
AUC: 0.8715

Epoch 5/30
 - 0s - loss: 0.9643 - val_loss: 0.5996
AUC: 0.8719

Epoch 6/30
 - 0s - loss: 0.9673 - val_loss: 0.5709
AUC: 0.8714

Epoch 7/30
 - 0s - loss: 0.9630 - val_loss: 0.5923
AUC: 0.8718

Epoch 8/30
 - 0s - loss: 0.9589 - val_loss: 0.6049
AUC: 0.8723

Epoch 9/30
 - 0s - loss: 0.9601 - val_loss: 0.6155
AUC: 0.8726

Epoch 10/30
 - 1s - loss: 0.9563 - val_loss: 0.6087
AUC: 0.8725

Epoch 11/30
 - 1s - loss: 0.9531 - val_loss: 0.5968
AUC: 0.8726

Epoch 12/30
 - 1s - loss: 0.9541 - val_loss: 0.6147
AUC: 0.8731

Epoch 13/30
 - 1s - loss: 0.9602 - val_loss: 0.6005
AUC: 0.8731

Epoch 14/30
 - 0s - loss: 0.9586 - val_loss: 0.6061
AUC: 0.8733

Epoch 15/30
 - 1s - loss: 0.9564 - val_loss: 0.5766
AUC: 0.8730

Epoch 16/30
 - 1s - loss: 0.9512 - val_loss: 0.5830
AUC: 0.8732

Epoch 17/30
 - 1s - loss: 0.9499 - val_loss: 0.5871
AUC: 0.8732

Epoch 18/30
 - 1s - loss: 0.9411 - val_loss: 0.5866
AUC: 0.8732

Epoch 19/30
 - 1s - loss: 0.9425 - val_loss: 0.5851
AUC: 0.8732

Epoch 20/30
 - 1s - loss: 0.9463 - val_loss: 0.5882
AUC: 0.8733

Epoch 21/30
 - 1s - loss: 0.9481 - val_loss: 0.5920
AUC: 0.8734

Epoch 22/30
 - 0s - loss: 0.9505 - val_loss: 0.5892
AUC: 0.8734

Epoch 23/30
 - 0s - loss: 0.9406 - val_loss: 0.5879
AUC: 0.8734

Epoch 24/30
 - 1s - loss: 0.9429 - val_loss: 0.5875
AUC: 0.8734

Epoch 25/30
 - 0s - loss: 0.9475 - val_loss: 0.5935
AUC: 0.8735

Epoch 26/30
 - 0s - loss: 0.9541 - val_loss: 0.5900
AUC: 0.8735

Epoch 27/30
 - 0s - loss: 0.9416 - val_loss: 0.5891
AUC: 0.8735

Epoch 28/30
 - 0s - loss: 0.9412 - val_loss: 0.5888
AUC: 0.8735

Epoch 29/30
 - 0s - loss: 0.9425 - val_loss: 0.5883
AUC: 0.8735

Epoch 30/30
 - 0s - loss: 0.9408 - val_loss: 0.5882
Using TensorFlow backend.
AUC: 0.8735

2019-03-08 07:18:14.984531: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:18:15.149994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:18:15.150042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:18:15.448496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:18:15.448552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:18:15.448562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:18:15.448834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3114
Epoch 2/80
 - 2s - loss: 0.3313
Epoch 3/80
 - 2s - loss: 0.2895
Epoch 4/80
 - 2s - loss: 0.2591
Epoch 5/80
 - 2s - loss: 0.2344
Epoch 6/80
 - 2s - loss: 0.2175
Epoch 7/80
 - 2s - loss: 0.2032
Epoch 8/80
 - 2s - loss: 0.1890
Epoch 9/80
 - 2s - loss: 0.1757
Epoch 10/80
 - 2s - loss: 0.1644
Epoch 11/80
 - 2s - loss: 0.1552
Epoch 12/80
 - 2s - loss: 0.1474
Epoch 13/80
 - 2s - loss: 0.1407
Epoch 14/80
 - 2s - loss: 0.1349
Epoch 15/80
 - 2s - loss: 0.1301
Epoch 16/80
 - 2s - loss: 0.1260
Epoch 17/80
 - 2s - loss: 0.1226
Epoch 18/80
 - 2s - loss: 0.1198
Epoch 19/80
 - 2s - loss: 0.1175
Epoch 20/80
 - 2s - loss: 0.1154
Epoch 21/80
 - 2s - loss: 0.1136
Epoch 22/80
 - 2s - loss: 0.1121
Epoch 23/80
 - 2s - loss: 0.1108
Epoch 24/80
 - 2s - loss: 0.1096
Epoch 25/80
 - 2s - loss: 0.1086
Epoch 26/80
 - 2s - loss: 0.1078
Epoch 27/80
 - 2s - loss: 0.1071
Epoch 28/80
 - 2s - loss: 0.1064
Epoch 29/80
 - 2s - loss: 0.1059
Epoch 30/80
 - 2s - loss: 0.1054
Epoch 31/80
 - 2s - loss: 0.1050
Epoch 32/80
 - 2s - loss: 0.1046
Epoch 33/80
 - 2s - loss: 0.1043
Epoch 34/80
 - 2s - loss: 0.1040
Epoch 35/80
 - 2s - loss: 0.1037
Epoch 36/80
 - 2s - loss: 0.1035
Epoch 37/80
 - 2s - loss: 0.1033
Epoch 38/80
 - 2s - loss: 0.1031
Epoch 39/80
 - 2s - loss: 0.1029
Epoch 40/80
 - 2s - loss: 0.1027
Epoch 41/80
 - 2s - loss: 0.1026
Epoch 42/80
 - 2s - loss: 0.1025
Epoch 43/80
 - 2s - loss: 0.1023
Epoch 44/80
 - 2s - loss: 0.1022
Epoch 45/80
 - 2s - loss: 0.1021
Epoch 46/80
 - 2s - loss: 0.1020
Epoch 47/80
 - 2s - loss: 0.1019
Epoch 48/80
 - 2s - loss: 0.1019
Epoch 49/80
 - 2s - loss: 0.1017
Epoch 50/80
 - 2s - loss: 0.1017
Epoch 51/80
 - 2s - loss: 0.1016
Epoch 52/80
 - 2s - loss: 0.1015
Epoch 53/80
 - 2s - loss: 0.1014
Epoch 54/80
 - 2s - loss: 0.1014
Epoch 55/80
 - 2s - loss: 0.1013
Epoch 56/80
 - 2s - loss: 0.1013
Epoch 57/80
 - 2s - loss: 0.1012
Epoch 58/80
 - 2s - loss: 0.1012
Epoch 59/80
 - 2s - loss: 0.1011
Epoch 60/80
 - 2s - loss: 0.1011
Epoch 61/80
 - 2s - loss: 0.1010
Epoch 62/80
 - 2s - loss: 0.1010
Epoch 63/80
 - 2s - loss: 0.1010
Epoch 64/80
 - 2s - loss: 0.1009
Epoch 65/80
 - 2s - loss: 0.1009
Epoch 66/80
 - 2s - loss: 0.1009
Epoch 67/80
 - 2s - loss: 0.1009
Epoch 68/80
 - 2s - loss: 0.0982
Epoch 69/80
 - 2s - loss: 0.0979
Epoch 70/80
 - 2s - loss: 0.0979
Epoch 71/80
 - 2s - loss: 0.0979
Epoch 72/80
 - 2s - loss: 0.0979
Epoch 73/80
 - 2s - loss: 0.0972
Epoch 74/80
 - 2s - loss: 0.0972
Epoch 75/80
 - 2s - loss: 0.0972
Epoch 76/80
 - 2s - loss: 0.0972
Epoch 77/80
 - 2s - loss: 0.0970
Epoch 78/80
 - 2s - loss: 0.0970
Epoch 79/80
 - 2s - loss: 0.0970
Epoch 80/80
 - 2s - loss: 0.0970
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.1095 - val_loss: 0.7824
AUC: 0.8183

Epoch 2/80
 - 0s - loss: 1.2603 - val_loss: 0.7585
AUC: 0.8377

Epoch 3/80
 - 0s - loss: 1.1494 - val_loss: 0.6620
AUC: 0.8431

Epoch 4/80
 - 0s - loss: 1.0979 - val_loss: 0.6240
AUC: 0.8489

Epoch 5/80
 - 0s - loss: 1.0673 - val_loss: 0.6305
AUC: 0.8526

Epoch 6/80
 - 0s - loss: 1.0529 - val_loss: 0.6859
AUC: 0.8561

Epoch 7/80
 - 0s - loss: 1.0396 - val_loss: 0.6653
AUC: 0.8555

Epoch 8/80
 - 0s - loss: 1.0337 - val_loss: 0.6974
AUC: 0.8599

Epoch 9/80
 - 0s - loss: 1.0263 - val_loss: 0.6362
AUC: 0.8598

Epoch 10/80
 - 0s - loss: 1.0144 - val_loss: 0.5948
AUC: 0.8581

Epoch 11/80
 - 0s - loss: 1.0075 - val_loss: 0.6585
AUC: 0.8612

Epoch 12/80
 - 0s - loss: 1.0047 - val_loss: 0.5695
AUC: 0.8590

Epoch 13/80
 - 0s - loss: 0.9956 - val_loss: 0.5968
AUC: 0.8604

Epoch 14/80
 - 0s - loss: 0.9982 - val_loss: 0.6375
AUC: 0.8615

Epoch 15/80
 - 0s - loss: 0.9805 - val_loss: 0.6297
AUC: 0.8615

Epoch 16/80
 - 0s - loss: 0.9850 - val_loss: 0.5666
AUC: 0.8609

Epoch 17/80
 - 0s - loss: 0.9821 - val_loss: 0.5838
AUC: 0.8618

Epoch 18/80
 - 0s - loss: 0.9860 - val_loss: 0.5707
AUC: 0.8588

Epoch 19/80
 - 0s - loss: 0.9851 - val_loss: 0.6988
AUC: 0.8648

Epoch 20/80
 - 0s - loss: 0.9691 - val_loss: 0.5910
AUC: 0.8637

Epoch 21/80
 - 0s - loss: 0.9711 - val_loss: 0.5724
AUC: 0.8621

Epoch 22/80
 - 0s - loss: 0.9570 - val_loss: 0.6041
AUC: 0.8647

Epoch 23/80
 - 0s - loss: 0.9553 - val_loss: 0.6361
AUC: 0.8637

Epoch 24/80
 - 0s - loss: 0.9630 - val_loss: 0.6660
AUC: 0.8662

Epoch 25/80
 - 0s - loss: 0.9533 - val_loss: 0.5932
AUC: 0.8654

Epoch 26/80
 - 0s - loss: 0.9508 - val_loss: 0.5978
AUC: 0.8653

Epoch 27/80
 - 0s - loss: 0.9420 - val_loss: 0.5959
AUC: 0.8661

Epoch 28/80
 - 0s - loss: 0.9406 - val_loss: 0.5966
AUC: 0.8659

Epoch 29/80
 - 0s - loss: 0.9355 - val_loss: 0.5808
AUC: 0.8654

Epoch 30/80
 - 0s - loss: 0.9354 - val_loss: 0.5864
AUC: 0.8659

Epoch 31/80
 - 0s - loss: 0.9289 - val_loss: 0.6033
AUC: 0.8659

Epoch 32/80
 - 0s - loss: 0.9289 - val_loss: 0.5912
AUC: 0.8661

Epoch 33/80
 - 0s - loss: 0.9330 - val_loss: 0.6122
AUC: 0.8667

Epoch 34/80
 - 0s - loss: 0.9272 - val_loss: 0.5942
AUC: 0.8661

Epoch 35/80
 - 0s - loss: 0.9245 - val_loss: 0.5855
AUC: 0.8659

Epoch 36/80
 - 0s - loss: 0.9293 - val_loss: 0.5783
AUC: 0.8659

Epoch 37/80
 - 0s - loss: 0.9244 - val_loss: 0.5935
AUC: 0.8662

Epoch 38/80
 - 0s - loss: 0.9285 - val_loss: 0.5829
AUC: 0.8661

Epoch 39/80
 - 0s - loss: 0.9256 - val_loss: 0.5825
AUC: 0.8660

Epoch 40/80
 - 0s - loss: 0.9267 - val_loss: 0.5756
AUC: 0.8660

Epoch 41/80
 - 0s - loss: 0.9261 - val_loss: 0.5810
AUC: 0.8662

Epoch 42/80
 - 0s - loss: 0.9204 - val_loss: 0.5934
AUC: 0.8665

Epoch 43/80
 - 0s - loss: 0.9230 - val_loss: 0.5815
AUC: 0.8662

Epoch 44/80
 - 0s - loss: 0.9207 - val_loss: 0.5976
AUC: 0.8666

Epoch 45/80
 - 0s - loss: 0.9265 - val_loss: 0.5836
AUC: 0.8664

Epoch 46/80
 - 0s - loss: 0.9199 - val_loss: 0.5848
AUC: 0.8663

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9309 - val_loss: 0.6003
AUC: 0.8664

Epoch 2/30
 - 0s - loss: 0.9282 - val_loss: 0.5712
AUC: 0.8664

Epoch 3/30
 - 0s - loss: 0.9292 - val_loss: 0.5938
AUC: 0.8663

Epoch 4/30
 - 0s - loss: 0.9235 - val_loss: 0.5862
AUC: 0.8663

Epoch 5/30
 - 0s - loss: 0.9228 - val_loss: 0.5796
AUC: 0.8664

Epoch 6/30
 - 0s - loss: 0.9260 - val_loss: 0.5770
AUC: 0.8665

Epoch 7/30
 - 0s - loss: 0.9158 - val_loss: 0.5781
AUC: 0.8665

Epoch 8/30
 - 0s - loss: 0.9177 - val_loss: 0.5985
AUC: 0.8669

Epoch 9/30
 - 0s - loss: 0.9155 - val_loss: 0.5862
AUC: 0.8665

Epoch 10/30
 - 0s - loss: 0.9079 - val_loss: 0.5623
AUC: 0.8662

Epoch 11/30
 - 0s - loss: 0.9148 - val_loss: 0.5897
AUC: 0.8664

Epoch 12/30
 - 0s - loss: 0.9160 - val_loss: 0.5754
AUC: 0.8662

Epoch 13/30
 - 0s - loss: 0.9062 - val_loss: 0.5690
AUC: 0.8662

Epoch 14/30
 - 0s - loss: 0.9083 - val_loss: 0.5889
AUC: 0.8664

Epoch 15/30
 - 0s - loss: 0.9024 - val_loss: 0.5661
AUC: 0.8661

Epoch 16/30
 - 0s - loss: 0.9065 - val_loss: 0.5776
AUC: 0.8662

Epoch 17/30
 - 0s - loss: 0.9080 - val_loss: 0.5889
AUC: 0.8667

Epoch 18/30
 - 0s - loss: 0.9020 - val_loss: 0.5733
AUC: 0.8660

Epoch 19/30
 - 0s - loss: 0.9043 - val_loss: 0.5747
AUC: 0.8666

Epoch 20/30
 - 0s - loss: 0.8980 - val_loss: 0.5809
AUC: 0.8669

Epoch 21/30
 - 0s - loss: 0.8988 - val_loss: 0.5715
AUC: 0.8667

Epoch 22/30
 - 0s - loss: 0.8979 - val_loss: 0.5728
AUC: 0.8667

Epoch 23/30
 - 0s - loss: 0.8963 - val_loss: 0.5803
AUC: 0.8667

Epoch 24/30
 - 0s - loss: 0.8951 - val_loss: 0.5767
AUC: 0.8665

Epoch 25/30
 - 0s - loss: 0.8970 - val_loss: 0.5751
AUC: 0.8665

Epoch 26/30
 - 0s - loss: 0.8957 - val_loss: 0.5715
AUC: 0.8664

Epoch 27/30
 - 0s - loss: 0.8941 - val_loss: 0.5764
AUC: 0.8665

Epoch 28/30
 - 0s - loss: 0.8940 - val_loss: 0.5745
AUC: 0.8665

Epoch 29/30
 - 0s - loss: 0.8909 - val_loss: 0.5742
AUC: 0.8665

Epoch 30/30
 - 0s - loss: 0.8960 - val_loss: 0.5675
Using TensorFlow backend.
AUC: 0.8663

2019-03-08 07:22:04.885487: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:22:05.054803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:22:05.054851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:22:05.355056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:22:05.355112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:22:05.355122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:22:05.355425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3127
Epoch 2/80
 - 2s - loss: 0.3358
Epoch 3/80
 - 2s - loss: 0.3081
Epoch 4/80
 - 2s - loss: 0.2907
Epoch 5/80
 - 2s - loss: 0.2632
Epoch 6/80
 - 2s - loss: 0.2337
Epoch 7/80
 - 2s - loss: 0.2107
Epoch 8/80
 - 2s - loss: 0.1934
Epoch 9/80
 - 2s - loss: 0.1791
Epoch 10/80
 - 2s - loss: 0.1672
Epoch 11/80
 - 2s - loss: 0.1574
Epoch 12/80
 - 2s - loss: 0.1489
Epoch 13/80
 - 2s - loss: 0.1417
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:22:52.333776: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:22:52.500916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:22:52.500962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:22:52.798026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:22:52.798097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:22:52.798106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:22:52.798377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3129
Epoch 2/80
 - 2s - loss: 0.3311
Epoch 3/80
 - 2s - loss: 0.2833
Epoch 4/80
 - 2s - loss: 0.2526
Epoch 5/80
 - 2s - loss: 0.2296
Epoch 6/80
 - 2s - loss: 0.2128
Epoch 7/80
 - 2s - loss: 0.1989
Epoch 8/80
 - 2s - loss: 0.1860
Epoch 9/80
 - 2s - loss: 0.1736
Epoch 10/80
 - 2s - loss: 0.1625
Epoch 11/80
 - 2s - loss: 0.1532
Epoch 12/80
 - 2s - loss: 0.1455
Epoch 13/80
 - 2s - loss: 0.1391
Epoch 14/80
 - 2s - loss: 0.1337
Epoch 15/80
 - 2s - loss: 0.1292
Epoch 16/80
 - 2s - loss: 0.1254
Epoch 17/80
 - 2s - loss: 0.1224
Epoch 18/80
 - 2s - loss: 0.1197
Epoch 19/80
 - 2s - loss: 0.1176
Epoch 20/80
 - 2s - loss: 0.1156
Epoch 21/80
 - 2s - loss: 0.1140
Epoch 22/80
 - 2s - loss: 0.1126
Epoch 23/80
 - 2s - loss: 0.1114
Epoch 24/80
 - 2s - loss: 0.1103
Epoch 25/80
 - 2s - loss: 0.1094
Epoch 26/80
 - 2s - loss: 0.1086
Epoch 27/80
 - 2s - loss: 0.1078
Epoch 28/80
 - 2s - loss: 0.1073
Epoch 29/80
 - 2s - loss: 0.1067
Epoch 30/80
 - 2s - loss: 0.1062
Epoch 31/80
 - 2s - loss: 0.1058
Epoch 32/80
 - 2s - loss: 0.1054
Epoch 33/80
 - 2s - loss: 0.1050
Epoch 34/80
 - 2s - loss: 0.1048
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2afa75fc96a0>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 07:24:20.277942: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:24:20.446096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:24:20.446142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:24:20.743679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:24:20.743735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:24:20.743744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:24:20.744014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0753
Epoch 2/80
 - 2s - loss: 0.1945
Epoch 3/80
 - 2s - loss: 0.1659
Epoch 4/80
 - 2s - loss: 0.1529
Epoch 5/80
 - 2s - loss: 0.1402
Epoch 6/80
 - 2s - loss: 0.1275
Epoch 7/80
 - 2s - loss: 0.1165
Epoch 8/80
 - 2s - loss: 0.1079
Epoch 9/80
 - 2s - loss: 0.1001
Epoch 10/80
 - 2s - loss: 0.0922
Epoch 11/80
 - 2s - loss: 0.0848
Epoch 12/80
 - 2s - loss: 0.0783
Epoch 13/80
 - 2s - loss: 0.0728
Epoch 14/80
 - 2s - loss: 0.0684
Epoch 15/80
 - 2s - loss: 0.0647
Epoch 16/80
 - 2s - loss: 0.0618
Epoch 17/80
 - 2s - loss: 0.0593
Epoch 18/80
 - 2s - loss: 0.0572
Epoch 19/80
 - 2s - loss: 0.0554
Epoch 20/80
 - 2s - loss: 0.0539
Epoch 21/80
 - 2s - loss: 0.0526
Epoch 22/80
 - 2s - loss: 0.0515
Epoch 23/80
 - 2s - loss: 0.0506
Epoch 24/80
 - 2s - loss: 0.0497
Epoch 25/80
 - 2s - loss: 0.0490
Epoch 26/80
 - 2s - loss: 0.0484
Epoch 27/80
 - 2s - loss: 0.0479
Epoch 28/80
 - 2s - loss: 0.0474
Epoch 29/80
 - 2s - loss: 0.0470
Epoch 30/80
 - 2s - loss: 0.0467
Epoch 31/80
 - 2s - loss: 0.0463
Epoch 32/80
 - 2s - loss: 0.0461
Epoch 33/80
 - 2s - loss: 0.0458
Epoch 34/80
 - 2s - loss: 0.0456
Epoch 35/80
 - 2s - loss: 0.0454
Epoch 36/80
 - 2s - loss: 0.0452
Epoch 37/80
 - 2s - loss: 0.0450
Epoch 38/80
 - 2s - loss: 0.0449
Epoch 39/80
 - 2s - loss: 0.0448
Epoch 40/80
 - 2s - loss: 0.0446
Epoch 41/80
 - 2s - loss: 0.0445
Epoch 42/80
 - 2s - loss: 0.0444
Epoch 43/80
 - 2s - loss: 0.0443
Epoch 44/80
 - 2s - loss: 0.0443
Epoch 45/80
 - 2s - loss: 0.0442
Epoch 46/80
 - 2s - loss: 0.0441
Epoch 47/80
 - 2s - loss: 0.0440
Epoch 48/80
 - 2s - loss: 0.0440
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:26:15.327404: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:26:15.502366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:26:15.502412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:26:15.801159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:26:15.801212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:26:15.801221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:26:15.801480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0907
Epoch 2/80
 - 2s - loss: 0.1959
Epoch 3/80
 - 2s - loss: 0.1664
Epoch 4/80
 - 2s - loss: 0.1509
Epoch 5/80
 - 2s - loss: 0.1334
Epoch 6/80
 - 2s - loss: 0.1194
Epoch 7/80
 - 2s - loss: 0.1090
Epoch 8/80
 - 2s - loss: 0.1003
Epoch 9/80
 - 2s - loss: 0.0927
Epoch 10/80
 - 2s - loss: 0.0861
Epoch 11/80
 - 2s - loss: 0.0803
Epoch 12/80
 - 2s - loss: 0.0754
Epoch 13/80
 - 2s - loss: 0.0712
Epoch 14/80
 - 2s - loss: 0.0675
Epoch 15/80
 - 2s - loss: 0.0643
Epoch 16/80
 - 2s - loss: 0.0614
Epoch 17/80
 - 2s - loss: 0.0590
Epoch 18/80
 - 2s - loss: 0.0570
Epoch 19/80
 - 2s - loss: 0.0553
Epoch 20/80
 - 2s - loss: 0.0538
Epoch 21/80
 - 2s - loss: 0.0525
Epoch 22/80
 - 2s - loss: 0.0514
Epoch 23/80
 - 2s - loss: 0.0505
Epoch 24/80
 - 2s - loss: 0.0497
Epoch 25/80
 - 2s - loss: 0.0490
Epoch 26/80
 - 2s - loss: 0.0483
Epoch 27/80
 - 2s - loss: 0.0478
Epoch 28/80
 - 2s - loss: 0.0473
Epoch 29/80
 - 2s - loss: 0.0469
Epoch 30/80
 - 2s - loss: 0.0465
Epoch 31/80
 - 2s - loss: 0.0462
Epoch 32/80
 - 2s - loss: 0.0460
Epoch 33/80
 - 2s - loss: 0.0457
Epoch 34/80
 - 2s - loss: 0.0455
Epoch 35/80
 - 2s - loss: 0.0453
Epoch 36/80
 - 2s - loss: 0.0451
Epoch 37/80
 - 2s - loss: 0.0450
Epoch 38/80
 - 2s - loss: 0.0448
Epoch 39/80
 - 2s - loss: 0.0447
Epoch 40/80
 - 2s - loss: 0.0446
Epoch 41/80
 - 2s - loss: 0.0445
Epoch 42/80
 - 2s - loss: 0.0444
Epoch 43/80
 - 2s - loss: 0.0443
Epoch 44/80
 - 2s - loss: 0.0442
Epoch 45/80
 - 2s - loss: 0.0441
Epoch 46/80
 - 2s - loss: 0.0441
Epoch 47/80
 - 2s - loss: 0.0440
Epoch 48/80
 - 2s - loss: 0.0439
Epoch 49/80
 - 2s - loss: 0.0439
Epoch 50/80
 - 2s - loss: 0.0438
Epoch 51/80
 - 2s - loss: 0.0438
Epoch 52/80
 - 2s - loss: 0.0437
Epoch 53/80
 - 2s - loss: 0.0437
Epoch 54/80
 - 2s - loss: 0.0437
Epoch 55/80
 - 2s - loss: 0.0436
Epoch 56/80
 - 2s - loss: 0.0436
Epoch 57/80
 - 2s - loss: 0.0436
Epoch 58/80
 - 2s - loss: 0.0435
Epoch 59/80
 - 2s - loss: 0.0435
Epoch 60/80
 - 2s - loss: 0.0435
Epoch 61/80
 - 2s - loss: 0.0435
Epoch 62/80
 - 2s - loss: 0.0422
Epoch 63/80
 - 2s - loss: 0.0421
Epoch 64/80
 - 2s - loss: 0.0420
Epoch 65/80
 - 2s - loss: 0.0420
Epoch 66/80
 - 2s - loss: 0.0420
Epoch 67/80
 - 2s - loss: 0.0417
Epoch 68/80
 - 2s - loss: 0.0417
Epoch 69/80
 - 2s - loss: 0.0417
Epoch 70/80
 - 2s - loss: 0.0417
Epoch 71/80
 - 2s - loss: 0.0416
Epoch 72/80
 - 2s - loss: 0.0416
Epoch 73/80
 - 2s - loss: 0.0416
Epoch 74/80
 - 2s - loss: 0.0416
Epoch 75/80
 - 2s - loss: 0.0416
Epoch 76/80
 - 2s - loss: 0.0416
Epoch 77/80
 - 2s - loss: 0.0416
Epoch 78/80
 - 2s - loss: 0.0416
Epoch 79/80
 - 2s - loss: 0.0416
Epoch 80/80
 - 2s - loss: 0.0416
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.8355 - val_loss: 1.0662
AUC: 0.8298

Epoch 2/80
 - 0s - loss: 1.4982 - val_loss: 0.7893
AUC: 0.8440

Epoch 3/80
 - 0s - loss: 1.1999 - val_loss: 0.6133
AUC: 0.8504

Epoch 4/80
 - 0s - loss: 1.1231 - val_loss: 0.5942
AUC: 0.8567

Epoch 5/80
 - 0s - loss: 1.0997 - val_loss: 0.5887
AUC: 0.8579

Epoch 6/80
 - 0s - loss: 1.0693 - val_loss: 0.5764
AUC: 0.8602

Epoch 7/80
 - 0s - loss: 1.0558 - val_loss: 0.6375
AUC: 0.8625

Epoch 8/80
 - 0s - loss: 1.0472 - val_loss: 0.7449
AUC: 0.8619

Epoch 9/80
 - 0s - loss: 1.0432 - val_loss: 0.6358
AUC: 0.8645

Epoch 10/80
 - 0s - loss: 1.0352 - val_loss: 0.6129
AUC: 0.8652

Epoch 11/80
 - 0s - loss: 1.0249 - val_loss: 0.6494
AUC: 0.8676

Epoch 12/80
 - 0s - loss: 1.0137 - val_loss: 0.6858
AUC: 0.8694

Epoch 13/80
 - 0s - loss: 1.0128 - val_loss: 0.6846
AUC: 0.8698

Epoch 14/80
 - 0s - loss: 1.0026 - val_loss: 0.5840
AUC: 0.8674

Epoch 15/80
 - 0s - loss: 0.9972 - val_loss: 0.5153
AUC: 0.8668

Epoch 16/80
 - 0s - loss: 0.9955 - val_loss: 0.6420
AUC: 0.8697

Epoch 17/80
 - 0s - loss: 0.9861 - val_loss: 0.6196
AUC: 0.8695

Epoch 18/80
 - 0s - loss: 0.9911 - val_loss: 0.5433
AUC: 0.8686

Epoch 19/80
 - 0s - loss: 0.9805 - val_loss: 0.6300
AUC: 0.8699

Epoch 20/80
 - 0s - loss: 0.9917 - val_loss: 0.6737
AUC: 0.8696

Epoch 21/80
 - 0s - loss: 0.9727 - val_loss: 0.5649
AUC: 0.8703

Epoch 22/80
 - 0s - loss: 0.9715 - val_loss: 0.5562
AUC: 0.8686

Epoch 23/80
 - 0s - loss: 0.9704 - val_loss: 0.6372
AUC: 0.8706

Epoch 24/80
 - 0s - loss: 0.9616 - val_loss: 0.6367
AUC: 0.8706

Epoch 25/80
 - 0s - loss: 0.9649 - val_loss: 0.6012
AUC: 0.8711

Epoch 26/80
 - 0s - loss: 0.9484 - val_loss: 0.5911
AUC: 0.8716

Epoch 27/80
 - 0s - loss: 0.9459 - val_loss: 0.5973
AUC: 0.8714

Epoch 28/80
 - 0s - loss: 0.9472 - val_loss: 0.6003
AUC: 0.8717

Epoch 29/80
 - 0s - loss: 0.9427 - val_loss: 0.5670
AUC: 0.8710

Epoch 30/80
 - 0s - loss: 0.9385 - val_loss: 0.5803
AUC: 0.8715

Epoch 31/80
 - 0s - loss: 0.9425 - val_loss: 0.5821
AUC: 0.8715

Epoch 32/80
 - 0s - loss: 0.9414 - val_loss: 0.5766
AUC: 0.8715

Epoch 33/80
 - 0s - loss: 0.9403 - val_loss: 0.5938
AUC: 0.8714

Epoch 34/80
 - 0s - loss: 0.9370 - val_loss: 0.5894
AUC: 0.8715

Epoch 35/80
 - 0s - loss: 0.9386 - val_loss: 0.5810
AUC: 0.8713

Epoch 36/80
 - 0s - loss: 0.9354 - val_loss: 0.5880
AUC: 0.8714

Epoch 37/80
 - 0s - loss: 0.9338 - val_loss: 0.5840
AUC: 0.8714

Epoch 38/80
 - 0s - loss: 0.9364 - val_loss: 0.5829
AUC: 0.8714

Epoch 39/80
 - 0s - loss: 0.9367 - val_loss: 0.5956
AUC: 0.8715

Epoch 40/80
 - 0s - loss: 0.9327 - val_loss: 0.5790
AUC: 0.8713

Epoch 41/80
 - 0s - loss: 0.9365 - val_loss: 0.5808
AUC: 0.8713

Epoch 42/80
 - 0s - loss: 0.9336 - val_loss: 0.5826
AUC: 0.8714

Epoch 43/80
 - 0s - loss: 0.9342 - val_loss: 0.5841
AUC: 0.8713

Epoch 44/80
 - 0s - loss: 0.9323 - val_loss: 0.5806
AUC: 0.8713

Epoch 45/80
 - 0s - loss: 0.9353 - val_loss: 0.5790
AUC: 0.8712

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9438 - val_loss: 0.5751
AUC: 0.8716

Epoch 2/30
 - 0s - loss: 0.9443 - val_loss: 0.5892
AUC: 0.8717

Epoch 3/30
 - 0s - loss: 0.9389 - val_loss: 0.5900
AUC: 0.8719

Epoch 4/30
 - 0s - loss: 0.9345 - val_loss: 0.5932
AUC: 0.8719

Epoch 5/30
 - 0s - loss: 0.9360 - val_loss: 0.5677
AUC: 0.8716

Epoch 6/30
 - 0s - loss: 0.9362 - val_loss: 0.5949
AUC: 0.8718

Epoch 7/30
 - 0s - loss: 0.9334 - val_loss: 0.5818
AUC: 0.8716

Epoch 8/30
 - 0s - loss: 0.9322 - val_loss: 0.5796
AUC: 0.8715

Epoch 9/30
 - 0s - loss: 0.9265 - val_loss: 0.5961
AUC: 0.8719

Epoch 10/30
 - 0s - loss: 0.9290 - val_loss: 0.5736
AUC: 0.8717

Epoch 11/30
 - 0s - loss: 0.9259 - val_loss: 0.5652
AUC: 0.8716

Epoch 12/30
 - 0s - loss: 0.9248 - val_loss: 0.5804
AUC: 0.8719

Epoch 13/30
 - 0s - loss: 0.9220 - val_loss: 0.5871
AUC: 0.8720

Epoch 14/30
 - 0s - loss: 0.9182 - val_loss: 0.5727
AUC: 0.8721

Epoch 15/30
 - 0s - loss: 0.9237 - val_loss: 0.5849
AUC: 0.8722

Epoch 16/30
 - 0s - loss: 0.9240 - val_loss: 0.5993
AUC: 0.8726

Epoch 17/30
 - 0s - loss: 0.9186 - val_loss: 0.5731
AUC: 0.8723

Epoch 18/30
 - 0s - loss: 0.9168 - val_loss: 0.5644
AUC: 0.8721

Epoch 19/30
 - 0s - loss: 0.9248 - val_loss: 0.5640
AUC: 0.8722

Epoch 20/30
 - 0s - loss: 0.9188 - val_loss: 0.5705
AUC: 0.8722

Epoch 21/30
 - 0s - loss: 0.9099 - val_loss: 0.5855
AUC: 0.8727

Epoch 22/30
 - 0s - loss: 0.9103 - val_loss: 0.5566
AUC: 0.8719

Epoch 23/30
 - 0s - loss: 0.9099 - val_loss: 0.5606
AUC: 0.8721

Epoch 24/30
 - 0s - loss: 0.9097 - val_loss: 0.5908
AUC: 0.8725

Epoch 25/30
 - 0s - loss: 0.9026 - val_loss: 0.5791
AUC: 0.8721

Epoch 26/30
 - 0s - loss: 0.9062 - val_loss: 0.6068
AUC: 0.8725

Epoch 27/30
 - 0s - loss: 0.9013 - val_loss: 0.5489
AUC: 0.8719

Epoch 28/30
 - 0s - loss: 0.8972 - val_loss: 0.5621
AUC: 0.8722

Epoch 29/30
 - 0s - loss: 0.8995 - val_loss: 0.5510
AUC: 0.8721

Epoch 30/30
 - 0s - loss: 0.8986 - val_loss: 0.5772
Using TensorFlow backend.
AUC: 0.8725

2019-03-08 07:30:11.163854: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:30:11.334271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:30:11.334318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:30:11.638644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:30:11.638700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:30:11.638710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:30:11.639012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.4 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0873
Epoch 2/80
 - 2s - loss: 0.1968
Epoch 3/80
 - 2s - loss: 0.1679
Epoch 4/80
 - 2s - loss: 0.1549
Epoch 5/80
 - 2s - loss: 0.1409
Epoch 6/80
 - 2s - loss: 0.1276
Epoch 7/80
 - 2s - loss: 0.1157
Epoch 8/80
 - 2s - loss: 0.1055
Epoch 9/80
 - 2s - loss: 0.0968
Epoch 10/80
 - 2s - loss: 0.0893
Epoch 11/80
 - 2s - loss: 0.0829
Epoch 12/80
 - 2s - loss: 0.0773
Epoch 13/80
 - 2s - loss: 0.0726
Epoch 14/80
 - 2s - loss: 0.0686
Epoch 15/80
 - 2s - loss: 0.0652
Epoch 16/80
 - 2s - loss: 0.0622
Epoch 17/80
 - 2s - loss: 0.0597
Epoch 18/80
 - 2s - loss: 0.0576
Epoch 19/80
 - 2s - loss: 0.0557
Epoch 20/80
 - 2s - loss: 0.0542
Epoch 21/80
 - 2s - loss: 0.0528
Epoch 22/80
 - 2s - loss: 0.0516
Epoch 23/80
 - 2s - loss: 0.0506
Epoch 24/80
 - 2s - loss: 0.0498
Epoch 25/80
 - 2s - loss: 0.0490
Epoch 26/80
 - 2s - loss: 0.0484
Epoch 27/80
 - 2s - loss: 0.0478
Epoch 28/80
 - 2s - loss: 0.0474
Epoch 29/80
 - 2s - loss: 0.0470
Epoch 30/80
 - 2s - loss: 0.0466
Epoch 31/80
 - 2s - loss: 0.0463
Epoch 32/80
 - 2s - loss: 0.0460
Epoch 33/80
 - 2s - loss: 0.0458
Epoch 34/80
 - 2s - loss: 0.0456
Epoch 35/80
 - 2s - loss: 0.0453
Epoch 36/80
 - 2s - loss: 0.0452
Epoch 37/80
 - 2s - loss: 0.0450
Epoch 38/80
 - 2s - loss: 0.0449
Epoch 39/80
 - 2s - loss: 0.0447
Epoch 40/80
 - 2s - loss: 0.0446
Epoch 41/80
 - 2s - loss: 0.0445
Epoch 42/80
 - 2s - loss: 0.0444
Epoch 43/80
 - 2s - loss: 0.0443
Epoch 44/80
 - 2s - loss: 0.0442
Epoch 45/80
 - 2s - loss: 0.0442
Epoch 46/80
 - 2s - loss: 0.0441
Epoch 47/80
 - 2s - loss: 0.0440
Epoch 48/80
 - 2s - loss: 0.0440
Epoch 49/80
 - 2s - loss: 0.0439
Epoch 50/80
 - 2s - loss: 0.0439
Epoch 51/80
 - 2s - loss: 0.0438
Epoch 52/80
 - 2s - loss: 0.0438
Epoch 53/80
 - 2s - loss: 0.0437
Epoch 54/80
 - 2s - loss: 0.0437
Epoch 55/80
 - 2s - loss: 0.0436
Epoch 56/80
 - 2s - loss: 0.0436
Epoch 57/80
 - 2s - loss: 0.0436
Epoch 58/80
 - 2s - loss: 0.0435
Epoch 59/80
 - 2s - loss: 0.0423
Epoch 60/80
 - 2s - loss: 0.0421
Epoch 61/80
 - 2s - loss: 0.0421
Epoch 62/80
 - 2s - loss: 0.0421
Epoch 63/80
 - 2s - loss: 0.0421
Epoch 64/80
 - 2s - loss: 0.0418
Epoch 65/80
 - 2s - loss: 0.0418
Epoch 66/80
 - 2s - loss: 0.0418
Epoch 67/80
 - 2s - loss: 0.0418
Epoch 68/80
 - 2s - loss: 0.0417
Epoch 69/80
 - 2s - loss: 0.0417
Epoch 70/80
 - 2s - loss: 0.0417
Epoch 71/80
 - 2s - loss: 0.0417
Epoch 72/80
 - 2s - loss: 0.0417
Epoch 73/80
 - 2s - loss: 0.0417
Epoch 74/80
 - 2s - loss: 0.0417
Epoch 75/80
 - 2s - loss: 0.0417
Epoch 76/80
 - 2s - loss: 0.0417
Epoch 77/80
 - 2s - loss: 0.0417
Epoch 78/80
 - 2s - loss: 0.0417
Epoch 79/80
 - 2s - loss: 0.0417
Epoch 80/80
 - 2s - loss: 0.0417
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.4497 - val_loss: 1.0779
AUC: 0.8205

Epoch 2/80
 - 0s - loss: 1.8294 - val_loss: 0.6945
AUC: 0.8329

Epoch 3/80
 - 0s - loss: 1.3041 - val_loss: 0.7151
AUC: 0.8469

Epoch 4/80
 - 0s - loss: 1.1842 - val_loss: 0.6922
AUC: 0.8529

Epoch 5/80
 - 0s - loss: 1.1273 - val_loss: 0.6556
AUC: 0.8580

Epoch 6/80
 - 0s - loss: 1.1020 - val_loss: 0.6855
AUC: 0.8624

Epoch 7/80
 - 0s - loss: 1.0798 - val_loss: 0.6926
AUC: 0.8630

Epoch 8/80
 - 0s - loss: 1.0636 - val_loss: 0.6511
AUC: 0.8640

Epoch 9/80
 - 0s - loss: 1.0496 - val_loss: 0.6466
AUC: 0.8640

Epoch 10/80
 - 0s - loss: 1.0476 - val_loss: 0.6651
AUC: 0.8662

Epoch 11/80
 - 0s - loss: 1.0421 - val_loss: 0.6414
AUC: 0.8679

Epoch 12/80
 - 0s - loss: 1.0280 - val_loss: 0.5930
AUC: 0.8664

Epoch 13/80
 - 0s - loss: 1.0248 - val_loss: 0.6479
AUC: 0.8676

Epoch 14/80
 - 0s - loss: 1.0146 - val_loss: 0.6334
AUC: 0.8677

Epoch 15/80
 - 0s - loss: 1.0086 - val_loss: 0.6753
AUC: 0.8696

Epoch 16/80
 - 0s - loss: 1.0134 - val_loss: 0.6237
AUC: 0.8677

Epoch 17/80
 - 0s - loss: 1.0051 - val_loss: 0.6601
AUC: 0.8697

Epoch 18/80
 - 0s - loss: 0.9958 - val_loss: 0.6334
AUC: 0.8681

Epoch 19/80
 - 0s - loss: 1.0000 - val_loss: 0.6224
AUC: 0.8694

Epoch 20/80
 - 0s - loss: 0.9926 - val_loss: 0.5465
AUC: 0.8688

Epoch 21/80
 - 0s - loss: 0.9913 - val_loss: 0.6053
AUC: 0.8705

Epoch 22/80
 - 0s - loss: 0.9818 - val_loss: 0.5870
AUC: 0.8692

Epoch 23/80
 - 0s - loss: 0.9803 - val_loss: 0.5683
AUC: 0.8700

Epoch 24/80
 - 0s - loss: 0.9869 - val_loss: 0.6481
AUC: 0.8714

Epoch 25/80
 - 0s - loss: 0.9786 - val_loss: 0.6483
AUC: 0.8716

Epoch 26/80
 - 0s - loss: 0.9698 - val_loss: 0.5681
AUC: 0.8698

Epoch 27/80
 - 0s - loss: 0.9664 - val_loss: 0.6275
AUC: 0.8711

Epoch 28/80
 - 0s - loss: 0.9694 - val_loss: 0.6902
AUC: 0.8697

Epoch 29/80
 - 0s - loss: 0.9692 - val_loss: 0.5642
AUC: 0.8694

Epoch 30/80
 - 0s - loss: 0.9710 - val_loss: 0.6452
AUC: 0.8710

Epoch 31/80
 - 0s - loss: 0.9483 - val_loss: 0.5958
AUC: 0.8714

Epoch 32/80
 - 0s - loss: 0.9438 - val_loss: 0.5862
AUC: 0.8713

Epoch 33/80
 - 0s - loss: 0.9415 - val_loss: 0.5816
AUC: 0.8713

Epoch 34/80
 - 0s - loss: 0.9437 - val_loss: 0.5877
AUC: 0.8717

Epoch 35/80
 - 0s - loss: 0.9410 - val_loss: 0.6017
AUC: 0.8718

Epoch 36/80
 - 0s - loss: 0.9379 - val_loss: 0.5834
AUC: 0.8717

Epoch 37/80
 - 0s - loss: 0.9450 - val_loss: 0.6029
AUC: 0.8719

Epoch 38/80
 - 0s - loss: 0.9396 - val_loss: 0.5651
AUC: 0.8718

Epoch 39/80
 - 0s - loss: 0.9326 - val_loss: 0.5821
AUC: 0.8718

Epoch 40/80
 - 0s - loss: 0.9340 - val_loss: 0.5732
AUC: 0.8716

Epoch 41/80
 - 0s - loss: 0.9306 - val_loss: 0.5821
AUC: 0.8717

Epoch 42/80
 - 0s - loss: 0.9311 - val_loss: 0.5882
AUC: 0.8719

Epoch 43/80
 - 0s - loss: 0.9329 - val_loss: 0.5993
AUC: 0.8720

Epoch 44/80
 - 0s - loss: 0.9275 - val_loss: 0.5860
AUC: 0.8719

Epoch 45/80
 - 0s - loss: 0.9289 - val_loss: 0.5920
AUC: 0.8720

Epoch 46/80
 - 0s - loss: 0.9321 - val_loss: 0.5882
AUC: 0.8720

Epoch 47/80
 - 0s - loss: 0.9325 - val_loss: 0.5913
AUC: 0.8721

Epoch 48/80
 - 0s - loss: 0.9258 - val_loss: 0.5870
AUC: 0.8720

Epoch 49/80
 - 0s - loss: 0.9292 - val_loss: 0.5834
AUC: 0.8718

Epoch 50/80
 - 0s - loss: 0.9284 - val_loss: 0.5857
AUC: 0.8717

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9313 - val_loss: 0.5979
AUC: 0.8720

Epoch 2/30
 - 0s - loss: 0.9287 - val_loss: 0.5928
AUC: 0.8723

Epoch 3/30
 - 0s - loss: 0.9318 - val_loss: 0.5929
AUC: 0.8723

Epoch 4/30
 - 0s - loss: 0.9295 - val_loss: 0.5632
AUC: 0.8717

Epoch 5/30
 - 0s - loss: 0.9272 - val_loss: 0.5865
AUC: 0.8722

Epoch 6/30
 - 0s - loss: 0.9275 - val_loss: 0.5851
AUC: 0.8722

Epoch 7/30
 - 0s - loss: 0.9250 - val_loss: 0.5895
AUC: 0.8720

Epoch 8/30
 - 0s - loss: 0.9282 - val_loss: 0.5975
AUC: 0.8726

Epoch 9/30
 - 0s - loss: 0.9204 - val_loss: 0.5695
AUC: 0.8721

Epoch 10/30
 - 0s - loss: 0.9159 - val_loss: 0.5890
AUC: 0.8726

Epoch 11/30
 - 0s - loss: 0.9118 - val_loss: 0.5914
AUC: 0.8725

Epoch 12/30
 - 0s - loss: 0.9162 - val_loss: 0.5715
AUC: 0.8723

Epoch 13/30
 - 0s - loss: 0.9101 - val_loss: 0.5718
AUC: 0.8722

Epoch 14/30
 - 0s - loss: 0.9163 - val_loss: 0.5746
AUC: 0.8723

Epoch 15/30
 - 0s - loss: 0.9123 - val_loss: 0.5812
AUC: 0.8724

Epoch 16/30
 - 0s - loss: 0.9159 - val_loss: 0.5823
AUC: 0.8724

Epoch 17/30
 - 0s - loss: 0.9120 - val_loss: 0.5861
AUC: 0.8724

Epoch 18/30
 - 0s - loss: 0.9154 - val_loss: 0.5783
AUC: 0.8723

Epoch 19/30
 - 0s - loss: 0.9111 - val_loss: 0.5806
AUC: 0.8724

Epoch 20/30
 - 0s - loss: 0.9120 - val_loss: 0.5806
AUC: 0.8724

Epoch 21/30
 - 0s - loss: 0.9093 - val_loss: 0.5806
AUC: 0.8724

Epoch 22/30
 - 0s - loss: 0.9084 - val_loss: 0.5781
AUC: 0.8724

Epoch 23/30
 - 0s - loss: 0.9063 - val_loss: 0.5793
AUC: 0.8724

Epoch 24/30
 - 0s - loss: 0.9110 - val_loss: 0.5760
AUC: 0.8723

Epoch 25/30
 - 0s - loss: 0.9044 - val_loss: 0.5765
AUC: 0.8723

Epoch 26/30
 - 0s - loss: 0.9084 - val_loss: 0.5779
AUC: 0.8724

Epoch 27/30
 - 0s - loss: 0.9073 - val_loss: 0.5773
AUC: 0.8724

Epoch 28/30
 - 0s - loss: 0.9105 - val_loss: 0.5768
AUC: 0.8724

Epoch 29/30
 - 0s - loss: 0.9106 - val_loss: 0.5793
AUC: 0.8724

Epoch 30/30
 - 0s - loss: 0.9072 - val_loss: 0.5795
Using TensorFlow backend.
AUC: 0.8724

2019-03-08 07:34:10.647948: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:34:10.813760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:34:10.813806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:34:11.113120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:34:11.113177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:34:11.113186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:34:11.113451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0931
Epoch 2/80
 - 2s - loss: 0.1964
Epoch 3/80
 - 2s - loss: 0.1681
Epoch 4/80
 - 2s - loss: 0.1547
Epoch 5/80
 - 2s - loss: 0.1405
Epoch 6/80
 - 2s - loss: 0.1269
Epoch 7/80
 - 2s - loss: 0.1151
Epoch 8/80
 - 2s - loss: 0.1049
Epoch 9/80
 - 2s - loss: 0.0961
Epoch 10/80
 - 2s - loss: 0.0884
Epoch 11/80
 - 2s - loss: 0.0819
Epoch 12/80
 - 2s - loss: 0.0763
Epoch 13/80
 - 2s - loss: 0.0716
Epoch 14/80
 - 2s - loss: 0.0675
Epoch 15/80
 - 2s - loss: 0.0642
Epoch 16/80
 - 2s - loss: 0.0613
Epoch 17/80
 - 2s - loss: 0.0589
Epoch 18/80
 - 2s - loss: 0.0570
Epoch 19/80
 - 2s - loss: 0.0553
Epoch 20/80
 - 2s - loss: 0.0538
Epoch 21/80
 - 2s - loss: 0.0526
Epoch 22/80
 - 2s - loss: 0.0515
Epoch 23/80
 - 2s - loss: 0.0506
Epoch 24/80
 - 2s - loss: 0.0498
Epoch 25/80
 - 2s - loss: 0.0491
Epoch 26/80
 - 2s - loss: 0.0485
Epoch 27/80
 - 2s - loss: 0.0480
Epoch 28/80
 - 2s - loss: 0.0475
Epoch 29/80
 - 2s - loss: 0.0471
Epoch 30/80
 - 2s - loss: 0.0467
Epoch 31/80
 - 2s - loss: 0.0464
Epoch 32/80
 - 2s - loss: 0.0462
Epoch 33/80
 - 2s - loss: 0.0459
Epoch 34/80
 - 2s - loss: 0.0457
Epoch 35/80
 - 2s - loss: 0.0455
Epoch 36/80
 - 2s - loss: 0.0453
Epoch 37/80
 - 2s - loss: 0.0452
Epoch 38/80
 - 2s - loss: 0.0450
Epoch 39/80
 - 2s - loss: 0.0449
Epoch 40/80
 - 2s - loss: 0.0448
Epoch 41/80
 - 2s - loss: 0.0447
Epoch 42/80
 - 2s - loss: 0.0446
Epoch 43/80
 - 2s - loss: 0.0445
Epoch 44/80
 - 2s - loss: 0.0444
Epoch 45/80
 - 2s - loss: 0.0443
Epoch 46/80
 - 2s - loss: 0.0443
Epoch 47/80
 - 2s - loss: 0.0442
Epoch 48/80
 - 2s - loss: 0.0441
Epoch 49/80
 - 2s - loss: 0.0441
Epoch 50/80
 - 2s - loss: 0.0440
Epoch 51/80
 - 2s - loss: 0.0440
Epoch 52/80
 - 2s - loss: 0.0439
Epoch 53/80
 - 2s - loss: 0.0439
Epoch 54/80
 - 2s - loss: 0.0438
Epoch 55/80
 - 2s - loss: 0.0438
Epoch 56/80
 - 2s - loss: 0.0438
Epoch 57/80
 - 2s - loss: 0.0437
Epoch 58/80
 - 2s - loss: 0.0437
Epoch 59/80
 - 2s - loss: 0.0437
Epoch 60/80
 - 2s - loss: 0.0424
Epoch 61/80
 - 2s - loss: 0.0423
Epoch 62/80
 - 2s - loss: 0.0422
Epoch 63/80
 - 2s - loss: 0.0422
Epoch 64/80
 - 2s - loss: 0.0422
Epoch 65/80
 - 2s - loss: 0.0419
Epoch 66/80
 - 2s - loss: 0.0419
Epoch 67/80
 - 2s - loss: 0.0419
Epoch 68/80
 - 2s - loss: 0.0419
Epoch 69/80
 - 2s - loss: 0.0418
Epoch 70/80
 - 2s - loss: 0.0418
Epoch 71/80
 - 2s - loss: 0.0418
Epoch 72/80
 - 2s - loss: 0.0418
Epoch 73/80
 - 2s - loss: 0.0418
Epoch 74/80
 - 2s - loss: 0.0418
Epoch 75/80
 - 2s - loss: 0.0418
Epoch 76/80
 - 2s - loss: 0.0418
Epoch 77/80
 - 2s - loss: 0.0418
Epoch 78/80
 - 2s - loss: 0.0418
Epoch 79/80
 - 2s - loss: 0.0418
Epoch 80/80
 - 2s - loss: 0.0418
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.6596 - val_loss: 1.1896
AUC: 0.8215

Epoch 2/80
 - 0s - loss: 1.4291 - val_loss: 0.8431
AUC: 0.8391

Epoch 3/80
 - 0s - loss: 1.1972 - val_loss: 0.6960
AUC: 0.8486

Epoch 4/80
 - 0s - loss: 1.1197 - val_loss: 0.7018
AUC: 0.8543

Epoch 5/80
 - 0s - loss: 1.0776 - val_loss: 0.6526
AUC: 0.8540

Epoch 6/80
 - 0s - loss: 1.0599 - val_loss: 0.6442
AUC: 0.8585

Epoch 7/80
 - 0s - loss: 1.0508 - val_loss: 0.6481
AUC: 0.8597

Epoch 8/80
 - 0s - loss: 1.0407 - val_loss: 0.6934
AUC: 0.8580

Epoch 9/80
 - 0s - loss: 1.0320 - val_loss: 0.6499
AUC: 0.8617

Epoch 10/80
 - 0s - loss: 1.0204 - val_loss: 0.6371
AUC: 0.8608

Epoch 11/80
 - 0s - loss: 1.0255 - val_loss: 0.6243
AUC: 0.8629

Epoch 12/80
 - 0s - loss: 1.0166 - val_loss: 0.6105
AUC: 0.8629

Epoch 13/80
 - 0s - loss: 1.0094 - val_loss: 0.6154
AUC: 0.8643

Epoch 14/80
 - 0s - loss: 1.0052 - val_loss: 0.6387
AUC: 0.8642

Epoch 15/80
 - 0s - loss: 0.9949 - val_loss: 0.5449
AUC: 0.8645

Epoch 16/80
 - 0s - loss: 0.9903 - val_loss: 0.6880
AUC: 0.8665

Epoch 17/80
 - 0s - loss: 0.9937 - val_loss: 0.5953
AUC: 0.8648

Epoch 18/80
 - 0s - loss: 0.9837 - val_loss: 0.6388
AUC: 0.8672

Epoch 19/80
 - 0s - loss: 0.9837 - val_loss: 0.6306
AUC: 0.8657

Epoch 20/80
 - 0s - loss: 0.9816 - val_loss: 0.5656
AUC: 0.8673

Epoch 21/80
 - 0s - loss: 0.9823 - val_loss: 0.6475
AUC: 0.8674

Epoch 22/80
 - 0s - loss: 0.9699 - val_loss: 0.5938
AUC: 0.8675

Epoch 23/80
 - 0s - loss: 0.9707 - val_loss: 0.6728
AUC: 0.8654

Epoch 24/80
 - 0s - loss: 0.9680 - val_loss: 0.6285
AUC: 0.8685

Epoch 25/80
 - 0s - loss: 0.9616 - val_loss: 0.5904
AUC: 0.8674

Epoch 26/80
 - 0s - loss: 0.9489 - val_loss: 0.6141
AUC: 0.8684

Epoch 27/80
 - 0s - loss: 0.9451 - val_loss: 0.5960
AUC: 0.8684

Epoch 28/80
 - 0s - loss: 0.9390 - val_loss: 0.5745
AUC: 0.8686

Epoch 29/80
 - 0s - loss: 0.9428 - val_loss: 0.5627
AUC: 0.8684

Epoch 30/80
 - 0s - loss: 0.9372 - val_loss: 0.5828
AUC: 0.8683

Epoch 31/80
 - 0s - loss: 0.9419 - val_loss: 0.5924
AUC: 0.8686

Epoch 32/80
 - 0s - loss: 0.9377 - val_loss: 0.5848
AUC: 0.8680

Epoch 33/80
 - 0s - loss: 0.9337 - val_loss: 0.5948
AUC: 0.8684

Epoch 34/80
 - 0s - loss: 0.9341 - val_loss: 0.6010
AUC: 0.8685

Epoch 35/80
 - 0s - loss: 0.9346 - val_loss: 0.5959
AUC: 0.8687

Epoch 36/80
 - 0s - loss: 0.9344 - val_loss: 0.5811
AUC: 0.8687

Epoch 37/80
 - 0s - loss: 0.9310 - val_loss: 0.5933
AUC: 0.8687

Epoch 38/80
 - 0s - loss: 0.9331 - val_loss: 0.5881
AUC: 0.8687

Epoch 39/80
 - 0s - loss: 0.9303 - val_loss: 0.5877
AUC: 0.8686

Epoch 40/80
 - 0s - loss: 0.9338 - val_loss: 0.5833
AUC: 0.8687

Epoch 41/80
 - 0s - loss: 0.9337 - val_loss: 0.5946
AUC: 0.8686

Epoch 42/80
 - 0s - loss: 0.9339 - val_loss: 0.5891
AUC: 0.8687

Epoch 43/80
 - 0s - loss: 0.9298 - val_loss: 0.5851
AUC: 0.8687

Epoch 44/80
 - 0s - loss: 0.9286 - val_loss: 0.5889
AUC: 0.8688

Epoch 45/80
 - 0s - loss: 0.9316 - val_loss: 0.5781
AUC: 0.8688

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9275 - val_loss: 0.5965
AUC: 0.8686

Epoch 2/30
 - 0s - loss: 0.9278 - val_loss: 0.6032
AUC: 0.8691

Epoch 3/30
 - 0s - loss: 0.9311 - val_loss: 0.5904
AUC: 0.8688

Epoch 4/30
 - 0s - loss: 0.9299 - val_loss: 0.5756
AUC: 0.8693

Epoch 5/30
 - 1s - loss: 0.9265 - val_loss: 0.5808
AUC: 0.8691

Epoch 6/30
 - 0s - loss: 0.9226 - val_loss: 0.5905
AUC: 0.8690

Epoch 7/30
 - 0s - loss: 0.9236 - val_loss: 0.5891
AUC: 0.8688

Epoch 8/30
 - 0s - loss: 0.9232 - val_loss: 0.5762
AUC: 0.8691

Epoch 9/30
 - 0s - loss: 0.9134 - val_loss: 0.5936
AUC: 0.8692

Epoch 10/30
 - 0s - loss: 0.9178 - val_loss: 0.5956
AUC: 0.8694

Epoch 11/30
 - 0s - loss: 0.9163 - val_loss: 0.5732
AUC: 0.8693

Epoch 12/30
 - 0s - loss: 0.9169 - val_loss: 0.5655
AUC: 0.8693

Epoch 13/30
 - 0s - loss: 0.9167 - val_loss: 0.5972
AUC: 0.8695

Epoch 14/30
 - 0s - loss: 0.9114 - val_loss: 0.5997
AUC: 0.8695

Epoch 15/30
 - 0s - loss: 0.9112 - val_loss: 0.5796
AUC: 0.8695

Epoch 16/30
 - 0s - loss: 0.9075 - val_loss: 0.5971
AUC: 0.8696

Epoch 17/30
 - 0s - loss: 0.9071 - val_loss: 0.5883
AUC: 0.8694

Epoch 18/30
 - 0s - loss: 0.9001 - val_loss: 0.5789
AUC: 0.8695

Epoch 19/30
 - 0s - loss: 0.9048 - val_loss: 0.5688
AUC: 0.8692

Epoch 20/30
 - 0s - loss: 0.9095 - val_loss: 0.6091
AUC: 0.8696

Epoch 21/30
 - 0s - loss: 0.9052 - val_loss: 0.5891
AUC: 0.8697

Epoch 22/30
 - 0s - loss: 0.9038 - val_loss: 0.5655
AUC: 0.8695

Epoch 23/30
 - 0s - loss: 0.8961 - val_loss: 0.5773
AUC: 0.8696

Epoch 24/30
 - 0s - loss: 0.8958 - val_loss: 0.5663
AUC: 0.8695

Epoch 25/30
 - 0s - loss: 0.8980 - val_loss: 0.5644
AUC: 0.8695

Epoch 26/30
 - 0s - loss: 0.8976 - val_loss: 0.5740
AUC: 0.8696

Epoch 27/30
 - 0s - loss: 0.8956 - val_loss: 0.5741
AUC: 0.8696

Epoch 28/30
 - 0s - loss: 0.8909 - val_loss: 0.5730
AUC: 0.8696

Epoch 29/30
 - 0s - loss: 0.8966 - val_loss: 0.5720
AUC: 0.8696

Epoch 30/30
 - 0s - loss: 0.9000 - val_loss: 0.5714
Using TensorFlow backend.
AUC: 0.8696

2019-03-08 07:38:01.604165: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:38:01.774461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:38:01.774505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:38:02.075158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:38:02.075225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:38:02.075235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:38:02.075498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6532
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:38:26.998093: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:38:27.173465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:38:27.173513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:38:27.528101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:38:27.528149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:38:27.528159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:38:27.528432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6500
Epoch 2/80
 - 2s - loss: 0.1022
Epoch 3/80
 - 2s - loss: 0.0686
Epoch 4/80
 - 2s - loss: 0.0629
Epoch 5/80
 - 2s - loss: 0.0588
Epoch 6/80
 - 2s - loss: 0.0545
Epoch 7/80
 - 2s - loss: 0.0504
Epoch 8/80
 - 2s - loss: 0.0465
Epoch 9/80
 - 2s - loss: 0.0428
Epoch 10/80
 - 2s - loss: 0.0392
Epoch 11/80
 - 2s - loss: 0.0359
Epoch 12/80
 - 2s - loss: 0.0329
Epoch 13/80
 - 2s - loss: 0.0301
Epoch 14/80
 - 2s - loss: 0.0278
Epoch 15/80
 - 2s - loss: 0.0257
Epoch 16/80
 - 2s - loss: 0.0241
Epoch 17/80
 - 2s - loss: 0.0227
Epoch 18/80
 - 2s - loss: 0.0215
Epoch 19/80
 - 2s - loss: 0.0206
Epoch 20/80
 - 2s - loss: 0.0198
Epoch 21/80
 - 2s - loss: 0.0192
Epoch 22/80
 - 2s - loss: 0.0186
Epoch 23/80
 - 2s - loss: 0.0181
Epoch 24/80
 - 2s - loss: 0.0176
Epoch 25/80
 - 2s - loss: 0.0172
Epoch 26/80
 - 2s - loss: 0.0169
Epoch 27/80
 - 2s - loss: 0.0166
Epoch 28/80
 - 2s - loss: 0.0163
Epoch 29/80
 - 2s - loss: 0.0161
Epoch 30/80
 - 2s - loss: 0.0158
Epoch 31/80
 - 2s - loss: 0.0157
Epoch 32/80
 - 2s - loss: 0.0155
Epoch 33/80
 - 2s - loss: 0.0154
Epoch 34/80
 - 2s - loss: 0.0152
Epoch 35/80
 - 2s - loss: 0.0151
Epoch 36/80
 - 2s - loss: 0.0150
Epoch 37/80
 - 2s - loss: 0.0149
Epoch 38/80
 - 2s - loss: 0.0148
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:40:04.241221: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:40:04.420085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:40:04.420133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:40:04.733173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:40:04.733222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:40:04.733232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:40:04.733498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6484
Epoch 2/80
 - 2s - loss: 0.1030
Epoch 3/80
 - 2s - loss: 0.0698
Epoch 4/80
 - 2s - loss: 0.0644
Epoch 5/80
 - 2s - loss: 0.0616
Epoch 6/80
 - 2s - loss: 0.0584
Epoch 7/80
 - 2s - loss: 0.0546
Epoch 8/80
 - 2s - loss: 0.0502
Epoch 9/80
 - 2s - loss: 0.0452
Epoch 10/80
 - 2s - loss: 0.0403
Epoch 11/80
 - 2s - loss: 0.0362
Epoch 12/80
 - 2s - loss: 0.0329
Epoch 13/80
 - 2s - loss: 0.0302
Epoch 14/80
 - 2s - loss: 0.0279
Epoch 15/80
 - 2s - loss: 0.0261
Epoch 16/80
 - 2s - loss: 0.0245
Epoch 17/80
 - 2s - loss: 0.0231
Epoch 18/80
 - 2s - loss: 0.0219
Epoch 19/80
 - 2s - loss: 0.0209
Epoch 20/80
 - 2s - loss: 0.0200
Epoch 21/80
 - 2s - loss: 0.0193
Epoch 22/80
 - 2s - loss: 0.0186
Epoch 23/80
 - 2s - loss: 0.0181
Epoch 24/80
 - 2s - loss: 0.0176
Epoch 25/80
 - 2s - loss: 0.0172
Epoch 26/80
 - 2s - loss: 0.0168
Epoch 27/80
 - 2s - loss: 0.0165
Epoch 28/80
 - 2s - loss: 0.0162
Epoch 29/80
 - 2s - loss: 0.0160
Epoch 30/80
 - 2s - loss: 0.0158
Epoch 31/80
 - 2s - loss: 0.0156
Epoch 32/80
 - 2s - loss: 0.0154
Epoch 33/80
 - 2s - loss: 0.0153
Epoch 34/80
 - 2s - loss: 0.0151
Epoch 35/80
 - 2s - loss: 0.0150
Epoch 36/80
 - 2s - loss: 0.0149
Epoch 37/80
 - 2s - loss: 0.0148
Epoch 38/80
 - 2s - loss: 0.0148
Epoch 39/80
 - 2s - loss: 0.0147
Epoch 40/80
 - 2s - loss: 0.0146
Epoch 41/80
 - 2s - loss: 0.0146
Epoch 42/80
 - 2s - loss: 0.0145
Epoch 43/80
 - 2s - loss: 0.0145
Epoch 44/80
 - 2s - loss: 0.0144
Epoch 45/80
 - 2s - loss: 0.0144
Epoch 46/80
 - 2s - loss: 0.0143
Epoch 47/80
 - 2s - loss: 0.0143
Epoch 48/80
 - 2s - loss: 0.0143
Epoch 49/80
 - 2s - loss: 0.0142
Epoch 50/80
 - 2s - loss: 0.0142
Epoch 51/80
 - 2s - loss: 0.0142
Epoch 52/80
 - 2s - loss: 0.0137
Epoch 53/80
 - 2s - loss: 0.0137
Epoch 54/80
 - 2s - loss: 0.0137
Epoch 55/80
 - 2s - loss: 0.0137
Epoch 56/80
 - 2s - loss: 0.0136
Epoch 57/80
 - 2s - loss: 0.0136
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:42:14.725372: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:42:14.890402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:42:14.890448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:42:15.192046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:42:15.192113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:42:15.192122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:42:15.192387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2928
Epoch 2/80
 - 2s - loss: 0.3323
Epoch 3/80
 - 2s - loss: 0.2913
Epoch 4/80
 - 2s - loss: 0.2616
Epoch 5/80
 - 2s - loss: 0.2353
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:42:43.167652: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:42:43.337117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:42:43.337163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:42:43.656326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:42:43.656386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:42:43.656395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:42:43.656668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3011
Epoch 2/80
 - 2s - loss: 0.3337
Epoch 3/80
 - 2s - loss: 0.3013
Epoch 4/80
 - 2s - loss: 0.2764
Epoch 5/80
 - 2s - loss: 0.2482
Epoch 6/80
 - 2s - loss: 0.2257
Epoch 7/80
 - 2s - loss: 0.2077
Epoch 8/80
 - 2s - loss: 0.1920
Epoch 9/80
 - 2s - loss: 0.1780
Epoch 10/80
 - 2s - loss: 0.1658
Epoch 11/80
 - 2s - loss: 0.1556
Epoch 12/80
 - 2s - loss: 0.1472
Epoch 13/80
 - 2s - loss: 0.1402
Epoch 14/80
 - 2s - loss: 0.1345
Epoch 15/80
 - 2s - loss: 0.1297
Epoch 16/80
 - 2s - loss: 0.1258
Epoch 17/80
 - 2s - loss: 0.1226
Epoch 18/80
 - 2s - loss: 0.1198
Epoch 19/80
 - 2s - loss: 0.1174
Epoch 20/80
 - 2s - loss: 0.1154
Epoch 21/80
 - 2s - loss: 0.1137
Epoch 22/80
 - 2s - loss: 0.1122
Epoch 23/80
 - 2s - loss: 0.1109
Epoch 24/80
 - 2s - loss: 0.1098
Epoch 25/80
 - 2s - loss: 0.1088
Epoch 26/80
 - 2s - loss: 0.1080
Epoch 27/80
 - 2s - loss: 0.1073
Epoch 28/80
 - 2s - loss: 0.1067
Epoch 29/80
 - 2s - loss: 0.1061
Epoch 30/80
 - 2s - loss: 0.1056
Epoch 31/80
 - 2s - loss: 0.1052
Epoch 32/80
 - 2s - loss: 0.1048
Epoch 33/80
 - 2s - loss: 0.1045
Epoch 34/80
 - 2s - loss: 0.1042
Epoch 35/80
 - 2s - loss: 0.1039
Epoch 36/80
 - 2s - loss: 0.1037
Epoch 37/80
 - 2s - loss: 0.1035
Epoch 38/80
 - 2s - loss: 0.1033
Epoch 39/80
 - 2s - loss: 0.1031
Epoch 40/80
 - 2s - loss: 0.1030
Epoch 41/80
 - 2s - loss: 0.1028
Epoch 42/80
 - 2s - loss: 0.1027
Epoch 43/80
 - 2s - loss: 0.1026
Epoch 44/80
 - 2s - loss: 0.1025
Epoch 45/80
 - 2s - loss: 0.1023
Epoch 46/80
 - 2s - loss: 0.1022
Epoch 47/80
 - 2s - loss: 0.1022
Epoch 48/80
 - 2s - loss: 0.1021
Epoch 49/80
 - 2s - loss: 0.1020
Epoch 50/80
 - 2s - loss: 0.1019
Epoch 51/80
 - 2s - loss: 0.1018
Epoch 52/80
 - 2s - loss: 0.1018
Epoch 53/80
 - 2s - loss: 0.1017
Epoch 54/80
 - 2s - loss: 0.1016
Epoch 55/80
 - 2s - loss: 0.1016
Epoch 56/80
 - 2s - loss: 0.1016
Epoch 57/80
 - 2s - loss: 0.1015
Epoch 58/80
 - 2s - loss: 0.1014
Epoch 59/80
 - 2s - loss: 0.1014
Epoch 60/80
 - 2s - loss: 0.1013
Epoch 61/80
 - 2s - loss: 0.1013
Epoch 62/80
 - 2s - loss: 0.1013
Epoch 63/80
 - 2s - loss: 0.1012
Epoch 64/80
 - 2s - loss: 0.1012
Epoch 65/80
 - 2s - loss: 0.1011
Epoch 66/80
 - 2s - loss: 0.1011
Epoch 67/80
 - 2s - loss: 0.1011
Epoch 68/80
 - 2s - loss: 0.0984
Epoch 69/80
 - 2s - loss: 0.0981
Epoch 70/80
 - 2s - loss: 0.0981
Epoch 71/80
 - 2s - loss: 0.0981
Epoch 72/80
 - 2s - loss: 0.0981
Epoch 73/80
 - 2s - loss: 0.0974
Epoch 74/80
 - 2s - loss: 0.0974
Epoch 75/80
 - 2s - loss: 0.0974
Epoch 76/80
 - 2s - loss: 0.0974
Epoch 77/80
 - 2s - loss: 0.0973
Epoch 78/80
 - 2s - loss: 0.0973
Epoch 79/80
 - 2s - loss: 0.0973
Epoch 80/80
 - 2s - loss: 0.0973
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.9439 - val_loss: 1.1624
AUC: 0.8139

Epoch 2/80
 - 0s - loss: 1.8712 - val_loss: 1.0209
AUC: 0.8349

Epoch 3/80
 - 0s - loss: 1.4392 - val_loss: 0.8173
AUC: 0.8397

Epoch 4/80
 - 0s - loss: 1.2591 - val_loss: 0.7309
AUC: 0.8466

Epoch 5/80
 - 0s - loss: 1.1579 - val_loss: 0.6720
AUC: 0.8479

Epoch 6/80
 - 0s - loss: 1.1266 - val_loss: 0.7066
AUC: 0.8532

Epoch 7/80
 - 0s - loss: 1.0881 - val_loss: 0.7178
AUC: 0.8557

Epoch 8/80
 - 0s - loss: 1.0745 - val_loss: 0.6314
AUC: 0.8561

Epoch 9/80
 - 0s - loss: 1.0613 - val_loss: 0.6274
AUC: 0.8578

Epoch 10/80
 - 0s - loss: 1.0542 - val_loss: 0.6089
AUC: 0.8586

Epoch 11/80
 - 0s - loss: 1.0451 - val_loss: 0.6256
AUC: 0.8612

Epoch 12/80
 - 0s - loss: 1.0395 - val_loss: 0.6719
AUC: 0.8622

Epoch 13/80
 - 0s - loss: 1.0209 - val_loss: 0.6800
AUC: 0.8639

Epoch 14/80
 - 0s - loss: 1.0275 - val_loss: 0.6520
AUC: 0.8632

Epoch 15/80
 - 0s - loss: 1.0238 - val_loss: 0.5952
AUC: 0.8639

Epoch 16/80
 - 0s - loss: 1.0114 - val_loss: 0.6344
AUC: 0.8641

Epoch 17/80
 - 0s - loss: 1.0108 - val_loss: 0.6071
AUC: 0.8651

Epoch 18/80
 - 0s - loss: 1.0031 - val_loss: 0.5927
AUC: 0.8656

Epoch 19/80
 - 0s - loss: 0.9995 - val_loss: 0.6380
AUC: 0.8630

Epoch 20/80
 - 0s - loss: 1.0036 - val_loss: 0.6056
AUC: 0.8658

Epoch 21/80
 - 0s - loss: 0.9962 - val_loss: 0.6925
AUC: 0.8671

Epoch 22/80
 - 0s - loss: 0.9898 - val_loss: 0.5932
AUC: 0.8670

Epoch 23/80
 - 0s - loss: 0.9883 - val_loss: 0.5638
AUC: 0.8676

Epoch 24/80
 - 0s - loss: 0.9767 - val_loss: 0.6123
AUC: 0.8679

Epoch 25/80
 - 0s - loss: 0.9842 - val_loss: 0.6485
AUC: 0.8680

Epoch 26/80
 - 0s - loss: 0.9749 - val_loss: 0.6068
AUC: 0.8684

Epoch 27/80
 - 0s - loss: 0.9725 - val_loss: 0.6533
AUC: 0.8692

Epoch 28/80
 - 0s - loss: 0.9679 - val_loss: 0.6123
AUC: 0.8683

Epoch 29/80
 - 0s - loss: 0.9682 - val_loss: 0.5945
AUC: 0.8695

Epoch 30/80
 - 0s - loss: 0.9725 - val_loss: 0.5607
AUC: 0.8693

Epoch 31/80
 - 0s - loss: 0.9699 - val_loss: 0.6151
AUC: 0.8703

Epoch 32/80
 - 0s - loss: 0.9633 - val_loss: 0.6269
AUC: 0.8706

Epoch 33/80
 - 0s - loss: 0.9645 - val_loss: 0.6121
AUC: 0.8705

Epoch 34/80
 - 0s - loss: 0.9579 - val_loss: 0.5782
AUC: 0.8695

Epoch 35/80
 - 0s - loss: 0.9535 - val_loss: 0.5721
AUC: 0.8704

Epoch 36/80
 - 0s - loss: 0.9511 - val_loss: 0.5363
AUC: 0.8710

Epoch 37/80
 - 0s - loss: 0.9549 - val_loss: 0.5626
AUC: 0.8714

Epoch 38/80
 - 0s - loss: 0.9488 - val_loss: 0.6070
AUC: 0.8710

Epoch 39/80
 - 0s - loss: 0.9485 - val_loss: 0.6246
AUC: 0.8711

Epoch 40/80
 - 0s - loss: 0.9425 - val_loss: 0.5600
AUC: 0.8709

Epoch 41/80
 - 0s - loss: 0.9422 - val_loss: 0.5620
AUC: 0.8708

Epoch 42/80
 - 0s - loss: 0.9423 - val_loss: 0.5787
AUC: 0.8709

Epoch 43/80
 - 0s - loss: 0.9396 - val_loss: 0.5696
AUC: 0.8705

Epoch 44/80
 - 0s - loss: 0.9368 - val_loss: 0.5140
AUC: 0.8714

Epoch 45/80
 - 0s - loss: 0.9314 - val_loss: 0.6011
AUC: 0.8713

Epoch 46/80
 - 0s - loss: 0.9359 - val_loss: 0.5073
AUC: 0.8717

Epoch 47/80
 - 0s - loss: 0.9324 - val_loss: 0.5876
AUC: 0.8712

Epoch 48/80
 - 0s - loss: 0.9363 - val_loss: 0.6556
AUC: 0.8718

Epoch 49/80
 - 0s - loss: 0.9266 - val_loss: 0.5867
AUC: 0.8722

Epoch 50/80
 - 0s - loss: 0.9240 - val_loss: 0.5872
AUC: 0.8707

Epoch 51/80
 - 0s - loss: 0.9288 - val_loss: 0.6288
AUC: 0.8721

Epoch 52/80
 - 0s - loss: 0.9251 - val_loss: 0.5690
AUC: 0.8724

Epoch 53/80
 - 0s - loss: 0.9217 - val_loss: 0.5619
AUC: 0.8712

Epoch 54/80
 - 0s - loss: 0.9236 - val_loss: 0.5300
AUC: 0.8713

Epoch 55/80
 - 0s - loss: 0.9199 - val_loss: 0.6413
AUC: 0.8713

Epoch 56/80
 - 0s - loss: 0.9164 - val_loss: 0.5897
AUC: 0.8724

Epoch 57/80
 - 0s - loss: 0.9083 - val_loss: 0.5632
AUC: 0.8722

Epoch 58/80
 - 0s - loss: 0.9042 - val_loss: 0.5803
AUC: 0.8724

Epoch 59/80
 - 0s - loss: 0.9063 - val_loss: 0.5808
AUC: 0.8720

Epoch 60/80
 - 0s - loss: 0.9042 - val_loss: 0.5990
AUC: 0.8717

Epoch 61/80
 - 0s - loss: 0.8983 - val_loss: 0.5810
AUC: 0.8716

Epoch 62/80
 - 0s - loss: 0.8973 - val_loss: 0.5923
AUC: 0.8720

Epoch 63/80
 - 0s - loss: 0.9018 - val_loss: 0.5756
AUC: 0.8723

Epoch 64/80
 - 0s - loss: 0.9006 - val_loss: 0.5929
AUC: 0.8719

Epoch 65/80
 - 0s - loss: 0.8963 - val_loss: 0.5858
AUC: 0.8714

Epoch 66/80
 - 0s - loss: 0.9005 - val_loss: 0.5881
AUC: 0.8720

Epoch 67/80
 - 0s - loss: 0.8959 - val_loss: 0.5802
AUC: 0.8721

Epoch 68/80
 - 0s - loss: 0.8919 - val_loss: 0.5767
AUC: 0.8719

Epoch 69/80
 - 0s - loss: 0.8924 - val_loss: 0.5701
AUC: 0.8720

Epoch 70/80
 - 0s - loss: 0.8985 - val_loss: 0.5746
AUC: 0.8720

Epoch 71/80
 - 0s - loss: 0.8922 - val_loss: 0.5798
AUC: 0.8720

Epoch 72/80
 - 0s - loss: 0.8977 - val_loss: 0.5718
AUC: 0.8721

Epoch 73/80
 - 0s - loss: 0.8946 - val_loss: 0.5669
AUC: 0.8720

Epoch 74/80
 - 0s - loss: 0.8957 - val_loss: 0.5766
AUC: 0.8720

Epoch 75/80
 - 0s - loss: 0.8919 - val_loss: 0.5747
AUC: 0.8721

Epoch 76/80
 - 0s - loss: 0.8964 - val_loss: 0.5741
AUC: 0.8721

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9030 - val_loss: 0.5765
AUC: 0.8720

Epoch 2/30
 - 0s - loss: 0.9015 - val_loss: 0.5673
AUC: 0.8719

Epoch 3/30
 - 0s - loss: 0.8981 - val_loss: 0.5595
AUC: 0.8721

Epoch 4/30
 - 0s - loss: 0.8951 - val_loss: 0.5998
AUC: 0.8719

Epoch 5/30
 - 0s - loss: 0.8974 - val_loss: 0.5638
AUC: 0.8719

Epoch 6/30
 - 0s - loss: 0.8944 - val_loss: 0.5930
AUC: 0.8721

Epoch 7/30
 - 0s - loss: 0.8932 - val_loss: 0.5795
AUC: 0.8722

Epoch 8/30
 - 0s - loss: 0.8966 - val_loss: 0.5682
AUC: 0.8722

Epoch 9/30
 - 0s - loss: 0.8907 - val_loss: 0.5745
AUC: 0.8722

Epoch 10/30
 - 0s - loss: 0.8868 - val_loss: 0.5852
AUC: 0.8723

Epoch 11/30
 - 0s - loss: 0.8884 - val_loss: 0.5812
AUC: 0.8720

Epoch 12/30
 - 0s - loss: 0.8838 - val_loss: 0.5780
AUC: 0.8724

Epoch 13/30
 - 0s - loss: 0.8850 - val_loss: 0.5533
AUC: 0.8722

Epoch 14/30
 - 0s - loss: 0.8803 - val_loss: 0.5668
AUC: 0.8722

Epoch 15/30
 - 0s - loss: 0.8811 - val_loss: 0.5473
AUC: 0.8723

Epoch 16/30
 - 0s - loss: 0.8794 - val_loss: 0.5759
AUC: 0.8725

Epoch 17/30
 - 0s - loss: 0.8705 - val_loss: 0.5543
AUC: 0.8722

Epoch 18/30
 - 0s - loss: 0.8769 - val_loss: 0.5790
AUC: 0.8725

Epoch 19/30
 - 0s - loss: 0.8746 - val_loss: 0.5529
AUC: 0.8724

Epoch 20/30
 - 0s - loss: 0.8733 - val_loss: 0.5525
AUC: 0.8723

Epoch 21/30
 - 0s - loss: 0.8723 - val_loss: 0.5347
AUC: 0.8723

Epoch 22/30
 - 0s - loss: 0.8706 - val_loss: 0.5822
AUC: 0.8723

Epoch 23/30
 - 0s - loss: 0.8709 - val_loss: 0.5691
AUC: 0.8724

Epoch 24/30
 - 0s - loss: 0.8711 - val_loss: 0.5539
AUC: 0.8722

Epoch 25/30
 - 0s - loss: 0.8678 - val_loss: 0.5618
AUC: 0.8724

Epoch 26/30
 - 0s - loss: 0.8672 - val_loss: 0.5663
AUC: 0.8723

Epoch 27/30
 - 0s - loss: 0.8665 - val_loss: 0.5565
AUC: 0.8725

Epoch 28/30
 - 0s - loss: 0.8681 - val_loss: 0.5849
AUC: 0.8724

Epoch 29/30
 - 0s - loss: 0.8623 - val_loss: 0.5550
AUC: 0.8725

Epoch 30/30
 - 0s - loss: 0.8622 - val_loss: 0.5560
Using TensorFlow backend.
AUC: 0.8725

2019-03-08 07:46:50.511364: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:46:50.677099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:46:50.677145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:46:50.981536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:46:50.981592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:46:50.981602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:46:50.981895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3027
Epoch 2/80
 - 2s - loss: 0.3340
Epoch 3/80
 - 2s - loss: 0.3078
Epoch 4/80
 - 2s - loss: 0.2927
Epoch 5/80
 - 2s - loss: 0.2679
Epoch 6/80
 - 2s - loss: 0.2379
Epoch 7/80
 - 2s - loss: 0.2127
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:47:27.174212: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:47:27.343742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:47:27.343811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:47:27.652662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:47:27.652732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:47:27.652742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:47:27.653063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1226
Epoch 2/80
 - 2s - loss: 0.1974
Epoch 3/80
 - 2s - loss: 0.1660
Epoch 4/80
 - 2s - loss: 0.1524
Epoch 5/80
 - 2s - loss: 0.1383
Epoch 6/80
 - 2s - loss: 0.1262
Epoch 7/80
 - 2s - loss: 0.1158
Epoch 8/80
 - 2s - loss: 0.1065
Epoch 9/80
 - 2s - loss: 0.0981
Epoch 10/80
 - 2s - loss: 0.0904
Epoch 11/80
 - 2s - loss: 0.0834
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:48:07.577402: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:48:07.746458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:48:07.746504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:48:08.051904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:48:08.051961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:48:08.051971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:48:08.052237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0529
Epoch 2/80
 - 2s - loss: 0.1934
Epoch 3/80
 - 2s - loss: 0.1692
Epoch 4/80
 - 2s - loss: 0.1596
Epoch 5/80
 - 2s - loss: 0.1467
Epoch 6/80
 - 2s - loss: 0.1326
Epoch 7/80
 - 2s - loss: 0.1207
Epoch 8/80
 - 2s - loss: 0.1101
Epoch 9/80
 - 2s - loss: 0.1004
Epoch 10/80
 - 2s - loss: 0.0917
Epoch 11/80
 - 2s - loss: 0.0844
Epoch 12/80
 - 2s - loss: 0.0783
Epoch 13/80
 - 2s - loss: 0.0733
Epoch 14/80
 - 2s - loss: 0.0689
Epoch 15/80
 - 2s - loss: 0.0652
Epoch 16/80
 - 2s - loss: 0.0622
Epoch 17/80
 - 2s - loss: 0.0596
Epoch 18/80
 - 2s - loss: 0.0574
Epoch 19/80
 - 2s - loss: 0.0557
Epoch 20/80
 - 2s - loss: 0.0542
Epoch 21/80
 - 2s - loss: 0.0529
Epoch 22/80
 - 2s - loss: 0.0517
Epoch 23/80
 - 2s - loss: 0.0508
Epoch 24/80
 - 2s - loss: 0.0499
Epoch 25/80
 - 2s - loss: 0.0492
Epoch 26/80
 - 2s - loss: 0.0486
Epoch 27/80
 - 2s - loss: 0.0480
Epoch 28/80
 - 2s - loss: 0.0475
Epoch 29/80
 - 2s - loss: 0.0471
Epoch 30/80
 - 2s - loss: 0.0468
Epoch 31/80
 - 2s - loss: 0.0464
Epoch 32/80
 - 2s - loss: 0.0461
Epoch 33/80
 - 2s - loss: 0.0459
Epoch 34/80
 - 2s - loss: 0.0457
Epoch 35/80
 - 2s - loss: 0.0455
Epoch 36/80
 - 2s - loss: 0.0453
Epoch 37/80
 - 2s - loss: 0.0451
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:49:44.621487: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:49:44.785941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:49:44.785986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:49:45.082463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:49:45.082518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:49:45.082527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:49:45.082798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0762
Epoch 2/80
 - 2s - loss: 0.1976
Epoch 3/80
 - 2s - loss: 0.1653
Epoch 4/80
 - 2s - loss: 0.1490
Epoch 5/80
 - 2s - loss: 0.1350
Epoch 6/80
 - 2s - loss: 0.1233
Epoch 7/80
 - 2s - loss: 0.1140
Epoch 8/80
 - 2s - loss: 0.1063
Epoch 9/80
 - 2s - loss: 0.0989
Epoch 10/80
 - 2s - loss: 0.0915
Epoch 11/80
 - 2s - loss: 0.0845
Epoch 12/80
 - 2s - loss: 0.0782
Epoch 13/80
 - 2s - loss: 0.0729
Epoch 14/80
 - 2s - loss: 0.0685
Epoch 15/80
 - 2s - loss: 0.0649
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:50:32.437098: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:50:32.603180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:50:32.603226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:50:32.901454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:50:32.901511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:50:32.901520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:50:32.901786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0693
Epoch 2/80
 - 2s - loss: 0.1941
Epoch 3/80
 - 2s - loss: 0.1648
Epoch 4/80
 - 2s - loss: 0.1515
Epoch 5/80
 - 2s - loss: 0.1399
Epoch 6/80
 - 2s - loss: 0.1292
Epoch 7/80
 - 2s - loss: 0.1188
Epoch 8/80
 - 2s - loss: 0.1091
Epoch 9/80
 - 2s - loss: 0.1001
Epoch 10/80
 - 2s - loss: 0.0918
Epoch 11/80
 - 2s - loss: 0.0845
Epoch 12/80
 - 2s - loss: 0.0784
Epoch 13/80
 - 2s - loss: 0.0733
Epoch 14/80
 - 2s - loss: 0.0690
Epoch 15/80
 - 2s - loss: 0.0655
Epoch 16/80
 - 2s - loss: 0.0625
Epoch 17/80
 - 2s - loss: 0.0601
Epoch 18/80
 - 2s - loss: 0.0580
Epoch 19/80
 - 2s - loss: 0.0562
Epoch 20/80
 - 2s - loss: 0.0547
Epoch 21/80
 - 2s - loss: 0.0534
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:51:36.380559: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:51:36.550136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:51:36.550185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:51:36.850297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:51:36.850354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:51:36.850363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:51:36.850628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6504
Epoch 2/80
 - 2s - loss: 0.1000
Epoch 3/80
 - 2s - loss: 0.0691
Epoch 4/80
 - 2s - loss: 0.0651
Epoch 5/80
 - 2s - loss: 0.0625
Epoch 6/80
 - 2s - loss: 0.0592
Epoch 7/80
 - 2s - loss: 0.0547
Epoch 8/80
 - 2s - loss: 0.0494
Epoch 9/80
 - 2s - loss: 0.0443
Epoch 10/80
 - 2s - loss: 0.0399
Epoch 11/80
 - 2s - loss: 0.0364
Epoch 12/80
 - 2s - loss: 0.0334
Epoch 13/80
 - 2s - loss: 0.0309
Epoch 14/80
 - 2s - loss: 0.0286
Epoch 15/80
 - 2s - loss: 0.0267
Epoch 16/80
 - 2s - loss: 0.0250
Epoch 17/80
 - 2s - loss: 0.0235
Epoch 18/80
 - 2s - loss: 0.0222
Epoch 19/80
 - 2s - loss: 0.0212
Epoch 20/80
 - 2s - loss: 0.0202
Epoch 21/80
 - 2s - loss: 0.0195
Epoch 22/80
 - 2s - loss: 0.0188
Epoch 23/80
 - 2s - loss: 0.0182
Epoch 24/80
 - 2s - loss: 0.0177
Epoch 25/80
 - 2s - loss: 0.0173
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:52:48.461277: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:52:48.633147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:52:48.633192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:52:48.963304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:52:48.963349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:52:48.963359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:52:48.963667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6454
Epoch 2/80
 - 2s - loss: 0.1014
Epoch 3/80
 - 2s - loss: 0.0696
Epoch 4/80
 - 2s - loss: 0.0647
Epoch 5/80
 - 2s - loss: 0.0617
Epoch 6/80
 - 2s - loss: 0.0581
Epoch 7/80
 - 2s - loss: 0.0538
Epoch 8/80
 - 2s - loss: 0.0493
Epoch 9/80
 - 2s - loss: 0.0447
Epoch 10/80
 - 2s - loss: 0.0402
Epoch 11/80
 - 2s - loss: 0.0363
Epoch 12/80
 - 2s - loss: 0.0329
Epoch 13/80
 - 2s - loss: 0.0302
Epoch 14/80
 - 2s - loss: 0.0279
Epoch 15/80
 - 2s - loss: 0.0260
Epoch 16/80
 - 2s - loss: 0.0244
Epoch 17/80
 - 2s - loss: 0.0230
Epoch 18/80
 - 2s - loss: 0.0219
Epoch 19/80
 - 2s - loss: 0.0209
Epoch 20/80
 - 2s - loss: 0.0201
Epoch 21/80
 - 2s - loss: 0.0193
Epoch 22/80
 - 2s - loss: 0.0187
Epoch 23/80
 - 2s - loss: 0.0182
Epoch 24/80
 - 2s - loss: 0.0177
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 07:53:59.097066: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:53:59.264290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:53:59.264336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:53:59.571284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:53:59.571343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:53:59.571353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:53:59.571646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6507
Epoch 2/80
 - 2s - loss: 0.1009
Epoch 3/80
 - 2s - loss: 0.0689
Epoch 4/80
 - 2s - loss: 0.0644
Epoch 5/80
 - 2s - loss: 0.0609
Epoch 6/80
 - 2s - loss: 0.0561
Epoch 7/80
 - 2s - loss: 0.0507
Epoch 8/80
 - 2s - loss: 0.0459
Epoch 9/80
 - 2s - loss: 0.0419
Epoch 10/80
 - 2s - loss: 0.0385
Epoch 11/80
 - 2s - loss: 0.0356
Epoch 12/80
 - 2s - loss: 0.0330
Epoch 13/80
 - 2s - loss: 0.0307
Epoch 14/80
 - 2s - loss: 0.0286
Epoch 15/80
 - 2s - loss: 0.0267
Epoch 16/80
 - 2s - loss: 0.0250
Epoch 17/80
 - 2s - loss: 0.0234
Epoch 18/80
 - 2s - loss: 0.0222
Epoch 19/80
 - 2s - loss: 0.0211
Epoch 20/80
 - 2s - loss: 0.0201
Epoch 21/80
 - 2s - loss: 0.0193
Epoch 22/80
 - 2s - loss: 0.0186
Epoch 23/80
 - 2s - loss: 0.0180
Epoch 24/80
 - 2s - loss: 0.0175
Epoch 25/80
 - 2s - loss: 0.0171
Epoch 26/80
 - 2s - loss: 0.0167
Epoch 27/80
 - 2s - loss: 0.0164
Epoch 28/80
 - 2s - loss: 0.0161
Epoch 29/80
 - 2s - loss: 0.0159
Epoch 30/80
 - 2s - loss: 0.0157
Epoch 31/80
 - 2s - loss: 0.0155
Epoch 32/80
 - 2s - loss: 0.0153
Epoch 33/80
 - 2s - loss: 0.0152
Epoch 34/80
 - 2s - loss: 0.0151
Epoch 35/80
 - 2s - loss: 0.0150
Epoch 36/80
 - 2s - loss: 0.0149
Epoch 37/80
 - 2s - loss: 0.0148
Epoch 38/80
 - 2s - loss: 0.0147
Epoch 39/80
 - 2s - loss: 0.0146
Epoch 40/80
 - 2s - loss: 0.0146
Epoch 41/80
 - 2s - loss: 0.0145
Epoch 42/80
 - 2s - loss: 0.0145
Epoch 43/80
 - 2s - loss: 0.0144
Epoch 44/80
 - 2s - loss: 0.0144
Epoch 45/80
 - 2s - loss: 0.0143
Epoch 46/80
 - 2s - loss: 0.0143
Epoch 47/80
 - 2s - loss: 0.0143
Epoch 48/80
 - 2s - loss: 0.0142
Epoch 49/80
 - 2s - loss: 0.0142
Epoch 50/80
 - 2s - loss: 0.0142
Epoch 51/80
 - 2s - loss: 0.0137
Epoch 52/80
 - 2s - loss: 0.0137
Epoch 53/80
 - 2s - loss: 0.0137
Epoch 54/80
 - 2s - loss: 0.0137
Epoch 55/80
 - 2s - loss: 0.0135
Epoch 56/80
 - 2s - loss: 0.0135
Epoch 57/80
 - 2s - loss: 0.0135
Epoch 58/80
 - 2s - loss: 0.0135
Epoch 59/80
 - 2s - loss: 0.0135
Epoch 60/80
 - 2s - loss: 0.0135
Epoch 61/80
 - 2s - loss: 0.0135
Epoch 62/80
 - 2s - loss: 0.0135
Epoch 63/80
 - 2s - loss: 0.0135
Epoch 64/80
 - 2s - loss: 0.0135
Epoch 65/80
 - 2s - loss: 0.0135
Epoch 66/80
 - 2s - loss: 0.0135
Epoch 67/80
 - 2s - loss: 0.0135
Epoch 68/80
 - 2s - loss: 0.0135
Epoch 69/80
 - 2s - loss: 0.0135
Epoch 70/80
 - 2s - loss: 0.0135
Epoch 71/80
 - 2s - loss: 0.0135
Epoch 72/80
 - 2s - loss: 0.0135
Epoch 73/80
 - 2s - loss: 0.0135
Epoch 74/80
 - 2s - loss: 0.0135
Epoch 75/80
 - 2s - loss: 0.0135
Epoch 76/80
 - 2s - loss: 0.0135
Epoch 77/80
 - 2s - loss: 0.0135
Epoch 78/80
 - 2s - loss: 0.0135
Epoch 79/80
 - 2s - loss: 0.0135
Epoch 80/80
 - 2s - loss: 0.0135
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.6579 - val_loss: 1.3773
AUC: 0.8053

Epoch 2/80
 - 0s - loss: 2.3409 - val_loss: 1.0748
AUC: 0.8343

Epoch 3/80
 - 0s - loss: 1.7042 - val_loss: 0.8042
AUC: 0.8424

Epoch 4/80
 - 0s - loss: 1.3477 - val_loss: 0.6896
AUC: 0.8537

Epoch 5/80
 - 0s - loss: 1.1786 - val_loss: 0.6589
AUC: 0.8571

Epoch 6/80
 - 0s - loss: 1.1334 - val_loss: 0.6828
AUC: 0.8602

Epoch 7/80
 - 0s - loss: 1.0980 - val_loss: 0.6478
AUC: 0.8621

Epoch 8/80
 - 0s - loss: 1.0756 - val_loss: 0.6250
AUC: 0.8641

Epoch 9/80
 - 0s - loss: 1.0548 - val_loss: 0.5641
AUC: 0.8653

Epoch 10/80
 - 0s - loss: 1.0461 - val_loss: 0.6928
AUC: 0.8669

Epoch 11/80
 - 0s - loss: 1.0266 - val_loss: 0.6679
AUC: 0.8687

Epoch 12/80
 - 0s - loss: 1.0235 - val_loss: 0.6114
AUC: 0.8678

Epoch 13/80
 - 0s - loss: 1.0154 - val_loss: 0.6696
AUC: 0.8701

Epoch 14/80
 - 0s - loss: 1.0128 - val_loss: 0.6338
AUC: 0.8707

Epoch 15/80
 - 0s - loss: 1.0054 - val_loss: 0.6128
AUC: 0.8702

Epoch 16/80
 - 0s - loss: 1.0017 - val_loss: 0.6706
AUC: 0.8721

Epoch 17/80
 - 0s - loss: 0.9969 - val_loss: 0.6559
AUC: 0.8722

Epoch 18/80
 - 0s - loss: 0.9924 - val_loss: 0.6174
AUC: 0.8711

Epoch 19/80
 - 0s - loss: 0.9907 - val_loss: 0.5913
AUC: 0.8721

Epoch 20/80
 - 0s - loss: 0.9773 - val_loss: 0.5861
AUC: 0.8726

Epoch 21/80
 - 0s - loss: 0.9753 - val_loss: 0.5815
AUC: 0.8726

Epoch 22/80
 - 0s - loss: 0.9755 - val_loss: 0.5966
AUC: 0.8732

Epoch 23/80
 - 0s - loss: 0.9718 - val_loss: 0.6242
AUC: 0.8736

Epoch 24/80
 - 0s - loss: 0.9732 - val_loss: 0.6099
AUC: 0.8738

Epoch 25/80
 - 0s - loss: 0.9690 - val_loss: 0.5615
AUC: 0.8728

Epoch 26/80
 - 0s - loss: 0.9705 - val_loss: 0.6072
AUC: 0.8738

Epoch 27/80
 - 0s - loss: 0.9678 - val_loss: 0.6076
AUC: 0.8738

Epoch 28/80
 - 0s - loss: 0.9651 - val_loss: 0.5720
AUC: 0.8734

Epoch 29/80
 - 0s - loss: 0.9671 - val_loss: 0.6652
AUC: 0.8740

Epoch 30/80
 - 0s - loss: 0.9712 - val_loss: 0.6044
AUC: 0.8737

Epoch 31/80
 - 0s - loss: 0.9710 - val_loss: 0.6329
AUC: 0.8744

Epoch 32/80
 - 0s - loss: 0.9644 - val_loss: 0.6046
AUC: 0.8740

Epoch 33/80
 - 0s - loss: 0.9693 - val_loss: 0.5607
AUC: 0.8733

Epoch 34/80
 - 0s - loss: 0.9636 - val_loss: 0.5999
AUC: 0.8742

Epoch 35/80
 - 0s - loss: 0.9568 - val_loss: 0.5753
AUC: 0.8734

Epoch 36/80
 - 0s - loss: 0.9629 - val_loss: 0.5933
AUC: 0.8737

Epoch 37/80
 - 0s - loss: 0.9636 - val_loss: 0.6121
AUC: 0.8740

Epoch 38/80
 - 0s - loss: 0.9643 - val_loss: 0.5625
AUC: 0.8734

Epoch 39/80
 - 0s - loss: 0.9629 - val_loss: 0.5900
AUC: 0.8740

Epoch 40/80
 - 0s - loss: 0.9619 - val_loss: 0.6318
AUC: 0.8745

Epoch 41/80
 - 0s - loss: 0.9626 - val_loss: 0.5764
AUC: 0.8737

Epoch 42/80
 - 0s - loss: 0.9627 - val_loss: 0.5711
AUC: 0.8739

Epoch 43/80
 - 0s - loss: 0.9605 - val_loss: 0.5845
AUC: 0.8742

Epoch 44/80
 - 0s - loss: 0.9539 - val_loss: 0.5801
AUC: 0.8741

Epoch 45/80
 - 0s - loss: 0.9516 - val_loss: 0.5965
AUC: 0.8743

Epoch 46/80
 - 0s - loss: 0.9525 - val_loss: 0.5859
AUC: 0.8741

Epoch 47/80
 - 0s - loss: 0.9547 - val_loss: 0.5925
AUC: 0.8742

Epoch 48/80
 - 0s - loss: 0.9567 - val_loss: 0.6021
AUC: 0.8744

Epoch 49/80
 - 0s - loss: 0.9545 - val_loss: 0.5826
AUC: 0.8742

Epoch 50/80
 - 0s - loss: 0.9545 - val_loss: 0.5938
AUC: 0.8743

Epoch 51/80
 - 0s - loss: 0.9528 - val_loss: 0.5982
AUC: 0.8743

Epoch 52/80
 - 0s - loss: 0.9573 - val_loss: 0.5990
AUC: 0.8743

Epoch 53/80
 - 0s - loss: 0.9555 - val_loss: 0.5965
AUC: 0.8742

Epoch 54/80
 - 0s - loss: 0.9550 - val_loss: 0.5913
AUC: 0.8742

Epoch 55/80
 - 0s - loss: 0.9490 - val_loss: 0.5862
AUC: 0.8741

Epoch 56/80
 - 0s - loss: 0.9536 - val_loss: 0.5863
AUC: 0.8741

Epoch 57/80
 - 0s - loss: 0.9514 - val_loss: 0.5865
AUC: 0.8741

Epoch 58/80
 - 0s - loss: 0.9506 - val_loss: 0.5861
AUC: 0.8741

Epoch 59/80
 - 0s - loss: 0.9547 - val_loss: 0.5876
AUC: 0.8741

Epoch 60/80
 - 0s - loss: 0.9502 - val_loss: 0.5870
AUC: 0.8741

Epoch 61/80
 - 0s - loss: 0.9497 - val_loss: 0.5862
AUC: 0.8741

Epoch 62/80
 - 0s - loss: 0.9513 - val_loss: 0.5868
AUC: 0.8741

Epoch 63/80
 - 0s - loss: 0.9509 - val_loss: 0.5874
AUC: 0.8742

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9619 - val_loss: 0.5960
AUC: 0.8743

Epoch 2/30
 - 0s - loss: 0.9545 - val_loss: 0.5774
AUC: 0.8740

Epoch 3/30
 - 0s - loss: 0.9541 - val_loss: 0.5875
AUC: 0.8745

Epoch 4/30
 - 0s - loss: 0.9489 - val_loss: 0.5752
AUC: 0.8744

Epoch 5/30
 - 0s - loss: 0.9514 - val_loss: 0.5612
AUC: 0.8744

Epoch 6/30
 - 0s - loss: 0.9525 - val_loss: 0.5838
AUC: 0.8748

Epoch 7/30
 - 0s - loss: 0.9488 - val_loss: 0.6075
AUC: 0.8753

Epoch 8/30
 - 0s - loss: 0.9428 - val_loss: 0.5528
AUC: 0.8746

Epoch 9/30
 - 0s - loss: 0.9391 - val_loss: 0.5666
AUC: 0.8750

Epoch 10/30
 - 0s - loss: 0.9488 - val_loss: 0.5750
AUC: 0.8751

Epoch 11/30
 - 0s - loss: 0.9426 - val_loss: 0.5882
AUC: 0.8755

Epoch 12/30
 - 0s - loss: 0.9403 - val_loss: 0.5815
AUC: 0.8753

Epoch 13/30
 - 0s - loss: 0.9371 - val_loss: 0.5719
AUC: 0.8753

Epoch 14/30
 - 0s - loss: 0.9366 - val_loss: 0.5689
AUC: 0.8754

Epoch 15/30
 - 0s - loss: 0.9375 - val_loss: 0.5829
AUC: 0.8757

Epoch 16/30
 - 0s - loss: 0.9346 - val_loss: 0.5846
AUC: 0.8760

Epoch 17/30
 - 0s - loss: 0.9329 - val_loss: 0.5537
AUC: 0.8755

Epoch 18/30
 - 0s - loss: 0.9325 - val_loss: 0.5656
AUC: 0.8759

Epoch 19/30
 - 0s - loss: 0.9300 - val_loss: 0.5703
AUC: 0.8760

Epoch 20/30
 - 0s - loss: 0.9274 - val_loss: 0.5784
AUC: 0.8761

Epoch 21/30
 - 0s - loss: 0.9305 - val_loss: 0.5773
AUC: 0.8761

Epoch 22/30
 - 0s - loss: 0.9306 - val_loss: 0.5784
AUC: 0.8761

Epoch 23/30
 - 0s - loss: 0.9297 - val_loss: 0.5823
AUC: 0.8761

Epoch 24/30
 - 0s - loss: 0.9318 - val_loss: 0.5815
AUC: 0.8762

Epoch 25/30
 - 0s - loss: 0.9281 - val_loss: 0.5754
AUC: 0.8761

Epoch 26/30
 - 0s - loss: 0.9308 - val_loss: 0.5786
AUC: 0.8761

Epoch 27/30
 - 0s - loss: 0.9252 - val_loss: 0.5738
AUC: 0.8761

Epoch 28/30
 - 0s - loss: 0.9270 - val_loss: 0.5681
AUC: 0.8760

Epoch 29/30
 - 0s - loss: 0.9329 - val_loss: 0.5713
AUC: 0.8760

Epoch 30/30
 - 0s - loss: 0.9240 - val_loss: 0.5739
Using TensorFlow backend.
AUC: 0.8761

2019-03-08 07:57:58.899507: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 07:57:59.063955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 07:57:59.064001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 07:57:59.362632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 07:57:59.362691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 07:57:59.362701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 07:57:59.362975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3105
Epoch 2/80
 - 2s - loss: 0.3333
Epoch 3/80
 - 2s - loss: 0.3041
Epoch 4/80
 - 2s - loss: 0.2836
Epoch 5/80
 - 2s - loss: 0.2569
Epoch 6/80
 - 2s - loss: 0.2319
Epoch 7/80
 - 2s - loss: 0.2092
Epoch 8/80
 - 2s - loss: 0.1894
Epoch 9/80
 - 2s - loss: 0.1743
Epoch 10/80
 - 2s - loss: 0.1629
Epoch 11/80
 - 2s - loss: 0.1538
Epoch 12/80
 - 2s - loss: 0.1461
Epoch 13/80
 - 2s - loss: 0.1396
Epoch 14/80
 - 2s - loss: 0.1341
Epoch 15/80
 - 2s - loss: 0.1295
Epoch 16/80
 - 2s - loss: 0.1257
Epoch 17/80
 - 2s - loss: 0.1226
Epoch 18/80
 - 2s - loss: 0.1198
Epoch 19/80
 - 2s - loss: 0.1175
Epoch 20/80
 - 2s - loss: 0.1155
Epoch 21/80
 - 2s - loss: 0.1137
Epoch 22/80
 - 2s - loss: 0.1122
Epoch 23/80
 - 2s - loss: 0.1110
Epoch 24/80
 - 2s - loss: 0.1099
Epoch 25/80
 - 2s - loss: 0.1089
Epoch 26/80
 - 2s - loss: 0.1081
Epoch 27/80
 - 2s - loss: 0.1074
Epoch 28/80
 - 2s - loss: 0.1067
Epoch 29/80
 - 2s - loss: 0.1062
Epoch 30/80
 - 2s - loss: 0.1057
Epoch 31/80
 - 2s - loss: 0.1053
Epoch 32/80
 - 2s - loss: 0.1049
Epoch 33/80
 - 2s - loss: 0.1046
Epoch 34/80
 - 2s - loss: 0.1043
Epoch 35/80
 - 2s - loss: 0.1040
Epoch 36/80
 - 2s - loss: 0.1038
Epoch 37/80
 - 2s - loss: 0.1035
Epoch 38/80
 - 2s - loss: 0.1034
Epoch 39/80
 - 2s - loss: 0.1032
Epoch 40/80
 - 2s - loss: 0.1030
Epoch 41/80
 - 2s - loss: 0.1028
Epoch 42/80
 - 2s - loss: 0.1027
Epoch 43/80
 - 2s - loss: 0.1026
Epoch 44/80
 - 2s - loss: 0.1024
Epoch 45/80
 - 2s - loss: 0.1023
Epoch 46/80
 - 2s - loss: 0.1022
Epoch 47/80
 - 2s - loss: 0.1021
Epoch 48/80
 - 2s - loss: 0.1020
Epoch 49/80
 - 2s - loss: 0.1019
Epoch 50/80
 - 2s - loss: 0.1019
Epoch 51/80
 - 2s - loss: 0.1018
Epoch 52/80
 - 2s - loss: 0.1017
Epoch 53/80
 - 2s - loss: 0.1017
Epoch 54/80
 - 2s - loss: 0.1016
Epoch 55/80
 - 2s - loss: 0.1015
Epoch 56/80
 - 2s - loss: 0.1015
Epoch 57/80
 - 2s - loss: 0.1014
Epoch 58/80
 - 2s - loss: 0.1014
Epoch 59/80
 - 2s - loss: 0.1013
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:00:11.563976: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:00:11.733547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:00:11.733592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:00:12.033612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:00:12.033663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:00:12.033672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:00:12.033951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2869
Epoch 2/80
 - 2s - loss: 0.3312
Epoch 3/80
 - 2s - loss: 0.2907
Epoch 4/80
 - 2s - loss: 0.2596
Epoch 5/80
 - 2s - loss: 0.2361
Epoch 6/80
 - 2s - loss: 0.2183
Epoch 7/80
 - 2s - loss: 0.2024
Epoch 8/80
 - 2s - loss: 0.1879
Epoch 9/80
 - 2s - loss: 0.1752
Epoch 10/80
 - 2s - loss: 0.1644
Epoch 11/80
 - 2s - loss: 0.1552
Epoch 12/80
 - 2s - loss: 0.1474
Epoch 13/80
 - 2s - loss: 0.1406
Epoch 14/80
 - 2s - loss: 0.1349
Epoch 15/80
 - 2s - loss: 0.1303
Epoch 16/80
 - 2s - loss: 0.1265
Epoch 17/80
 - 2s - loss: 0.1233
Epoch 18/80
 - 2s - loss: 0.1206
Epoch 19/80
 - 2s - loss: 0.1182
Epoch 20/80
 - 2s - loss: 0.1161
Epoch 21/80
 - 2s - loss: 0.1144
Epoch 22/80
 - 2s - loss: 0.1128
Epoch 23/80
 - 2s - loss: 0.1114
Epoch 24/80
 - 2s - loss: 0.1102
Epoch 25/80
 - 2s - loss: 0.1092
Epoch 26/80
 - 2s - loss: 0.1083
Epoch 27/80
 - 2s - loss: 0.1076
Epoch 28/80
 - 2s - loss: 0.1069
Epoch 29/80
 - 2s - loss: 0.1063
Epoch 30/80
 - 2s - loss: 0.1058
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2b640b6ae198>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 08:01:32.135251: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:01:32.306450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:01:32.306495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:01:32.603253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:01:32.603309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:01:32.603319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:01:32.603578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2992
Epoch 2/80
 - 2s - loss: 0.3326
Epoch 3/80
 - 2s - loss: 0.3005
Epoch 4/80
 - 2s - loss: 0.2787
Epoch 5/80
 - 2s - loss: 0.2526
Epoch 6/80
 - 2s - loss: 0.2285
Epoch 7/80
 - 2s - loss: 0.2081
Epoch 8/80
 - 2s - loss: 0.1911
Epoch 9/80
 - 2s - loss: 0.1769
Epoch 10/80
 - 2s - loss: 0.1651
Epoch 11/80
 - 2s - loss: 0.1556
Epoch 12/80
 - 2s - loss: 0.1476
Epoch 13/80
 - 2s - loss: 0.1410
Epoch 14/80
 - 2s - loss: 0.1355
Epoch 15/80
 - 2s - loss: 0.1309
Epoch 16/80
 - 2s - loss: 0.1271
Epoch 17/80
 - 2s - loss: 0.1239
Epoch 18/80
 - 2s - loss: 0.1210
Epoch 19/80
 - 2s - loss: 0.1185
Epoch 20/80
 - 2s - loss: 0.1163
Epoch 21/80
 - 2s - loss: 0.1143
Epoch 22/80
 - 2s - loss: 0.1126
Epoch 23/80
 - 2s - loss: 0.1112
Epoch 24/80
 - 2s - loss: 0.1099
Epoch 25/80
 - 2s - loss: 0.1089
Epoch 26/80
 - 2s - loss: 0.1080
Epoch 27/80
 - 2s - loss: 0.1073
Epoch 28/80
 - 2s - loss: 0.1066
Epoch 29/80
 - 2s - loss: 0.1060
Epoch 30/80
 - 2s - loss: 0.1055
Epoch 31/80
 - 2s - loss: 0.1051
Epoch 32/80
 - 2s - loss: 0.1047
Epoch 33/80
 - 2s - loss: 0.1044
Epoch 34/80
 - 2s - loss: 0.1041
Epoch 35/80
 - 2s - loss: 0.1039
Epoch 36/80
 - 2s - loss: 0.1037
Epoch 37/80
 - 2s - loss: 0.1034
Epoch 38/80
 - 2s - loss: 0.1033
Epoch 39/80
 - 2s - loss: 0.1031
Epoch 40/80
 - 2s - loss: 0.1029
Epoch 41/80
 - 2s - loss: 0.1028
Epoch 42/80
 - 2s - loss: 0.1027
Epoch 43/80
 - 2s - loss: 0.1026
Epoch 44/80
 - 2s - loss: 0.1024
Epoch 45/80
 - 2s - loss: 0.1024
Epoch 46/80
 - 2s - loss: 0.1022
Epoch 47/80
 - 2s - loss: 0.1022
Epoch 48/80
 - 2s - loss: 0.1021
Epoch 49/80
 - 2s - loss: 0.1020
Epoch 50/80
 - 2s - loss: 0.1019
Epoch 51/80
 - 2s - loss: 0.1019
Epoch 52/80
 - 2s - loss: 0.1018
Epoch 53/80
 - 2s - loss: 0.1018
Epoch 54/80
 - 2s - loss: 0.1017
Epoch 55/80
 - 2s - loss: 0.1017
Epoch 56/80
 - 2s - loss: 0.1016
Epoch 57/80
 - 2s - loss: 0.1016
Epoch 58/80
 - 2s - loss: 0.1015
Epoch 59/80
 - 2s - loss: 0.1015
Epoch 60/80
 - 2s - loss: 0.1015
Epoch 61/80
 - 2s - loss: 0.1014
Epoch 62/80
 - 2s - loss: 0.1014
Epoch 63/80
 - 2s - loss: 0.1013
Epoch 64/80
 - 2s - loss: 0.1013
Epoch 65/80
 - 2s - loss: 0.0986
Epoch 66/80
 - 2s - loss: 0.0984
Epoch 67/80
 - 2s - loss: 0.0983
Epoch 68/80
 - 2s - loss: 0.0983
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:04:06.279490: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:04:06.448683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:04:06.448729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:04:06.750428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:04:06.750483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:04:06.750493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:04:06.750763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0678
Epoch 2/80
 - 2s - loss: 0.1937
Epoch 3/80
 - 2s - loss: 0.1660
Epoch 4/80
 - 2s - loss: 0.1530
Epoch 5/80
 - 2s - loss: 0.1405
Epoch 6/80
 - 2s - loss: 0.1296
Epoch 7/80
 - 2s - loss: 0.1191
Epoch 8/80
 - 2s - loss: 0.1084
Epoch 9/80
 - 2s - loss: 0.0987
Epoch 10/80
 - 2s - loss: 0.0904
Epoch 11/80
 - 2s - loss: 0.0835
Epoch 12/80
 - 2s - loss: 0.0778
Epoch 13/80
 - 2s - loss: 0.0730
Epoch 14/80
 - 2s - loss: 0.0689
Epoch 15/80
 - 2s - loss: 0.0652
Epoch 16/80
 - 2s - loss: 0.0622
Epoch 17/80
 - 2s - loss: 0.0595
Epoch 18/80
 - 2s - loss: 0.0573
Epoch 19/80
 - 2s - loss: 0.0554
Epoch 20/80
 - 2s - loss: 0.0538
Epoch 21/80
 - 2s - loss: 0.0525
Epoch 22/80
 - 2s - loss: 0.0513
Epoch 23/80
 - 2s - loss: 0.0504
Epoch 24/80
 - 2s - loss: 0.0495
Epoch 25/80
 - 2s - loss: 0.0488
Epoch 26/80
 - 2s - loss: 0.0482
Epoch 27/80
 - 2s - loss: 0.0477
Epoch 28/80
 - 2s - loss: 0.0472
Epoch 29/80
 - 2s - loss: 0.0468
Epoch 30/80
 - 2s - loss: 0.0465
Epoch 31/80
 - 2s - loss: 0.0462
Epoch 32/80
 - 2s - loss: 0.0459
Epoch 33/80
 - 2s - loss: 0.0457
Epoch 34/80
 - 2s - loss: 0.0455
Epoch 35/80
 - 2s - loss: 0.0453
Epoch 36/80
 - 2s - loss: 0.0451
Epoch 37/80
 - 2s - loss: 0.0449
Epoch 38/80
 - 2s - loss: 0.0448
Epoch 39/80
 - 2s - loss: 0.0447
Epoch 40/80
 - 2s - loss: 0.0446
Epoch 41/80
 - 2s - loss: 0.0445
Epoch 42/80
 - 2s - loss: 0.0444
Epoch 43/80
 - 2s - loss: 0.0443
Epoch 44/80
 - 2s - loss: 0.0442
Epoch 45/80
 - 2s - loss: 0.0441
Epoch 46/80
 - 2s - loss: 0.0441
Epoch 47/80
 - 2s - loss: 0.0440
Epoch 48/80
 - 2s - loss: 0.0439
Epoch 49/80
 - 2s - loss: 0.0439
Epoch 50/80
 - 2s - loss: 0.0438
Epoch 51/80
 - 2s - loss: 0.0438
Epoch 52/80
 - 2s - loss: 0.0437
Epoch 53/80
 - 2s - loss: 0.0437
Epoch 54/80
 - 2s - loss: 0.0437
Epoch 55/80
 - 2s - loss: 0.0436
Epoch 56/80
 - 2s - loss: 0.0436
Epoch 57/80
 - 2s - loss: 0.0435
Epoch 58/80
 - 2s - loss: 0.0435
Epoch 59/80
 - 2s - loss: 0.0423
Epoch 60/80
 - 2s - loss: 0.0421
Epoch 61/80
 - 2s - loss: 0.0421
Epoch 62/80
 - 2s - loss: 0.0421
Epoch 63/80
 - 2s - loss: 0.0421
Epoch 64/80
 - 2s - loss: 0.0418
Epoch 65/80
 - 2s - loss: 0.0418
Epoch 66/80
 - 2s - loss: 0.0418
Epoch 67/80
 - 2s - loss: 0.0418
Epoch 68/80
 - 2s - loss: 0.0417
Epoch 69/80
 - 2s - loss: 0.0417
Epoch 70/80
 - 2s - loss: 0.0417
Epoch 71/80
 - 2s - loss: 0.0417
Epoch 72/80
 - 2s - loss: 0.0417
Epoch 73/80
 - 2s - loss: 0.0417
Epoch 74/80
 - 2s - loss: 0.0417
Epoch 75/80
 - 2s - loss: 0.0417
Epoch 76/80
 - 2s - loss: 0.0417
Epoch 77/80
 - 2s - loss: 0.0417
Epoch 78/80
 - 2s - loss: 0.0417
Epoch 79/80
 - 2s - loss: 0.0417
Epoch 80/80
 - 2s - loss: 0.0417
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.3612 - val_loss: 0.9769
AUC: 0.8034

Epoch 2/80
 - 0s - loss: 2.2331 - val_loss: 1.0967
AUC: 0.8376

Epoch 3/80
 - 0s - loss: 1.5963 - val_loss: 0.8422
AUC: 0.8468

Epoch 4/80
 - 0s - loss: 1.3026 - val_loss: 0.7691
AUC: 0.8505

Epoch 5/80
 - 0s - loss: 1.1897 - val_loss: 0.6933
AUC: 0.8550

Epoch 6/80
 - 0s - loss: 1.1346 - val_loss: 0.6913
AUC: 0.8571

Epoch 7/80
 - 0s - loss: 1.1047 - val_loss: 0.6766
AUC: 0.8594

Epoch 8/80
 - 0s - loss: 1.0797 - val_loss: 0.6578
AUC: 0.8600

Epoch 9/80
 - 0s - loss: 1.0809 - val_loss: 0.7198
AUC: 0.8626

Epoch 10/80
 - 0s - loss: 1.0666 - val_loss: 0.6694
AUC: 0.8623

Epoch 11/80
 - 0s - loss: 1.0555 - val_loss: 0.6148
AUC: 0.8641

Epoch 12/80
 - 0s - loss: 1.0427 - val_loss: 0.6219
AUC: 0.8645

Epoch 13/80
 - 0s - loss: 1.0370 - val_loss: 0.6822
AUC: 0.8674

Epoch 14/80
 - 0s - loss: 1.0340 - val_loss: 0.6542
AUC: 0.8662

Epoch 15/80
 - 0s - loss: 1.0375 - val_loss: 0.6128
AUC: 0.8680

Epoch 16/80
 - 0s - loss: 1.0148 - val_loss: 0.6273
AUC: 0.8667

Epoch 17/80
 - 0s - loss: 1.0256 - val_loss: 0.7369
AUC: 0.8698

Epoch 18/80
 - 0s - loss: 1.0198 - val_loss: 0.5436
AUC: 0.8676

Epoch 19/80
 - 0s - loss: 1.0057 - val_loss: 0.6519
AUC: 0.8700

Epoch 20/80
 - 0s - loss: 1.0051 - val_loss: 0.6503
AUC: 0.8710

Epoch 21/80
 - 0s - loss: 1.0078 - val_loss: 0.5935
AUC: 0.8692

Epoch 22/80
 - 0s - loss: 0.9935 - val_loss: 0.6218
AUC: 0.8715

Epoch 23/80
 - 0s - loss: 1.0007 - val_loss: 0.6104
AUC: 0.8715

Epoch 24/80
 - 0s - loss: 0.9921 - val_loss: 0.6136
AUC: 0.8707

Epoch 25/80
 - 0s - loss: 0.9886 - val_loss: 0.6482
AUC: 0.8725

Epoch 26/80
 - 0s - loss: 0.9903 - val_loss: 0.6275
AUC: 0.8730

Epoch 27/80
 - 0s - loss: 0.9866 - val_loss: 0.6360
AUC: 0.8715

Epoch 28/80
 - 0s - loss: 0.9802 - val_loss: 0.5911
AUC: 0.8727

Epoch 29/80
 - 0s - loss: 0.9774 - val_loss: 0.5935
AUC: 0.8733

Epoch 30/80
 - 0s - loss: 0.9640 - val_loss: 0.6019
AUC: 0.8732

Epoch 31/80
 - 0s - loss: 0.9577 - val_loss: 0.6112
AUC: 0.8735

Epoch 32/80
 - 0s - loss: 0.9620 - val_loss: 0.5788
AUC: 0.8729

Epoch 33/80
 - 0s - loss: 0.9589 - val_loss: 0.5732
AUC: 0.8731

Epoch 34/80
 - 0s - loss: 0.9616 - val_loss: 0.5908
AUC: 0.8739

Epoch 35/80
 - 0s - loss: 0.9614 - val_loss: 0.5921
AUC: 0.8729

Epoch 36/80
 - 0s - loss: 0.9559 - val_loss: 0.6112
AUC: 0.8734

Epoch 37/80
 - 0s - loss: 0.9606 - val_loss: 0.5996
AUC: 0.8732

Epoch 38/80
 - 0s - loss: 0.9656 - val_loss: 0.6019
AUC: 0.8738

Epoch 39/80
 - 0s - loss: 0.9545 - val_loss: 0.6083
AUC: 0.8738

Epoch 40/80
 - 0s - loss: 0.9614 - val_loss: 0.6165
AUC: 0.8740

Epoch 41/80
 - 0s - loss: 0.9577 - val_loss: 0.6019
AUC: 0.8737

Epoch 42/80
 - 0s - loss: 0.9557 - val_loss: 0.5909
AUC: 0.8736

Epoch 43/80
 - 0s - loss: 0.9521 - val_loss: 0.5981
AUC: 0.8736

Epoch 44/80
 - 0s - loss: 0.9584 - val_loss: 0.5956
AUC: 0.8736

Epoch 45/80
 - 0s - loss: 0.9556 - val_loss: 0.5934
AUC: 0.8736

Epoch 46/80
 - 0s - loss: 0.9537 - val_loss: 0.6055
AUC: 0.8738

Epoch 47/80
 - 0s - loss: 0.9572 - val_loss: 0.5981
AUC: 0.8737

Epoch 48/80
 - 0s - loss: 0.9568 - val_loss: 0.5970
AUC: 0.8736

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9593 - val_loss: 0.5830
AUC: 0.8736

Epoch 2/30
 - 0s - loss: 0.9535 - val_loss: 0.5860
AUC: 0.8736

Epoch 3/30
 - 0s - loss: 0.9528 - val_loss: 0.5777
AUC: 0.8738

Epoch 4/30
 - 0s - loss: 0.9533 - val_loss: 0.6183
AUC: 0.8745

Epoch 5/30
 - 0s - loss: 0.9510 - val_loss: 0.6198
AUC: 0.8744

Epoch 6/30
 - 0s - loss: 0.9455 - val_loss: 0.5794
AUC: 0.8739

Epoch 7/30
 - 0s - loss: 0.9480 - val_loss: 0.6048
AUC: 0.8746

Epoch 8/30
 - 0s - loss: 0.9475 - val_loss: 0.5879
AUC: 0.8743

Epoch 9/30
 - 0s - loss: 0.9441 - val_loss: 0.6137
AUC: 0.8747

Epoch 10/30
 - 0s - loss: 0.9401 - val_loss: 0.6022
AUC: 0.8746

Epoch 11/30
 - 0s - loss: 0.9412 - val_loss: 0.5973
AUC: 0.8748

Epoch 12/30
 - 0s - loss: 0.9409 - val_loss: 0.5927
AUC: 0.8748

Epoch 13/30
 - 0s - loss: 0.9381 - val_loss: 0.6139
AUC: 0.8747

Epoch 14/30
 - 0s - loss: 0.9370 - val_loss: 0.5956
AUC: 0.8745

Epoch 15/30
 - 0s - loss: 0.9308 - val_loss: 0.5868
AUC: 0.8745

Epoch 16/30
 - 0s - loss: 0.9372 - val_loss: 0.5852
AUC: 0.8745

Epoch 17/30
 - 0s - loss: 0.9329 - val_loss: 0.5987
AUC: 0.8746

Epoch 18/30
 - 0s - loss: 0.9360 - val_loss: 0.5928
AUC: 0.8746

Epoch 19/30
 - 0s - loss: 0.9312 - val_loss: 0.5975
AUC: 0.8747

Epoch 20/30
 - 0s - loss: 0.9325 - val_loss: 0.5901
AUC: 0.8746

Epoch 21/30
 - 0s - loss: 0.9365 - val_loss: 0.5885
AUC: 0.8745

Epoch 22/30
 - 0s - loss: 0.9316 - val_loss: 0.5968
AUC: 0.8747

Epoch 23/30
 - 0s - loss: 0.9318 - val_loss: 0.5897
AUC: 0.8747

Epoch 24/30
 - 0s - loss: 0.9324 - val_loss: 0.5909
AUC: 0.8747

Epoch 25/30
 - 0s - loss: 0.9302 - val_loss: 0.5893
AUC: 0.8747

Epoch 26/30
 - 0s - loss: 0.9305 - val_loss: 0.5902
AUC: 0.8747

Epoch 27/30
 - 0s - loss: 0.9324 - val_loss: 0.5902
AUC: 0.8747

Epoch 28/30
 - 0s - loss: 0.9298 - val_loss: 0.5894
AUC: 0.8747

Epoch 29/30
 - 0s - loss: 0.9295 - val_loss: 0.5889
AUC: 0.8747

Epoch 30/30
 - 0s - loss: 0.9275 - val_loss: 0.5884
Using TensorFlow backend.
AUC: 0.8747

2019-03-08 08:08:00.569931: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:08:00.738649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:08:00.738695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:08:01.041398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:08:01.041433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:08:01.041442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:08:01.041722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0654
Epoch 2/80
 - 2s - loss: 0.1953
Epoch 3/80
 - 2s - loss: 0.1688
Epoch 4/80
 - 2s - loss: 0.1578
Epoch 5/80
 - 2s - loss: 0.1436
Epoch 6/80
 - 2s - loss: 0.1290
Epoch 7/80
 - 2s - loss: 0.1169
Epoch 8/80
 - 2s - loss: 0.1070
Epoch 9/80
 - 2s - loss: 0.0982
Epoch 10/80
 - 2s - loss: 0.0905
Epoch 11/80
 - 2s - loss: 0.0837
Epoch 12/80
 - 2s - loss: 0.0780
Epoch 13/80
 - 2s - loss: 0.0731
Epoch 14/80
 - 2s - loss: 0.0689
Epoch 15/80
 - 2s - loss: 0.0654
Epoch 16/80
 - 2s - loss: 0.0624
Epoch 17/80
 - 2s - loss: 0.0598
Epoch 18/80
 - 2s - loss: 0.0577
Epoch 19/80
 - 2s - loss: 0.0558
Epoch 20/80
 - 2s - loss: 0.0542
Epoch 21/80
 - 2s - loss: 0.0528
Epoch 22/80
 - 2s - loss: 0.0516
Epoch 23/80
 - 2s - loss: 0.0506
Epoch 24/80
 - 2s - loss: 0.0498
Epoch 25/80
 - 2s - loss: 0.0490
Epoch 26/80
 - 2s - loss: 0.0484
Epoch 27/80
 - 2s - loss: 0.0478
Epoch 28/80
 - 2s - loss: 0.0473
Epoch 29/80
 - 2s - loss: 0.0469
Epoch 30/80
 - 2s - loss: 0.0466
Epoch 31/80
 - 2s - loss: 0.0463
Epoch 32/80
 - 2s - loss: 0.0460
Epoch 33/80
 - 2s - loss: 0.0458
Epoch 34/80
 - 2s - loss: 0.0456
Epoch 35/80
 - 2s - loss: 0.0454
Epoch 36/80
 - 2s - loss: 0.0452
Epoch 37/80
 - 2s - loss: 0.0451
Epoch 38/80
 - 2s - loss: 0.0449
Epoch 39/80
 - 2s - loss: 0.0448
Epoch 40/80
 - 2s - loss: 0.0447
Epoch 41/80
 - 2s - loss: 0.0446
Epoch 42/80
 - 2s - loss: 0.0445
Epoch 43/80
 - 2s - loss: 0.0444
Epoch 44/80
 - 2s - loss: 0.0443
Epoch 45/80
 - 2s - loss: 0.0442
Epoch 46/80
 - 2s - loss: 0.0441
Epoch 47/80
 - 2s - loss: 0.0441
Epoch 48/80
 - 2s - loss: 0.0440
Epoch 49/80
 - 2s - loss: 0.0440
Epoch 50/80
 - 2s - loss: 0.0439
Epoch 51/80
 - 2s - loss: 0.0439
Epoch 52/80
 - 2s - loss: 0.0438
Epoch 53/80
 - 2s - loss: 0.0438
Epoch 54/80
 - 2s - loss: 0.0437
Epoch 55/80
 - 2s - loss: 0.0437
Epoch 56/80
 - 2s - loss: 0.0436
Epoch 57/80
 - 2s - loss: 0.0436
Epoch 58/80
 - 2s - loss: 0.0436
Epoch 59/80
 - 2s - loss: 0.0436
Epoch 60/80
 - 2s - loss: 0.0423
Epoch 61/80
 - 2s - loss: 0.0422
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:10:17.400379: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:10:17.564706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:10:17.564759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:10:17.864828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:10:17.864885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:10:17.864896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:10:17.865207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0841
Epoch 2/80
 - 2s - loss: 0.1946
Epoch 3/80
 - 2s - loss: 0.1660
Epoch 4/80
 - 2s - loss: 0.1522
Epoch 5/80
 - 2s - loss: 0.1378
Epoch 6/80
 - 2s - loss: 0.1260
Epoch 7/80
 - 2s - loss: 0.1160
Epoch 8/80
 - 2s - loss: 0.1066
Epoch 9/80
 - 2s - loss: 0.0979
Epoch 10/80
 - 2s - loss: 0.0903
Epoch 11/80
 - 2s - loss: 0.0838
Epoch 12/80
 - 2s - loss: 0.0781
Epoch 13/80
 - 2s - loss: 0.0730
Epoch 14/80
 - 2s - loss: 0.0687
Epoch 15/80
 - 2s - loss: 0.0649
Epoch 16/80
 - 2s - loss: 0.0618
Epoch 17/80
 - 2s - loss: 0.0593
Epoch 18/80
 - 2s - loss: 0.0571
Epoch 19/80
 - 2s - loss: 0.0554
Epoch 20/80
 - 2s - loss: 0.0539
Epoch 21/80
 - 2s - loss: 0.0526
Epoch 22/80
 - 2s - loss: 0.0515
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:11:23.248340: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:11:23.417377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:11:23.417423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:11:23.715353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:11:23.715409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:11:23.715418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:11:23.715684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0739
Epoch 2/80
 - 2s - loss: 0.1953
Epoch 3/80
 - 2s - loss: 0.1667
Epoch 4/80
 - 2s - loss: 0.1506
Epoch 5/80
 - 2s - loss: 0.1350
Epoch 6/80
 - 2s - loss: 0.1226
Epoch 7/80
 - 2s - loss: 0.1125
Epoch 8/80
 - 2s - loss: 0.1039
Epoch 9/80
 - 2s - loss: 0.0961
Epoch 10/80
 - 2s - loss: 0.0892
Epoch 11/80
 - 2s - loss: 0.0831
Epoch 12/80
 - 2s - loss: 0.0776
Epoch 13/80
 - 2s - loss: 0.0726
Epoch 14/80
 - 2s - loss: 0.0683
Epoch 15/80
 - 2s - loss: 0.0647
Epoch 16/80
 - 2s - loss: 0.0617
Epoch 17/80
 - 2s - loss: 0.0593
Epoch 18/80
 - 2s - loss: 0.0573
Epoch 19/80
 - 2s - loss: 0.0556
Epoch 20/80
 - 2s - loss: 0.0541
Epoch 21/80
 - 2s - loss: 0.0528
Epoch 22/80
 - 2s - loss: 0.0518
Epoch 23/80
 - 2s - loss: 0.0508
Epoch 24/80
 - 2s - loss: 0.0500
Epoch 25/80
 - 2s - loss: 0.0493
Epoch 26/80
 - 2s - loss: 0.0487
Epoch 27/80
 - 2s - loss: 0.0481
Epoch 28/80
 - 2s - loss: 0.0476
Epoch 29/80
 - 2s - loss: 0.0472
Epoch 30/80
 - 2s - loss: 0.0469
Epoch 31/80
 - 2s - loss: 0.0465
Epoch 32/80
 - 2s - loss: 0.0462
Epoch 33/80
 - 2s - loss: 0.0460
Epoch 34/80
 - 2s - loss: 0.0458
Epoch 35/80
 - 2s - loss: 0.0456
Epoch 36/80
 - 2s - loss: 0.0454
Epoch 37/80
 - 2s - loss: 0.0452
Epoch 38/80
 - 2s - loss: 0.0451
Epoch 39/80
 - 2s - loss: 0.0449
Epoch 40/80
 - 2s - loss: 0.0448
Epoch 41/80
 - 2s - loss: 0.0447
Epoch 42/80
 - 2s - loss: 0.0446
Epoch 43/80
 - 2s - loss: 0.0445
Epoch 44/80
 - 2s - loss: 0.0444
Epoch 45/80
 - 2s - loss: 0.0443
Epoch 46/80
 - 2s - loss: 0.0443
Epoch 47/80
 - 2s - loss: 0.0442
Epoch 48/80
 - 2s - loss: 0.0441
Epoch 49/80
 - 2s - loss: 0.0440
Epoch 50/80
 - 2s - loss: 0.0440
Epoch 51/80
 - 2s - loss: 0.0440
Epoch 52/80
 - 2s - loss: 0.0439
Epoch 53/80
 - 2s - loss: 0.0439
Epoch 54/80
 - 2s - loss: 0.0438
Epoch 55/80
 - 2s - loss: 0.0438
Epoch 56/80
 - 2s - loss: 0.0437
Epoch 57/80
 - 2s - loss: 0.0437
Epoch 58/80
 - 2s - loss: 0.0437
Epoch 59/80
 - 2s - loss: 0.0436
Epoch 60/80
 - 2s - loss: 0.0436
Epoch 61/80
 - 2s - loss: 0.0436
Epoch 62/80
 - 2s - loss: 0.0435
Epoch 63/80
 - 2s - loss: 0.0423
Epoch 64/80
 - 2s - loss: 0.0422
Epoch 65/80
 - 2s - loss: 0.0421
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:13:47.732746: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:13:47.900141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:13:47.900187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:13:48.201340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:13:48.201397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:13:48.201407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:13:48.201668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6569
Epoch 2/80
 - 2s - loss: 0.1040
Epoch 3/80
 - 2s - loss: 0.0689
Epoch 4/80
 - 2s - loss: 0.0627
Epoch 5/80
 - 2s - loss: 0.0579
Epoch 6/80
 - 2s - loss: 0.0528
Epoch 7/80
 - 2s - loss: 0.0482
Epoch 8/80
 - 2s - loss: 0.0443
Epoch 9/80
 - 2s - loss: 0.0407
Epoch 10/80
 - 2s - loss: 0.0375
Epoch 11/80
 - 2s - loss: 0.0346
Epoch 12/80
 - 2s - loss: 0.0319
Epoch 13/80
 - 2s - loss: 0.0296
Epoch 14/80
 - 2s - loss: 0.0275
Epoch 15/80
 - 2s - loss: 0.0257
Epoch 16/80
 - 2s - loss: 0.0241
Epoch 17/80
 - 2s - loss: 0.0227
Epoch 18/80
 - 2s - loss: 0.0215
Epoch 19/80
 - 2s - loss: 0.0205
Epoch 20/80
 - 2s - loss: 0.0197
Epoch 21/80
 - 2s - loss: 0.0190
Epoch 22/80
 - 2s - loss: 0.0183
Epoch 23/80
 - 2s - loss: 0.0178
Epoch 24/80
 - 2s - loss: 0.0174
Epoch 25/80
 - 2s - loss: 0.0170
Epoch 26/80
 - 2s - loss: 0.0166
Epoch 27/80
 - 2s - loss: 0.0163
Epoch 28/80
 - 2s - loss: 0.0161
Epoch 29/80
 - 2s - loss: 0.0159
Epoch 30/80
 - 2s - loss: 0.0157
Epoch 31/80
 - 2s - loss: 0.0155
Epoch 32/80
 - 2s - loss: 0.0154
Epoch 33/80
 - 2s - loss: 0.0152
Epoch 34/80
 - 2s - loss: 0.0151
Epoch 35/80
 - 2s - loss: 0.0150
Epoch 36/80
 - 2s - loss: 0.0149
Epoch 37/80
 - 2s - loss: 0.0149
Epoch 38/80
 - 2s - loss: 0.0148
Epoch 39/80
 - 2s - loss: 0.0147
Epoch 40/80
 - 2s - loss: 0.0146
Epoch 41/80
 - 2s - loss: 0.0146
Epoch 42/80
 - 2s - loss: 0.0145
Epoch 43/80
 - 2s - loss: 0.0145
Epoch 44/80
 - 2s - loss: 0.0144
Epoch 45/80
 - 2s - loss: 0.0144
Epoch 46/80
 - 2s - loss: 0.0144
Epoch 47/80
 - 2s - loss: 0.0143
Epoch 48/80
 - 2s - loss: 0.0143
Epoch 49/80
 - 2s - loss: 0.0143
Epoch 50/80
 - 2s - loss: 0.0143
Epoch 51/80
 - 2s - loss: 0.0142
Epoch 52/80
 - 2s - loss: 0.0138
Epoch 53/80
 - 2s - loss: 0.0137
Epoch 54/80
 - 2s - loss: 0.0137
Epoch 55/80
 - 2s - loss: 0.0137
Epoch 56/80
 - 2s - loss: 0.0136
Epoch 57/80
 - 2s - loss: 0.0136
Epoch 58/80
 - 2s - loss: 0.0136
Epoch 59/80
 - 2s - loss: 0.0136
Epoch 60/80
 - 2s - loss: 0.0136
Epoch 61/80
 - 2s - loss: 0.0136
Epoch 62/80
 - 2s - loss: 0.0136
Epoch 63/80
 - 2s - loss: 0.0136
Epoch 64/80
 - 2s - loss: 0.0136
Epoch 65/80
 - 2s - loss: 0.0136
Epoch 66/80
 - 2s - loss: 0.0136
Epoch 67/80
 - 2s - loss: 0.0136
Epoch 68/80
 - 2s - loss: 0.0136
Epoch 69/80
 - 2s - loss: 0.0136
Epoch 70/80
 - 2s - loss: 0.0136
Epoch 71/80
 - 2s - loss: 0.0136
Epoch 72/80
 - 2s - loss: 0.0136
Epoch 73/80
 - 2s - loss: 0.0136
Epoch 74/80
 - 2s - loss: 0.0136
Epoch 75/80
 - 2s - loss: 0.0136
Epoch 76/80
 - 2s - loss: 0.0136
Epoch 77/80
 - 2s - loss: 0.0136
Epoch 78/80
 - 2s - loss: 0.0136
Epoch 79/80
 - 2s - loss: 0.0136
Epoch 80/80
 - 2s - loss: 0.0136
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.3310 - val_loss: 1.1893
AUC: 0.8091

Epoch 2/80
 - 0s - loss: 1.9474 - val_loss: 0.7851
AUC: 0.8314

Epoch 3/80
 - 0s - loss: 1.3624 - val_loss: 0.8406
AUC: 0.8464

Epoch 4/80
 - 0s - loss: 1.1686 - val_loss: 0.6808
AUC: 0.8469

Epoch 5/80
 - 0s - loss: 1.1122 - val_loss: 0.7019
AUC: 0.8500

Epoch 6/80
 - 0s - loss: 1.0785 - val_loss: 0.6701
AUC: 0.8527

Epoch 7/80
 - 0s - loss: 1.0596 - val_loss: 0.5950
AUC: 0.8523

Epoch 8/80
 - 0s - loss: 1.0371 - val_loss: 0.6747
AUC: 0.8561

Epoch 9/80
 - 0s - loss: 1.0443 - val_loss: 0.6163
AUC: 0.8546

Epoch 10/80
 - 0s - loss: 1.0299 - val_loss: 0.5870
AUC: 0.8578

Epoch 11/80
 - 0s - loss: 1.0208 - val_loss: 0.6782
AUC: 0.8604

Epoch 12/80
 - 0s - loss: 1.0194 - val_loss: 0.5562
AUC: 0.8574

Epoch 13/80
 - 0s - loss: 1.0074 - val_loss: 0.6079
AUC: 0.8597

Epoch 14/80
 - 0s - loss: 1.0017 - val_loss: 0.5761
AUC: 0.8609

Epoch 15/80
 - 0s - loss: 1.0006 - val_loss: 0.5839
AUC: 0.8608

Epoch 16/80
 - 0s - loss: 0.9905 - val_loss: 0.6128
AUC: 0.8617

Epoch 17/80
 - 0s - loss: 0.9928 - val_loss: 0.6121
AUC: 0.8617

Epoch 18/80
 - 0s - loss: 0.9880 - val_loss: 0.5693
AUC: 0.8622

Epoch 19/80
 - 0s - loss: 0.9741 - val_loss: 0.5790
AUC: 0.8643

Epoch 20/80
 - 0s - loss: 0.9775 - val_loss: 0.6234
AUC: 0.8636

Epoch 21/80
 - 0s - loss: 0.9776 - val_loss: 0.5813
AUC: 0.8646

Epoch 22/80
 - 0s - loss: 0.9686 - val_loss: 0.6330
AUC: 0.8632

Epoch 23/80
 - 0s - loss: 0.9554 - val_loss: 0.6202
AUC: 0.8646

Epoch 24/80
 - 0s - loss: 0.9567 - val_loss: 0.5810
AUC: 0.8645

Epoch 25/80
 - 0s - loss: 0.9541 - val_loss: 0.6183
AUC: 0.8650

Epoch 26/80
 - 0s - loss: 0.9572 - val_loss: 0.5955
AUC: 0.8644

Epoch 27/80
 - 0s - loss: 0.9467 - val_loss: 0.6054
AUC: 0.8650

Epoch 28/80
 - 0s - loss: 0.9536 - val_loss: 0.6088
AUC: 0.8649

Epoch 29/80
 - 0s - loss: 0.9500 - val_loss: 0.6105
AUC: 0.8654

Epoch 30/80
 - 0s - loss: 0.9487 - val_loss: 0.5959
AUC: 0.8650

Epoch 31/80
 - 0s - loss: 0.9428 - val_loss: 0.6164
AUC: 0.8653

Epoch 32/80
 - 0s - loss: 0.9441 - val_loss: 0.5650
AUC: 0.8642

Epoch 33/80
 - 0s - loss: 0.9418 - val_loss: 0.5915
AUC: 0.8646

Epoch 34/80
 - 0s - loss: 0.9454 - val_loss: 0.5959
AUC: 0.8647

Epoch 35/80
 - 0s - loss: 0.9401 - val_loss: 0.6145
AUC: 0.8649

Epoch 36/80
 - 0s - loss: 0.9407 - val_loss: 0.5940
AUC: 0.8646

Epoch 37/80
 - 0s - loss: 0.9365 - val_loss: 0.5990
AUC: 0.8647

Epoch 38/80
 - 0s - loss: 0.9435 - val_loss: 0.6047
AUC: 0.8649

Epoch 39/80
 - 0s - loss: 0.9401 - val_loss: 0.6086
AUC: 0.8651

Epoch 40/80
 - 0s - loss: 0.9426 - val_loss: 0.6064
AUC: 0.8651

Epoch 41/80
 - 0s - loss: 0.9417 - val_loss: 0.5942
AUC: 0.8649

Epoch 42/80
 - 0s - loss: 0.9399 - val_loss: 0.6021
AUC: 0.8650

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9455 - val_loss: 0.5894
AUC: 0.8651

Epoch 2/30
 - 0s - loss: 0.9441 - val_loss: 0.5985
AUC: 0.8651

Epoch 3/30
 - 0s - loss: 0.9385 - val_loss: 0.6256
AUC: 0.8655

Epoch 4/30
 - 0s - loss: 0.9419 - val_loss: 0.6058
AUC: 0.8656

Epoch 5/30
 - 0s - loss: 0.9386 - val_loss: 0.5807
AUC: 0.8653

Epoch 6/30
 - 0s - loss: 0.9352 - val_loss: 0.5965
AUC: 0.8658

Epoch 7/30
 - 0s - loss: 0.9353 - val_loss: 0.5985
AUC: 0.8658

Epoch 8/30
 - 0s - loss: 0.9355 - val_loss: 0.6044
AUC: 0.8659

Epoch 9/30
 - 0s - loss: 0.9328 - val_loss: 0.5890
AUC: 0.8656

Epoch 10/30
 - 0s - loss: 0.9306 - val_loss: 0.5911
AUC: 0.8659

Epoch 11/30
 - 0s - loss: 0.9303 - val_loss: 0.5722
AUC: 0.8657

Epoch 12/30
 - 0s - loss: 0.9311 - val_loss: 0.5998
AUC: 0.8662

Epoch 13/30
 - 0s - loss: 0.9215 - val_loss: 0.5843
AUC: 0.8661

Epoch 14/30
 - 0s - loss: 0.9212 - val_loss: 0.5923
AUC: 0.8662

Epoch 15/30
 - 0s - loss: 0.9240 - val_loss: 0.5918
AUC: 0.8664

Epoch 16/30
 - 0s - loss: 0.9180 - val_loss: 0.6151
AUC: 0.8666

Epoch 17/30
 - 0s - loss: 0.9200 - val_loss: 0.5849
AUC: 0.8660

Epoch 18/30
 - 0s - loss: 0.9198 - val_loss: 0.5994
AUC: 0.8666

Epoch 19/30
 - 0s - loss: 0.9175 - val_loss: 0.6048
AUC: 0.8665

Epoch 20/30
 - 0s - loss: 0.9166 - val_loss: 0.5802
AUC: 0.8663

Epoch 21/30
 - 0s - loss: 0.9088 - val_loss: 0.5825
AUC: 0.8664

Epoch 22/30
 - 1s - loss: 0.9090 - val_loss: 0.5797
AUC: 0.8665

Epoch 23/30
 - 0s - loss: 0.9097 - val_loss: 0.5881
AUC: 0.8666

Epoch 24/30
 - 1s - loss: 0.9103 - val_loss: 0.5799
AUC: 0.8664

Epoch 25/30
 - 1s - loss: 0.9070 - val_loss: 0.5828
AUC: 0.8665

Epoch 26/30
 - 0s - loss: 0.9113 - val_loss: 0.5763
AUC: 0.8664

Epoch 27/30
 - 1s - loss: 0.9117 - val_loss: 0.5884
AUC: 0.8666

Epoch 28/30
 - 0s - loss: 0.9080 - val_loss: 0.5810
AUC: 0.8666

Epoch 29/30
 - 0s - loss: 0.9082 - val_loss: 0.5913
AUC: 0.8667

Epoch 30/30
 - 0s - loss: 0.9077 - val_loss: 0.5871
Using TensorFlow backend.
AUC: 0.8666

2019-03-08 08:17:37.183112: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:17:37.350150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:17:37.350196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:17:37.649207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:17:37.649262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:17:37.649272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:17:37.649537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6420
Epoch 2/80
 - 2s - loss: 0.1003
Epoch 3/80
 - 2s - loss: 0.0687
Epoch 4/80
 - 2s - loss: 0.0628
Epoch 5/80
 - 2s - loss: 0.0571
Epoch 6/80
 - 2s - loss: 0.0518
Epoch 7/80
 - 2s - loss: 0.0477
Epoch 8/80
 - 2s - loss: 0.0443
Epoch 9/80
 - 2s - loss: 0.0413
Epoch 10/80
 - 2s - loss: 0.0386
Epoch 11/80
 - 2s - loss: 0.0359
Epoch 12/80
 - 2s - loss: 0.0334
Epoch 13/80
 - 2s - loss: 0.0310
Epoch 14/80
 - 2s - loss: 0.0287
Epoch 15/80
 - 2s - loss: 0.0266
Epoch 16/80
 - 2s - loss: 0.0248
Epoch 17/80
 - 2s - loss: 0.0232
Epoch 18/80
 - 2s - loss: 0.0220
Epoch 19/80
 - 2s - loss: 0.0209
Epoch 20/80
 - 2s - loss: 0.0200
Epoch 21/80
 - 2s - loss: 0.0193
Epoch 22/80
 - 2s - loss: 0.0186
Epoch 23/80
 - 2s - loss: 0.0181
Epoch 24/80
 - 2s - loss: 0.0176
Epoch 25/80
 - 2s - loss: 0.0172
Epoch 26/80
 - 2s - loss: 0.0169
Epoch 27/80
 - 2s - loss: 0.0166
Epoch 28/80
 - 2s - loss: 0.0163
Epoch 29/80
 - 2s - loss: 0.0161
Epoch 30/80
 - 2s - loss: 0.0158
Epoch 31/80
 - 2s - loss: 0.0157
Epoch 32/80
 - 2s - loss: 0.0155
Epoch 33/80
 - 2s - loss: 0.0154
Epoch 34/80
 - 2s - loss: 0.0152
Epoch 35/80
 - 2s - loss: 0.0151
Epoch 36/80
 - 2s - loss: 0.0150
Epoch 37/80
 - 2s - loss: 0.0149
Epoch 38/80
 - 2s - loss: 0.0148
Epoch 39/80
 - 2s - loss: 0.0148
Epoch 40/80
 - 2s - loss: 0.0147
Epoch 41/80
 - 2s - loss: 0.0146
Epoch 42/80
 - 2s - loss: 0.0146
Epoch 43/80
 - 2s - loss: 0.0145
Epoch 44/80
 - 2s - loss: 0.0145
Epoch 45/80
 - 2s - loss: 0.0145
Epoch 46/80
 - 2s - loss: 0.0144
Epoch 47/80
 - 2s - loss: 0.0144
Epoch 48/80
 - 2s - loss: 0.0143
Epoch 49/80
 - 2s - loss: 0.0143
Epoch 50/80
 - 2s - loss: 0.0143
Epoch 51/80
 - 2s - loss: 0.0138
Epoch 52/80
 - 2s - loss: 0.0138
Epoch 53/80
 - 2s - loss: 0.0138
Epoch 54/80
 - 2s - loss: 0.0138
Epoch 55/80
 - 2s - loss: 0.0137
Epoch 56/80
 - 2s - loss: 0.0137
Epoch 57/80
 - 2s - loss: 0.0137
Epoch 58/80
 - 2s - loss: 0.0137
Epoch 59/80
 - 2s - loss: 0.0136
Epoch 60/80
 - 2s - loss: 0.0136
Epoch 61/80
 - 2s - loss: 0.0136
Epoch 62/80
 - 2s - loss: 0.0136
Epoch 63/80
 - 2s - loss: 0.0136
Epoch 64/80
 - 2s - loss: 0.0136
Epoch 65/80
 - 2s - loss: 0.0136
Epoch 66/80
 - 2s - loss: 0.0136
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:20:07.007112: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:20:07.176058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:20:07.176106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:20:07.475907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:20:07.475962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:20:07.475971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:20:07.476236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6640
Epoch 2/80
 - 2s - loss: 0.1040
Epoch 3/80
 - 2s - loss: 0.0698
Epoch 4/80
 - 2s - loss: 0.0651
Epoch 5/80
 - 2s - loss: 0.0624
Epoch 6/80
 - 2s - loss: 0.0589
Epoch 7/80
 - 2s - loss: 0.0544
Epoch 8/80
 - 2s - loss: 0.0493
Epoch 9/80
 - 2s - loss: 0.0445
Epoch 10/80
 - 2s - loss: 0.0403
Epoch 11/80
 - 2s - loss: 0.0364
Epoch 12/80
 - 2s - loss: 0.0330
Epoch 13/80
 - 2s - loss: 0.0302
Epoch 14/80
 - 2s - loss: 0.0278
Epoch 15/80
 - 2s - loss: 0.0258
Epoch 16/80
 - 2s - loss: 0.0241
Epoch 17/80
 - 2s - loss: 0.0227
Epoch 18/80
 - 2s - loss: 0.0215
Epoch 19/80
 - 2s - loss: 0.0205
Epoch 20/80
 - 2s - loss: 0.0197
Epoch 21/80
 - 2s - loss: 0.0190
Epoch 22/80
 - 2s - loss: 0.0184
Epoch 23/80
 - 2s - loss: 0.0179
Epoch 24/80
 - 2s - loss: 0.0175
Epoch 25/80
 - 2s - loss: 0.0171
Epoch 26/80
 - 2s - loss: 0.0168
Epoch 27/80
 - 2s - loss: 0.0165
Epoch 28/80
 - 2s - loss: 0.0162
Epoch 29/80
 - 2s - loss: 0.0160
Epoch 30/80
 - 2s - loss: 0.0158
Epoch 31/80
 - 2s - loss: 0.0156
Epoch 32/80
 - 2s - loss: 0.0154
Epoch 33/80
 - 2s - loss: 0.0153
Epoch 34/80
 - 2s - loss: 0.0152
Epoch 35/80
 - 2s - loss: 0.0151
Epoch 36/80
 - 2s - loss: 0.0150
Epoch 37/80
 - 2s - loss: 0.0149
Epoch 38/80
 - 2s - loss: 0.0148
Epoch 39/80
 - 2s - loss: 0.0147
Epoch 40/80
 - 2s - loss: 0.0147
Epoch 41/80
 - 2s - loss: 0.0146
Epoch 42/80
 - 2s - loss: 0.0145
Epoch 43/80
 - 2s - loss: 0.0145
Epoch 44/80
 - 2s - loss: 0.0145
Epoch 45/80
 - 2s - loss: 0.0144
Epoch 46/80
 - 2s - loss: 0.0144
Epoch 47/80
 - 2s - loss: 0.0143
Epoch 48/80
 - 2s - loss: 0.0143
Epoch 49/80
 - 2s - loss: 0.0143
Epoch 50/80
 - 2s - loss: 0.0138
Epoch 51/80
 - 2s - loss: 0.0138
Epoch 52/80
 - 2s - loss: 0.0138
Epoch 53/80
 - 2s - loss: 0.0138
Epoch 54/80
 - 2s - loss: 0.0136
Epoch 55/80
 - 2s - loss: 0.0136
Epoch 56/80
 - 2s - loss: 0.0136
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:22:17.261678: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:22:17.433120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:22:17.433169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:22:17.755099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:22:17.755157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:22:17.755167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:22:17.755442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.4 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2747
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:22:38.198207: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:22:38.362839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:22:38.362885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:22:38.660896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:22:38.660950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:22:38.660959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:22:38.661226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3172
Epoch 2/80
 - 2s - loss: 0.3324
Epoch 3/80
 - 2s - loss: 0.2943
Epoch 4/80
 - 2s - loss: 0.2688
Epoch 5/80
 - 2s - loss: 0.2439
Epoch 6/80
 - 2s - loss: 0.2210
Epoch 7/80
 - 2s - loss: 0.2028
Epoch 8/80
 - 2s - loss: 0.1877
Epoch 9/80
 - 2s - loss: 0.1749
Epoch 10/80
 - 2s - loss: 0.1642
Epoch 11/80
 - 2s - loss: 0.1550
Epoch 12/80
 - 2s - loss: 0.1471
Epoch 13/80
 - 2s - loss: 0.1403
Epoch 14/80
 - 2s - loss: 0.1347
Epoch 15/80
 - 2s - loss: 0.1301
Epoch 16/80
 - 2s - loss: 0.1263
Epoch 17/80
 - 2s - loss: 0.1231
Epoch 18/80
 - 2s - loss: 0.1205
Epoch 19/80
 - 2s - loss: 0.1182
Epoch 20/80
 - 2s - loss: 0.1162
Epoch 21/80
 - 2s - loss: 0.1144
Epoch 22/80
 - 2s - loss: 0.1129
Epoch 23/80
 - 2s - loss: 0.1116
Epoch 24/80
 - 2s - loss: 0.1104
Epoch 25/80
 - 2s - loss: 0.1094
Epoch 26/80
 - 2s - loss: 0.1085
Epoch 27/80
 - 2s - loss: 0.1078
Epoch 28/80
 - 2s - loss: 0.1071
Epoch 29/80
 - 2s - loss: 0.1065
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:23:56.756167: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:23:56.923439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:23:56.923489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:23:57.221516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:23:57.221571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:23:57.221581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:23:57.221874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2843
Epoch 2/80
 - 2s - loss: 0.3317
Epoch 3/80
 - 2s - loss: 0.2998
Epoch 4/80
 - 2s - loss: 0.2762
Epoch 5/80
 - 2s - loss: 0.2526
Epoch 6/80
 - 2s - loss: 0.2318
Epoch 7/80
 - 2s - loss: 0.2125
Epoch 8/80
 - 2s - loss: 0.1947
Epoch 9/80
 - 2s - loss: 0.1796
Epoch 10/80
 - 2s - loss: 0.1674
Epoch 11/80
 - 2s - loss: 0.1576
Epoch 12/80
 - 2s - loss: 0.1494
Epoch 13/80
 - 2s - loss: 0.1423
Epoch 14/80
 - 2s - loss: 0.1364
Epoch 15/80
 - 2s - loss: 0.1314
Epoch 16/80
 - 2s - loss: 0.1274
Epoch 17/80
 - 2s - loss: 0.1240
Epoch 18/80
 - 2s - loss: 0.1212
Epoch 19/80
 - 2s - loss: 0.1187
Epoch 20/80
 - 2s - loss: 0.1166
Epoch 21/80
 - 2s - loss: 0.1148
Epoch 22/80
 - 2s - loss: 0.1132
Epoch 23/80
 - 2s - loss: 0.1118
Epoch 24/80
 - 2s - loss: 0.1107
Epoch 25/80
 - 2s - loss: 0.1096
Epoch 26/80
 - 2s - loss: 0.1088
Epoch 27/80
 - 2s - loss: 0.1080
Epoch 28/80
 - 2s - loss: 0.1074
Epoch 29/80
 - 2s - loss: 0.1068
Epoch 30/80
 - 2s - loss: 0.1063
Epoch 31/80
 - 2s - loss: 0.1059
Epoch 32/80
 - 2s - loss: 0.1055
Epoch 33/80
 - 2s - loss: 0.1052
Epoch 34/80
 - 2s - loss: 0.1049
Epoch 35/80
 - 2s - loss: 0.1046
Epoch 36/80
 - 2s - loss: 0.1044
Epoch 37/80
 - 2s - loss: 0.1041
Epoch 38/80
 - 2s - loss: 0.1039
Epoch 39/80
 - 2s - loss: 0.1037
Epoch 40/80
 - 2s - loss: 0.1036
Epoch 41/80
 - 2s - loss: 0.1034
Epoch 42/80
 - 2s - loss: 0.1033
Epoch 43/80
 - 2s - loss: 0.1031
Epoch 44/80
 - 2s - loss: 0.1030
Epoch 45/80
 - 2s - loss: 0.1029
Epoch 46/80
 - 2s - loss: 0.1028
Epoch 47/80
 - 2s - loss: 0.1027
Epoch 48/80
 - 2s - loss: 0.1026
Epoch 49/80
 - 2s - loss: 0.1025
Epoch 50/80
 - 2s - loss: 0.1024
Epoch 51/80
 - 2s - loss: 0.1023
Epoch 52/80
 - 2s - loss: 0.1023
Epoch 53/80
 - 2s - loss: 0.1022
Epoch 54/80
 - 2s - loss: 0.1021
Epoch 55/80
 - 2s - loss: 0.1021
Epoch 56/80
 - 2s - loss: 0.1020
Epoch 57/80
 - 2s - loss: 0.1019
Epoch 58/80
 - 2s - loss: 0.1019
Epoch 59/80
 - 2s - loss: 0.1019
Epoch 60/80
 - 2s - loss: 0.1018
Epoch 61/80
 - 2s - loss: 0.1018
Epoch 62/80
 - 2s - loss: 0.1017
Epoch 63/80
 - 2s - loss: 0.1017
Epoch 64/80
 - 2s - loss: 0.1017
Epoch 65/80
 - 2s - loss: 0.1016
Epoch 66/80
 - 2s - loss: 0.1016
Epoch 67/80
 - 2s - loss: 0.1015
Epoch 68/80
 - 2s - loss: 0.1015
Epoch 69/80
 - 2s - loss: 0.1015
Epoch 70/80
 - 2s - loss: 0.1015
Epoch 71/80
 - 2s - loss: 0.0988
Epoch 72/80
 - 2s - loss: 0.0985
Epoch 73/80
 - 2s - loss: 0.0985
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:26:38.572266: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:26:38.737954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:26:38.738000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:26:39.037545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:26:39.037594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:26:39.037603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:26:39.037875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0847
Epoch 2/80
 - 2s - loss: 0.1957
Epoch 3/80
 - 2s - loss: 0.1708
Epoch 4/80
 - 2s - loss: 0.1640
Epoch 5/80
 - 2s - loss: 0.1557
Epoch 6/80
 - 2s - loss: 0.1432
Epoch 7/80
 - 2s - loss: 0.1275
Epoch 8/80
 - 2s - loss: 0.1133
Epoch 9/80
 - 2s - loss: 0.1021
Epoch 10/80
 - 2s - loss: 0.0926
Epoch 11/80
 - 2s - loss: 0.0845
Epoch 12/80
 - 2s - loss: 0.0779
Epoch 13/80
 - 2s - loss: 0.0727
Epoch 14/80
 - 2s - loss: 0.0683
Epoch 15/80
 - 2s - loss: 0.0648
Epoch 16/80
 - 2s - loss: 0.0619
Epoch 17/80
 - 2s - loss: 0.0594
Epoch 18/80
 - 2s - loss: 0.0574
Epoch 19/80
 - 2s - loss: 0.0557
Epoch 20/80
 - 2s - loss: 0.0542
Epoch 21/80
 - 2s - loss: 0.0529
Epoch 22/80
 - 2s - loss: 0.0518
Epoch 23/80
 - 2s - loss: 0.0508
Epoch 24/80
 - 2s - loss: 0.0499
Epoch 25/80
 - 2s - loss: 0.0491
Epoch 26/80
 - 2s - loss: 0.0485
Epoch 27/80
 - 2s - loss: 0.0479
Epoch 28/80
 - 2s - loss: 0.0474
Epoch 29/80
 - 2s - loss: 0.0470
Epoch 30/80
 - 2s - loss: 0.0466
Epoch 31/80
 - 2s - loss: 0.0463
Epoch 32/80
 - 2s - loss: 0.0460
Epoch 33/80
 - 2s - loss: 0.0458
Epoch 34/80
 - 2s - loss: 0.0456
Epoch 35/80
 - 2s - loss: 0.0454
Epoch 36/80
 - 2s - loss: 0.0452
Epoch 37/80
 - 2s - loss: 0.0450
Epoch 38/80
 - 2s - loss: 0.0449
Epoch 39/80
 - 2s - loss: 0.0448
Epoch 40/80
 - 2s - loss: 0.0447
Epoch 41/80
 - 2s - loss: 0.0445
Epoch 42/80
 - 2s - loss: 0.0444
Epoch 43/80
 - 2s - loss: 0.0444
Epoch 44/80
 - 2s - loss: 0.0443
Epoch 45/80
 - 2s - loss: 0.0442
Epoch 46/80
 - 2s - loss: 0.0441
Epoch 47/80
 - 2s - loss: 0.0440
Epoch 48/80
 - 2s - loss: 0.0440
Epoch 49/80
 - 2s - loss: 0.0439
Epoch 50/80
 - 2s - loss: 0.0439
Epoch 51/80
 - 2s - loss: 0.0438
Epoch 52/80
 - 2s - loss: 0.0438
Epoch 53/80
 - 2s - loss: 0.0437
Epoch 54/80
 - 2s - loss: 0.0437
Epoch 55/80
 - 2s - loss: 0.0437
Epoch 56/80
 - 2s - loss: 0.0436
Epoch 57/80
 - 2s - loss: 0.0436
Epoch 58/80
 - 2s - loss: 0.0436
Epoch 59/80
 - 2s - loss: 0.0435
Epoch 60/80
 - 2s - loss: 0.0435
Epoch 61/80
 - 2s - loss: 0.0422
Epoch 62/80
 - 2s - loss: 0.0421
Epoch 63/80
 - 2s - loss: 0.0421
Epoch 64/80
 - 2s - loss: 0.0421
Epoch 65/80
 - 2s - loss: 0.0421
Epoch 66/80
 - 2s - loss: 0.0418
Epoch 67/80
 - 2s - loss: 0.0417
Epoch 68/80
 - 2s - loss: 0.0417
Epoch 69/80
 - 2s - loss: 0.0417
Epoch 70/80
 - 2s - loss: 0.0417
Epoch 71/80
 - 2s - loss: 0.0417
Epoch 72/80
 - 2s - loss: 0.0417
Epoch 73/80
 - 2s - loss: 0.0417
Epoch 74/80
 - 2s - loss: 0.0417
Epoch 75/80
 - 2s - loss: 0.0417
Epoch 76/80
 - 2s - loss: 0.0416
Epoch 77/80
 - 2s - loss: 0.0416
Epoch 78/80
 - 2s - loss: 0.0416
Epoch 79/80
 - 2s - loss: 0.0416
Epoch 80/80
 - 2s - loss: 0.0416
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.4505 - val_loss: 1.1047
AUC: 0.8281

Epoch 2/80
 - 0s - loss: 1.5032 - val_loss: 0.8042
AUC: 0.8533

Epoch 3/80
 - 0s - loss: 1.1954 - val_loss: 0.6837
AUC: 0.8564

Epoch 4/80
 - 0s - loss: 1.1208 - val_loss: 0.7739
AUC: 0.8604

Epoch 5/80
 - 0s - loss: 1.0836 - val_loss: 0.6851
AUC: 0.8634

Epoch 6/80
 - 0s - loss: 1.0698 - val_loss: 0.7515
AUC: 0.8667

Epoch 7/80
 - 0s - loss: 1.0495 - val_loss: 0.6669
AUC: 0.8649

Epoch 8/80
 - 0s - loss: 1.0464 - val_loss: 0.5769
AUC: 0.8666

Epoch 9/80
 - 0s - loss: 1.0306 - val_loss: 0.5754
AUC: 0.8666

Epoch 10/80
 - 0s - loss: 1.0301 - val_loss: 0.7338
AUC: 0.8689

Epoch 11/80
 - 0s - loss: 1.0263 - val_loss: 0.6286
AUC: 0.8698

Epoch 12/80
 - 0s - loss: 1.0120 - val_loss: 0.6322
AUC: 0.8699

Epoch 13/80
 - 0s - loss: 1.0076 - val_loss: 0.6243
AUC: 0.8707

Epoch 14/80
 - 0s - loss: 1.0100 - val_loss: 0.6827
AUC: 0.8720

Epoch 15/80
 - 0s - loss: 1.0016 - val_loss: 0.6229
AUC: 0.8720

Epoch 16/80
 - 0s - loss: 0.9915 - val_loss: 0.6258
AUC: 0.8718

Epoch 17/80
 - 0s - loss: 0.9882 - val_loss: 0.7245
AUC: 0.8722

Epoch 18/80
 - 0s - loss: 0.9834 - val_loss: 0.6550
AUC: 0.8711

Epoch 19/80
 - 0s - loss: 0.9801 - val_loss: 0.5465
AUC: 0.8734

Epoch 20/80
 - 0s - loss: 0.9743 - val_loss: 0.5763
AUC: 0.8726

Epoch 21/80
 - 0s - loss: 0.9747 - val_loss: 0.5793
AUC: 0.8737

Epoch 22/80
 - 0s - loss: 0.9703 - val_loss: 0.6432
AUC: 0.8749

Epoch 23/80
 - 0s - loss: 0.9659 - val_loss: 0.5965
AUC: 0.8744

Epoch 24/80
 - 0s - loss: 0.9593 - val_loss: 0.5026
AUC: 0.8731

Epoch 25/80
 - 0s - loss: 0.9593 - val_loss: 0.6244
AUC: 0.8749

Epoch 26/80
 - 0s - loss: 0.9527 - val_loss: 0.5779
AUC: 0.8742

Epoch 27/80
 - 0s - loss: 0.9551 - val_loss: 0.6481
AUC: 0.8749

Epoch 28/80
 - 0s - loss: 0.9561 - val_loss: 0.6053
AUC: 0.8761

Epoch 29/80
 - 0s - loss: 0.9416 - val_loss: 0.5890
AUC: 0.8750

Epoch 30/80
 - 0s - loss: 0.9383 - val_loss: 0.6519
AUC: 0.8764

Epoch 31/80
 - 0s - loss: 0.9432 - val_loss: 0.5251
AUC: 0.8747

Epoch 32/80
 - 0s - loss: 0.9395 - val_loss: 0.5150
AUC: 0.8745

Epoch 33/80
 - 0s - loss: 0.9306 - val_loss: 0.5591
AUC: 0.8746

Epoch 34/80
 - 0s - loss: 0.9255 - val_loss: 0.5736
AUC: 0.8729

Epoch 35/80
 - 0s - loss: 0.9182 - val_loss: 0.5767
AUC: 0.8753

Epoch 36/80
 - 0s - loss: 0.9134 - val_loss: 0.5867
AUC: 0.8758

Epoch 37/80
 - 0s - loss: 0.9104 - val_loss: 0.5886
AUC: 0.8765

Epoch 38/80
 - 0s - loss: 0.9080 - val_loss: 0.5880
AUC: 0.8763

Epoch 39/80
 - 0s - loss: 0.9068 - val_loss: 0.5650
AUC: 0.8762

Epoch 40/80
 - 0s - loss: 0.9048 - val_loss: 0.5734
AUC: 0.8758

Epoch 41/80
 - 0s - loss: 0.9036 - val_loss: 0.5573
AUC: 0.8758

Epoch 42/80
 - 0s - loss: 0.9029 - val_loss: 0.5716
AUC: 0.8758

Epoch 43/80
 - 0s - loss: 0.9041 - val_loss: 0.6071
AUC: 0.8770

Epoch 44/80
 - 0s - loss: 0.8992 - val_loss: 0.5683
AUC: 0.8758

Epoch 45/80
 - 0s - loss: 0.8969 - val_loss: 0.5854
AUC: 0.8763

Epoch 46/80
 - 0s - loss: 0.8951 - val_loss: 0.5648
AUC: 0.8760

Epoch 47/80
 - 0s - loss: 0.8972 - val_loss: 0.5867
AUC: 0.8762

Epoch 48/80
 - 0s - loss: 0.8954 - val_loss: 0.5751
AUC: 0.8762

Epoch 49/80
 - 0s - loss: 0.8942 - val_loss: 0.5787
AUC: 0.8763

Epoch 50/80
 - 0s - loss: 0.8960 - val_loss: 0.5729
AUC: 0.8761

Epoch 51/80
 - 0s - loss: 0.8947 - val_loss: 0.5624
AUC: 0.8760

Epoch 52/80
 - 0s - loss: 0.8960 - val_loss: 0.5707
AUC: 0.8761

Epoch 53/80
 - 0s - loss: 0.8936 - val_loss: 0.5769
AUC: 0.8762

Epoch 54/80
 - 0s - loss: 0.8899 - val_loss: 0.5798
AUC: 0.8762

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.8997 - val_loss: 0.5712
AUC: 0.8757

Epoch 2/30
 - 1s - loss: 0.8972 - val_loss: 0.5490
AUC: 0.8754

Epoch 3/30
 - 1s - loss: 0.8926 - val_loss: 0.5730
AUC: 0.8761

Epoch 4/30
 - 1s - loss: 0.8934 - val_loss: 0.5667
AUC: 0.8760

Epoch 5/30
 - 1s - loss: 0.8923 - val_loss: 0.5760
AUC: 0.8762

Epoch 6/30
 - 1s - loss: 0.8943 - val_loss: 0.5862
AUC: 0.8763

Epoch 7/30
 - 1s - loss: 0.8923 - val_loss: 0.5940
AUC: 0.8764

Epoch 8/30
 - 1s - loss: 0.8879 - val_loss: 0.6014
AUC: 0.8766

Epoch 9/30
 - 1s - loss: 0.8844 - val_loss: 0.5765
AUC: 0.8763

Epoch 10/30
 - 1s - loss: 0.8838 - val_loss: 0.5646
AUC: 0.8757

Epoch 11/30
 - 1s - loss: 0.8824 - val_loss: 0.5735
AUC: 0.8761

Epoch 12/30
 - 1s - loss: 0.8835 - val_loss: 0.5772
AUC: 0.8760

Epoch 13/30
 - 1s - loss: 0.8775 - val_loss: 0.5630
AUC: 0.8758

Epoch 14/30
 - 1s - loss: 0.8784 - val_loss: 0.5626
AUC: 0.8759

Epoch 15/30
 - 1s - loss: 0.8782 - val_loss: 0.5646
AUC: 0.8760

Epoch 16/30
 - 1s - loss: 0.8768 - val_loss: 0.5593
AUC: 0.8760

Epoch 17/30
 - 1s - loss: 0.8701 - val_loss: 0.5667
AUC: 0.8760

Epoch 18/30
 - 1s - loss: 0.8738 - val_loss: 0.5673
AUC: 0.8760

Epoch 19/30
 - 1s - loss: 0.8777 - val_loss: 0.5709
AUC: 0.8761

Epoch 20/30
 - 1s - loss: 0.8808 - val_loss: 0.5669
AUC: 0.8760

Epoch 21/30
 - 1s - loss: 0.8760 - val_loss: 0.5620
AUC: 0.8760

Epoch 22/30
 - 1s - loss: 0.8754 - val_loss: 0.5672
AUC: 0.8760

Epoch 23/30
 - 1s - loss: 0.8732 - val_loss: 0.5661
AUC: 0.8760

Epoch 24/30
 - 1s - loss: 0.8750 - val_loss: 0.5638
AUC: 0.8759

Epoch 25/30
 - 1s - loss: 0.8739 - val_loss: 0.5655
AUC: 0.8759

Epoch 26/30
 - 1s - loss: 0.8713 - val_loss: 0.5644
AUC: 0.8759

Epoch 27/30
 - 1s - loss: 0.8781 - val_loss: 0.5656
AUC: 0.8760

Epoch 28/30
 - 1s - loss: 0.8742 - val_loss: 0.5649
AUC: 0.8760

Epoch 29/30
 - 1s - loss: 0.8759 - val_loss: 0.5653
AUC: 0.8760

Epoch 30/30
 - 1s - loss: 0.8746 - val_loss: 0.5653
Using TensorFlow backend.
AUC: 0.8760

2019-03-08 08:30:39.345600: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:30:39.515424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:30:39.515474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:30:39.822750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:30:39.822822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:30:39.822843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:30:39.823126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0784
Epoch 2/80
 - 2s - loss: 0.1954
Epoch 3/80
 - 2s - loss: 0.1645
Epoch 4/80
 - 2s - loss: 0.1481
Epoch 5/80
 - 2s - loss: 0.1357
Epoch 6/80
 - 2s - loss: 0.1258
Epoch 7/80
 - 2s - loss: 0.1166
Epoch 8/80
 - 2s - loss: 0.1068
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:31:13.995785: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:31:14.165645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:31:14.165706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:31:14.469313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:31:14.469368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:31:14.469378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:31:14.469641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0992
Epoch 2/80
 - 2s - loss: 0.1972
Epoch 3/80
 - 2s - loss: 0.1653
Epoch 4/80
 - 2s - loss: 0.1503
Epoch 5/80
 - 2s - loss: 0.1354
Epoch 6/80
 - 2s - loss: 0.1226
Epoch 7/80
 - 2s - loss: 0.1120
Epoch 8/80
 - 2s - loss: 0.1029
Epoch 9/80
 - 2s - loss: 0.0946
Epoch 10/80
 - 2s - loss: 0.0875
Epoch 11/80
 - 2s - loss: 0.0815
Epoch 12/80
 - 2s - loss: 0.0762
Epoch 13/80
 - 2s - loss: 0.0717
Epoch 14/80
 - 2s - loss: 0.0679
Epoch 15/80
 - 2s - loss: 0.0646
Epoch 16/80
 - 2s - loss: 0.0619
Epoch 17/80
 - 2s - loss: 0.0596
Epoch 18/80
 - 2s - loss: 0.0576
Epoch 19/80
 - 2s - loss: 0.0560
Epoch 20/80
 - 2s - loss: 0.0546
Epoch 21/80
 - 2s - loss: 0.0533
Epoch 22/80
 - 2s - loss: 0.0522
Epoch 23/80
 - 2s - loss: 0.0512
Epoch 24/80
 - 2s - loss: 0.0504
Epoch 25/80
 - 2s - loss: 0.0496
Epoch 26/80
 - 2s - loss: 0.0489
Epoch 27/80
 - 2s - loss: 0.0484
Epoch 28/80
 - 2s - loss: 0.0479
Epoch 29/80
 - 2s - loss: 0.0474
Epoch 30/80
 - 2s - loss: 0.0470
Epoch 31/80
 - 2s - loss: 0.0467
Epoch 32/80
 - 2s - loss: 0.0464
Epoch 33/80
 - 2s - loss: 0.0461
Epoch 34/80
 - 2s - loss: 0.0459
Epoch 35/80
 - 2s - loss: 0.0457
Epoch 36/80
 - 2s - loss: 0.0455
Epoch 37/80
 - 2s - loss: 0.0453
Epoch 38/80
 - 2s - loss: 0.0451
Epoch 39/80
 - 2s - loss: 0.0450
Epoch 40/80
 - 2s - loss: 0.0448
Epoch 41/80
 - 2s - loss: 0.0447
Epoch 42/80
 - 2s - loss: 0.0446
Epoch 43/80
 - 2s - loss: 0.0445
Epoch 44/80
 - 2s - loss: 0.0444
Epoch 45/80
 - 2s - loss: 0.0443
Epoch 46/80
 - 2s - loss: 0.0442
Epoch 47/80
 - 2s - loss: 0.0442
Epoch 48/80
 - 2s - loss: 0.0441
Epoch 49/80
 - 2s - loss: 0.0440
Epoch 50/80
 - 2s - loss: 0.0440
Epoch 51/80
 - 2s - loss: 0.0439
Epoch 52/80
 - 2s - loss: 0.0438
Epoch 53/80
 - 2s - loss: 0.0438
Epoch 54/80
 - 2s - loss: 0.0438
Epoch 55/80
 - 2s - loss: 0.0437
Epoch 56/80
 - 2s - loss: 0.0437
Epoch 57/80
 - 2s - loss: 0.0436
Epoch 58/80
 - 2s - loss: 0.0436
Epoch 59/80
 - 2s - loss: 0.0436
Epoch 60/80
 - 2s - loss: 0.0435
Epoch 61/80
 - 2s - loss: 0.0435
Epoch 62/80
 - 2s - loss: 0.0435
Epoch 63/80
 - 2s - loss: 0.0434
Epoch 64/80
 - 2s - loss: 0.0422
Epoch 65/80
 - 2s - loss: 0.0421
Epoch 66/80
 - 2s - loss: 0.0420
Epoch 67/80
 - 2s - loss: 0.0420
Epoch 68/80
 - 2s - loss: 0.0420
Epoch 69/80
 - 2s - loss: 0.0417
Epoch 70/80
 - 2s - loss: 0.0417
Epoch 71/80
 - 2s - loss: 0.0417
Epoch 72/80
 - 2s - loss: 0.0417
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1116, in save_weights
    saving.save_weights_to_hdf5_group(f, self.layers)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/saving.py", line 446, in save_weights_to_hdf5_group
    g = f.create_group(layer.name)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/group.py", line 60, in create_group
    gid = h5g.create(self.id, name, lcpl=lcpl, gcpl=gcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5g.pyx", line 161, in h5py.h5g.create
ValueError: Unable to create group (name already exists)
2019-03-08 08:33:55.762855: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:33:55.951192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:33:55.951252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:33:56.300290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:33:56.300336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:33:56.300345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:33:56.300683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0570
Epoch 2/80
 - 2s - loss: 0.1933
Epoch 3/80
 - 2s - loss: 0.1674
Epoch 4/80
 - 2s - loss: 0.1541
Epoch 5/80
 - 2s - loss: 0.1413
Epoch 6/80
 - 2s - loss: 0.1294
Epoch 7/80
 - 2s - loss: 0.1181
Epoch 8/80
 - 2s - loss: 0.1080
Epoch 9/80
 - 2s - loss: 0.0990
Epoch 10/80
 - 2s - loss: 0.0911
Epoch 11/80
 - 2s - loss: 0.0840
Epoch 12/80
 - 2s - loss: 0.0779
Epoch 13/80
 - 2s - loss: 0.0729
Epoch 14/80
 - 2s - loss: 0.0686
Epoch 15/80
 - 2s - loss: 0.0651
Epoch 16/80
 - 2s - loss: 0.0622
Epoch 17/80
 - 2s - loss: 0.0597
Epoch 18/80
 - 2s - loss: 0.0576
Epoch 19/80
 - 2s - loss: 0.0558
Epoch 20/80
 - 2s - loss: 0.0543
Epoch 21/80
 - 2s - loss: 0.0529
Epoch 22/80
 - 2s - loss: 0.0518
Epoch 23/80
 - 2s - loss: 0.0509
Epoch 24/80
 - 2s - loss: 0.0500
Epoch 25/80
 - 2s - loss: 0.0493
Epoch 26/80
 - 2s - loss: 0.0487
Epoch 27/80
 - 2s - loss: 0.0481
Epoch 28/80
 - 2s - loss: 0.0476
Epoch 29/80
 - 2s - loss: 0.0472
Epoch 30/80
 - 2s - loss: 0.0468
Epoch 31/80
 - 2s - loss: 0.0465
Epoch 32/80
 - 2s - loss: 0.0462
Epoch 33/80
 - 2s - loss: 0.0460
Epoch 34/80
 - 2s - loss: 0.0457
Epoch 35/80
 - 2s - loss: 0.0455
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:35:26.824431: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:35:26.996555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:35:26.996602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:35:27.300852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:35:27.300908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:35:27.300917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:35:27.301185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6559
Epoch 2/80
 - 2s - loss: 0.1015
Epoch 3/80
 - 2s - loss: 0.0695
Epoch 4/80
 - 2s - loss: 0.0649
Epoch 5/80
 - 2s - loss: 0.0622
Epoch 6/80
 - 2s - loss: 0.0585
Epoch 7/80
 - 2s - loss: 0.0537
Epoch 8/80
 - 2s - loss: 0.0488
Epoch 9/80
 - 2s - loss: 0.0444
Epoch 10/80
 - 2s - loss: 0.0403
Epoch 11/80
 - 2s - loss: 0.0365
Epoch 12/80
 - 2s - loss: 0.0331
Epoch 13/80
 - 2s - loss: 0.0302
Epoch 14/80
 - 2s - loss: 0.0279
Epoch 15/80
 - 2s - loss: 0.0259
Epoch 16/80
 - 2s - loss: 0.0242
Epoch 17/80
 - 2s - loss: 0.0228
Epoch 18/80
 - 2s - loss: 0.0216
Epoch 19/80
 - 2s - loss: 0.0206
Epoch 20/80
 - 2s - loss: 0.0198
Epoch 21/80
 - 2s - loss: 0.0191
Epoch 22/80
 - 2s - loss: 0.0184
Epoch 23/80
 - 2s - loss: 0.0179
Epoch 24/80
 - 2s - loss: 0.0174
Epoch 25/80
 - 2s - loss: 0.0170
Epoch 26/80
 - 2s - loss: 0.0167
Epoch 27/80
 - 2s - loss: 0.0164
Epoch 28/80
 - 2s - loss: 0.0161
Epoch 29/80
 - 2s - loss: 0.0159
Epoch 30/80
 - 2s - loss: 0.0157
Epoch 31/80
 - 2s - loss: 0.0155
Epoch 32/80
 - 2s - loss: 0.0153
Epoch 33/80
 - 2s - loss: 0.0152
Epoch 34/80
 - 2s - loss: 0.0151
Epoch 35/80
 - 2s - loss: 0.0150
Epoch 36/80
 - 2s - loss: 0.0149
Epoch 37/80
 - 2s - loss: 0.0148
Epoch 38/80
 - 2s - loss: 0.0147
Epoch 39/80
 - 2s - loss: 0.0147
Epoch 40/80
 - 2s - loss: 0.0146
Epoch 41/80
 - 2s - loss: 0.0145
Epoch 42/80
 - 2s - loss: 0.0145
Epoch 43/80
 - 2s - loss: 0.0145
Epoch 44/80
 - 2s - loss: 0.0144
Epoch 45/80
 - 2s - loss: 0.0144
Epoch 46/80
 - 2s - loss: 0.0143
Epoch 47/80
 - 2s - loss: 0.0143
Epoch 48/80
 - 2s - loss: 0.0143
Epoch 49/80
 - 2s - loss: 0.0142
Epoch 50/80
 - 2s - loss: 0.0142
Epoch 51/80
 - 2s - loss: 0.0138
Epoch 52/80
 - 2s - loss: 0.0137
Epoch 53/80
 - 2s - loss: 0.0137
Epoch 54/80
 - 2s - loss: 0.0137
Epoch 55/80
 - 2s - loss: 0.0136
Epoch 56/80
 - 2s - loss: 0.0136
Epoch 57/80
 - 2s - loss: 0.0136
Epoch 58/80
 - 2s - loss: 0.0136
Epoch 59/80
 - 2s - loss: 0.0136
Epoch 60/80
 - 2s - loss: 0.0136
Epoch 61/80
 - 2s - loss: 0.0136
Epoch 62/80
 - 2s - loss: 0.0136
Epoch 63/80
 - 2s - loss: 0.0136
Epoch 64/80
 - 2s - loss: 0.0136
Epoch 65/80
 - 2s - loss: 0.0136
Epoch 66/80
 - 2s - loss: 0.0136
Epoch 67/80
 - 2s - loss: 0.0136
Epoch 68/80
 - 2s - loss: 0.0136
Epoch 69/80
 - 2s - loss: 0.0136
Epoch 70/80
 - 2s - loss: 0.0136
Epoch 71/80
 - 2s - loss: 0.0136
Epoch 72/80
 - 2s - loss: 0.0136
Epoch 73/80
 - 2s - loss: 0.0136
Epoch 74/80
 - 2s - loss: 0.0136
Epoch 75/80
 - 2s - loss: 0.0136
Epoch 76/80
 - 2s - loss: 0.0136
Epoch 77/80
 - 2s - loss: 0.0136
Epoch 78/80
 - 2s - loss: 0.0136
Epoch 79/80
 - 2s - loss: 0.0136
Epoch 80/80
 - 2s - loss: 0.0136
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.0650 - val_loss: 1.5187
AUC: 0.7765

Epoch 2/80
 - 0s - loss: 2.2040 - val_loss: 0.8169
AUC: 0.8279

Epoch 3/80
 - 0s - loss: 1.5424 - val_loss: 0.7934
AUC: 0.8410

Epoch 4/80
 - 0s - loss: 1.2550 - val_loss: 0.7971
AUC: 0.8512

Epoch 5/80
 - 0s - loss: 1.1236 - val_loss: 0.6386
AUC: 0.8504

Epoch 6/80
 - 0s - loss: 1.0907 - val_loss: 0.7451
AUC: 0.8541

Epoch 7/80
 - 0s - loss: 1.0836 - val_loss: 0.6913
AUC: 0.8546

Epoch 8/80
 - 0s - loss: 1.0585 - val_loss: 0.6355
AUC: 0.8545

Epoch 9/80
 - 0s - loss: 1.0475 - val_loss: 0.6689
AUC: 0.8600

Epoch 10/80
 - 0s - loss: 1.0339 - val_loss: 0.6643
AUC: 0.8583

Epoch 11/80
 - 0s - loss: 1.0147 - val_loss: 0.6318
AUC: 0.8587

Epoch 12/80
 - 0s - loss: 1.0176 - val_loss: 0.6001
AUC: 0.8602

Epoch 13/80
 - 0s - loss: 1.0185 - val_loss: 0.7232
AUC: 0.8598

Epoch 14/80
 - 0s - loss: 1.0082 - val_loss: 0.6720
AUC: 0.8606

Epoch 15/80
 - 0s - loss: 1.0037 - val_loss: 0.5946
AUC: 0.8596

Epoch 16/80
 - 0s - loss: 0.9984 - val_loss: 0.6072
AUC: 0.8600

Epoch 17/80
 - 0s - loss: 0.9882 - val_loss: 0.6245
AUC: 0.8612

Epoch 18/80
 - 0s - loss: 0.9813 - val_loss: 0.5860
AUC: 0.8610

Epoch 19/80
 - 0s - loss: 0.9786 - val_loss: 0.5787
AUC: 0.8622

Epoch 20/80
 - 0s - loss: 0.9826 - val_loss: 0.6474
AUC: 0.8634

Epoch 21/80
 - 0s - loss: 0.9691 - val_loss: 0.5750
AUC: 0.8627

Epoch 22/80
 - 0s - loss: 0.9740 - val_loss: 0.5417
AUC: 0.8599

Epoch 23/80
 - 0s - loss: 0.9642 - val_loss: 0.6490
AUC: 0.8648

Epoch 24/80
 - 0s - loss: 0.9679 - val_loss: 0.6150
AUC: 0.8631

Epoch 25/80
 - 0s - loss: 0.9555 - val_loss: 0.6091
AUC: 0.8639

Epoch 26/80
 - 0s - loss: 0.9551 - val_loss: 0.6624
AUC: 0.8646

Epoch 27/80
 - 0s - loss: 0.9560 - val_loss: 0.6201
AUC: 0.8637

Epoch 28/80
 - 0s - loss: 0.9459 - val_loss: 0.6636
AUC: 0.8659

Epoch 29/80
 - 0s - loss: 0.9369 - val_loss: 0.5607
AUC: 0.8636

Epoch 30/80
 - 0s - loss: 0.9443 - val_loss: 0.5586
AUC: 0.8638

Epoch 31/80
 - 0s - loss: 0.9307 - val_loss: 0.5749
AUC: 0.8654

Epoch 32/80
 - 0s - loss: 0.9322 - val_loss: 0.5640
AUC: 0.8647

Epoch 33/80
 - 0s - loss: 0.9236 - val_loss: 0.5687
AUC: 0.8659

Epoch 34/80
 - 0s - loss: 0.9079 - val_loss: 0.5952
AUC: 0.8664

Epoch 35/80
 - 0s - loss: 0.9098 - val_loss: 0.6041
AUC: 0.8662

Epoch 36/80
 - 0s - loss: 0.9066 - val_loss: 0.5567
AUC: 0.8654

Epoch 37/80
 - 0s - loss: 0.9111 - val_loss: 0.5965
AUC: 0.8662

Epoch 38/80
 - 0s - loss: 0.9065 - val_loss: 0.5628
AUC: 0.8656

Epoch 39/80
 - 0s - loss: 0.9108 - val_loss: 0.5553
AUC: 0.8653

Epoch 40/80
 - 0s - loss: 0.9061 - val_loss: 0.6154
AUC: 0.8663

Epoch 41/80
 - 0s - loss: 0.9029 - val_loss: 0.6074
AUC: 0.8657

Epoch 42/80
 - 0s - loss: 0.9058 - val_loss: 0.6074
AUC: 0.8662

Epoch 43/80
 - 0s - loss: 0.8959 - val_loss: 0.5908
AUC: 0.8660

Epoch 44/80
 - 0s - loss: 0.9009 - val_loss: 0.5804
AUC: 0.8659

Epoch 45/80
 - 0s - loss: 0.8973 - val_loss: 0.5811
AUC: 0.8661

Epoch 46/80
 - 0s - loss: 0.9032 - val_loss: 0.5868
AUC: 0.8662

Epoch 47/80
 - 0s - loss: 0.8947 - val_loss: 0.5686
AUC: 0.8660

Epoch 48/80
 - 0s - loss: 0.8944 - val_loss: 0.5780
AUC: 0.8660

Epoch 49/80
 - 0s - loss: 0.8973 - val_loss: 0.5784
AUC: 0.8660

Epoch 50/80
 - 0s - loss: 0.8977 - val_loss: 0.5736
AUC: 0.8661

Epoch 51/80
 - 0s - loss: 0.8955 - val_loss: 0.5856
AUC: 0.8662

Epoch 52/80
 - 0s - loss: 0.8957 - val_loss: 0.5817
AUC: 0.8661

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9093 - val_loss: 0.5634
AUC: 0.8659

Epoch 2/30
 - 1s - loss: 0.9099 - val_loss: 0.5949
AUC: 0.8662

Epoch 3/30
 - 1s - loss: 0.9062 - val_loss: 0.5747
AUC: 0.8659

Epoch 4/30
 - 1s - loss: 0.9125 - val_loss: 0.5828
AUC: 0.8666

Epoch 5/30
 - 1s - loss: 0.9009 - val_loss: 0.5791
AUC: 0.8661

Epoch 6/30
 - 1s - loss: 0.8992 - val_loss: 0.5603
AUC: 0.8661

Epoch 7/30
 - 1s - loss: 0.9027 - val_loss: 0.5802
AUC: 0.8663

Epoch 8/30
 - 1s - loss: 0.9019 - val_loss: 0.5790
AUC: 0.8665

Epoch 9/30
 - 1s - loss: 0.8967 - val_loss: 0.5783
AUC: 0.8667

Epoch 10/30
 - 1s - loss: 0.8942 - val_loss: 0.5766
AUC: 0.8665

Epoch 11/30
 - 1s - loss: 0.8945 - val_loss: 0.5866
AUC: 0.8667

Epoch 12/30
 - 1s - loss: 0.8896 - val_loss: 0.6051
AUC: 0.8670

Epoch 13/30
 - 1s - loss: 0.8901 - val_loss: 0.5821
AUC: 0.8667

Epoch 14/30
 - 1s - loss: 0.8895 - val_loss: 0.5954
AUC: 0.8671

Epoch 15/30
 - 1s - loss: 0.8897 - val_loss: 0.5473
AUC: 0.8663

Epoch 16/30
 - 1s - loss: 0.8865 - val_loss: 0.5823
AUC: 0.8669

Epoch 17/30
 - 1s - loss: 0.8864 - val_loss: 0.5888
AUC: 0.8667

Epoch 18/30
 - 1s - loss: 0.8793 - val_loss: 0.5953
AUC: 0.8669

Epoch 19/30
 - 1s - loss: 0.8831 - val_loss: 0.5860
AUC: 0.8667

Epoch 20/30
 - 1s - loss: 0.8798 - val_loss: 0.5720
AUC: 0.8667

Epoch 21/30
 - 1s - loss: 0.8746 - val_loss: 0.5997
AUC: 0.8668

Epoch 22/30
 - 1s - loss: 0.8697 - val_loss: 0.5526
AUC: 0.8664

Epoch 23/30
 - 1s - loss: 0.8755 - val_loss: 0.5561
AUC: 0.8663

Epoch 24/30
 - 1s - loss: 0.8718 - val_loss: 0.5926
AUC: 0.8668

Epoch 25/30
 - 1s - loss: 0.8724 - val_loss: 0.5614
AUC: 0.8667

Epoch 26/30
 - 1s - loss: 0.8663 - val_loss: 0.5700
AUC: 0.8668

Epoch 27/30
 - 1s - loss: 0.8681 - val_loss: 0.5775
AUC: 0.8669

Epoch 28/30
 - 1s - loss: 0.8681 - val_loss: 0.5695
AUC: 0.8667

Epoch 29/30
 - 1s - loss: 0.8640 - val_loss: 0.5728
AUC: 0.8667

Epoch 30/30
 - 1s - loss: 0.8691 - val_loss: 0.5727
Using TensorFlow backend.
AUC: 0.8667

2019-03-08 08:39:27.386836: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:39:27.555469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:39:27.555515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:39:27.860696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:39:27.860750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:39:27.860764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:39:27.861115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6586
Epoch 2/80
 - 2s - loss: 0.1020
Epoch 3/80
 - 2s - loss: 0.0680
Epoch 4/80
 - 2s - loss: 0.0620
Epoch 5/80
 - 2s - loss: 0.0575
Epoch 6/80
 - 2s - loss: 0.0535
Epoch 7/80
 - 2s - loss: 0.0502
Epoch 8/80
 - 2s - loss: 0.0471
Epoch 9/80
 - 2s - loss: 0.0440
Epoch 10/80
 - 2s - loss: 0.0406
Epoch 11/80
 - 2s - loss: 0.0370
Epoch 12/80
 - 2s - loss: 0.0336
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:40:09.886700: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:40:10.059333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:40:10.059378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:40:10.367295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:40:10.367350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:40:10.367359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:40:10.367627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6444
Epoch 2/80
 - 2s - loss: 0.1024
Epoch 3/80
 - 2s - loss: 0.0696
Epoch 4/80
 - 2s - loss: 0.0644
Epoch 5/80
 - 2s - loss: 0.0611
Epoch 6/80
 - 2s - loss: 0.0571
Epoch 7/80
 - 2s - loss: 0.0524
Epoch 8/80
 - 2s - loss: 0.0475
Epoch 9/80
 - 2s - loss: 0.0429
Epoch 10/80
 - 2s - loss: 0.0387
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:40:52.238505: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:40:52.407911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:40:52.407959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:40:52.712906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:40:52.712963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:40:52.712973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:40:52.713254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1985
Epoch 2/80
 - 2s - loss: 0.3173
Epoch 3/80
 - 2s - loss: 0.2868
Epoch 4/80
 - 2s - loss: 0.2504
Epoch 5/80
 - 2s - loss: 0.2163
Epoch 6/80
 - 2s - loss: 0.1925
Epoch 7/80
 - 2s - loss: 0.1745
Epoch 8/80
 - 2s - loss: 0.1600
Epoch 9/80
 - 2s - loss: 0.1482
Epoch 10/80
 - 2s - loss: 0.1387
Epoch 11/80
 - 2s - loss: 0.1310
Epoch 12/80
 - 2s - loss: 0.1248
Epoch 13/80
 - 2s - loss: 0.1197
Epoch 14/80
 - 2s - loss: 0.1155
Epoch 15/80
 - 2s - loss: 0.1118
Epoch 16/80
 - 2s - loss: 0.1086
Epoch 17/80
 - 2s - loss: 0.1058
Epoch 18/80
 - 2s - loss: 0.1034
Epoch 19/80
 - 2s - loss: 0.1012
Epoch 20/80
 - 2s - loss: 0.0993
Epoch 21/80
 - 2s - loss: 0.0977
Epoch 22/80
 - 2s - loss: 0.0963
Epoch 23/80
 - 2s - loss: 0.0951
Epoch 24/80
 - 2s - loss: 0.0940
Epoch 25/80
 - 2s - loss: 0.0931
Epoch 26/80
 - 2s - loss: 0.0923
Epoch 27/80
 - 2s - loss: 0.0916
Epoch 28/80
 - 2s - loss: 0.0911
Epoch 29/80
 - 2s - loss: 0.0905
Epoch 30/80
 - 2s - loss: 0.0901
Epoch 31/80
 - 2s - loss: 0.0897
Epoch 32/80
 - 2s - loss: 0.0893
Epoch 33/80
 - 2s - loss: 0.0890
Epoch 34/80
 - 2s - loss: 0.0887
Epoch 35/80
 - 2s - loss: 0.0884
Epoch 36/80
 - 2s - loss: 0.0882
Epoch 37/80
 - 2s - loss: 0.0879
Epoch 38/80
 - 2s - loss: 0.0877
Epoch 39/80
 - 2s - loss: 0.0875
Epoch 40/80
 - 2s - loss: 0.0874
Epoch 41/80
 - 2s - loss: 0.0872
Epoch 42/80
 - 2s - loss: 0.0871
Epoch 43/80
 - 2s - loss: 0.0869
Epoch 44/80
 - 2s - loss: 0.0868
Epoch 45/80
 - 2s - loss: 0.0867
Epoch 46/80
 - 2s - loss: 0.0865
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:42:44.403645: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:42:44.569624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:42:44.569670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:42:44.873829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:42:44.873884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:42:44.873894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:42:44.874158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2060
Epoch 2/80
 - 2s - loss: 0.3183
Epoch 3/80
 - 2s - loss: 0.2759
Epoch 4/80
 - 2s - loss: 0.2378
Epoch 5/80
 - 2s - loss: 0.2115
Epoch 6/80
 - 2s - loss: 0.1920
Epoch 7/80
 - 2s - loss: 0.1761
Epoch 8/80
 - 2s - loss: 0.1624
Epoch 9/80
 - 2s - loss: 0.1505
Epoch 10/80
 - 2s - loss: 0.1404
Epoch 11/80
 - 2s - loss: 0.1321
Epoch 12/80
 - 2s - loss: 0.1254
Epoch 13/80
 - 2s - loss: 0.1200
Epoch 14/80
 - 2s - loss: 0.1155
Epoch 15/80
 - 2s - loss: 0.1117
Epoch 16/80
 - 2s - loss: 0.1083
Epoch 17/80
 - 2s - loss: 0.1054
Epoch 18/80
 - 2s - loss: 0.1030
Epoch 19/80
 - 2s - loss: 0.1008
Epoch 20/80
 - 2s - loss: 0.0989
Epoch 21/80
 - 2s - loss: 0.0973
Epoch 22/80
 - 2s - loss: 0.0959
Epoch 23/80
 - 2s - loss: 0.0948
Epoch 24/80
 - 2s - loss: 0.0938
Epoch 25/80
 - 2s - loss: 0.0929
Epoch 26/80
 - 2s - loss: 0.0921
Epoch 27/80
 - 2s - loss: 0.0914
Epoch 28/80
 - 2s - loss: 0.0909
Epoch 29/80
 - 2s - loss: 0.0904
Epoch 30/80
 - 2s - loss: 0.0899
Epoch 31/80
 - 2s - loss: 0.0895
Epoch 32/80
 - 2s - loss: 0.0891
Epoch 33/80
 - 2s - loss: 0.0888
Epoch 34/80
 - 2s - loss: 0.0885
Epoch 35/80
 - 2s - loss: 0.0883
Epoch 36/80
 - 2s - loss: 0.0880
Epoch 37/80
 - 2s - loss: 0.0878
Epoch 38/80
 - 2s - loss: 0.0876
Epoch 39/80
 - 2s - loss: 0.0874
Epoch 40/80
 - 2s - loss: 0.0872
Epoch 41/80
 - 2s - loss: 0.0870
Epoch 42/80
 - 2s - loss: 0.0869
Epoch 43/80
 - 2s - loss: 0.0868
Epoch 44/80
 - 2s - loss: 0.0867
Epoch 45/80
 - 2s - loss: 0.0865
Epoch 46/80
 - 2s - loss: 0.0864
Epoch 47/80
 - 2s - loss: 0.0863
Epoch 48/80
 - 2s - loss: 0.0862
Epoch 49/80
 - 2s - loss: 0.0861
Epoch 50/80
 - 2s - loss: 0.0860
Epoch 51/80
 - 2s - loss: 0.0859
Epoch 52/80
 - 2s - loss: 0.0859
Epoch 53/80
 - 2s - loss: 0.0858
Epoch 54/80
 - 2s - loss: 0.0857
Epoch 55/80
 - 2s - loss: 0.0856
Epoch 56/80
 - 2s - loss: 0.0856
Epoch 57/80
 - 2s - loss: 0.0855
Epoch 58/80
 - 2s - loss: 0.0855
Epoch 59/80
 - 2s - loss: 0.0854
Epoch 60/80
 - 2s - loss: 0.0854
Epoch 61/80
 - 2s - loss: 0.0853
Epoch 62/80
 - 2s - loss: 0.0853
Epoch 63/80
 - 2s - loss: 0.0852
Epoch 64/80
 - 2s - loss: 0.0852
Epoch 65/80
 - 2s - loss: 0.0852
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:45:09.472382: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:45:09.640419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:45:09.640465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:45:09.944660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:45:09.944721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:45:09.944731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:45:09.945018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2342
Epoch 2/80
 - 2s - loss: 0.3152
Epoch 3/80
 - 2s - loss: 0.2680
Epoch 4/80
 - 2s - loss: 0.2282
Epoch 5/80
 - 2s - loss: 0.2028
Epoch 6/80
 - 2s - loss: 0.1844
Epoch 7/80
 - 2s - loss: 0.1692
Epoch 8/80
 - 2s - loss: 0.1565
Epoch 9/80
 - 2s - loss: 0.1461
Epoch 10/80
 - 2s - loss: 0.1375
Epoch 11/80
 - 2s - loss: 0.1305
Epoch 12/80
 - 2s - loss: 0.1247
Epoch 13/80
 - 2s - loss: 0.1198
Epoch 14/80
 - 2s - loss: 0.1155
Epoch 15/80
 - 2s - loss: 0.1117
Epoch 16/80
 - 2s - loss: 0.1085
Epoch 17/80
 - 2s - loss: 0.1056
Epoch 18/80
 - 2s - loss: 0.1031
Epoch 19/80
 - 2s - loss: 0.1010
Epoch 20/80
 - 2s - loss: 0.0992
Epoch 21/80
 - 2s - loss: 0.0976
Epoch 22/80
 - 2s - loss: 0.0962
Epoch 23/80
 - 2s - loss: 0.0950
Epoch 24/80
 - 2s - loss: 0.0941
Epoch 25/80
 - 2s - loss: 0.0932
Epoch 26/80
 - 2s - loss: 0.0925
Epoch 27/80
 - 2s - loss: 0.0918
Epoch 28/80
 - 2s - loss: 0.0912
Epoch 29/80
 - 2s - loss: 0.0907
Epoch 30/80
 - 2s - loss: 0.0903
Epoch 31/80
 - 2s - loss: 0.0899
Epoch 32/80
 - 2s - loss: 0.0896
Epoch 33/80
 - 2s - loss: 0.0892
Epoch 34/80
 - 2s - loss: 0.0890
Epoch 35/80
 - 2s - loss: 0.0887
Epoch 36/80
 - 2s - loss: 0.0885
Epoch 37/80
 - 2s - loss: 0.0883
Epoch 38/80
 - 2s - loss: 0.0881
Epoch 39/80
 - 2s - loss: 0.0879
Epoch 40/80
 - 2s - loss: 0.0877
Epoch 41/80
 - 2s - loss: 0.0876
Epoch 42/80
 - 2s - loss: 0.0874
Epoch 43/80
 - 2s - loss: 0.0873
Epoch 44/80
 - 2s - loss: 0.0872
Epoch 45/80
 - 2s - loss: 0.0871
Epoch 46/80
 - 2s - loss: 0.0870
Epoch 47/80
 - 2s - loss: 0.0868
Epoch 48/80
 - 2s - loss: 0.0868
Epoch 49/80
 - 2s - loss: 0.0867
Epoch 50/80
 - 2s - loss: 0.0866
Epoch 51/80
 - 2s - loss: 0.0865
Epoch 52/80
 - 2s - loss: 0.0864
Epoch 53/80
 - 2s - loss: 0.0864
Epoch 54/80
 - 2s - loss: 0.0863
Epoch 55/80
 - 2s - loss: 0.0862
Epoch 56/80
 - 2s - loss: 0.0862
Epoch 57/80
 - 2s - loss: 0.0861
Epoch 58/80
 - 2s - loss: 0.0861
Epoch 59/80
 - 2s - loss: 0.0860
Epoch 60/80
 - 2s - loss: 0.0859
Epoch 61/80
 - 2s - loss: 0.0859
Epoch 62/80
 - 2s - loss: 0.0858
Epoch 63/80
 - 2s - loss: 0.0858
Epoch 64/80
 - 2s - loss: 0.0858
Epoch 65/80
 - 2s - loss: 0.0857
Epoch 66/80
 - 2s - loss: 0.0857
Epoch 67/80
 - 2s - loss: 0.0857
Epoch 68/80
 - 2s - loss: 0.0856
Epoch 69/80
 - 2s - loss: 0.0856
Epoch 70/80
 - 2s - loss: 0.0856
Epoch 71/80
 - 2s - loss: 0.0855
Epoch 72/80
 - 2s - loss: 0.0855
Epoch 73/80
 - 2s - loss: 0.0854
Epoch 74/80
 - 2s - loss: 0.0855
Epoch 75/80
 - 2s - loss: 0.0821
Epoch 76/80
 - 2s - loss: 0.0818
Epoch 77/80
 - 2s - loss: 0.0818
Epoch 78/80
 - 2s - loss: 0.0818
Epoch 79/80
 - 2s - loss: 0.0817
Epoch 80/80
 - 2s - loss: 0.0809
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.6658 - val_loss: 1.3725
AUC: 0.7836

Epoch 2/80
 - 0s - loss: 2.2716 - val_loss: 0.9500
AUC: 0.8106

Epoch 3/80
 - 0s - loss: 1.4853 - val_loss: 0.7482
AUC: 0.8161

Epoch 4/80
 - 0s - loss: 1.3154 - val_loss: 0.8129
AUC: 0.8267

Epoch 5/80
 - 0s - loss: 1.2360 - val_loss: 0.6669
AUC: 0.8325

Epoch 6/80
 - 0s - loss: 1.2102 - val_loss: 0.6819
AUC: 0.8404

Epoch 7/80
 - 0s - loss: 1.1706 - val_loss: 0.6663
AUC: 0.8443

Epoch 8/80
 - 0s - loss: 1.1491 - val_loss: 0.7289
AUC: 0.8498

Epoch 9/80
 - 0s - loss: 1.1355 - val_loss: 0.7030
AUC: 0.8502

Epoch 10/80
 - 0s - loss: 1.1205 - val_loss: 0.6370
AUC: 0.8522

Epoch 11/80
 - 0s - loss: 1.1098 - val_loss: 0.6302
AUC: 0.8533

Epoch 12/80
 - 0s - loss: 1.0978 - val_loss: 0.6126
AUC: 0.8538

Epoch 13/80
 - 0s - loss: 1.0869 - val_loss: 0.6560
AUC: 0.8547

Epoch 14/80
 - 0s - loss: 1.0791 - val_loss: 0.6476
AUC: 0.8549

Epoch 15/80
 - 0s - loss: 1.0673 - val_loss: 0.6629
AUC: 0.8564

Epoch 16/80
 - 0s - loss: 1.0641 - val_loss: 0.6451
AUC: 0.8557

Epoch 17/80
 - 0s - loss: 1.0579 - val_loss: 0.7115
AUC: 0.8565

Epoch 18/80
 - 0s - loss: 1.0617 - val_loss: 0.6765
AUC: 0.8574

Epoch 19/80
 - 0s - loss: 1.0522 - val_loss: 0.6592
AUC: 0.8588

Epoch 20/80
 - 0s - loss: 1.0451 - val_loss: 0.6822
AUC: 0.8586

Epoch 21/80
 - 0s - loss: 1.0474 - val_loss: 0.6302
AUC: 0.8585

Epoch 22/80
 - 0s - loss: 1.0389 - val_loss: 0.6503
AUC: 0.8591

Epoch 23/80
 - 0s - loss: 1.0337 - val_loss: 0.6297
AUC: 0.8593

Epoch 24/80
 - 0s - loss: 1.0314 - val_loss: 0.6284
AUC: 0.8594

Epoch 25/80
 - 0s - loss: 1.0237 - val_loss: 0.6215
AUC: 0.8597

Epoch 26/80
 - 0s - loss: 1.0233 - val_loss: 0.6284
AUC: 0.8597

Epoch 27/80
 - 0s - loss: 1.0253 - val_loss: 0.6065
AUC: 0.8596

Epoch 28/80
 - 0s - loss: 1.0279 - val_loss: 0.6193
AUC: 0.8599

Epoch 29/80
 - 0s - loss: 1.0234 - val_loss: 0.6368
AUC: 0.8604

Epoch 30/80
 - 0s - loss: 1.0251 - val_loss: 0.6251
AUC: 0.8601

Epoch 31/80
 - 0s - loss: 1.0254 - val_loss: 0.6200
AUC: 0.8603

Epoch 32/80
 - 0s - loss: 1.0294 - val_loss: 0.6385
AUC: 0.8604

Epoch 33/80
 - 0s - loss: 1.0230 - val_loss: 0.6371
AUC: 0.8606

Epoch 34/80
 - 0s - loss: 1.0248 - val_loss: 0.6191
AUC: 0.8603

Epoch 35/80
 - 0s - loss: 1.0229 - val_loss: 0.6350
AUC: 0.8608

Epoch 36/80
 - 0s - loss: 1.0188 - val_loss: 0.6181
AUC: 0.8606

Epoch 37/80
 - 0s - loss: 1.0123 - val_loss: 0.6044
AUC: 0.8604

Epoch 38/80
 - 0s - loss: 1.0206 - val_loss: 0.6019
AUC: 0.8604

Epoch 39/80
 - 0s - loss: 1.0130 - val_loss: 0.6396
AUC: 0.8606

Epoch 40/80
 - 0s - loss: 1.0171 - val_loss: 0.6287
AUC: 0.8607

Epoch 41/80
 - 0s - loss: 1.0161 - val_loss: 0.6267
AUC: 0.8608

Epoch 42/80
 - 0s - loss: 1.0157 - val_loss: 0.6183
AUC: 0.8609

Epoch 43/80
 - 0s - loss: 1.0152 - val_loss: 0.6217
AUC: 0.8614

Epoch 44/80
 - 0s - loss: 1.0173 - val_loss: 0.6283
AUC: 0.8612

Epoch 45/80
 - 0s - loss: 1.0126 - val_loss: 0.6278
AUC: 0.8614

Epoch 46/80
 - 0s - loss: 1.0145 - val_loss: 0.6355
AUC: 0.8613

Epoch 47/80
 - 0s - loss: 1.0194 - val_loss: 0.6141
AUC: 0.8608

Epoch 48/80
 - 0s - loss: 1.0035 - val_loss: 0.6219
AUC: 0.8611

Epoch 49/80
 - 0s - loss: 1.0127 - val_loss: 0.6222
AUC: 0.8611

Epoch 50/80
 - 0s - loss: 1.0097 - val_loss: 0.6249
AUC: 0.8613

Epoch 51/80
 - 0s - loss: 1.0103 - val_loss: 0.6246
AUC: 0.8614

Epoch 52/80
 - 0s - loss: 1.0126 - val_loss: 0.6245
AUC: 0.8614

Epoch 53/80
 - 0s - loss: 1.0115 - val_loss: 0.6192
AUC: 0.8614

Epoch 54/80
 - 0s - loss: 1.0136 - val_loss: 0.6236
AUC: 0.8615

Epoch 55/80
 - 0s - loss: 1.0090 - val_loss: 0.6178
AUC: 0.8614

Epoch 56/80
 - 0s - loss: 1.0099 - val_loss: 0.6233
AUC: 0.8614

Epoch 57/80
 - 0s - loss: 1.0173 - val_loss: 0.6212
AUC: 0.8614

Epoch 58/80
 - 0s - loss: 1.0051 - val_loss: 0.6263
AUC: 0.8615

Epoch 59/80
 - 0s - loss: 1.0067 - val_loss: 0.6258
AUC: 0.8615

Epoch 60/80
 - 0s - loss: 1.0102 - val_loss: 0.6227
AUC: 0.8615

Epoch 61/80
 - 0s - loss: 1.0100 - val_loss: 0.6229
AUC: 0.8615

Epoch 62/80
 - 0s - loss: 1.0062 - val_loss: 0.6209
AUC: 0.8615

Epoch 63/80
 - 0s - loss: 1.0079 - val_loss: 0.6196
AUC: 0.8615

Epoch 64/80
 - 0s - loss: 1.0082 - val_loss: 0.6199
AUC: 0.8615

Epoch 65/80
 - 0s - loss: 1.0087 - val_loss: 0.6193
AUC: 0.8615

Epoch 66/80
 - 0s - loss: 1.0103 - val_loss: 0.6218
AUC: 0.8615

Epoch 67/80
 - 0s - loss: 1.0088 - val_loss: 0.6227
AUC: 0.8615

Epoch 68/80
 - 0s - loss: 1.0126 - val_loss: 0.6232
AUC: 0.8615

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0106 - val_loss: 0.6285
AUC: 0.8619

Epoch 2/30
 - 0s - loss: 1.0104 - val_loss: 0.6127
AUC: 0.8618

Epoch 3/30
 - 0s - loss: 1.0118 - val_loss: 0.6303
AUC: 0.8620

Epoch 4/30
 - 0s - loss: 1.0031 - val_loss: 0.6217
AUC: 0.8621

Epoch 5/30
 - 0s - loss: 1.0014 - val_loss: 0.6256
AUC: 0.8624

Epoch 6/30
 - 0s - loss: 0.9990 - val_loss: 0.6101
AUC: 0.8624

Epoch 7/30
 - 0s - loss: 1.0010 - val_loss: 0.6241
AUC: 0.8627

Epoch 8/30
 - 0s - loss: 1.0025 - val_loss: 0.6067
AUC: 0.8627

Epoch 9/30
 - 0s - loss: 0.9996 - val_loss: 0.6454
AUC: 0.8631

Epoch 10/30
 - 0s - loss: 0.9914 - val_loss: 0.6170
AUC: 0.8630

Epoch 11/30
 - 0s - loss: 0.9938 - val_loss: 0.6041
AUC: 0.8631

Epoch 12/30
 - 0s - loss: 0.9913 - val_loss: 0.6160
AUC: 0.8633

Epoch 13/30
 - 0s - loss: 0.9936 - val_loss: 0.6177
AUC: 0.8635

Epoch 14/30
 - 0s - loss: 0.9871 - val_loss: 0.6199
AUC: 0.8635

Epoch 15/30
 - 0s - loss: 0.9907 - val_loss: 0.6185
AUC: 0.8638

Epoch 16/30
 - 0s - loss: 0.9898 - val_loss: 0.6174
AUC: 0.8639

Epoch 17/30
 - 0s - loss: 0.9816 - val_loss: 0.6233
AUC: 0.8640

Epoch 18/30
 - 0s - loss: 0.9821 - val_loss: 0.5971
AUC: 0.8637

Epoch 19/30
 - 0s - loss: 0.9861 - val_loss: 0.6173
AUC: 0.8641

Epoch 20/30
 - 0s - loss: 0.9825 - val_loss: 0.6261
AUC: 0.8645

Epoch 21/30
 - 0s - loss: 0.9797 - val_loss: 0.6175
AUC: 0.8645

Epoch 22/30
 - 0s - loss: 0.9797 - val_loss: 0.6145
AUC: 0.8644

Epoch 23/30
 - 0s - loss: 0.9780 - val_loss: 0.6109
AUC: 0.8645

Epoch 24/30
 - 0s - loss: 0.9755 - val_loss: 0.6096
AUC: 0.8645

Epoch 25/30
 - 0s - loss: 0.9778 - val_loss: 0.6042
AUC: 0.8646

Epoch 26/30
 - 0s - loss: 0.9751 - val_loss: 0.5941
AUC: 0.8647

Epoch 27/30
 - 0s - loss: 0.9704 - val_loss: 0.6170
AUC: 0.8650

Epoch 28/30
 - 0s - loss: 0.9712 - val_loss: 0.6118
AUC: 0.8650

Epoch 29/30
 - 0s - loss: 0.9695 - val_loss: 0.6115
AUC: 0.8651

Epoch 30/30
 - 0s - loss: 0.9707 - val_loss: 0.5992
Using TensorFlow backend.
AUC: 0.8650

2019-03-08 08:49:16.013689: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:49:16.184302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:49:16.184348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:49:16.487824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:49:16.487895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:49:16.487905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:49:16.488183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9863
Epoch 2/80
 - 2s - loss: 0.1802
Epoch 3/80
 - 2s - loss: 0.1514
Epoch 4/80
 - 2s - loss: 0.1289
Epoch 5/80
 - 2s - loss: 0.1143
Epoch 6/80
 - 2s - loss: 0.1025
Epoch 7/80
 - 2s - loss: 0.0924
Epoch 8/80
 - 2s - loss: 0.0837
Epoch 9/80
 - 2s - loss: 0.0763
Epoch 10/80
 - 2s - loss: 0.0699
Epoch 11/80
 - 2s - loss: 0.0648
Epoch 12/80
 - 2s - loss: 0.0607
Epoch 13/80
 - 2s - loss: 0.0574
Epoch 14/80
 - 2s - loss: 0.0547
Epoch 15/80
 - 2s - loss: 0.0524
Epoch 16/80
 - 2s - loss: 0.0504
Epoch 17/80
 - 2s - loss: 0.0487
Epoch 18/80
 - 2s - loss: 0.0472
Epoch 19/80
 - 2s - loss: 0.0459
Epoch 20/80
 - 2s - loss: 0.0447
Epoch 21/80
 - 2s - loss: 0.0437
Epoch 22/80
 - 2s - loss: 0.0428
Epoch 23/80
 - 2s - loss: 0.0420
Epoch 24/80
 - 2s - loss: 0.0414
Epoch 25/80
 - 2s - loss: 0.0408
Epoch 26/80
 - 2s - loss: 0.0403
Epoch 27/80
 - 2s - loss: 0.0398
Epoch 28/80
 - 2s - loss: 0.0394
Epoch 29/80
 - 2s - loss: 0.0391
Epoch 30/80
 - 2s - loss: 0.0388
Epoch 31/80
 - 2s - loss: 0.0385
Epoch 32/80
 - 2s - loss: 0.0383
Epoch 33/80
 - 2s - loss: 0.0381
Epoch 34/80
 - 2s - loss: 0.0379
Epoch 35/80
 - 2s - loss: 0.0377
Epoch 36/80
 - 2s - loss: 0.0376
Epoch 37/80
 - 2s - loss: 0.0374
Epoch 38/80
 - 2s - loss: 0.0373
Epoch 39/80
 - 2s - loss: 0.0372
Epoch 40/80
 - 2s - loss: 0.0371
Epoch 41/80
 - 2s - loss: 0.0370
Epoch 42/80
 - 2s - loss: 0.0369
Epoch 43/80
 - 2s - loss: 0.0369
Epoch 44/80
 - 2s - loss: 0.0368
Epoch 45/80
 - 2s - loss: 0.0367
Epoch 46/80
 - 2s - loss: 0.0366
Epoch 47/80
 - 2s - loss: 0.0366
Epoch 48/80
 - 2s - loss: 0.0365
Epoch 49/80
 - 2s - loss: 0.0365
Epoch 50/80
 - 2s - loss: 0.0364
Epoch 51/80
 - 2s - loss: 0.0364
Epoch 52/80
 - 2s - loss: 0.0364
Epoch 53/80
 - 2s - loss: 0.0363
Epoch 54/80
 - 2s - loss: 0.0363
Epoch 55/80
 - 2s - loss: 0.0362
Epoch 56/80
 - 2s - loss: 0.0362
Epoch 57/80
 - 2s - loss: 0.0362
Epoch 58/80
 - 2s - loss: 0.0346
Epoch 59/80
 - 2s - loss: 0.0345
Epoch 60/80
 - 2s - loss: 0.0345
Epoch 61/80
 - 2s - loss: 0.0345
Epoch 62/80
 - 2s - loss: 0.0345
Epoch 63/80
 - 2s - loss: 0.0341
Epoch 64/80
 - 2s - loss: 0.0341
Epoch 65/80
 - 2s - loss: 0.0341
Epoch 66/80
 - 2s - loss: 0.0341
Epoch 67/80
 - 2s - loss: 0.0340
Epoch 68/80
 - 2s - loss: 0.0340
Epoch 69/80
 - 2s - loss: 0.0340
Epoch 70/80
 - 2s - loss: 0.0340
Epoch 71/80
 - 2s - loss: 0.0340
Epoch 72/80
 - 2s - loss: 0.0340
Epoch 73/80
 - 2s - loss: 0.0340
Epoch 74/80
 - 2s - loss: 0.0340
Epoch 75/80
 - 2s - loss: 0.0340
Epoch 76/80
 - 2s - loss: 0.0340
Epoch 77/80
 - 2s - loss: 0.0340
Epoch 78/80
 - 2s - loss: 0.0340
Epoch 79/80
 - 2s - loss: 0.0340
Epoch 80/80
 - 2s - loss: 0.0340
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 6.9604 - val_loss: 2.0223
AUC: 0.7565

Epoch 2/80
 - 0s - loss: 4.5196 - val_loss: 1.8292
AUC: 0.7812

Epoch 3/80
 - 0s - loss: 3.0844 - val_loss: 0.9414
AUC: 0.7955

Epoch 4/80
 - 0s - loss: 2.0053 - val_loss: 0.8860
AUC: 0.8041

Epoch 5/80
 - 0s - loss: 1.5034 - val_loss: 0.7753
AUC: 0.8165

Epoch 6/80
 - 0s - loss: 1.3370 - val_loss: 0.7691
AUC: 0.8251

Epoch 7/80
 - 0s - loss: 1.2915 - val_loss: 0.7721
AUC: 0.8330

Epoch 8/80
 - 0s - loss: 1.2429 - val_loss: 0.7297
AUC: 0.8410

Epoch 9/80
 - 0s - loss: 1.2057 - val_loss: 0.6831
AUC: 0.8447

Epoch 10/80
 - 0s - loss: 1.1787 - val_loss: 0.7628
AUC: 0.8498

Epoch 11/80
 - 0s - loss: 1.1565 - val_loss: 0.7271
AUC: 0.8546

Epoch 12/80
 - 0s - loss: 1.1375 - val_loss: 0.6668
AUC: 0.8562

Epoch 13/80
 - 0s - loss: 1.1296 - val_loss: 0.6808
AUC: 0.8576

Epoch 14/80
 - 0s - loss: 1.1129 - val_loss: 0.6021
AUC: 0.8579

Epoch 15/80
 - 0s - loss: 1.0954 - val_loss: 0.6829
AUC: 0.8610

Epoch 16/80
 - 0s - loss: 1.0987 - val_loss: 0.6853
AUC: 0.8619

Epoch 17/80
 - 0s - loss: 1.0885 - val_loss: 0.6219
AUC: 0.8622

Epoch 18/80
 - 0s - loss: 1.0904 - val_loss: 0.6863
AUC: 0.8635

Epoch 19/80
 - 0s - loss: 1.0779 - val_loss: 0.5893
AUC: 0.8632

Epoch 20/80
 - 0s - loss: 1.0709 - val_loss: 0.5777
AUC: 0.8641

Epoch 21/80
 - 0s - loss: 1.0676 - val_loss: 0.6325
AUC: 0.8652

Epoch 22/80
 - 0s - loss: 1.0651 - val_loss: 0.6524
AUC: 0.8657

Epoch 23/80
 - 0s - loss: 1.0610 - val_loss: 0.6054
AUC: 0.8657

Epoch 24/80
 - 0s - loss: 1.0461 - val_loss: 0.6799
AUC: 0.8680

Epoch 25/80
 - 0s - loss: 1.0560 - val_loss: 0.6551
AUC: 0.8676

Epoch 26/80
 - 0s - loss: 1.0489 - val_loss: 0.6423
AUC: 0.8677

Epoch 27/80
 - 0s - loss: 1.0352 - val_loss: 0.6608
AUC: 0.8688

Epoch 28/80
 - 0s - loss: 1.0480 - val_loss: 0.6936
AUC: 0.8693

Epoch 29/80
 - 0s - loss: 1.0406 - val_loss: 0.5703
AUC: 0.8695

Epoch 30/80
 - 0s - loss: 1.0371 - val_loss: 0.6330
AUC: 0.8701

Epoch 31/80
 - 0s - loss: 1.0340 - val_loss: 0.6443
AUC: 0.8703

Epoch 32/80
 - 0s - loss: 1.0295 - val_loss: 0.6212
AUC: 0.8704

Epoch 33/80
 - 0s - loss: 1.0255 - val_loss: 0.5934
AUC: 0.8707

Epoch 34/80
 - 0s - loss: 1.0234 - val_loss: 0.5595
AUC: 0.8709

Epoch 35/80
 - 0s - loss: 1.0250 - val_loss: 0.5951
AUC: 0.8717

Epoch 36/80
 - 0s - loss: 1.0183 - val_loss: 0.6061
AUC: 0.8713

Epoch 37/80
 - 0s - loss: 1.0185 - val_loss: 0.6045
AUC: 0.8717

Epoch 38/80
 - 0s - loss: 1.0155 - val_loss: 0.6113
AUC: 0.8722

Epoch 39/80
 - 0s - loss: 1.0225 - val_loss: 0.6280
AUC: 0.8727

Epoch 40/80
 - 0s - loss: 1.0138 - val_loss: 0.6419
AUC: 0.8728

Epoch 41/80
 - 0s - loss: 1.0013 - val_loss: 0.6280
AUC: 0.8720

Epoch 42/80
 - 0s - loss: 1.0075 - val_loss: 0.6403
AUC: 0.8727

Epoch 43/80
 - 0s - loss: 1.0059 - val_loss: 0.6019
AUC: 0.8725

Epoch 44/80
 - 0s - loss: 1.0036 - val_loss: 0.5875
AUC: 0.8733

Epoch 45/80
 - 0s - loss: 0.9974 - val_loss: 0.6188
AUC: 0.8733

Epoch 46/80
 - 0s - loss: 1.0006 - val_loss: 0.5955
AUC: 0.8731

Epoch 47/80
 - 0s - loss: 0.9985 - val_loss: 0.6185
AUC: 0.8735

Epoch 48/80
 - 0s - loss: 1.0020 - val_loss: 0.5885
AUC: 0.8735

Epoch 49/80
 - 0s - loss: 0.9920 - val_loss: 0.6024
AUC: 0.8736

Epoch 50/80
 - 0s - loss: 1.0024 - val_loss: 0.6070
AUC: 0.8735

Epoch 51/80
 - 0s - loss: 0.9960 - val_loss: 0.5998
AUC: 0.8734

Epoch 52/80
 - 0s - loss: 0.9971 - val_loss: 0.6167
AUC: 0.8735

Epoch 53/80
 - 0s - loss: 0.9965 - val_loss: 0.6307
AUC: 0.8735

Epoch 54/80
 - 0s - loss: 0.9893 - val_loss: 0.6098
AUC: 0.8738

Epoch 55/80
 - 0s - loss: 0.9955 - val_loss: 0.6033
AUC: 0.8738

Epoch 56/80
 - 0s - loss: 0.9872 - val_loss: 0.6048
AUC: 0.8737

Epoch 57/80
 - 0s - loss: 0.9932 - val_loss: 0.6019
AUC: 0.8737

Epoch 58/80
 - 0s - loss: 0.9949 - val_loss: 0.6024
AUC: 0.8737

Epoch 59/80
 - 0s - loss: 0.9870 - val_loss: 0.5980
AUC: 0.8737

Epoch 60/80
 - 0s - loss: 0.9954 - val_loss: 0.6043
AUC: 0.8737

Epoch 61/80
 - 0s - loss: 0.9894 - val_loss: 0.6045
AUC: 0.8737

Epoch 62/80
 - 0s - loss: 0.9875 - val_loss: 0.6000
AUC: 0.8736

Epoch 63/80
 - 0s - loss: 0.9920 - val_loss: 0.5976
AUC: 0.8737

Epoch 64/80
 - 0s - loss: 0.9906 - val_loss: 0.6026
AUC: 0.8737

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9898 - val_loss: 0.5975
AUC: 0.8735

Epoch 2/30
 - 0s - loss: 0.9879 - val_loss: 0.6023
AUC: 0.8737

Epoch 3/30
 - 0s - loss: 0.9882 - val_loss: 0.6074
AUC: 0.8739

Epoch 4/30
 - 0s - loss: 0.9809 - val_loss: 0.5973
AUC: 0.8737

Epoch 5/30
 - 0s - loss: 0.9807 - val_loss: 0.6022
AUC: 0.8737

Epoch 6/30
 - 0s - loss: 0.9824 - val_loss: 0.5960
AUC: 0.8739

Epoch 7/30
 - 0s - loss: 0.9839 - val_loss: 0.6074
AUC: 0.8740

Epoch 8/30
 - 0s - loss: 0.9786 - val_loss: 0.6032
AUC: 0.8739

Epoch 9/30
 - 0s - loss: 0.9796 - val_loss: 0.6086
AUC: 0.8741

Epoch 10/30
 - 0s - loss: 0.9766 - val_loss: 0.6056
AUC: 0.8743

Epoch 11/30
 - 0s - loss: 0.9796 - val_loss: 0.5900
AUC: 0.8740

Epoch 12/30
 - 0s - loss: 0.9819 - val_loss: 0.5940
AUC: 0.8741

Epoch 13/30
 - 0s - loss: 0.9664 - val_loss: 0.5963
AUC: 0.8741

Epoch 14/30
 - 0s - loss: 0.9682 - val_loss: 0.5809
AUC: 0.8741

Epoch 15/30
 - 0s - loss: 0.9697 - val_loss: 0.5826
AUC: 0.8741

Epoch 16/30
 - 0s - loss: 0.9718 - val_loss: 0.5992
AUC: 0.8746

Epoch 17/30
 - 0s - loss: 0.9691 - val_loss: 0.5947
AUC: 0.8745

Epoch 18/30
 - 0s - loss: 0.9689 - val_loss: 0.5972
AUC: 0.8745

Epoch 19/30
 - 0s - loss: 0.9590 - val_loss: 0.5857
AUC: 0.8743

Epoch 20/30
 - 0s - loss: 0.9601 - val_loss: 0.5802
AUC: 0.8743

Epoch 21/30
 - 0s - loss: 0.9605 - val_loss: 0.5825
AUC: 0.8744

Epoch 22/30
 - 0s - loss: 0.9591 - val_loss: 0.6085
AUC: 0.8746

Epoch 23/30
 - 0s - loss: 0.9569 - val_loss: 0.5756
AUC: 0.8745

Epoch 24/30
 - 0s - loss: 0.9610 - val_loss: 0.5902
AUC: 0.8744

Epoch 25/30
 - 0s - loss: 0.9572 - val_loss: 0.5831
AUC: 0.8744

Epoch 26/30
 - 0s - loss: 0.9625 - val_loss: 0.5866
AUC: 0.8747

Epoch 27/30
 - 0s - loss: 0.9521 - val_loss: 0.5813
AUC: 0.8746

Epoch 28/30
 - 0s - loss: 0.9523 - val_loss: 0.5822
AUC: 0.8747

Epoch 29/30
 - 0s - loss: 0.9533 - val_loss: 0.6003
AUC: 0.8747

Epoch 30/30
 - 0s - loss: 0.9488 - val_loss: 0.5864
Using TensorFlow backend.
AUC: 0.8746

2019-03-08 08:53:18.609528: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:53:18.778540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:53:18.778586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:53:19.083970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:53:19.084037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:53:19.084047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:53:19.084312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9843
Epoch 2/80
 - 2s - loss: 0.1805
Epoch 3/80
 - 2s - loss: 0.1541
Epoch 4/80
 - 2s - loss: 0.1324
Epoch 5/80
 - 2s - loss: 0.1172
Epoch 6/80
 - 2s - loss: 0.1057
Epoch 7/80
 - 2s - loss: 0.0952
Epoch 8/80
 - 2s - loss: 0.0859
Epoch 9/80
 - 2s - loss: 0.0783
Epoch 10/80
 - 2s - loss: 0.0720
Epoch 11/80
 - 2s - loss: 0.0668
Epoch 12/80
 - 2s - loss: 0.0624
Epoch 13/80
 - 2s - loss: 0.0588
Epoch 14/80
 - 2s - loss: 0.0557
Epoch 15/80
 - 2s - loss: 0.0531
Epoch 16/80
 - 2s - loss: 0.0509
Epoch 17/80
 - 2s - loss: 0.0490
Epoch 18/80
 - 2s - loss: 0.0474
Epoch 19/80
 - 2s - loss: 0.0460
Epoch 20/80
 - 2s - loss: 0.0448
Epoch 21/80
 - 2s - loss: 0.0438
Epoch 22/80
 - 2s - loss: 0.0429
Epoch 23/80
 - 2s - loss: 0.0421
Epoch 24/80
 - 2s - loss: 0.0414
Epoch 25/80
 - 2s - loss: 0.0409
Epoch 26/80
 - 2s - loss: 0.0404
Epoch 27/80
 - 2s - loss: 0.0399
Epoch 28/80
 - 2s - loss: 0.0395
Epoch 29/80
 - 2s - loss: 0.0392
Epoch 30/80
 - 2s - loss: 0.0389
Epoch 31/80
 - 2s - loss: 0.0387
Epoch 32/80
 - 2s - loss: 0.0384
Epoch 33/80
 - 2s - loss: 0.0382
Epoch 34/80
 - 2s - loss: 0.0380
Epoch 35/80
 - 2s - loss: 0.0379
Epoch 36/80
 - 2s - loss: 0.0377
Epoch 37/80
 - 2s - loss: 0.0376
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:54:54.598339: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:54:54.768379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:54:54.768426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:54:55.087778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:54:55.087835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:54:55.087844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:54:55.088121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.4 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9800
Epoch 2/80
 - 2s - loss: 0.1832
Epoch 3/80
 - 2s - loss: 0.1624
Epoch 4/80
 - 2s - loss: 0.1414
Epoch 5/80
 - 2s - loss: 0.1213
Epoch 6/80
 - 2s - loss: 0.1066
Epoch 7/80
 - 2s - loss: 0.0954
Epoch 8/80
 - 2s - loss: 0.0864
Epoch 9/80
 - 2s - loss: 0.0788
Epoch 10/80
 - 2s - loss: 0.0724
Epoch 11/80
 - 2s - loss: 0.0671
Epoch 12/80
 - 2s - loss: 0.0627
Epoch 13/80
 - 2s - loss: 0.0592
Epoch 14/80
 - 2s - loss: 0.0562
Epoch 15/80
 - 2s - loss: 0.0536
Epoch 16/80
 - 2s - loss: 0.0514
Epoch 17/80
 - 2s - loss: 0.0495
Epoch 18/80
 - 2s - loss: 0.0479
Epoch 19/80
 - 2s - loss: 0.0465
Epoch 20/80
 - 2s - loss: 0.0453
Epoch 21/80
 - 2s - loss: 0.0443
Epoch 22/80
 - 2s - loss: 0.0434
Epoch 23/80
 - 2s - loss: 0.0426
Epoch 24/80
 - 2s - loss: 0.0419
Epoch 25/80
 - 2s - loss: 0.0413
Epoch 26/80
 - 2s - loss: 0.0407
Epoch 27/80
 - 2s - loss: 0.0402
Epoch 28/80
 - 2s - loss: 0.0399
Epoch 29/80
 - 2s - loss: 0.0395
Epoch 30/80
 - 2s - loss: 0.0392
Epoch 31/80
 - 2s - loss: 0.0389
Epoch 32/80
 - 2s - loss: 0.0386
Epoch 33/80
 - 2s - loss: 0.0384
Epoch 34/80
 - 2s - loss: 0.0382
Epoch 35/80
 - 2s - loss: 0.0380
Epoch 36/80
 - 2s - loss: 0.0379
Epoch 37/80
 - 2s - loss: 0.0377
Epoch 38/80
 - 2s - loss: 0.0376
Epoch 39/80
 - 2s - loss: 0.0375
Epoch 40/80
 - 2s - loss: 0.0374
Epoch 41/80
 - 2s - loss: 0.0373
Epoch 42/80
 - 2s - loss: 0.0372
Epoch 43/80
 - 2s - loss: 0.0371
Epoch 44/80
 - 2s - loss: 0.0370
Epoch 45/80
 - 2s - loss: 0.0369
Epoch 46/80
 - 2s - loss: 0.0369
Epoch 47/80
 - 2s - loss: 0.0368
Epoch 48/80
 - 2s - loss: 0.0367
Epoch 49/80
 - 2s - loss: 0.0367
Epoch 50/80
 - 2s - loss: 0.0366
Epoch 51/80
 - 2s - loss: 0.0366
Epoch 52/80
 - 2s - loss: 0.0365
Epoch 53/80
 - 2s - loss: 0.0365
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:56:59.220647: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:56:59.388561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:56:59.388606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:56:59.696190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:56:59.696239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:56:59.696248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:56:59.696516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9929
Epoch 2/80
 - 2s - loss: 0.1800
Epoch 3/80
 - 2s - loss: 0.1525
Epoch 4/80
 - 2s - loss: 0.1319
Epoch 5/80
 - 2s - loss: 0.1154
Epoch 6/80
 - 2s - loss: 0.1027
Epoch 7/80
 - 2s - loss: 0.0924
Epoch 8/80
 - 2s - loss: 0.0837
Epoch 9/80
 - 2s - loss: 0.0764
Epoch 10/80
 - 2s - loss: 0.0704
Epoch 11/80
 - 2s - loss: 0.0655
Epoch 12/80
 - 2s - loss: 0.0615
Epoch 13/80
 - 2s - loss: 0.0581
Epoch 14/80
 - 2s - loss: 0.0553
Epoch 15/80
 - 2s - loss: 0.0529
Epoch 16/80
 - 2s - loss: 0.0509
Epoch 17/80
 - 2s - loss: 0.0492
Epoch 18/80
 - 2s - loss: 0.0476
Epoch 19/80
 - 2s - loss: 0.0463
Epoch 20/80
 - 2s - loss: 0.0451
Epoch 21/80
 - 2s - loss: 0.0441
Epoch 22/80
 - 2s - loss: 0.0432
Epoch 23/80
 - 2s - loss: 0.0424
Epoch 24/80
 - 2s - loss: 0.0418
Epoch 25/80
 - 2s - loss: 0.0412
Epoch 26/80
 - 2s - loss: 0.0407
Epoch 27/80
 - 2s - loss: 0.0402
Epoch 28/80
 - 2s - loss: 0.0398
Epoch 29/80
 - 2s - loss: 0.0395
Epoch 30/80
 - 2s - loss: 0.0392
Epoch 31/80
 - 2s - loss: 0.0389
Epoch 32/80
 - 2s - loss: 0.0387
Epoch 33/80
 - 2s - loss: 0.0385
Epoch 34/80
 - 2s - loss: 0.0383
Epoch 35/80
 - 2s - loss: 0.0381
Epoch 36/80
 - 2s - loss: 0.0380
Epoch 37/80
 - 2s - loss: 0.0378
Epoch 38/80
 - 2s - loss: 0.0377
Epoch 39/80
 - 2s - loss: 0.0376
Epoch 40/80
 - 2s - loss: 0.0375
Epoch 41/80
 - 2s - loss: 0.0374
Epoch 42/80
 - 2s - loss: 0.0373
Epoch 43/80
 - 2s - loss: 0.0372
Epoch 44/80
 - 2s - loss: 0.0371
Epoch 45/80
 - 2s - loss: 0.0371
Epoch 46/80
 - 2s - loss: 0.0370
Epoch 47/80
 - 2s - loss: 0.0369
Epoch 48/80
 - 2s - loss: 0.0369
Epoch 49/80
 - 2s - loss: 0.0368
Epoch 50/80
 - 2s - loss: 0.0368
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 08:58:56.609998: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 08:58:56.776110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 08:58:56.776157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 08:58:57.082651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 08:58:57.082707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 08:58:57.082717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 08:58:57.083026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.4 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6048
Epoch 2/80
 - 2s - loss: 0.0841
Epoch 3/80
 - 2s - loss: 0.0657
Epoch 4/80
 - 2s - loss: 0.0603
Epoch 5/80
 - 2s - loss: 0.0537
Epoch 6/80
 - 2s - loss: 0.0471
Epoch 7/80
 - 2s - loss: 0.0414
Epoch 8/80
 - 2s - loss: 0.0366
Epoch 9/80
 - 2s - loss: 0.0328
Epoch 10/80
 - 2s - loss: 0.0296
Epoch 11/80
 - 2s - loss: 0.0270
Epoch 12/80
 - 2s - loss: 0.0247
Epoch 13/80
 - 2s - loss: 0.0228
Epoch 14/80
 - 2s - loss: 0.0212
Epoch 15/80
 - 2s - loss: 0.0199
Epoch 16/80
 - 2s - loss: 0.0188
Epoch 17/80
 - 2s - loss: 0.0179
Epoch 18/80
 - 2s - loss: 0.0171
Epoch 19/80
 - 2s - loss: 0.0164
Epoch 20/80
 - 2s - loss: 0.0159
Epoch 21/80
 - 2s - loss: 0.0154
Epoch 22/80
 - 2s - loss: 0.0150
Epoch 23/80
 - 2s - loss: 0.0146
Epoch 24/80
 - 2s - loss: 0.0143
Epoch 25/80
 - 2s - loss: 0.0140
Epoch 26/80
 - 2s - loss: 0.0137
Epoch 27/80
 - 2s - loss: 0.0135
Epoch 28/80
 - 2s - loss: 0.0133
Epoch 29/80
 - 2s - loss: 0.0131
Epoch 30/80
 - 2s - loss: 0.0130
Epoch 31/80
 - 2s - loss: 0.0129
Epoch 32/80
 - 2s - loss: 0.0127
Epoch 33/80
 - 2s - loss: 0.0126
Epoch 34/80
 - 2s - loss: 0.0125
Epoch 35/80
 - 2s - loss: 0.0124
Epoch 36/80
 - 2s - loss: 0.0124
Epoch 37/80
 - 2s - loss: 0.0123
Epoch 38/80
 - 2s - loss: 0.0122
Epoch 39/80
 - 2s - loss: 0.0122
Epoch 40/80
 - 2s - loss: 0.0121
Epoch 41/80
 - 2s - loss: 0.0121
Epoch 42/80
 - 2s - loss: 0.0120
Epoch 43/80
 - 2s - loss: 0.0120
Epoch 44/80
 - 2s - loss: 0.0120
Epoch 45/80
 - 2s - loss: 0.0119
Epoch 46/80
 - 2s - loss: 0.0114
Epoch 47/80
 - 2s - loss: 0.0113
Epoch 48/80
 - 2s - loss: 0.0113
Epoch 49/80
 - 2s - loss: 0.0113
Epoch 50/80
 - 2s - loss: 0.0112
Epoch 51/80
 - 2s - loss: 0.0112
Epoch 52/80
 - 2s - loss: 0.0112
Epoch 53/80
 - 2s - loss: 0.0112
Epoch 54/80
 - 2s - loss: 0.0112
Epoch 55/80
 - 2s - loss: 0.0112
Epoch 56/80
 - 2s - loss: 0.0112
Epoch 57/80
 - 2s - loss: 0.0112
Epoch 58/80
 - 2s - loss: 0.0112
Epoch 59/80
 - 2s - loss: 0.0112
Epoch 60/80
 - 2s - loss: 0.0112
Epoch 61/80
 - 2s - loss: 0.0112
Epoch 62/80
 - 2s - loss: 0.0112
Epoch 63/80
 - 2s - loss: 0.0112
Epoch 64/80
 - 2s - loss: 0.0112
Epoch 65/80
 - 2s - loss: 0.0112
Epoch 66/80
 - 2s - loss: 0.0112
Epoch 67/80
 - 2s - loss: 0.0112
Epoch 68/80
 - 2s - loss: 0.0112
Epoch 69/80
 - 2s - loss: 0.0112
Epoch 70/80
 - 2s - loss: 0.0112
Epoch 71/80
 - 2s - loss: 0.0112
Epoch 72/80
 - 2s - loss: 0.0112
Epoch 73/80
 - 2s - loss: 0.0112
Epoch 74/80
 - 2s - loss: 0.0112
Epoch 75/80
 - 2s - loss: 0.0112
Epoch 76/80
 - 2s - loss: 0.0112
Epoch 77/80
 - 2s - loss: 0.0112
Epoch 78/80
 - 2s - loss: 0.0112
Epoch 79/80
 - 2s - loss: 0.0112
Epoch 80/80
 - 2s - loss: 0.0112
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 7.7140 - val_loss: 2.5323
AUC: 0.6678

Epoch 2/80
 - 0s - loss: 4.6813 - val_loss: 1.3239
AUC: 0.7522

Epoch 3/80
 - 0s - loss: 2.6724 - val_loss: 0.9278
AUC: 0.7933

Epoch 4/80
 - 0s - loss: 1.6976 - val_loss: 0.8024
AUC: 0.8079

Epoch 5/80
 - 0s - loss: 1.3886 - val_loss: 0.6914
AUC: 0.8128

Epoch 6/80
 - 0s - loss: 1.2774 - val_loss: 0.7144
AUC: 0.8202

Epoch 7/80
 - 0s - loss: 1.2316 - val_loss: 0.6732
AUC: 0.8288

Epoch 8/80
 - 0s - loss: 1.1932 - val_loss: 0.6839
AUC: 0.8330

Epoch 9/80
 - 0s - loss: 1.1695 - val_loss: 0.6686
AUC: 0.8387

Epoch 10/80
 - 0s - loss: 1.1395 - val_loss: 0.6758
AUC: 0.8432

Epoch 11/80
 - 0s - loss: 1.1241 - val_loss: 0.7130
AUC: 0.8455

Epoch 12/80
 - 0s - loss: 1.1157 - val_loss: 0.6383
AUC: 0.8488

Epoch 13/80
 - 0s - loss: 1.0971 - val_loss: 0.6881
AUC: 0.8517

Epoch 14/80
 - 0s - loss: 1.0867 - val_loss: 0.6586
AUC: 0.8533

Epoch 15/80
 - 0s - loss: 1.0823 - val_loss: 0.7084
AUC: 0.8546

Epoch 16/80
 - 0s - loss: 1.0688 - val_loss: 0.6004
AUC: 0.8538

Epoch 17/80
 - 0s - loss: 1.0674 - val_loss: 0.6830
AUC: 0.8570

Epoch 18/80
 - 0s - loss: 1.0609 - val_loss: 0.6115
AUC: 0.8565

Epoch 19/80
 - 0s - loss: 1.0567 - val_loss: 0.6554
AUC: 0.8589

Epoch 20/80
 - 0s - loss: 1.0495 - val_loss: 0.6631
AUC: 0.8591

Epoch 21/80
 - 0s - loss: 1.0411 - val_loss: 0.6711
AUC: 0.8604

Epoch 22/80
 - 0s - loss: 1.0372 - val_loss: 0.6510
AUC: 0.8605

Epoch 23/80
 - 0s - loss: 1.0346 - val_loss: 0.6485
AUC: 0.8602

Epoch 24/80
 - 0s - loss: 1.0380 - val_loss: 0.6124
AUC: 0.8602

Epoch 25/80
 - 0s - loss: 1.0249 - val_loss: 0.6377
AUC: 0.8618

Epoch 26/80
 - 0s - loss: 1.0219 - val_loss: 0.6403
AUC: 0.8626

Epoch 27/80
 - 0s - loss: 1.0211 - val_loss: 0.6185
AUC: 0.8621

Epoch 28/80
 - 0s - loss: 1.0175 - val_loss: 0.6300
AUC: 0.8622

Epoch 29/80
 - 0s - loss: 1.0124 - val_loss: 0.6123
AUC: 0.8621

Epoch 30/80
 - 0s - loss: 1.0215 - val_loss: 0.6194
AUC: 0.8621

Epoch 31/80
 - 0s - loss: 1.0180 - val_loss: 0.6157
AUC: 0.8621

Epoch 32/80
 - 0s - loss: 1.0146 - val_loss: 0.6105
AUC: 0.8621

Epoch 33/80
 - 0s - loss: 1.0146 - val_loss: 0.6310
AUC: 0.8626

Epoch 34/80
 - 0s - loss: 1.0119 - val_loss: 0.6405
AUC: 0.8627

Epoch 35/80
 - 0s - loss: 1.0112 - val_loss: 0.6037
AUC: 0.8620

Epoch 36/80
 - 0s - loss: 1.0138 - val_loss: 0.6195
AUC: 0.8624

Epoch 37/80
 - 0s - loss: 1.0098 - val_loss: 0.6177
AUC: 0.8625

Epoch 38/80
 - 0s - loss: 1.0098 - val_loss: 0.6216
AUC: 0.8625

Epoch 39/80
 - 0s - loss: 1.0147 - val_loss: 0.6117
AUC: 0.8624

Epoch 40/80
 - 0s - loss: 1.0124 - val_loss: 0.6173
AUC: 0.8626

Epoch 41/80
 - 0s - loss: 1.0115 - val_loss: 0.6155
AUC: 0.8627

Epoch 42/80
 - 0s - loss: 1.0146 - val_loss: 0.6162
AUC: 0.8628

Epoch 43/80
 - 0s - loss: 1.0096 - val_loss: 0.6203
AUC: 0.8629

Epoch 44/80
 - 0s - loss: 1.0174 - val_loss: 0.6092
AUC: 0.8626

Epoch 45/80
 - 0s - loss: 1.0040 - val_loss: 0.6146
AUC: 0.8627

Epoch 46/80
 - 0s - loss: 1.0092 - val_loss: 0.6154
AUC: 0.8627

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0066 - val_loss: 0.6102
AUC: 0.8626

Epoch 2/30
 - 0s - loss: 1.0099 - val_loss: 0.6101
AUC: 0.8628

Epoch 3/30
 - 0s - loss: 1.0059 - val_loss: 0.6095
AUC: 0.8632

Epoch 4/30
 - 0s - loss: 1.0028 - val_loss: 0.6053
AUC: 0.8632

Epoch 5/30
 - 0s - loss: 1.0082 - val_loss: 0.6266
AUC: 0.8640

Epoch 6/30
 - 0s - loss: 0.9989 - val_loss: 0.6271
AUC: 0.8640

Epoch 7/30
 - 0s - loss: 0.9971 - val_loss: 0.5850
AUC: 0.8631

Epoch 8/30
 - 0s - loss: 1.0017 - val_loss: 0.6122
AUC: 0.8640

Epoch 9/30
 - 0s - loss: 0.9939 - val_loss: 0.5892
AUC: 0.8636

Epoch 10/30
 - 0s - loss: 0.9910 - val_loss: 0.5916
AUC: 0.8638

Epoch 11/30
 - 0s - loss: 0.9906 - val_loss: 0.6070
AUC: 0.8644

Epoch 12/30
 - 0s - loss: 0.9879 - val_loss: 0.6095
AUC: 0.8645

Epoch 13/30
 - 0s - loss: 0.9887 - val_loss: 0.5938
AUC: 0.8645

Epoch 14/30
 - 0s - loss: 0.9825 - val_loss: 0.6173
AUC: 0.8651

Epoch 15/30
 - 0s - loss: 0.9796 - val_loss: 0.6084
AUC: 0.8649

Epoch 16/30
 - 0s - loss: 0.9796 - val_loss: 0.6036
AUC: 0.8649

Epoch 17/30
 - 0s - loss: 0.9808 - val_loss: 0.6055
AUC: 0.8651

Epoch 18/30
 - 0s - loss: 0.9734 - val_loss: 0.6044
AUC: 0.8651

Epoch 19/30
 - 0s - loss: 0.9785 - val_loss: 0.6038
AUC: 0.8651

Epoch 20/30
 - 0s - loss: 0.9752 - val_loss: 0.6022
AUC: 0.8650

Epoch 21/30
 - 0s - loss: 0.9760 - val_loss: 0.5993
AUC: 0.8650

Epoch 22/30
 - 0s - loss: 0.9743 - val_loss: 0.6003
AUC: 0.8650

Epoch 23/30
 - 0s - loss: 0.9733 - val_loss: 0.6012
AUC: 0.8651

Epoch 24/30
 - 0s - loss: 0.9785 - val_loss: 0.6022
AUC: 0.8651

Epoch 25/30
 - 0s - loss: 0.9760 - val_loss: 0.5996
AUC: 0.8651

Epoch 26/30
 - 0s - loss: 0.9775 - val_loss: 0.6012
AUC: 0.8651

Epoch 27/30
 - 0s - loss: 0.9811 - val_loss: 0.5995
AUC: 0.8651

Epoch 28/30
 - 0s - loss: 0.9728 - val_loss: 0.5996
AUC: 0.8651

Epoch 29/30
 - 0s - loss: 0.9768 - val_loss: 0.6007
AUC: 0.8652

Epoch 30/30
 - 0s - loss: 0.9801 - val_loss: 0.6017
Using TensorFlow backend.
AUC: 0.8652

2019-03-08 09:02:48.014421: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:02:48.188059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:02:48.188106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:02:48.492480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:02:48.492538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:02:48.492547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:02:48.492822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.5910
Epoch 2/80
 - 2s - loss: 0.0817
Epoch 3/80
 - 2s - loss: 0.0652
Epoch 4/80
 - 2s - loss: 0.0599
Epoch 5/80
 - 2s - loss: 0.0534
Epoch 6/80
 - 2s - loss: 0.0471
Epoch 7/80
 - 2s - loss: 0.0418
Epoch 8/80
 - 2s - loss: 0.0372
Epoch 9/80
 - 2s - loss: 0.0333
Epoch 10/80
 - 2s - loss: 0.0300
Epoch 11/80
 - 2s - loss: 0.0272
Epoch 12/80
 - 2s - loss: 0.0248
Epoch 13/80
 - 2s - loss: 0.0229
Epoch 14/80
 - 2s - loss: 0.0213
Epoch 15/80
 - 2s - loss: 0.0199
Epoch 16/80
 - 2s - loss: 0.0188
Epoch 17/80
 - 2s - loss: 0.0179
Epoch 18/80
 - 2s - loss: 0.0171
Epoch 19/80
 - 2s - loss: 0.0164
Epoch 20/80
 - 2s - loss: 0.0159
Epoch 21/80
 - 2s - loss: 0.0154
Epoch 22/80
 - 2s - loss: 0.0149
Epoch 23/80
 - 2s - loss: 0.0146
Epoch 24/80
 - 2s - loss: 0.0142
Epoch 25/80
 - 2s - loss: 0.0140
Epoch 26/80
 - 2s - loss: 0.0137
Epoch 27/80
 - 2s - loss: 0.0135
Epoch 28/80
 - 2s - loss: 0.0133
Epoch 29/80
 - 2s - loss: 0.0131
Epoch 30/80
 - 2s - loss: 0.0130
Epoch 31/80
 - 2s - loss: 0.0128
Epoch 32/80
 - 2s - loss: 0.0127
Epoch 33/80
 - 2s - loss: 0.0126
Epoch 34/80
 - 2s - loss: 0.0125
Epoch 35/80
 - 2s - loss: 0.0125
Epoch 36/80
 - 2s - loss: 0.0124
Epoch 37/80
 - 2s - loss: 0.0123
Epoch 38/80
 - 2s - loss: 0.0123
Epoch 39/80
 - 2s - loss: 0.0122
Epoch 40/80
 - 2s - loss: 0.0122
Epoch 41/80
 - 2s - loss: 0.0121
Epoch 42/80
 - 2s - loss: 0.0121
Epoch 43/80
 - 2s - loss: 0.0120
Epoch 44/80
 - 2s - loss: 0.0120
Epoch 45/80
 - 2s - loss: 0.0120
Epoch 46/80
 - 2s - loss: 0.0119
Epoch 47/80
 - 2s - loss: 0.0119
Epoch 48/80
 - 2s - loss: 0.0119
Epoch 49/80
 - 2s - loss: 0.0114
Epoch 50/80
 - 2s - loss: 0.0113
Epoch 51/80
 - 2s - loss: 0.0113
Epoch 52/80
 - 2s - loss: 0.0113
Epoch 53/80
 - 2s - loss: 0.0112
Epoch 54/80
 - 2s - loss: 0.0112
Epoch 55/80
 - 2s - loss: 0.0112
Epoch 56/80
 - 2s - loss: 0.0112
Epoch 57/80
 - 2s - loss: 0.0111
Epoch 58/80
 - 2s - loss: 0.0111
Epoch 59/80
 - 2s - loss: 0.0111
Epoch 60/80
 - 2s - loss: 0.0111
Epoch 61/80
 - 2s - loss: 0.0111
Epoch 62/80
 - 2s - loss: 0.0111
Epoch 63/80
 - 2s - loss: 0.0111
Epoch 64/80
 - 2s - loss: 0.0111
Epoch 65/80
 - 2s - loss: 0.0111
Epoch 66/80
 - 2s - loss: 0.0111
Epoch 67/80
 - 2s - loss: 0.0111
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:05:20.965997: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:05:21.130978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:05:21.131023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:05:21.429220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:05:21.429275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:05:21.429284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:05:21.429548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6145
Epoch 2/80
 - 2s - loss: 0.0856
Epoch 3/80
 - 2s - loss: 0.0631
Epoch 4/80
 - 2s - loss: 0.0547
Epoch 5/80
 - 2s - loss: 0.0474
Epoch 6/80
 - 2s - loss: 0.0421
Epoch 7/80
 - 2s - loss: 0.0379
Epoch 8/80
 - 2s - loss: 0.0342
Epoch 9/80
 - 2s - loss: 0.0310
Epoch 10/80
 - 2s - loss: 0.0281
Epoch 11/80
 - 2s - loss: 0.0257
Epoch 12/80
 - 2s - loss: 0.0238
Epoch 13/80
 - 2s - loss: 0.0221
Epoch 14/80
 - 2s - loss: 0.0207
Epoch 15/80
 - 2s - loss: 0.0196
Epoch 16/80
 - 2s - loss: 0.0186
Epoch 17/80
 - 2s - loss: 0.0177
Epoch 18/80
 - 2s - loss: 0.0170
Epoch 19/80
 - 2s - loss: 0.0163
Epoch 20/80
 - 2s - loss: 0.0158
Epoch 21/80
 - 2s - loss: 0.0153
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:06:25.212838: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:06:25.380211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:06:25.380267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:06:25.677878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:06:25.677934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:06:25.677943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:06:25.678210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2011
Epoch 2/80
 - 2s - loss: 0.3155
Epoch 3/80
 - 2s - loss: 0.2655
Epoch 4/80
 - 2s - loss: 0.2279
Epoch 5/80
 - 2s - loss: 0.2056
Epoch 6/80
 - 2s - loss: 0.1876
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:06:55.940216: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:06:56.111058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:06:56.111103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:06:56.426766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:06:56.426821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:06:56.426830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:06:56.427133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1803
Epoch 2/80
 - 2s - loss: 0.3143
Epoch 3/80
 - 2s - loss: 0.2723
Epoch 4/80
 - 2s - loss: 0.2410
Epoch 5/80
 - 2s - loss: 0.2154
Epoch 6/80
 - 2s - loss: 0.1912
Epoch 7/80
 - 2s - loss: 0.1719
Epoch 8/80
 - 2s - loss: 0.1579
Epoch 9/80
 - 2s - loss: 0.1470
Epoch 10/80
 - 2s - loss: 0.1382
Epoch 11/80
 - 2s - loss: 0.1311
Epoch 12/80
 - 2s - loss: 0.1251
Epoch 13/80
 - 2s - loss: 0.1201
Epoch 14/80
 - 2s - loss: 0.1158
Epoch 15/80
 - 2s - loss: 0.1121
Epoch 16/80
 - 2s - loss: 0.1089
Epoch 17/80
 - 2s - loss: 0.1060
Epoch 18/80
 - 2s - loss: 0.1035
Epoch 19/80
 - 2s - loss: 0.1014
Epoch 20/80
 - 2s - loss: 0.0995
Epoch 21/80
 - 2s - loss: 0.0979
Epoch 22/80
 - 2s - loss: 0.0964
Epoch 23/80
 - 2s - loss: 0.0952
Epoch 24/80
 - 2s - loss: 0.0941
Epoch 25/80
 - 2s - loss: 0.0932
Epoch 26/80
 - 2s - loss: 0.0924
Epoch 27/80
 - 2s - loss: 0.0917
Epoch 28/80
 - 2s - loss: 0.0911
Epoch 29/80
 - 2s - loss: 0.0905
Epoch 30/80
 - 2s - loss: 0.0900
Epoch 31/80
 - 2s - loss: 0.0896
Epoch 32/80
 - 2s - loss: 0.0893
Epoch 33/80
 - 2s - loss: 0.0889
Epoch 34/80
 - 2s - loss: 0.0886
Epoch 35/80
 - 2s - loss: 0.0883
Epoch 36/80
 - 2s - loss: 0.0881
Epoch 37/80
 - 2s - loss: 0.0879
Epoch 38/80
 - 2s - loss: 0.0876
Epoch 39/80
 - 2s - loss: 0.0875
Epoch 40/80
 - 2s - loss: 0.0873
Epoch 41/80
 - 2s - loss: 0.0872
Epoch 42/80
 - 2s - loss: 0.0870
Epoch 43/80
 - 2s - loss: 0.0868
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:08:38.749817: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:08:38.919081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:08:38.919139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:08:39.221066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:08:39.221121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:08:39.221130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:08:39.221395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2044
Epoch 2/80
 - 2s - loss: 0.3165
Epoch 3/80
 - 2s - loss: 0.2752
Epoch 4/80
 - 2s - loss: 0.2338
Epoch 5/80
 - 2s - loss: 0.2055
Epoch 6/80
 - 2s - loss: 0.1847
Epoch 7/80
 - 2s - loss: 0.1689
Epoch 8/80
 - 2s - loss: 0.1566
Epoch 9/80
 - 2s - loss: 0.1464
Epoch 10/80
 - 2s - loss: 0.1378
Epoch 11/80
 - 2s - loss: 0.1308
Epoch 12/80
 - 2s - loss: 0.1250
Epoch 13/80
 - 2s - loss: 0.1201
Epoch 14/80
 - 2s - loss: 0.1158
Epoch 15/80
 - 2s - loss: 0.1120
Epoch 16/80
 - 2s - loss: 0.1087
Epoch 17/80
 - 2s - loss: 0.1059
Epoch 18/80
 - 2s - loss: 0.1033
Epoch 19/80
 - 2s - loss: 0.1012
Epoch 20/80
 - 2s - loss: 0.0994
Epoch 21/80
 - 2s - loss: 0.0977
Epoch 22/80
 - 2s - loss: 0.0964
Epoch 23/80
 - 2s - loss: 0.0952
Epoch 24/80
 - 2s - loss: 0.0942
Epoch 25/80
 - 2s - loss: 0.0933
Epoch 26/80
 - 2s - loss: 0.0926
Epoch 27/80
 - 2s - loss: 0.0919
Epoch 28/80
 - 2s - loss: 0.0913
Epoch 29/80
 - 2s - loss: 0.0908
Epoch 30/80
 - 2s - loss: 0.0904
Epoch 31/80
 - 2s - loss: 0.0900
Epoch 32/80
 - 2s - loss: 0.0896
Epoch 33/80
 - 2s - loss: 0.0893
Epoch 34/80
 - 2s - loss: 0.0891
Epoch 35/80
 - 2s - loss: 0.0888
Epoch 36/80
 - 2s - loss: 0.0885
Epoch 37/80
 - 2s - loss: 0.0884
Epoch 38/80
 - 2s - loss: 0.0881
Epoch 39/80
 - 2s - loss: 0.0880
Epoch 40/80
 - 2s - loss: 0.0878
Epoch 41/80
 - 2s - loss: 0.0876
Epoch 42/80
 - 2s - loss: 0.0875
Epoch 43/80
 - 2s - loss: 0.0873
Epoch 44/80
 - 2s - loss: 0.0872
Epoch 45/80
 - 2s - loss: 0.0871
Epoch 46/80
 - 2s - loss: 0.0870
Epoch 47/80
 - 2s - loss: 0.0869
Epoch 48/80
 - 2s - loss: 0.0868
Epoch 49/80
 - 2s - loss: 0.0867
Epoch 50/80
 - 2s - loss: 0.0866
Epoch 51/80
 - 2s - loss: 0.0865
Epoch 52/80
 - 2s - loss: 0.0864
Epoch 53/80
 - 2s - loss: 0.0864
Epoch 54/80
 - 2s - loss: 0.0863
Epoch 55/80
 - 2s - loss: 0.0863
Epoch 56/80
 - 2s - loss: 0.0862
Epoch 57/80
 - 2s - loss: 0.0861
Epoch 58/80
 - 2s - loss: 0.0861
Epoch 59/80
 - 2s - loss: 0.0860
Epoch 60/80
 - 2s - loss: 0.0859
Epoch 61/80
 - 2s - loss: 0.0859
Epoch 62/80
 - 2s - loss: 0.0858
Epoch 63/80
 - 2s - loss: 0.0858
Epoch 64/80
 - 2s - loss: 0.0857
Epoch 65/80
 - 2s - loss: 0.0857
Epoch 66/80
 - 2s - loss: 0.0856
Epoch 67/80
 - 2s - loss: 0.0856
Epoch 68/80
 - 2s - loss: 0.0856
Epoch 69/80
 - 2s - loss: 0.0822
Epoch 70/80
 - 2s - loss: 0.0819
Epoch 71/80
 - 2s - loss: 0.0819
Epoch 72/80
 - 2s - loss: 0.0819
Epoch 73/80
 - 2s - loss: 0.0819
Epoch 74/80
 - 2s - loss: 0.0811
Epoch 75/80
 - 2s - loss: 0.0811
Epoch 76/80
 - 2s - loss: 0.0811
Epoch 77/80
 - 2s - loss: 0.0810
Epoch 78/80
 - 2s - loss: 0.0809
Epoch 79/80
 - 2s - loss: 0.0809
Epoch 80/80
 - 2s - loss: 0.0809
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.3425 - val_loss: 1.3859
AUC: 0.7851

Epoch 2/80
 - 0s - loss: 2.1324 - val_loss: 0.9467
AUC: 0.8081

Epoch 3/80
 - 0s - loss: 1.5559 - val_loss: 0.8142
AUC: 0.8149

Epoch 4/80
 - 0s - loss: 1.3270 - val_loss: 0.7390
AUC: 0.8196

Epoch 5/80
 - 0s - loss: 1.2456 - val_loss: 0.7142
AUC: 0.8311

Epoch 6/80
 - 0s - loss: 1.1902 - val_loss: 0.7060
AUC: 0.8398

Epoch 7/80
 - 0s - loss: 1.1696 - val_loss: 0.6701
AUC: 0.8444

Epoch 8/80
 - 0s - loss: 1.1470 - val_loss: 0.7179
AUC: 0.8481

Epoch 9/80
 - 0s - loss: 1.1212 - val_loss: 0.6335
AUC: 0.8493

Epoch 10/80
 - 0s - loss: 1.1036 - val_loss: 0.6495
AUC: 0.8516

Epoch 11/80
 - 0s - loss: 1.1071 - val_loss: 0.5903
AUC: 0.8512

Epoch 12/80
 - 0s - loss: 1.0822 - val_loss: 0.6438
AUC: 0.8536

Epoch 13/80
 - 0s - loss: 1.0672 - val_loss: 0.6381
AUC: 0.8541

Epoch 14/80
 - 0s - loss: 1.0622 - val_loss: 0.5905
AUC: 0.8562

Epoch 15/80
 - 0s - loss: 1.0568 - val_loss: 0.6459
AUC: 0.8579

Epoch 16/80
 - 0s - loss: 1.0519 - val_loss: 0.6216
AUC: 0.8576

Epoch 17/80
 - 0s - loss: 1.0382 - val_loss: 0.6552
AUC: 0.8590

Epoch 18/80
 - 0s - loss: 1.0381 - val_loss: 0.6036
AUC: 0.8592

Epoch 19/80
 - 0s - loss: 1.0349 - val_loss: 0.6525
AUC: 0.8609

Epoch 20/80
 - 0s - loss: 1.0293 - val_loss: 0.6517
AUC: 0.8610

Epoch 21/80
 - 0s - loss: 1.0266 - val_loss: 0.6504
AUC: 0.8618

Epoch 22/80
 - 0s - loss: 1.0250 - val_loss: 0.5960
AUC: 0.8613

Epoch 23/80
 - 0s - loss: 1.0258 - val_loss: 0.6234
AUC: 0.8619

Epoch 24/80
 - 0s - loss: 1.0136 - val_loss: 0.6368
AUC: 0.8619

Epoch 25/80
 - 0s - loss: 1.0141 - val_loss: 0.6275
AUC: 0.8621

Epoch 26/80
 - 0s - loss: 1.0084 - val_loss: 0.6107
AUC: 0.8621

Epoch 27/80
 - 0s - loss: 1.0101 - val_loss: 0.6246
AUC: 0.8622

Epoch 28/80
 - 0s - loss: 1.0090 - val_loss: 0.6320
AUC: 0.8623

Epoch 29/80
 - 0s - loss: 1.0075 - val_loss: 0.6571
AUC: 0.8626

Epoch 30/80
 - 0s - loss: 1.0069 - val_loss: 0.6198
AUC: 0.8624

Epoch 31/80
 - 0s - loss: 1.0120 - val_loss: 0.6049
AUC: 0.8622

Epoch 32/80
 - 0s - loss: 1.0088 - val_loss: 0.6203
AUC: 0.8625

Epoch 33/80
 - 0s - loss: 1.0128 - val_loss: 0.6200
AUC: 0.8625

Epoch 34/80
 - 0s - loss: 1.0071 - val_loss: 0.6183
AUC: 0.8625

Epoch 35/80
 - 0s - loss: 1.0060 - val_loss: 0.6057
AUC: 0.8625

Epoch 36/80
 - 0s - loss: 1.0005 - val_loss: 0.6223
AUC: 0.8627

Epoch 37/80
 - 0s - loss: 1.0081 - val_loss: 0.6221
AUC: 0.8626

Epoch 38/80
 - 0s - loss: 1.0036 - val_loss: 0.6177
AUC: 0.8627

Epoch 39/80
 - 0s - loss: 1.0007 - val_loss: 0.6088
AUC: 0.8625

Epoch 40/80
 - 0s - loss: 1.0018 - val_loss: 0.6137
AUC: 0.8626

Epoch 41/80
 - 0s - loss: 1.0022 - val_loss: 0.6149
AUC: 0.8628

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.0110 - val_loss: 0.6304
AUC: 0.8631

Epoch 2/30
 - 0s - loss: 1.0046 - val_loss: 0.6272
AUC: 0.8634

Epoch 3/30
 - 0s - loss: 1.0014 - val_loss: 0.6127
AUC: 0.8633

Epoch 4/30
 - 0s - loss: 0.9998 - val_loss: 0.6132
AUC: 0.8634

Epoch 5/30
 - 0s - loss: 1.0017 - val_loss: 0.5872
AUC: 0.8633

Epoch 6/30
 - 0s - loss: 0.9895 - val_loss: 0.6201
AUC: 0.8635

Epoch 7/30
 - 0s - loss: 0.9946 - val_loss: 0.5999
AUC: 0.8637

Epoch 8/30
 - 0s - loss: 0.9952 - val_loss: 0.6355
AUC: 0.8643

Epoch 9/30
 - 0s - loss: 0.9898 - val_loss: 0.5888
AUC: 0.8639

Epoch 10/30
 - 0s - loss: 0.9935 - val_loss: 0.6015
AUC: 0.8641

Epoch 11/30
 - 0s - loss: 0.9860 - val_loss: 0.6139
AUC: 0.8643

Epoch 12/30
 - 0s - loss: 0.9829 - val_loss: 0.6025
AUC: 0.8643

Epoch 13/30
 - 0s - loss: 0.9801 - val_loss: 0.6002
AUC: 0.8644

Epoch 14/30
 - 0s - loss: 0.9828 - val_loss: 0.6094
AUC: 0.8648

Epoch 15/30
 - 0s - loss: 0.9728 - val_loss: 0.6084
AUC: 0.8647

Epoch 16/30
 - 0s - loss: 0.9833 - val_loss: 0.6040
AUC: 0.8648

Epoch 17/30
 - 0s - loss: 0.9744 - val_loss: 0.6019
AUC: 0.8648

Epoch 18/30
 - 0s - loss: 0.9798 - val_loss: 0.5994
AUC: 0.8648

Epoch 19/30
 - 0s - loss: 0.9766 - val_loss: 0.6019
AUC: 0.8649

Epoch 20/30
 - 0s - loss: 0.9719 - val_loss: 0.6025
AUC: 0.8649

Epoch 21/30
 - 0s - loss: 0.9746 - val_loss: 0.6070
AUC: 0.8649

Epoch 22/30
 - 0s - loss: 0.9802 - val_loss: 0.6084
AUC: 0.8649

Epoch 23/30
 - 0s - loss: 0.9791 - val_loss: 0.6087
AUC: 0.8650

Epoch 24/30
 - 0s - loss: 0.9739 - val_loss: 0.6055
AUC: 0.8650

Epoch 25/30
 - 0s - loss: 0.9751 - val_loss: 0.6025
AUC: 0.8650

Epoch 26/30
 - 0s - loss: 0.9779 - val_loss: 0.6027
AUC: 0.8651

Epoch 27/30
 - 0s - loss: 0.9749 - val_loss: 0.6036
AUC: 0.8650

Epoch 28/30
 - 0s - loss: 0.9757 - val_loss: 0.6040
AUC: 0.8651

Epoch 29/30
 - 0s - loss: 0.9706 - val_loss: 0.6029
AUC: 0.8651

Epoch 30/30
 - 0s - loss: 0.9743 - val_loss: 0.6035
Using TensorFlow backend.
AUC: 0.8651

2019-03-08 09:12:24.426835: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:12:24.596442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:12:24.596488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:12:24.904625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:12:24.904681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:12:24.904690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:12:24.905022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9968
Epoch 2/80
 - 2s - loss: 0.1841
Epoch 3/80
 - 2s - loss: 0.1595
Epoch 4/80
 - 2s - loss: 0.1393
Epoch 5/80
 - 2s - loss: 0.1218
Epoch 6/80
 - 2s - loss: 0.1072
Epoch 7/80
 - 2s - loss: 0.0948
Epoch 8/80
 - 2s - loss: 0.0848
Epoch 9/80
 - 2s - loss: 0.0769
Epoch 10/80
 - 2s - loss: 0.0706
Epoch 11/80
 - 2s - loss: 0.0655
Epoch 12/80
 - 2s - loss: 0.0614
Epoch 13/80
 - 2s - loss: 0.0580
Epoch 14/80
 - 2s - loss: 0.0552
Epoch 15/80
 - 2s - loss: 0.0528
Epoch 16/80
 - 2s - loss: 0.0507
Epoch 17/80
 - 2s - loss: 0.0489
Epoch 18/80
 - 2s - loss: 0.0473
Epoch 19/80
 - 2s - loss: 0.0459
Epoch 20/80
 - 2s - loss: 0.0447
Epoch 21/80
 - 2s - loss: 0.0437
Epoch 22/80
 - 2s - loss: 0.0428
Epoch 23/80
 - 2s - loss: 0.0420
Epoch 24/80
 - 2s - loss: 0.0414
Epoch 25/80
 - 2s - loss: 0.0408
Epoch 26/80
 - 2s - loss: 0.0403
Epoch 27/80
 - 2s - loss: 0.0398
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:13:36.824179: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:13:36.993900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:13:36.993947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:13:37.298380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:13:37.298423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:13:37.298433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:13:37.298710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0068
Epoch 2/80
 - 2s - loss: 0.1802
Epoch 3/80
 - 2s - loss: 0.1502
Epoch 4/80
 - 2s - loss: 0.1292
Epoch 5/80
 - 2s - loss: 0.1140
Epoch 6/80
 - 2s - loss: 0.1014
Epoch 7/80
 - 2s - loss: 0.0912
Epoch 8/80
 - 2s - loss: 0.0830
Epoch 9/80
 - 2s - loss: 0.0761
Epoch 10/80
 - 2s - loss: 0.0702
Epoch 11/80
 - 2s - loss: 0.0652
Epoch 12/80
 - 2s - loss: 0.0612
Epoch 13/80
 - 2s - loss: 0.0579
Epoch 14/80
 - 2s - loss: 0.0551
Epoch 15/80
 - 2s - loss: 0.0528
Epoch 16/80
 - 2s - loss: 0.0508
Epoch 17/80
 - 2s - loss: 0.0491
Epoch 18/80
 - 2s - loss: 0.0475
Epoch 19/80
 - 2s - loss: 0.0462
Epoch 20/80
 - 2s - loss: 0.0451
Epoch 21/80
 - 2s - loss: 0.0441
Epoch 22/80
 - 2s - loss: 0.0432
Epoch 23/80
 - 2s - loss: 0.0424
Epoch 24/80
 - 2s - loss: 0.0417
Epoch 25/80
 - 2s - loss: 0.0411
Epoch 26/80
 - 2s - loss: 0.0406
Epoch 27/80
 - 2s - loss: 0.0401
Epoch 28/80
 - 2s - loss: 0.0397
Epoch 29/80
 - 2s - loss: 0.0394
Epoch 30/80
 - 2s - loss: 0.0390
Epoch 31/80
 - 2s - loss: 0.0388
Epoch 32/80
 - 2s - loss: 0.0385
Epoch 33/80
 - 2s - loss: 0.0383
Epoch 34/80
 - 2s - loss: 0.0381
Epoch 35/80
 - 2s - loss: 0.0380
Epoch 36/80
 - 2s - loss: 0.0378
Epoch 37/80
 - 2s - loss: 0.0377
Epoch 38/80
 - 2s - loss: 0.0375
Epoch 39/80
 - 2s - loss: 0.0374
Epoch 40/80
 - 2s - loss: 0.0373
Epoch 41/80
 - 2s - loss: 0.0372
Epoch 42/80
 - 2s - loss: 0.0371
Epoch 43/80
 - 2s - loss: 0.0370
Epoch 44/80
 - 2s - loss: 0.0370
Epoch 45/80
 - 2s - loss: 0.0369
Epoch 46/80
 - 2s - loss: 0.0368
Epoch 47/80
 - 2s - loss: 0.0368
Epoch 48/80
 - 2s - loss: 0.0367
Epoch 49/80
 - 2s - loss: 0.0367
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:15:34.913510: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:15:35.087547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:15:35.087593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:15:35.392469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:15:35.392529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:15:35.392540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:15:35.392826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9753
Epoch 2/80
 - 2s - loss: 0.1816
Epoch 3/80
 - 2s - loss: 0.1599
Epoch 4/80
 - 2s - loss: 0.1377
Epoch 5/80
 - 2s - loss: 0.1181
Epoch 6/80
 - 2s - loss: 0.1048
Epoch 7/80
 - 2s - loss: 0.0941
Epoch 8/80
 - 2s - loss: 0.0851
Epoch 9/80
 - 2s - loss: 0.0778
Epoch 10/80
 - 2s - loss: 0.0716
Epoch 11/80
 - 2s - loss: 0.0664
Epoch 12/80
 - 2s - loss: 0.0622
Epoch 13/80
 - 2s - loss: 0.0586
Epoch 14/80
 - 2s - loss: 0.0557
Epoch 15/80
 - 2s - loss: 0.0532
Epoch 16/80
 - 2s - loss: 0.0511
Epoch 17/80
 - 2s - loss: 0.0492
Epoch 18/80
 - 2s - loss: 0.0477
Epoch 19/80
 - 2s - loss: 0.0463
Epoch 20/80
 - 2s - loss: 0.0451
Epoch 21/80
 - 2s - loss: 0.0441
Epoch 22/80
 - 2s - loss: 0.0432
Epoch 23/80
 - 2s - loss: 0.0424
Epoch 24/80
 - 2s - loss: 0.0417
Epoch 25/80
 - 2s - loss: 0.0411
Epoch 26/80
 - 2s - loss: 0.0406
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:16:49.140728: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:16:49.306606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:16:49.306654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:16:49.607417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:16:49.607474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:16:49.607482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:16:49.607747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9756
Epoch 2/80
 - 2s - loss: 0.1827
Epoch 3/80
 - 2s - loss: 0.1660
Epoch 4/80
 - 2s - loss: 0.1506
Epoch 5/80
 - 2s - loss: 0.1294
Epoch 6/80
 - 2s - loss: 0.1120
Epoch 7/80
 - 2s - loss: 0.0984
Epoch 8/80
 - 2s - loss: 0.0875
Epoch 9/80
 - 2s - loss: 0.0789
Epoch 10/80
 - 2s - loss: 0.0722
Epoch 11/80
 - 2s - loss: 0.0669
Epoch 12/80
 - 2s - loss: 0.0626
Epoch 13/80
 - 2s - loss: 0.0591
Epoch 14/80
 - 2s - loss: 0.0561
Epoch 15/80
 - 2s - loss: 0.0536
Epoch 16/80
 - 2s - loss: 0.0515
Epoch 17/80
 - 2s - loss: 0.0496
Epoch 18/80
 - 2s - loss: 0.0479
Epoch 19/80
 - 2s - loss: 0.0465
Epoch 20/80
 - 2s - loss: 0.0453
Epoch 21/80
 - 2s - loss: 0.0442
Epoch 22/80
 - 2s - loss: 0.0433
Epoch 23/80
 - 2s - loss: 0.0425
Epoch 24/80
 - 2s - loss: 0.0418
Epoch 25/80
 - 2s - loss: 0.0412
Epoch 26/80
 - 2s - loss: 0.0406
Epoch 27/80
 - 2s - loss: 0.0402
Epoch 28/80
 - 2s - loss: 0.0398
Epoch 29/80
 - 2s - loss: 0.0394
Epoch 30/80
 - 2s - loss: 0.0391
Epoch 31/80
 - 2s - loss: 0.0388
Epoch 32/80
 - 2s - loss: 0.0386
Epoch 33/80
 - 2s - loss: 0.0384
Epoch 34/80
 - 2s - loss: 0.0382
Epoch 35/80
 - 2s - loss: 0.0380
Epoch 36/80
 - 2s - loss: 0.0379
Epoch 37/80
 - 2s - loss: 0.0377
Epoch 38/80
 - 2s - loss: 0.0376
Epoch 39/80
 - 2s - loss: 0.0375
Epoch 40/80
 - 2s - loss: 0.0374
Epoch 41/80
 - 2s - loss: 0.0373
Epoch 42/80
 - 2s - loss: 0.0372
Epoch 43/80
 - 2s - loss: 0.0371
Epoch 44/80
 - 2s - loss: 0.0370
Epoch 45/80
 - 2s - loss: 0.0370
Epoch 46/80
 - 2s - loss: 0.0369
Epoch 47/80
 - 2s - loss: 0.0369
Epoch 48/80
 - 2s - loss: 0.0368
Epoch 49/80
 - 2s - loss: 0.0367
Epoch 50/80
 - 2s - loss: 0.0367
Epoch 51/80
 - 2s - loss: 0.0366
Epoch 52/80
 - 2s - loss: 0.0366
Epoch 53/80
 - 2s - loss: 0.0366
Epoch 54/80
 - 2s - loss: 0.0365
Epoch 55/80
 - 2s - loss: 0.0365
Epoch 56/80
 - 2s - loss: 0.0364
Epoch 57/80
 - 2s - loss: 0.0364
Epoch 58/80
 - 2s - loss: 0.0349
Epoch 59/80
 - 2s - loss: 0.0347
Epoch 60/80
 - 2s - loss: 0.0347
Epoch 61/80
 - 2s - loss: 0.0347
Epoch 62/80
 - 2s - loss: 0.0347
Epoch 63/80
 - 2s - loss: 0.0343
Epoch 64/80
 - 2s - loss: 0.0343
Epoch 65/80
 - 2s - loss: 0.0343
Epoch 66/80
 - 2s - loss: 0.0343
Epoch 67/80
 - 2s - loss: 0.0342
Epoch 68/80
 - 2s - loss: 0.0342
Epoch 69/80
 - 2s - loss: 0.0342
Epoch 70/80
 - 2s - loss: 0.0342
Epoch 71/80
 - 2s - loss: 0.0342
Epoch 72/80
 - 2s - loss: 0.0342
Epoch 73/80
 - 2s - loss: 0.0342
Epoch 74/80
 - 2s - loss: 0.0342
Epoch 75/80
 - 2s - loss: 0.0342
Epoch 76/80
 - 2s - loss: 0.0342
Epoch 77/80
 - 2s - loss: 0.0342
Epoch 78/80
 - 2s - loss: 0.0342
Epoch 79/80
 - 2s - loss: 0.0342
Epoch 80/80
 - 2s - loss: 0.0342
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.3406 - val_loss: 1.0654
AUC: 0.7780

Epoch 2/80
 - 0s - loss: 1.6273 - val_loss: 0.8074
AUC: 0.7988

Epoch 3/80
 - 0s - loss: 1.2984 - val_loss: 0.7734
AUC: 0.8168

Epoch 4/80
 - 0s - loss: 1.2251 - val_loss: 0.7205
AUC: 0.8273

Epoch 5/80
 - 0s - loss: 1.1834 - val_loss: 0.6502
AUC: 0.8327

Epoch 6/80
 - 0s - loss: 1.1558 - val_loss: 0.7422
AUC: 0.8420

Epoch 7/80
 - 0s - loss: 1.1276 - val_loss: 0.6555
AUC: 0.8445

Epoch 8/80
 - 0s - loss: 1.1091 - val_loss: 0.6950
AUC: 0.8470

Epoch 9/80
 - 0s - loss: 1.1048 - val_loss: 0.6564
AUC: 0.8489

Epoch 10/80
 - 0s - loss: 1.0891 - val_loss: 0.7274
AUC: 0.8517

Epoch 11/80
 - 0s - loss: 1.0713 - val_loss: 0.6410
AUC: 0.8528

Epoch 12/80
 - 0s - loss: 1.0711 - val_loss: 0.6779
AUC: 0.8552

Epoch 13/80
 - 0s - loss: 1.0619 - val_loss: 0.6242
AUC: 0.8553

Epoch 14/80
 - 0s - loss: 1.0606 - val_loss: 0.6803
AUC: 0.8575

Epoch 15/80
 - 0s - loss: 1.0533 - val_loss: 0.6748
AUC: 0.8576

Epoch 16/80
 - 0s - loss: 1.0440 - val_loss: 0.6208
AUC: 0.8582

Epoch 17/80
 - 0s - loss: 1.0322 - val_loss: 0.6609
AUC: 0.8593

Epoch 18/80
 - 0s - loss: 1.0407 - val_loss: 0.6475
AUC: 0.8595

Epoch 19/80
 - 0s - loss: 1.0297 - val_loss: 0.6697
AUC: 0.8614

Epoch 20/80
 - 0s - loss: 1.0227 - val_loss: 0.6144
AUC: 0.8609

Epoch 21/80
 - 0s - loss: 1.0276 - val_loss: 0.5445
AUC: 0.8607

Epoch 22/80
 - 0s - loss: 1.0141 - val_loss: 0.6143
AUC: 0.8621

Epoch 23/80
 - 0s - loss: 1.0185 - val_loss: 0.6138
AUC: 0.8632

Epoch 24/80
 - 0s - loss: 1.0112 - val_loss: 0.6662
AUC: 0.8635

Epoch 25/80
 - 0s - loss: 1.0111 - val_loss: 0.5955
AUC: 0.8637

Epoch 26/80
 - 0s - loss: 1.0082 - val_loss: 0.6200
AUC: 0.8646

Epoch 27/80
 - 0s - loss: 1.0099 - val_loss: 0.6138
AUC: 0.8638

Epoch 28/80
 - 0s - loss: 1.0033 - val_loss: 0.6394
AUC: 0.8639

Epoch 29/80
 - 0s - loss: 0.9973 - val_loss: 0.7107
AUC: 0.8657

Epoch 30/80
 - 0s - loss: 1.0013 - val_loss: 0.5904
AUC: 0.8647

Epoch 31/80
 - 0s - loss: 0.9950 - val_loss: 0.5665
AUC: 0.8631

Epoch 32/80
 - 0s - loss: 0.9890 - val_loss: 0.6312
AUC: 0.8649

Epoch 33/80
 - 0s - loss: 0.9856 - val_loss: 0.6267
AUC: 0.8655

Epoch 34/80
 - 0s - loss: 0.9825 - val_loss: 0.5953
AUC: 0.8650

Epoch 35/80
 - 0s - loss: 0.9842 - val_loss: 0.6237
AUC: 0.8653

Epoch 36/80
 - 0s - loss: 0.9880 - val_loss: 0.6069
AUC: 0.8653

Epoch 37/80
 - 0s - loss: 0.9809 - val_loss: 0.5917
AUC: 0.8652

Epoch 38/80
 - 0s - loss: 0.9838 - val_loss: 0.6226
AUC: 0.8656

Epoch 39/80
 - 0s - loss: 0.9838 - val_loss: 0.6240
AUC: 0.8659

Epoch 40/80
 - 0s - loss: 0.9816 - val_loss: 0.5967
AUC: 0.8657

Epoch 41/80
 - 0s - loss: 0.9831 - val_loss: 0.6165
AUC: 0.8660

Epoch 42/80
 - 0s - loss: 0.9787 - val_loss: 0.6093
AUC: 0.8659

Epoch 43/80
 - 0s - loss: 0.9736 - val_loss: 0.6033
AUC: 0.8658

Epoch 44/80
 - 0s - loss: 0.9769 - val_loss: 0.6088
AUC: 0.8660

Epoch 45/80
 - 0s - loss: 0.9706 - val_loss: 0.6053
AUC: 0.8659

Epoch 46/80
 - 0s - loss: 0.9773 - val_loss: 0.6023
AUC: 0.8659

Epoch 47/80
 - 0s - loss: 0.9770 - val_loss: 0.6101
AUC: 0.8659

Epoch 48/80
 - 0s - loss: 0.9789 - val_loss: 0.6066
AUC: 0.8658

Epoch 49/80
 - 0s - loss: 0.9768 - val_loss: 0.6092
AUC: 0.8659

Epoch 50/80
 - 0s - loss: 0.9730 - val_loss: 0.6028
AUC: 0.8658

Epoch 51/80
 - 0s - loss: 0.9793 - val_loss: 0.6112
AUC: 0.8659

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9767 - val_loss: 0.6104
AUC: 0.8658

Epoch 2/30
 - 0s - loss: 0.9754 - val_loss: 0.6125
AUC: 0.8661

Epoch 3/30
 - 0s - loss: 0.9705 - val_loss: 0.6250
AUC: 0.8664

Epoch 4/30
 - 0s - loss: 0.9718 - val_loss: 0.6074
AUC: 0.8664

Epoch 5/30
 - 0s - loss: 0.9700 - val_loss: 0.6051
AUC: 0.8665

Epoch 6/30
 - 0s - loss: 0.9661 - val_loss: 0.6159
AUC: 0.8668

Epoch 7/30
 - 0s - loss: 0.9718 - val_loss: 0.6002
AUC: 0.8666

Epoch 8/30
 - 0s - loss: 0.9655 - val_loss: 0.6232
AUC: 0.8668

Epoch 9/30
 - 0s - loss: 0.9650 - val_loss: 0.6159
AUC: 0.8669

Epoch 10/30
 - 0s - loss: 0.9663 - val_loss: 0.6154
AUC: 0.8669

Epoch 11/30
 - 0s - loss: 0.9573 - val_loss: 0.6074
AUC: 0.8671

Epoch 12/30
 - 0s - loss: 0.9624 - val_loss: 0.5869
AUC: 0.8671

Epoch 13/30
 - 0s - loss: 0.9560 - val_loss: 0.6217
AUC: 0.8671

Epoch 14/30
 - 0s - loss: 0.9547 - val_loss: 0.6125
AUC: 0.8672

Epoch 15/30
 - 0s - loss: 0.9557 - val_loss: 0.6033
AUC: 0.8672

Epoch 16/30
 - 0s - loss: 0.9508 - val_loss: 0.6025
AUC: 0.8673

Epoch 17/30
 - 0s - loss: 0.9569 - val_loss: 0.5823
AUC: 0.8672

Epoch 18/30
 - 0s - loss: 0.9536 - val_loss: 0.5928
AUC: 0.8674

Epoch 19/30
 - 0s - loss: 0.9470 - val_loss: 0.5933
AUC: 0.8675

Epoch 20/30
 - 0s - loss: 0.9468 - val_loss: 0.5975
AUC: 0.8675

Epoch 21/30
 - 0s - loss: 0.9476 - val_loss: 0.5904
AUC: 0.8674

Epoch 22/30
 - 0s - loss: 0.9395 - val_loss: 0.5886
AUC: 0.8673

Epoch 23/30
 - 0s - loss: 0.9425 - val_loss: 0.5909
AUC: 0.8676

Epoch 24/30
 - 0s - loss: 0.9395 - val_loss: 0.6164
AUC: 0.8679

Epoch 25/30
 - 0s - loss: 0.9408 - val_loss: 0.6183
AUC: 0.8680

Epoch 26/30
 - 0s - loss: 0.9410 - val_loss: 0.5904
AUC: 0.8677

Epoch 27/30
 - 0s - loss: 0.9414 - val_loss: 0.5915
AUC: 0.8677

Epoch 28/30
 - 0s - loss: 0.9374 - val_loss: 0.5888
AUC: 0.8677

Epoch 29/30
 - 0s - loss: 0.9384 - val_loss: 0.5901
AUC: 0.8678

Epoch 30/30
 - 0s - loss: 0.9370 - val_loss: 0.5927
Using TensorFlow backend.
AUC: 0.8678

2019-03-08 09:20:45.011388: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:20:45.179327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:20:45.179376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:20:45.481653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:20:45.481710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:20:45.481720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:20:45.481990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6044
Epoch 2/80
 - 2s - loss: 0.0837
Epoch 3/80
 - 2s - loss: 0.0640
Epoch 4/80
 - 2s - loss: 0.0563
Epoch 5/80
 - 2s - loss: 0.0498
Epoch 6/80
 - 2s - loss: 0.0442
Epoch 7/80
 - 2s - loss: 0.0394
Epoch 8/80
 - 2s - loss: 0.0351
Epoch 9/80
 - 2s - loss: 0.0316
Epoch 10/80
 - 2s - loss: 0.0287
Epoch 11/80
 - 2s - loss: 0.0263
Epoch 12/80
 - 2s - loss: 0.0242
Epoch 13/80
 - 2s - loss: 0.0224
Epoch 14/80
 - 2s - loss: 0.0209
Epoch 15/80
 - 2s - loss: 0.0197
Epoch 16/80
 - 2s - loss: 0.0186
Epoch 17/80
 - 2s - loss: 0.0177
Epoch 18/80
 - 2s - loss: 0.0170
Epoch 19/80
 - 2s - loss: 0.0163
Epoch 20/80
 - 2s - loss: 0.0158
Epoch 21/80
 - 2s - loss: 0.0153
Epoch 22/80
 - 2s - loss: 0.0149
Epoch 23/80
 - 2s - loss: 0.0145
Epoch 24/80
 - 2s - loss: 0.0142
Epoch 25/80
 - 2s - loss: 0.0139
Epoch 26/80
 - 2s - loss: 0.0137
Epoch 27/80
 - 2s - loss: 0.0134
Epoch 28/80
 - 2s - loss: 0.0132
Epoch 29/80
 - 2s - loss: 0.0131
Epoch 30/80
 - 2s - loss: 0.0129
Epoch 31/80
 - 2s - loss: 0.0128
Epoch 32/80
 - 2s - loss: 0.0127
Epoch 33/80
 - 2s - loss: 0.0126
Epoch 34/80
 - 2s - loss: 0.0125
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:22:13.920231: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:22:14.088348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:22:14.088395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:22:14.393169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:22:14.393227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:22:14.393237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:22:14.393497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.5942
Epoch 2/80
 - 2s - loss: 0.0844
Epoch 3/80
 - 2s - loss: 0.0659
Epoch 4/80
 - 2s - loss: 0.0602
Epoch 5/80
 - 2s - loss: 0.0537
Epoch 6/80
 - 2s - loss: 0.0468
Epoch 7/80
 - 2s - loss: 0.0410
Epoch 8/80
 - 2s - loss: 0.0364
Epoch 9/80
 - 2s - loss: 0.0325
Epoch 10/80
 - 2s - loss: 0.0293
Epoch 11/80
 - 2s - loss: 0.0267
Epoch 12/80
 - 2s - loss: 0.0245
Epoch 13/80
 - 2s - loss: 0.0228
Epoch 14/80
 - 2s - loss: 0.0212
Epoch 15/80
 - 2s - loss: 0.0200
Epoch 16/80
 - 2s - loss: 0.0189
Epoch 17/80
 - 2s - loss: 0.0180
Epoch 18/80
 - 2s - loss: 0.0172
Epoch 19/80
 - 2s - loss: 0.0165
Epoch 20/80
 - 2s - loss: 0.0159
Epoch 21/80
 - 2s - loss: 0.0154
Epoch 22/80
 - 2s - loss: 0.0150
Epoch 23/80
 - 2s - loss: 0.0146
Epoch 24/80
 - 2s - loss: 0.0143
Epoch 25/80
 - 2s - loss: 0.0140
Epoch 26/80
 - 2s - loss: 0.0137
Epoch 27/80
 - 2s - loss: 0.0135
Epoch 28/80
 - 2s - loss: 0.0133
Epoch 29/80
 - 2s - loss: 0.0132
Epoch 30/80
 - 2s - loss: 0.0130
Epoch 31/80
 - 2s - loss: 0.0129
Epoch 32/80
 - 2s - loss: 0.0127
Epoch 33/80
 - 2s - loss: 0.0127
Epoch 34/80
 - 2s - loss: 0.0126
Epoch 35/80
 - 2s - loss: 0.0125
Epoch 36/80
 - 2s - loss: 0.0124
Epoch 37/80
 - 2s - loss: 0.0123
Epoch 38/80
 - 2s - loss: 0.0123
Epoch 39/80
 - 2s - loss: 0.0122
Epoch 40/80
 - 2s - loss: 0.0122
Epoch 41/80
 - 2s - loss: 0.0121
Epoch 42/80
 - 2s - loss: 0.0121
Epoch 43/80
 - 2s - loss: 0.0120
Epoch 44/80
 - 2s - loss: 0.0120
Epoch 45/80
 - 2s - loss: 0.0120
Epoch 46/80
 - 2s - loss: 0.0119
Epoch 47/80
 - 2s - loss: 0.0119
Epoch 48/80
 - 2s - loss: 0.0114
Epoch 49/80
 - 2s - loss: 0.0113
Epoch 50/80
 - 2s - loss: 0.0113
Epoch 51/80
 - 2s - loss: 0.0113
Epoch 52/80
 - 2s - loss: 0.0112
Epoch 53/80
 - 2s - loss: 0.0112
Epoch 54/80
 - 2s - loss: 0.0112
Epoch 55/80
 - 2s - loss: 0.0112
Epoch 56/80
 - 2s - loss: 0.0111
Epoch 57/80
 - 2s - loss: 0.0111
Epoch 58/80
 - 2s - loss: 0.0111
Epoch 59/80
 - 2s - loss: 0.0111
Epoch 60/80
 - 2s - loss: 0.0111
Epoch 61/80
 - 2s - loss: 0.0111
Epoch 62/80
 - 2s - loss: 0.0111
Epoch 63/80
 - 2s - loss: 0.0111
Epoch 64/80
 - 2s - loss: 0.0111
Epoch 65/80
 - 2s - loss: 0.0111
Epoch 66/80
 - 2s - loss: 0.0111
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:24:46.080515: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:24:46.250092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:24:46.250139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:24:46.552780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:24:46.552838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:24:46.552848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:24:46.553176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.5820
Epoch 2/80
 - 2s - loss: 0.0821
Epoch 3/80
 - 2s - loss: 0.0655
Epoch 4/80
 - 2s - loss: 0.0598
Epoch 5/80
 - 2s - loss: 0.0535
Epoch 6/80
 - 2s - loss: 0.0472
Epoch 7/80
 - 2s - loss: 0.0419
Epoch 8/80
 - 2s - loss: 0.0374
Epoch 9/80
 - 2s - loss: 0.0336
Epoch 10/80
 - 2s - loss: 0.0303
Epoch 11/80
 - 2s - loss: 0.0275
Epoch 12/80
 - 2s - loss: 0.0251
Epoch 13/80
 - 2s - loss: 0.0231
Epoch 14/80
 - 2s - loss: 0.0215
Epoch 15/80
 - 2s - loss: 0.0201
Epoch 16/80
 - 2s - loss: 0.0190
Epoch 17/80
 - 2s - loss: 0.0180
Epoch 18/80
 - 2s - loss: 0.0172
Epoch 19/80
 - 2s - loss: 0.0165
Epoch 20/80
 - 2s - loss: 0.0159
Epoch 21/80
 - 2s - loss: 0.0154
Epoch 22/80
 - 2s - loss: 0.0150
Epoch 23/80
 - 2s - loss: 0.0146
Epoch 24/80
 - 2s - loss: 0.0143
Epoch 25/80
 - 2s - loss: 0.0140
Epoch 26/80
 - 2s - loss: 0.0137
Epoch 27/80
 - 2s - loss: 0.0135
Epoch 28/80
 - 2s - loss: 0.0133
Epoch 29/80
 - 2s - loss: 0.0131
Epoch 30/80
 - 2s - loss: 0.0130
Epoch 31/80
 - 2s - loss: 0.0128
Epoch 32/80
 - 2s - loss: 0.0127
Epoch 33/80
 - 2s - loss: 0.0126
Epoch 34/80
 - 2s - loss: 0.0125
Epoch 35/80
 - 2s - loss: 0.0124
Epoch 36/80
 - 2s - loss: 0.0123
Epoch 37/80
 - 2s - loss: 0.0123
Epoch 38/80
 - 2s - loss: 0.0122
Epoch 39/80
 - 2s - loss: 0.0122
Epoch 40/80
 - 2s - loss: 0.0121
Epoch 41/80
 - 2s - loss: 0.0121
Epoch 42/80
 - 2s - loss: 0.0120
Epoch 43/80
 - 2s - loss: 0.0120
Epoch 44/80
 - 2s - loss: 0.0119
Epoch 45/80
 - 2s - loss: 0.0119
Epoch 46/80
 - 2s - loss: 0.0119
Epoch 47/80
 - 2s - loss: 0.0113
Epoch 48/80
 - 2s - loss: 0.0113
Epoch 49/80
 - 2s - loss: 0.0113
Epoch 50/80
 - 2s - loss: 0.0113
Epoch 51/80
 - 2s - loss: 0.0112
Epoch 52/80
 - 2s - loss: 0.0111
Epoch 53/80
 - 2s - loss: 0.0111
Epoch 54/80
 - 2s - loss: 0.0111
Epoch 55/80
 - 2s - loss: 0.0111
Epoch 56/80
 - 2s - loss: 0.0111
Epoch 57/80
 - 2s - loss: 0.0111
Epoch 58/80
 - 2s - loss: 0.0111
Epoch 59/80
 - 2s - loss: 0.0111
Epoch 60/80
 - 2s - loss: 0.0111
Epoch 61/80
 - 2s - loss: 0.0111
Epoch 62/80
 - 2s - loss: 0.0111
Epoch 63/80
 - 2s - loss: 0.0111
Epoch 64/80
 - 2s - loss: 0.0111
Epoch 65/80
 - 2s - loss: 0.0111
Epoch 66/80
 - 2s - loss: 0.0111
Epoch 67/80
 - 2s - loss: 0.0111
Epoch 68/80
 - 2s - loss: 0.0111
Epoch 69/80
 - 2s - loss: 0.0111
Epoch 70/80
 - 2s - loss: 0.0111
Epoch 71/80
 - 2s - loss: 0.0111
Epoch 72/80
 - 2s - loss: 0.0111
Epoch 73/80
 - 2s - loss: 0.0111
Epoch 74/80
 - 2s - loss: 0.0111
Epoch 75/80
 - 2s - loss: 0.0111
Epoch 76/80
 - 2s - loss: 0.0111
Epoch 77/80
 - 2s - loss: 0.0111
Epoch 78/80
 - 2s - loss: 0.0111
Epoch 79/80
 - 2s - loss: 0.0111
Epoch 80/80
 - 2s - loss: 0.0111
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.4945 - val_loss: 1.2077
AUC: 0.8045

Epoch 2/80
 - 0s - loss: 2.1318 - val_loss: 0.7792
AUC: 0.8174

Epoch 3/80
 - 0s - loss: 1.4277 - val_loss: 0.7293
AUC: 0.8273

Epoch 4/80
 - 0s - loss: 1.2437 - val_loss: 0.7034
AUC: 0.8394

Epoch 5/80
 - 0s - loss: 1.1867 - val_loss: 0.6102
AUC: 0.8435

Epoch 6/80
 - 0s - loss: 1.1420 - val_loss: 0.7139
AUC: 0.8523

Epoch 7/80
 - 0s - loss: 1.1145 - val_loss: 0.7019
AUC: 0.8558

Epoch 8/80
 - 0s - loss: 1.0926 - val_loss: 0.7037
AUC: 0.8588

Epoch 9/80
 - 0s - loss: 1.0835 - val_loss: 0.6242
AUC: 0.8586

Epoch 10/80
 - 0s - loss: 1.0650 - val_loss: 0.6761
AUC: 0.8617

Epoch 11/80
 - 0s - loss: 1.0552 - val_loss: 0.6596
AUC: 0.8612

Epoch 12/80
 - 0s - loss: 1.0472 - val_loss: 0.6328
AUC: 0.8624

Epoch 13/80
 - 0s - loss: 1.0407 - val_loss: 0.6148
AUC: 0.8633

Epoch 14/80
 - 0s - loss: 1.0331 - val_loss: 0.6661
AUC: 0.8647

Epoch 15/80
 - 0s - loss: 1.0290 - val_loss: 0.5775
AUC: 0.8635

Epoch 16/80
 - 0s - loss: 1.0266 - val_loss: 0.6198
AUC: 0.8656

Epoch 17/80
 - 0s - loss: 1.0173 - val_loss: 0.6156
AUC: 0.8657

Epoch 18/80
 - 0s - loss: 1.0144 - val_loss: 0.6511
AUC: 0.8668

Epoch 19/80
 - 0s - loss: 1.0059 - val_loss: 0.5676
AUC: 0.8658

Epoch 20/80
 - 0s - loss: 1.0082 - val_loss: 0.6277
AUC: 0.8677

Epoch 21/80
 - 0s - loss: 1.0043 - val_loss: 0.6804
AUC: 0.8685

Epoch 22/80
 - 0s - loss: 1.0027 - val_loss: 0.5886
AUC: 0.8675

Epoch 23/80
 - 0s - loss: 1.0020 - val_loss: 0.6448
AUC: 0.8682

Epoch 24/80
 - 0s - loss: 1.0007 - val_loss: 0.6346
AUC: 0.8691

Epoch 25/80
 - 0s - loss: 1.0000 - val_loss: 0.6406
AUC: 0.8690

Epoch 26/80
 - 0s - loss: 0.9940 - val_loss: 0.6184
AUC: 0.8698

Epoch 27/80
 - 0s - loss: 0.9875 - val_loss: 0.6189
AUC: 0.8696

Epoch 28/80
 - 0s - loss: 0.9890 - val_loss: 0.5828
AUC: 0.8680

Epoch 29/80
 - 0s - loss: 0.9897 - val_loss: 0.6171
AUC: 0.8699

Epoch 30/80
 - 0s - loss: 0.9724 - val_loss: 0.6018
AUC: 0.8698

Epoch 31/80
 - 0s - loss: 0.9743 - val_loss: 0.6181
AUC: 0.8700

Epoch 32/80
 - 0s - loss: 0.9774 - val_loss: 0.5919
AUC: 0.8694

Epoch 33/80
 - 0s - loss: 0.9701 - val_loss: 0.5938
AUC: 0.8695

Epoch 34/80
 - 0s - loss: 0.9665 - val_loss: 0.6078
AUC: 0.8701

Epoch 35/80
 - 0s - loss: 0.9737 - val_loss: 0.5875
AUC: 0.8698

Epoch 36/80
 - 0s - loss: 0.9650 - val_loss: 0.5980
AUC: 0.8703

Epoch 37/80
 - 0s - loss: 0.9697 - val_loss: 0.5754
AUC: 0.8695

Epoch 38/80
 - 0s - loss: 0.9714 - val_loss: 0.6111
AUC: 0.8706

Epoch 39/80
 - 0s - loss: 0.9654 - val_loss: 0.5900
AUC: 0.8704

Epoch 40/80
 - 0s - loss: 0.9683 - val_loss: 0.5890
AUC: 0.8703

Epoch 41/80
 - 0s - loss: 0.9614 - val_loss: 0.5933
AUC: 0.8703

Epoch 42/80
 - 0s - loss: 0.9580 - val_loss: 0.5863
AUC: 0.8702

Epoch 43/80
 - 0s - loss: 0.9629 - val_loss: 0.6003
AUC: 0.8704

Epoch 44/80
 - 0s - loss: 0.9630 - val_loss: 0.5917
AUC: 0.8703

Epoch 45/80
 - 0s - loss: 0.9665 - val_loss: 0.5980
AUC: 0.8703

Epoch 46/80
 - 0s - loss: 0.9640 - val_loss: 0.5879
AUC: 0.8702

Epoch 47/80
 - 0s - loss: 0.9651 - val_loss: 0.6015
AUC: 0.8703

Epoch 48/80
 - 0s - loss: 0.9699 - val_loss: 0.5918
AUC: 0.8702

Epoch 49/80
 - 0s - loss: 0.9600 - val_loss: 0.5971
AUC: 0.8702

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9662 - val_loss: 0.5954
AUC: 0.8701

Epoch 2/30
 - 0s - loss: 0.9611 - val_loss: 0.5830
AUC: 0.8702

Epoch 3/30
 - 1s - loss: 0.9598 - val_loss: 0.6157
AUC: 0.8709

Epoch 4/30
 - 0s - loss: 0.9613 - val_loss: 0.5894
AUC: 0.8708

Epoch 5/30
 - 0s - loss: 0.9613 - val_loss: 0.5804
AUC: 0.8706

Epoch 6/30
 - 0s - loss: 0.9533 - val_loss: 0.5696
AUC: 0.8704

Epoch 7/30
 - 0s - loss: 0.9596 - val_loss: 0.6200
AUC: 0.8714

Epoch 8/30
 - 0s - loss: 0.9588 - val_loss: 0.5858
AUC: 0.8711

Epoch 9/30
 - 0s - loss: 0.9577 - val_loss: 0.5870
AUC: 0.8713

Epoch 10/30
 - 0s - loss: 0.9539 - val_loss: 0.5823
AUC: 0.8710

Epoch 11/30
 - 0s - loss: 0.9531 - val_loss: 0.5768
AUC: 0.8712

Epoch 12/30
 - 0s - loss: 0.9523 - val_loss: 0.5917
AUC: 0.8716

Epoch 13/30
 - 0s - loss: 0.9476 - val_loss: 0.5922
AUC: 0.8716

Epoch 14/30
 - 0s - loss: 0.9511 - val_loss: 0.5973
AUC: 0.8716

Epoch 15/30
 - 0s - loss: 0.9447 - val_loss: 0.5956
AUC: 0.8718

Epoch 16/30
 - 0s - loss: 0.9407 - val_loss: 0.6090
AUC: 0.8722

Epoch 17/30
 - 0s - loss: 0.9394 - val_loss: 0.5842
AUC: 0.8718

Epoch 18/30
 - 0s - loss: 0.9392 - val_loss: 0.5826
AUC: 0.8718

Epoch 19/30
 - 0s - loss: 0.9322 - val_loss: 0.5782
AUC: 0.8718

Epoch 20/30
 - 0s - loss: 0.9422 - val_loss: 0.5803
AUC: 0.8718

Epoch 21/30
 - 0s - loss: 0.9348 - val_loss: 0.5883
AUC: 0.8720

Epoch 22/30
 - 0s - loss: 0.9348 - val_loss: 0.5814
AUC: 0.8719

Epoch 23/30
 - 0s - loss: 0.9367 - val_loss: 0.5826
AUC: 0.8719

Epoch 24/30
 - 0s - loss: 0.9365 - val_loss: 0.5795
AUC: 0.8718

Epoch 25/30
 - 0s - loss: 0.9382 - val_loss: 0.5843
AUC: 0.8719

Epoch 26/30
 - 0s - loss: 0.9414 - val_loss: 0.5807
AUC: 0.8719

Epoch 27/30
 - 0s - loss: 0.9375 - val_loss: 0.5810
AUC: 0.8719

Epoch 28/30
 - 0s - loss: 0.9347 - val_loss: 0.5816
AUC: 0.8719

Epoch 29/30
 - 0s - loss: 0.9366 - val_loss: 0.5821
AUC: 0.8719

Epoch 30/30
 - 0s - loss: 0.9370 - val_loss: 0.5822
Using TensorFlow backend.
AUC: 0.8719

2019-03-08 09:28:39.620547: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:28:39.786974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:28:39.787021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:28:40.085683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:28:40.085738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:28:40.085747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:28:40.086074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2069
Epoch 2/80
 - 2s - loss: 0.3097
Epoch 3/80
 - 2s - loss: 0.2594
Epoch 4/80
 - 2s - loss: 0.2254
Epoch 5/80
 - 2s - loss: 0.2014
Epoch 6/80
 - 2s - loss: 0.1828
Epoch 7/80
 - 2s - loss: 0.1679
Epoch 8/80
 - 2s - loss: 0.1555
Epoch 9/80
 - 2s - loss: 0.1452
Epoch 10/80
 - 2s - loss: 0.1367
Epoch 11/80
 - 2s - loss: 0.1299
Epoch 12/80
 - 2s - loss: 0.1241
Epoch 13/80
 - 2s - loss: 0.1193
Epoch 14/80
 - 2s - loss: 0.1150
Epoch 15/80
 - 2s - loss: 0.1113
Epoch 16/80
 - 2s - loss: 0.1080
Epoch 17/80
 - 2s - loss: 0.1052
Epoch 18/80
 - 2s - loss: 0.1027
Epoch 19/80
 - 2s - loss: 0.1005
Epoch 20/80
 - 2s - loss: 0.0986
Epoch 21/80
 - 2s - loss: 0.0970
Epoch 22/80
 - 2s - loss: 0.0955
Epoch 23/80
 - 2s - loss: 0.0944
Epoch 24/80
 - 2s - loss: 0.0934
Epoch 25/80
 - 2s - loss: 0.0925
Epoch 26/80
 - 2s - loss: 0.0917
Epoch 27/80
 - 2s - loss: 0.0911
Epoch 28/80
 - 2s - loss: 0.0905
Epoch 29/80
 - 2s - loss: 0.0900
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:29:58.812928: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:29:58.981247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:29:58.981293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:29:59.286881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:29:59.286934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:29:59.286944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:29:59.287230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2068
Epoch 2/80
 - 2s - loss: 0.3148
Epoch 3/80
 - 2s - loss: 0.2689
Epoch 4/80
 - 2s - loss: 0.2333
Epoch 5/80
 - 2s - loss: 0.2095
Epoch 6/80
 - 2s - loss: 0.1891
Epoch 7/80
 - 2s - loss: 0.1721
Epoch 8/80
 - 2s - loss: 0.1586
Epoch 9/80
 - 2s - loss: 0.1472
Epoch 10/80
 - 2s - loss: 0.1379
Epoch 11/80
 - 2s - loss: 0.1305
Epoch 12/80
 - 2s - loss: 0.1245
Epoch 13/80
 - 2s - loss: 0.1196
Epoch 14/80
 - 2s - loss: 0.1154
Epoch 15/80
 - 2s - loss: 0.1117
Epoch 16/80
 - 2s - loss: 0.1084
Epoch 17/80
 - 2s - loss: 0.1055
Epoch 18/80
 - 2s - loss: 0.1030
Epoch 19/80
 - 2s - loss: 0.1008
Epoch 20/80
 - 2s - loss: 0.0989
Epoch 21/80
 - 2s - loss: 0.0973
Epoch 22/80
 - 2s - loss: 0.0959
Epoch 23/80
 - 2s - loss: 0.0947
Epoch 24/80
 - 2s - loss: 0.0937
Epoch 25/80
 - 2s - loss: 0.0928
Epoch 26/80
 - 2s - loss: 0.0920
Epoch 27/80
 - 2s - loss: 0.0914
Epoch 28/80
 - 2s - loss: 0.0908
Epoch 29/80
 - 2s - loss: 0.0903
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:31:18.629232: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:31:18.797731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:31:18.797814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:31:19.098878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:31:19.098928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:31:19.098939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:31:19.099235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1953
Epoch 2/80
 - 2s - loss: 0.3185
Epoch 3/80
 - 2s - loss: 0.2851
Epoch 4/80
 - 2s - loss: 0.2443
Epoch 5/80
 - 2s - loss: 0.2132
Epoch 6/80
 - 2s - loss: 0.1907
Epoch 7/80
 - 2s - loss: 0.1732
Epoch 8/80
 - 2s - loss: 0.1594
Epoch 9/80
 - 2s - loss: 0.1482
Epoch 10/80
 - 2s - loss: 0.1389
Epoch 11/80
 - 2s - loss: 0.1315
Epoch 12/80
 - 2s - loss: 0.1255
Epoch 13/80
 - 2s - loss: 0.1205
Epoch 14/80
 - 2s - loss: 0.1162
Epoch 15/80
 - 2s - loss: 0.1125
Epoch 16/80
 - 2s - loss: 0.1093
Epoch 17/80
 - 2s - loss: 0.1064
Epoch 18/80
 - 2s - loss: 0.1039
Epoch 19/80
 - 2s - loss: 0.1018
Epoch 20/80
 - 2s - loss: 0.0999
Epoch 21/80
 - 2s - loss: 0.0983
Epoch 22/80
 - 2s - loss: 0.0969
Epoch 23/80
 - 2s - loss: 0.0957
Epoch 24/80
 - 2s - loss: 0.0946
Epoch 25/80
 - 2s - loss: 0.0937
Epoch 26/80
 - 2s - loss: 0.0929
Epoch 27/80
 - 2s - loss: 0.0922
Epoch 28/80
 - 2s - loss: 0.0917
Epoch 29/80
 - 2s - loss: 0.0911
Epoch 30/80
 - 2s - loss: 0.0906
Epoch 31/80
 - 2s - loss: 0.0902
Epoch 32/80
 - 2s - loss: 0.0898
Epoch 33/80
 - 2s - loss: 0.0895
Epoch 34/80
 - 2s - loss: 0.0892
Epoch 35/80
 - 2s - loss: 0.0889
Epoch 36/80
 - 2s - loss: 0.0887
Epoch 37/80
 - 2s - loss: 0.0885
Epoch 38/80
 - 2s - loss: 0.0883
Epoch 39/80
 - 2s - loss: 0.0880
Epoch 40/80
 - 2s - loss: 0.0879
Epoch 41/80
 - 2s - loss: 0.0877
Epoch 42/80
 - 2s - loss: 0.0876
Epoch 43/80
 - 2s - loss: 0.0874
Epoch 44/80
 - 2s - loss: 0.0873
Epoch 45/80
 - 2s - loss: 0.0872
Epoch 46/80
 - 2s - loss: 0.0871
Epoch 47/80
 - 2s - loss: 0.0869
Epoch 48/80
 - 2s - loss: 0.0869
Epoch 49/80
 - 2s - loss: 0.0868
Epoch 50/80
 - 2s - loss: 0.0867
Epoch 51/80
 - 2s - loss: 0.0866
Epoch 52/80
 - 2s - loss: 0.0865
Epoch 53/80
 - 2s - loss: 0.0864
Epoch 54/80
 - 2s - loss: 0.0864
Epoch 55/80
 - 2s - loss: 0.0863
Epoch 56/80
 - 2s - loss: 0.0862
Epoch 57/80
 - 2s - loss: 0.0862
Epoch 58/80
 - 2s - loss: 0.0861
Epoch 59/80
 - 2s - loss: 0.0861
Epoch 60/80
 - 2s - loss: 0.0860
Epoch 61/80
 - 2s - loss: 0.0860
Epoch 62/80
 - 2s - loss: 0.0859
Epoch 63/80
 - 2s - loss: 0.0859
Epoch 64/80
 - 2s - loss: 0.0858
Epoch 65/80
 - 2s - loss: 0.0858
Epoch 66/80
 - 2s - loss: 0.0857
Epoch 67/80
 - 2s - loss: 0.0857
Epoch 68/80
 - 2s - loss: 0.0856
Epoch 69/80
 - 2s - loss: 0.0856
Epoch 70/80
 - 2s - loss: 0.0856
Epoch 71/80
 - 2s - loss: 0.0856
Epoch 72/80
 - 2s - loss: 0.0855
Epoch 73/80
 - 2s - loss: 0.0855
Epoch 74/80
 - 2s - loss: 0.0855
Epoch 75/80
 - 2s - loss: 0.0854
Epoch 76/80
 - 2s - loss: 0.0820
Epoch 77/80
 - 2s - loss: 0.0818
Epoch 78/80
 - 2s - loss: 0.0817
Epoch 79/80
 - 2s - loss: 0.0817
Epoch 80/80
 - 2s - loss: 0.0817
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.2334 - val_loss: 1.4081
AUC: 0.7843

Epoch 2/80
 - 0s - loss: 1.8659 - val_loss: 0.8457
AUC: 0.8153

Epoch 3/80
 - 0s - loss: 1.3992 - val_loss: 0.7571
AUC: 0.8262

Epoch 4/80
 - 0s - loss: 1.2385 - val_loss: 0.7514
AUC: 0.8384

Epoch 5/80
 - 0s - loss: 1.1875 - val_loss: 0.7040
AUC: 0.8447

Epoch 6/80
 - 0s - loss: 1.1527 - val_loss: 0.6750
AUC: 0.8494

Epoch 7/80
 - 0s - loss: 1.1342 - val_loss: 0.6368
AUC: 0.8502

Epoch 8/80
 - 0s - loss: 1.1114 - val_loss: 0.6624
AUC: 0.8555

Epoch 9/80
 - 0s - loss: 1.0925 - val_loss: 0.6637
AUC: 0.8568

Epoch 10/80
 - 0s - loss: 1.0854 - val_loss: 0.6600
AUC: 0.8584

Epoch 11/80
 - 0s - loss: 1.0684 - val_loss: 0.6255
AUC: 0.8591

Epoch 12/80
 - 0s - loss: 1.0649 - val_loss: 0.6426
AUC: 0.8585

Epoch 13/80
 - 0s - loss: 1.0414 - val_loss: 0.6239
AUC: 0.8606

Epoch 14/80
 - 0s - loss: 1.0490 - val_loss: 0.6111
AUC: 0.8604

Epoch 15/80
 - 0s - loss: 1.0415 - val_loss: 0.6332
AUC: 0.8617

Epoch 16/80
 - 0s - loss: 1.0326 - val_loss: 0.6590
AUC: 0.8622

Epoch 17/80
 - 0s - loss: 1.0288 - val_loss: 0.6189
AUC: 0.8621

Epoch 18/80
 - 0s - loss: 1.0201 - val_loss: 0.6277
AUC: 0.8628

Epoch 19/80
 - 0s - loss: 1.0029 - val_loss: 0.6378
AUC: 0.8635

Epoch 20/80
 - 0s - loss: 1.0141 - val_loss: 0.6323
AUC: 0.8645

Epoch 21/80
 - 0s - loss: 1.0096 - val_loss: 0.6333
AUC: 0.8646

Epoch 22/80
 - 0s - loss: 1.0039 - val_loss: 0.6141
AUC: 0.8640

Epoch 23/80
 - 0s - loss: 1.0001 - val_loss: 0.6852
AUC: 0.8651

Epoch 24/80
 - 0s - loss: 1.0003 - val_loss: 0.5858
AUC: 0.8643

Epoch 25/80
 - 0s - loss: 0.9959 - val_loss: 0.6239
AUC: 0.8650

Epoch 26/80
 - 0s - loss: 0.9908 - val_loss: 0.6307
AUC: 0.8661

Epoch 27/80
 - 0s - loss: 0.9901 - val_loss: 0.5900
AUC: 0.8666

Epoch 28/80
 - 0s - loss: 0.9842 - val_loss: 0.5387
AUC: 0.8660

Epoch 29/80
 - 0s - loss: 0.9804 - val_loss: 0.5747
AUC: 0.8661

Epoch 30/80
 - 0s - loss: 0.9763 - val_loss: 0.6227
AUC: 0.8661

Epoch 31/80
 - 0s - loss: 0.9824 - val_loss: 0.5645
AUC: 0.8664

Epoch 32/80
 - 0s - loss: 0.9736 - val_loss: 0.5760
AUC: 0.8660

Epoch 33/80
 - 0s - loss: 0.9721 - val_loss: 0.5607
AUC: 0.8668

Epoch 34/80
 - 0s - loss: 0.9699 - val_loss: 0.6167
AUC: 0.8660

Epoch 35/80
 - 0s - loss: 0.9720 - val_loss: 0.6420
AUC: 0.8677

Epoch 36/80
 - 0s - loss: 0.9631 - val_loss: 0.5758
AUC: 0.8668

Epoch 37/80
 - 0s - loss: 0.9605 - val_loss: 0.5417
AUC: 0.8665

Epoch 38/80
 - 0s - loss: 0.9604 - val_loss: 0.5461
AUC: 0.8659

Epoch 39/80
 - 0s - loss: 0.9449 - val_loss: 0.6103
AUC: 0.8677

Epoch 40/80
 - 0s - loss: 0.9477 - val_loss: 0.5780
AUC: 0.8673

Epoch 41/80
 - 0s - loss: 0.9408 - val_loss: 0.5736
AUC: 0.8673

Epoch 42/80
 - 0s - loss: 0.9426 - val_loss: 0.6088
AUC: 0.8681

Epoch 43/80
 - 0s - loss: 0.9452 - val_loss: 0.5997
AUC: 0.8680

Epoch 44/80
 - 0s - loss: 0.9393 - val_loss: 0.5767
AUC: 0.8675

Epoch 45/80
 - 0s - loss: 0.9352 - val_loss: 0.5693
AUC: 0.8672

Epoch 46/80
 - 0s - loss: 0.9342 - val_loss: 0.5591
AUC: 0.8674

Epoch 47/80
 - 0s - loss: 0.9394 - val_loss: 0.5667
AUC: 0.8676

Epoch 48/80
 - 0s - loss: 0.9394 - val_loss: 0.5545
AUC: 0.8673

Epoch 49/80
 - 0s - loss: 0.9405 - val_loss: 0.5857
AUC: 0.8679

Epoch 50/80
 - 0s - loss: 0.9332 - val_loss: 0.5861
AUC: 0.8679

Epoch 51/80
 - 0s - loss: 0.9378 - val_loss: 0.5855
AUC: 0.8679

Epoch 52/80
 - 0s - loss: 0.9341 - val_loss: 0.5994
AUC: 0.8680

Epoch 53/80
 - 0s - loss: 0.9355 - val_loss: 0.5912
AUC: 0.8680

Epoch 54/80
 - 0s - loss: 0.9374 - val_loss: 0.5974
AUC: 0.8681

Epoch 55/80
 - 0s - loss: 0.9330 - val_loss: 0.5906
AUC: 0.8680

Epoch 56/80
 - 0s - loss: 0.9295 - val_loss: 0.5882
AUC: 0.8680

Epoch 57/80
 - 0s - loss: 0.9353 - val_loss: 0.5836
AUC: 0.8679

Epoch 58/80
 - 0s - loss: 0.9395 - val_loss: 0.5922
AUC: 0.8680

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9383 - val_loss: 0.5723
AUC: 0.8676

Epoch 2/30
 - 1s - loss: 0.9405 - val_loss: 0.5961
AUC: 0.8680

Epoch 3/30
 - 1s - loss: 0.9366 - val_loss: 0.5879
AUC: 0.8681

Epoch 4/30
 - 1s - loss: 0.9342 - val_loss: 0.6108
AUC: 0.8685

Epoch 5/30
 - 1s - loss: 0.9326 - val_loss: 0.5944
AUC: 0.8683

Epoch 6/30
 - 1s - loss: 0.9287 - val_loss: 0.5797
AUC: 0.8682

Epoch 7/30
 - 1s - loss: 0.9313 - val_loss: 0.5782
AUC: 0.8681

Epoch 8/30
 - 1s - loss: 0.9273 - val_loss: 0.5896
AUC: 0.8681

Epoch 9/30
 - 1s - loss: 0.9248 - val_loss: 0.5895
AUC: 0.8684

Epoch 10/30
 - 1s - loss: 0.9261 - val_loss: 0.5774
AUC: 0.8683

Epoch 11/30
 - 1s - loss: 0.9245 - val_loss: 0.5856
AUC: 0.8685

Epoch 12/30
 - 1s - loss: 0.9219 - val_loss: 0.5868
AUC: 0.8686

Epoch 13/30
 - 1s - loss: 0.9232 - val_loss: 0.5804
AUC: 0.8686

Epoch 14/30
 - 1s - loss: 0.9154 - val_loss: 0.5816
AUC: 0.8685

Epoch 15/30
 - 1s - loss: 0.9178 - val_loss: 0.5848
AUC: 0.8685

Epoch 16/30
 - 1s - loss: 0.9215 - val_loss: 0.5851
AUC: 0.8685

Epoch 17/30
 - 1s - loss: 0.9194 - val_loss: 0.5812
AUC: 0.8684

Epoch 18/30
 - 1s - loss: 0.9171 - val_loss: 0.5868
AUC: 0.8686

Epoch 19/30
 - 1s - loss: 0.9198 - val_loss: 0.5847
AUC: 0.8686

Epoch 20/30
 - 1s - loss: 0.9199 - val_loss: 0.5821
AUC: 0.8686

Epoch 21/30
 - 1s - loss: 0.9117 - val_loss: 0.5819
AUC: 0.8685

Epoch 22/30
 - 1s - loss: 0.9161 - val_loss: 0.5821
AUC: 0.8685

Epoch 23/30
 - 1s - loss: 0.9158 - val_loss: 0.5810
AUC: 0.8685

Epoch 24/30
 - 1s - loss: 0.9179 - val_loss: 0.5811
AUC: 0.8685

Epoch 25/30
 - 1s - loss: 0.9109 - val_loss: 0.5826
AUC: 0.8686

Epoch 26/30
 - 1s - loss: 0.9167 - val_loss: 0.5826
AUC: 0.8686

Epoch 27/30
 - 1s - loss: 0.9164 - val_loss: 0.5830
AUC: 0.8686

Epoch 28/30
 - 1s - loss: 0.9187 - val_loss: 0.5824
AUC: 0.8686

Epoch 29/30
 - 1s - loss: 0.9157 - val_loss: 0.5822
AUC: 0.8686

Epoch 30/30
 - 1s - loss: 0.9147 - val_loss: 0.5819
Using TensorFlow backend.
AUC: 0.8686

2019-03-08 09:35:24.097478: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:35:24.268031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:35:24.268093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:35:24.570679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:35:24.570734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:35:24.570760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:35:24.571028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9921
Epoch 2/80
 - 2s - loss: 0.1811
Epoch 3/80
 - 2s - loss: 0.1551
Epoch 4/80
 - 2s - loss: 0.1311
Epoch 5/80
 - 2s - loss: 0.1134
Epoch 6/80
 - 2s - loss: 0.1012
Epoch 7/80
 - 2s - loss: 0.0914
Epoch 8/80
 - 2s - loss: 0.0831
Epoch 9/80
 - 2s - loss: 0.0761
Epoch 10/80
 - 2s - loss: 0.0702
Epoch 11/80
 - 2s - loss: 0.0653
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:36:04.940648: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:36:05.110010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:36:05.110057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:36:05.409209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:36:05.409264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:36:05.409274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:36:05.409539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9757
Epoch 2/80
 - 2s - loss: 0.1830
Epoch 3/80
 - 2s - loss: 0.1632
Epoch 4/80
 - 2s - loss: 0.1438
Epoch 5/80
 - 2s - loss: 0.1228
Epoch 6/80
 - 2s - loss: 0.1072
Epoch 7/80
 - 2s - loss: 0.0946
Epoch 8/80
 - 2s - loss: 0.0849
Epoch 9/80
 - 2s - loss: 0.0774
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:36:42.548364: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:36:42.711422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:36:42.711467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:36:43.011604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:36:43.011659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:36:43.011668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:36:43.011942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9958
Epoch 2/80
 - 2s - loss: 0.1832
Epoch 3/80
 - 2s - loss: 0.1616
Epoch 4/80
 - 2s - loss: 0.1392
Epoch 5/80
 - 2s - loss: 0.1203
Epoch 6/80
 - 2s - loss: 0.1077
Epoch 7/80
 - 2s - loss: 0.0972
Epoch 8/80
 - 2s - loss: 0.0875
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:37:17.348688: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:37:17.517759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:37:17.517806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:37:17.820142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:37:17.820194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:37:17.820205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:37:17.820497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9897
Epoch 2/80
 - 2s - loss: 0.1793
Epoch 3/80
 - 2s - loss: 0.1526
Epoch 4/80
 - 2s - loss: 0.1352
Epoch 5/80
 - 2s - loss: 0.1219
Epoch 6/80
 - 2s - loss: 0.1092
Epoch 7/80
 - 2s - loss: 0.0970
Epoch 8/80
 - 2s - loss: 0.0866
Epoch 9/80
 - 2s - loss: 0.0785
Epoch 10/80
 - 2s - loss: 0.0719
Epoch 11/80
 - 2s - loss: 0.0666
Epoch 12/80
 - 2s - loss: 0.0622
Epoch 13/80
 - 2s - loss: 0.0587
Epoch 14/80
 - 2s - loss: 0.0557
Epoch 15/80
 - 2s - loss: 0.0532
Epoch 16/80
 - 2s - loss: 0.0510
Epoch 17/80
 - 2s - loss: 0.0492
Epoch 18/80
 - 2s - loss: 0.0476
Epoch 19/80
 - 2s - loss: 0.0463
Epoch 20/80
 - 2s - loss: 0.0451
Epoch 21/80
 - 2s - loss: 0.0441
Epoch 22/80
 - 2s - loss: 0.0432
Epoch 23/80
 - 2s - loss: 0.0425
Epoch 24/80
 - 2s - loss: 0.0418
Epoch 25/80
 - 2s - loss: 0.0412
Epoch 26/80
 - 2s - loss: 0.0407
Epoch 27/80
 - 2s - loss: 0.0402
Epoch 28/80
 - 2s - loss: 0.0398
Epoch 29/80
 - 2s - loss: 0.0395
Epoch 30/80
 - 2s - loss: 0.0392
Epoch 31/80
 - 2s - loss: 0.0389
Epoch 32/80
 - 2s - loss: 0.0387
Epoch 33/80
 - 2s - loss: 0.0385
Epoch 34/80
 - 2s - loss: 0.0383
Epoch 35/80
 - 2s - loss: 0.0381
Epoch 36/80
 - 2s - loss: 0.0379
Epoch 37/80
 - 2s - loss: 0.0378
Epoch 38/80
 - 2s - loss: 0.0377
Epoch 39/80
 - 2s - loss: 0.0375
Epoch 40/80
 - 2s - loss: 0.0374
Epoch 41/80
 - 2s - loss: 0.0373
Epoch 42/80
 - 2s - loss: 0.0373
Epoch 43/80
 - 2s - loss: 0.0372
Epoch 44/80
 - 2s - loss: 0.0371
Epoch 45/80
 - 2s - loss: 0.0370
Epoch 46/80
 - 2s - loss: 0.0370
Epoch 47/80
 - 2s - loss: 0.0369
Epoch 48/80
 - 2s - loss: 0.0368
Epoch 49/80
 - 2s - loss: 0.0368
Epoch 50/80
 - 2s - loss: 0.0367
Epoch 51/80
 - 2s - loss: 0.0367
Epoch 52/80
 - 2s - loss: 0.0366
Epoch 53/80
 - 2s - loss: 0.0366
Epoch 54/80
 - 2s - loss: 0.0365
Epoch 55/80
 - 2s - loss: 0.0365
Epoch 56/80
 - 2s - loss: 0.0365
Epoch 57/80
 - 2s - loss: 0.0364
Epoch 58/80
 - 2s - loss: 0.0364
Epoch 59/80
 - 2s - loss: 0.0364
Epoch 60/80
 - 2s - loss: 0.0363
Epoch 61/80
 - 2s - loss: 0.0363
Epoch 62/80
 - 2s - loss: 0.0348
Epoch 63/80
 - 2s - loss: 0.0346
Epoch 64/80
 - 2s - loss: 0.0346
Epoch 65/80
 - 2s - loss: 0.0346
Epoch 66/80
 - 2s - loss: 0.0346
Epoch 67/80
 - 2s - loss: 0.0343
Epoch 68/80
 - 2s - loss: 0.0342
Epoch 69/80
 - 2s - loss: 0.0342
Epoch 70/80
 - 2s - loss: 0.0342
Epoch 71/80
 - 2s - loss: 0.0342
Epoch 72/80
 - 2s - loss: 0.0342
Epoch 73/80
 - 2s - loss: 0.0342
Epoch 74/80
 - 2s - loss: 0.0342
Epoch 75/80
 - 2s - loss: 0.0341
Epoch 76/80
 - 2s - loss: 0.0341
Epoch 77/80
 - 2s - loss: 0.0341
Epoch 78/80
 - 2s - loss: 0.0341
Epoch 79/80
 - 2s - loss: 0.0341
Epoch 80/80
 - 2s - loss: 0.0341
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.5156 - val_loss: 1.2146
AUC: 0.7511

Epoch 2/80
 - 0s - loss: 1.9355 - val_loss: 0.7971
AUC: 0.8098

Epoch 3/80
 - 0s - loss: 1.3955 - val_loss: 0.7174
AUC: 0.8277

Epoch 4/80
 - 0s - loss: 1.2314 - val_loss: 0.7044
AUC: 0.8408

Epoch 5/80
 - 0s - loss: 1.1762 - val_loss: 0.7256
AUC: 0.8473

Epoch 6/80
 - 0s - loss: 1.1323 - val_loss: 0.6896
AUC: 0.8518

Epoch 7/80
 - 0s - loss: 1.1095 - val_loss: 0.6655
AUC: 0.8563

Epoch 8/80
 - 0s - loss: 1.0927 - val_loss: 0.6752
AUC: 0.8586

Epoch 9/80
 - 0s - loss: 1.0793 - val_loss: 0.6658
AUC: 0.8608

Epoch 10/80
 - 0s - loss: 1.0707 - val_loss: 0.6098
AUC: 0.8611

Epoch 11/80
 - 0s - loss: 1.0647 - val_loss: 0.6125
AUC: 0.8625

Epoch 12/80
 - 0s - loss: 1.0549 - val_loss: 0.6021
AUC: 0.8614

Epoch 13/80
 - 0s - loss: 1.0452 - val_loss: 0.6639
AUC: 0.8631

Epoch 14/80
 - 0s - loss: 1.0374 - val_loss: 0.6802
AUC: 0.8642

Epoch 15/80
 - 0s - loss: 1.0310 - val_loss: 0.6912
AUC: 0.8659

Epoch 16/80
 - 0s - loss: 1.0306 - val_loss: 0.6897
AUC: 0.8645

Epoch 17/80
 - 0s - loss: 1.0230 - val_loss: 0.6691
AUC: 0.8649

Epoch 18/80
 - 0s - loss: 1.0168 - val_loss: 0.6020
AUC: 0.8651

Epoch 19/80
 - 0s - loss: 1.0130 - val_loss: 0.6051
AUC: 0.8663

Epoch 20/80
 - 0s - loss: 1.0016 - val_loss: 0.6455
AUC: 0.8637

Epoch 21/80
 - 0s - loss: 1.0034 - val_loss: 0.6156
AUC: 0.8661

Epoch 22/80
 - 0s - loss: 1.0022 - val_loss: 0.5965
AUC: 0.8665

Epoch 23/80
 - 0s - loss: 0.9961 - val_loss: 0.6175
AUC: 0.8674

Epoch 24/80
 - 0s - loss: 0.9918 - val_loss: 0.6089
AUC: 0.8676

Epoch 25/80
 - 0s - loss: 0.9946 - val_loss: 0.6805
AUC: 0.8672

Epoch 26/80
 - 0s - loss: 0.9868 - val_loss: 0.5983
AUC: 0.8683

Epoch 27/80
 - 0s - loss: 0.9873 - val_loss: 0.5808
AUC: 0.8663

Epoch 28/80
 - 0s - loss: 0.9757 - val_loss: 0.6274
AUC: 0.8673

Epoch 29/80
 - 0s - loss: 0.9713 - val_loss: 0.5757
AUC: 0.8674

Epoch 30/80
 - 0s - loss: 0.9776 - val_loss: 0.6141
AUC: 0.8685

Epoch 31/80
 - 0s - loss: 0.9685 - val_loss: 0.5601
AUC: 0.8675

Epoch 32/80
 - 0s - loss: 0.9641 - val_loss: 0.5443
AUC: 0.8668

Epoch 33/80
 - 0s - loss: 0.9706 - val_loss: 0.6175
AUC: 0.8671

Epoch 34/80
 - 0s - loss: 0.9605 - val_loss: 0.6251
AUC: 0.8683

Epoch 35/80
 - 0s - loss: 0.9608 - val_loss: 0.6293
AUC: 0.8674

Epoch 36/80
 - 0s - loss: 0.9562 - val_loss: 0.6569
AUC: 0.8681

Epoch 37/80
 - 0s - loss: 0.9511 - val_loss: 0.5698
AUC: 0.8690

Epoch 38/80
 - 0s - loss: 0.9496 - val_loss: 0.5922
AUC: 0.8679

Epoch 39/80
 - 0s - loss: 0.9423 - val_loss: 0.6144
AUC: 0.8692

Epoch 40/80
 - 0s - loss: 0.9420 - val_loss: 0.5940
AUC: 0.8682

Epoch 41/80
 - 0s - loss: 0.9438 - val_loss: 0.5799
AUC: 0.8698

Epoch 42/80
 - 0s - loss: 0.9436 - val_loss: 0.5829
AUC: 0.8680

Epoch 43/80
 - 0s - loss: 0.9268 - val_loss: 0.5848
AUC: 0.8694

Epoch 44/80
 - 0s - loss: 0.9279 - val_loss: 0.5873
AUC: 0.8695

Epoch 45/80
 - 0s - loss: 0.9178 - val_loss: 0.5687
AUC: 0.8690

Epoch 46/80
 - 0s - loss: 0.9252 - val_loss: 0.5804
AUC: 0.8695

Epoch 47/80
 - 0s - loss: 0.9228 - val_loss: 0.5664
AUC: 0.8687

Epoch 48/80
 - 0s - loss: 0.9206 - val_loss: 0.5836
AUC: 0.8695

Epoch 49/80
 - 0s - loss: 0.9229 - val_loss: 0.5921
AUC: 0.8694

Epoch 50/80
 - 0s - loss: 0.9220 - val_loss: 0.5833
AUC: 0.8691

Epoch 51/80
 - 0s - loss: 0.9151 - val_loss: 0.5850
AUC: 0.8692

Epoch 52/80
 - 0s - loss: 0.9236 - val_loss: 0.5857
AUC: 0.8691

Epoch 53/80
 - 0s - loss: 0.9209 - val_loss: 0.5727
AUC: 0.8692

Epoch 54/80
 - 0s - loss: 0.9148 - val_loss: 0.5831
AUC: 0.8694

Epoch 55/80
 - 0s - loss: 0.9111 - val_loss: 0.5717
AUC: 0.8692

Epoch 56/80
 - 0s - loss: 0.9099 - val_loss: 0.5889
AUC: 0.8694

Epoch 57/80
 - 0s - loss: 0.9163 - val_loss: 0.5783
AUC: 0.8692

Epoch 58/80
 - 0s - loss: 0.9191 - val_loss: 0.5797
AUC: 0.8693

Epoch 59/80
 - 0s - loss: 0.9093 - val_loss: 0.5831
AUC: 0.8693

Epoch 60/80
 - 0s - loss: 0.9153 - val_loss: 0.5842
AUC: 0.8694

Epoch 61/80
 - 0s - loss: 0.9041 - val_loss: 0.5678
AUC: 0.8691

Epoch 62/80
 - 0s - loss: 0.9107 - val_loss: 0.5814
AUC: 0.8692

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9268 - val_loss: 0.5506
AUC: 0.8687

Epoch 2/30
 - 1s - loss: 0.9247 - val_loss: 0.5890
AUC: 0.8694

Epoch 3/30
 - 1s - loss: 0.9225 - val_loss: 0.5994
AUC: 0.8693

Epoch 4/30
 - 1s - loss: 0.9206 - val_loss: 0.5888
AUC: 0.8690

Epoch 5/30
 - 1s - loss: 0.9196 - val_loss: 0.5876
AUC: 0.8692

Epoch 6/30
 - 1s - loss: 0.9137 - val_loss: 0.5973
AUC: 0.8697

Epoch 7/30
 - 1s - loss: 0.9138 - val_loss: 0.5798
AUC: 0.8692

Epoch 8/30
 - 1s - loss: 0.9124 - val_loss: 0.5777
AUC: 0.8694

Epoch 9/30
 - 1s - loss: 0.9119 - val_loss: 0.5695
AUC: 0.8692

Epoch 10/30
 - 1s - loss: 0.9086 - val_loss: 0.6184
AUC: 0.8697

Epoch 11/30
 - 1s - loss: 0.9130 - val_loss: 0.5798
AUC: 0.8693

Epoch 12/30
 - 1s - loss: 0.9068 - val_loss: 0.5790
AUC: 0.8694

Epoch 13/30
 - 1s - loss: 0.9113 - val_loss: 0.5836
AUC: 0.8694

Epoch 14/30
 - 1s - loss: 0.9050 - val_loss: 0.5837
AUC: 0.8695

Epoch 15/30
 - 1s - loss: 0.9112 - val_loss: 0.5829
AUC: 0.8694

Epoch 16/30
 - 1s - loss: 0.9070 - val_loss: 0.5754
AUC: 0.8693

Epoch 17/30
 - 1s - loss: 0.9025 - val_loss: 0.5808
AUC: 0.8694

Epoch 18/30
 - 1s - loss: 0.8973 - val_loss: 0.5750
AUC: 0.8692

Epoch 19/30
 - 1s - loss: 0.9025 - val_loss: 0.5753
AUC: 0.8692

Epoch 20/30
 - 1s - loss: 0.9002 - val_loss: 0.5740
AUC: 0.8692

Epoch 21/30
 - 1s - loss: 0.8994 - val_loss: 0.5821
AUC: 0.8693

Epoch 22/30
 - 1s - loss: 0.9031 - val_loss: 0.5807
AUC: 0.8693

Epoch 23/30
 - 1s - loss: 0.8972 - val_loss: 0.5788
AUC: 0.8693

Epoch 24/30
 - 1s - loss: 0.9000 - val_loss: 0.5776
AUC: 0.8692

Epoch 25/30
 - 1s - loss: 0.9011 - val_loss: 0.5763
AUC: 0.8692

Epoch 26/30
 - 1s - loss: 0.8968 - val_loss: 0.5760
AUC: 0.8692

Epoch 27/30
 - 1s - loss: 0.8985 - val_loss: 0.5743
AUC: 0.8692

Epoch 28/30
 - 1s - loss: 0.9007 - val_loss: 0.5748
AUC: 0.8692

Epoch 29/30
 - 1s - loss: 0.9076 - val_loss: 0.5766
AUC: 0.8692

Epoch 30/30
 - 1s - loss: 0.9033 - val_loss: 0.5769
Using TensorFlow backend.
AUC: 0.8693

2019-03-08 09:41:24.778563: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:41:24.945564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:41:24.945620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:41:25.260249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:41:25.260304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:41:25.260313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:41:25.260578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6148
Epoch 2/80
 - 2s - loss: 0.0840
Epoch 3/80
 - 2s - loss: 0.0636
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:41:49.854626: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:41:50.020027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:41:50.020073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:41:50.327462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:41:50.327515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:41:50.327524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:41:50.327812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6056
Epoch 2/80
 - 2s - loss: 0.0826
Epoch 3/80
 - 2s - loss: 0.0634
Epoch 4/80
 - 2s - loss: 0.0567
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:42:16.945906: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:42:17.114093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:42:17.114140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:42:17.412928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:42:17.412982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:42:17.412991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:42:17.413251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.5931
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:42:41.866071: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:42:42.034865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:42:42.034912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:42:42.336956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:42:42.337013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:42:42.337022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:42:42.337287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1953
Epoch 2/80
 - 2s - loss: 0.3172
Epoch 3/80
 - 2s - loss: 0.2761
Epoch 4/80
 - 2s - loss: 0.2335
Epoch 5/80
 - 2s - loss: 0.2055
Epoch 6/80
 - 2s - loss: 0.1858
Epoch 7/80
 - 2s - loss: 0.1703
Epoch 8/80
 - 2s - loss: 0.1570
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:43:16.660542: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:43:16.828588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:43:16.828636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:43:17.131453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:43:17.131508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:43:17.131517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:43:17.131796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2109
Epoch 2/80
 - 2s - loss: 0.3149
Epoch 3/80
 - 2s - loss: 0.2717
Epoch 4/80
 - 2s - loss: 0.2367
Epoch 5/80
 - 2s - loss: 0.2086
Epoch 6/80
 - 2s - loss: 0.1875
Epoch 7/80
 - 2s - loss: 0.1707
Epoch 8/80
 - 2s - loss: 0.1573
Epoch 9/80
 - 2s - loss: 0.1465
Epoch 10/80
 - 2s - loss: 0.1377
Epoch 11/80
 - 2s - loss: 0.1305
Epoch 12/80
 - 2s - loss: 0.1245
Epoch 13/80
 - 2s - loss: 0.1195
Epoch 14/80
 - 2s - loss: 0.1152
Epoch 15/80
 - 2s - loss: 0.1114
Epoch 16/80
 - 2s - loss: 0.1081
Epoch 17/80
 - 2s - loss: 0.1052
Epoch 18/80
 - 2s - loss: 0.1028
Epoch 19/80
 - 2s - loss: 0.1006
Epoch 20/80
 - 2s - loss: 0.0988
Epoch 21/80
 - 2s - loss: 0.0971
Epoch 22/80
 - 2s - loss: 0.0958
Epoch 23/80
 - 2s - loss: 0.0946
Epoch 24/80
 - 2s - loss: 0.0936
Epoch 25/80
 - 2s - loss: 0.0927
Epoch 26/80
 - 2s - loss: 0.0920
Epoch 27/80
 - 2s - loss: 0.0914
Epoch 28/80
 - 2s - loss: 0.0908
Epoch 29/80
 - 2s - loss: 0.0903
Epoch 30/80
 - 2s - loss: 0.0899
Epoch 31/80
 - 2s - loss: 0.0895
Epoch 32/80
 - 2s - loss: 0.0891
Epoch 33/80
 - 2s - loss: 0.0888
Epoch 34/80
 - 2s - loss: 0.0885
Epoch 35/80
 - 2s - loss: 0.0883
Epoch 36/80
 - 2s - loss: 0.0881
Epoch 37/80
 - 2s - loss: 0.0879
Epoch 38/80
 - 2s - loss: 0.0876
Epoch 39/80
 - 2s - loss: 0.0875
Epoch 40/80
 - 2s - loss: 0.0873
Epoch 41/80
 - 2s - loss: 0.0872
Epoch 42/80
 - 2s - loss: 0.0870
Epoch 43/80
 - 2s - loss: 0.0869
Epoch 44/80
 - 2s - loss: 0.0868
Epoch 45/80
 - 2s - loss: 0.0866
Epoch 46/80
 - 2s - loss: 0.0865
Epoch 47/80
 - 2s - loss: 0.0864
Epoch 48/80
 - 2s - loss: 0.0863
Epoch 49/80
 - 2s - loss: 0.0862
Epoch 50/80
 - 2s - loss: 0.0861
Epoch 51/80
 - 2s - loss: 0.0861
Epoch 52/80
 - 2s - loss: 0.0860
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:45:21.447881: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:45:21.618386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:45:21.618432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:45:21.922047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:45:21.922095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:45:21.922104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:45:21.922370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1815
Epoch 2/80
 - 2s - loss: 0.3138
Epoch 3/80
 - 2s - loss: 0.2720
Epoch 4/80
 - 2s - loss: 0.2393
Epoch 5/80
 - 2s - loss: 0.2101
Epoch 6/80
 - 2s - loss: 0.1872
Epoch 7/80
 - 2s - loss: 0.1711
Epoch 8/80
 - 2s - loss: 0.1585
Epoch 9/80
 - 2s - loss: 0.1477
Epoch 10/80
 - 2s - loss: 0.1388
Epoch 11/80
 - 2s - loss: 0.1315
Epoch 12/80
 - 2s - loss: 0.1255
Epoch 13/80
 - 2s - loss: 0.1205
Epoch 14/80
 - 2s - loss: 0.1163
Epoch 15/80
 - 2s - loss: 0.1124
Epoch 16/80
 - 2s - loss: 0.1091
Epoch 17/80
 - 2s - loss: 0.1061
Epoch 18/80
 - 2s - loss: 0.1036
Epoch 19/80
 - 2s - loss: 0.1013
Epoch 20/80
 - 2s - loss: 0.0994
Epoch 21/80
 - 2s - loss: 0.0977
Epoch 22/80
 - 2s - loss: 0.0962
Epoch 23/80
 - 2s - loss: 0.0950
Epoch 24/80
 - 2s - loss: 0.0940
Epoch 25/80
 - 2s - loss: 0.0931
Epoch 26/80
 - 2s - loss: 0.0923
Epoch 27/80
 - 2s - loss: 0.0916
Epoch 28/80
 - 2s - loss: 0.0911
Epoch 29/80
 - 2s - loss: 0.0905
Epoch 30/80
 - 2s - loss: 0.0901
Epoch 31/80
 - 2s - loss: 0.0898
Epoch 32/80
 - 2s - loss: 0.0894
Epoch 33/80
 - 2s - loss: 0.0891
Epoch 34/80
 - 2s - loss: 0.0888
Epoch 35/80
 - 2s - loss: 0.0885
Epoch 36/80
 - 2s - loss: 0.0883
Epoch 37/80
 - 2s - loss: 0.0881
Epoch 38/80
 - 2s - loss: 0.0879
Epoch 39/80
 - 2s - loss: 0.0877
Epoch 40/80
 - 2s - loss: 0.0876
Epoch 41/80
 - 2s - loss: 0.0874
Epoch 42/80
 - 2s - loss: 0.0873
Epoch 43/80
 - 2s - loss: 0.0871
Epoch 44/80
 - 2s - loss: 0.0871
Epoch 45/80
 - 2s - loss: 0.0869
Epoch 46/80
 - 2s - loss: 0.0868
Epoch 47/80
 - 2s - loss: 0.0867
Epoch 48/80
 - 2s - loss: 0.0867
Epoch 49/80
 - 2s - loss: 0.0866
Epoch 50/80
 - 2s - loss: 0.0864
Epoch 51/80
 - 2s - loss: 0.0864
Epoch 52/80
 - 2s - loss: 0.0863
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2b164b89e0b8>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 09:47:26.376660: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:47:26.545180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:47:26.545226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:47:26.844368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:47:26.844422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:47:26.844442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:47:26.844707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0050
Epoch 2/80
 - 2s - loss: 0.1812
Epoch 3/80
 - 2s - loss: 0.1612
Epoch 4/80
 - 2s - loss: 0.1407
Epoch 5/80
 - 2s - loss: 0.1199
Epoch 6/80
 - 2s - loss: 0.1059
Epoch 7/80
 - 2s - loss: 0.0954
Epoch 8/80
 - 2s - loss: 0.0863
Epoch 9/80
 - 2s - loss: 0.0784
Epoch 10/80
 - 2s - loss: 0.0718
Epoch 11/80
 - 2s - loss: 0.0663
Epoch 12/80
 - 2s - loss: 0.0620
Epoch 13/80
 - 2s - loss: 0.0584
Epoch 14/80
 - 2s - loss: 0.0554
Epoch 15/80
 - 2s - loss: 0.0529
Epoch 16/80
 - 2s - loss: 0.0508
Epoch 17/80
 - 2s - loss: 0.0489
Epoch 18/80
 - 2s - loss: 0.0473
Epoch 19/80
 - 2s - loss: 0.0459
Epoch 20/80
 - 2s - loss: 0.0447
Epoch 21/80
 - 2s - loss: 0.0437
Epoch 22/80
 - 2s - loss: 0.0428
Epoch 23/80
 - 2s - loss: 0.0420
Epoch 24/80
 - 2s - loss: 0.0413
Epoch 25/80
 - 2s - loss: 0.0407
Epoch 26/80
 - 2s - loss: 0.0402
Epoch 27/80
 - 2s - loss: 0.0398
Epoch 28/80
 - 2s - loss: 0.0394
Epoch 29/80
 - 2s - loss: 0.0391
Epoch 30/80
 - 2s - loss: 0.0388
Epoch 31/80
 - 2s - loss: 0.0385
Epoch 32/80
 - 2s - loss: 0.0383
Epoch 33/80
 - 2s - loss: 0.0381
Epoch 34/80
 - 2s - loss: 0.0379
Epoch 35/80
 - 2s - loss: 0.0377
Epoch 36/80
 - 2s - loss: 0.0376
Epoch 37/80
 - 2s - loss: 0.0374
Epoch 38/80
 - 2s - loss: 0.0373
Epoch 39/80
 - 2s - loss: 0.0372
Epoch 40/80
 - 2s - loss: 0.0371
Epoch 41/80
 - 2s - loss: 0.0370
Epoch 42/80
 - 2s - loss: 0.0369
Epoch 43/80
 - 2s - loss: 0.0368
Epoch 44/80
 - 2s - loss: 0.0368
Epoch 45/80
 - 2s - loss: 0.0367
Epoch 46/80
 - 2s - loss: 0.0366
Epoch 47/80
 - 2s - loss: 0.0366
Epoch 48/80
 - 2s - loss: 0.0365
Epoch 49/80
 - 2s - loss: 0.0365
Epoch 50/80
 - 2s - loss: 0.0364
Epoch 51/80
 - 2s - loss: 0.0364
Epoch 52/80
 - 2s - loss: 0.0363
Epoch 53/80
 - 2s - loss: 0.0363
Epoch 54/80
 - 2s - loss: 0.0363
Epoch 55/80
 - 2s - loss: 0.0362
Epoch 56/80
 - 2s - loss: 0.0362
Epoch 57/80
 - 2s - loss: 0.0347
Epoch 58/80
 - 2s - loss: 0.0345
Epoch 59/80
 - 2s - loss: 0.0345
Epoch 60/80
 - 2s - loss: 0.0345
Epoch 61/80
 - 2s - loss: 0.0345
Epoch 62/80
 - 2s - loss: 0.0341
Epoch 63/80
 - 2s - loss: 0.0341
Epoch 64/80
 - 2s - loss: 0.0341
Epoch 65/80
 - 2s - loss: 0.0341
Epoch 66/80
 - 2s - loss: 0.0340
Epoch 67/80
 - 2s - loss: 0.0340
Epoch 68/80
 - 2s - loss: 0.0340
Epoch 69/80
 - 2s - loss: 0.0340
Epoch 70/80
 - 2s - loss: 0.0340
Epoch 71/80
 - 2s - loss: 0.0340
Epoch 72/80
 - 2s - loss: 0.0340
Epoch 73/80
 - 2s - loss: 0.0340
Epoch 74/80
 - 2s - loss: 0.0340
Epoch 75/80
 - 2s - loss: 0.0340
Epoch 76/80
 - 2s - loss: 0.0340
Epoch 77/80
 - 2s - loss: 0.0340
Epoch 78/80
 - 2s - loss: 0.0340
Epoch 79/80
 - 2s - loss: 0.0340
Epoch 80/80
 - 2s - loss: 0.0340
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.7785 - val_loss: 1.6485
AUC: 0.7814

Epoch 2/80
 - 0s - loss: 2.4972 - val_loss: 0.8643
AUC: 0.8031

Epoch 3/80
 - 0s - loss: 1.6663 - val_loss: 0.7518
AUC: 0.8184

Epoch 4/80
 - 0s - loss: 1.3432 - val_loss: 0.7814
AUC: 0.8313

Epoch 5/80
 - 0s - loss: 1.2363 - val_loss: 0.6759
AUC: 0.8361

Epoch 6/80
 - 0s - loss: 1.1966 - val_loss: 0.7047
AUC: 0.8420

Epoch 7/80
 - 0s - loss: 1.1567 - val_loss: 0.7113
AUC: 0.8516

Epoch 8/80
 - 0s - loss: 1.1312 - val_loss: 0.6749
AUC: 0.8539

Epoch 9/80
 - 0s - loss: 1.1141 - val_loss: 0.7113
AUC: 0.8567

Epoch 10/80
 - 0s - loss: 1.0990 - val_loss: 0.6586
AUC: 0.8592

Epoch 11/80
 - 0s - loss: 1.0916 - val_loss: 0.6781
AUC: 0.8619

Epoch 12/80
 - 0s - loss: 1.0843 - val_loss: 0.6703
AUC: 0.8631

Epoch 13/80
 - 0s - loss: 1.0800 - val_loss: 0.6610
AUC: 0.8647

Epoch 14/80
 - 0s - loss: 1.0666 - val_loss: 0.6245
AUC: 0.8637

Epoch 15/80
 - 0s - loss: 1.0714 - val_loss: 0.6773
AUC: 0.8651

Epoch 16/80
 - 0s - loss: 1.0574 - val_loss: 0.6054
AUC: 0.8657

Epoch 17/80
 - 0s - loss: 1.0513 - val_loss: 0.6193
AUC: 0.8662

Epoch 18/80
 - 0s - loss: 1.0442 - val_loss: 0.6221
AUC: 0.8677

Epoch 19/80
 - 0s - loss: 1.0465 - val_loss: 0.6557
AUC: 0.8677

Epoch 20/80
 - 0s - loss: 1.0373 - val_loss: 0.6108
AUC: 0.8684

Epoch 21/80
 - 0s - loss: 1.0311 - val_loss: 0.6586
AUC: 0.8689

Epoch 22/80
 - 0s - loss: 1.0325 - val_loss: 0.6695
AUC: 0.8700

Epoch 23/80
 - 0s - loss: 1.0285 - val_loss: 0.6527
AUC: 0.8703

Epoch 24/80
 - 0s - loss: 1.0277 - val_loss: 0.6612
AUC: 0.8697

Epoch 25/80
 - 0s - loss: 1.0255 - val_loss: 0.6672
AUC: 0.8699

Epoch 26/80
 - 0s - loss: 1.0199 - val_loss: 0.6513
AUC: 0.8705

Epoch 27/80
 - 0s - loss: 1.0100 - val_loss: 0.6044
AUC: 0.8704

Epoch 28/80
 - 0s - loss: 1.0089 - val_loss: 0.6343
AUC: 0.8712

Epoch 29/80
 - 0s - loss: 1.0054 - val_loss: 0.6088
AUC: 0.8712

Epoch 30/80
 - 0s - loss: 1.0100 - val_loss: 0.6250
AUC: 0.8714

Epoch 31/80
 - 0s - loss: 1.0036 - val_loss: 0.6014
AUC: 0.8710

Epoch 32/80
 - 0s - loss: 1.0073 - val_loss: 0.6309
AUC: 0.8713

Epoch 33/80
 - 0s - loss: 1.0086 - val_loss: 0.5860
AUC: 0.8714

Epoch 34/80
 - 0s - loss: 1.0066 - val_loss: 0.6401
AUC: 0.8715

Epoch 35/80
 - 0s - loss: 1.0043 - val_loss: 0.6134
AUC: 0.8712

Epoch 36/80
 - 0s - loss: 1.0070 - val_loss: 0.6170
AUC: 0.8717

Epoch 37/80
 - 0s - loss: 1.0075 - val_loss: 0.6260
AUC: 0.8715

Epoch 38/80
 - 0s - loss: 1.0073 - val_loss: 0.6193
AUC: 0.8714

Epoch 39/80
 - 0s - loss: 1.0072 - val_loss: 0.5768
AUC: 0.8717

Epoch 40/80
 - 0s - loss: 1.0038 - val_loss: 0.6353
AUC: 0.8714

Epoch 41/80
 - 0s - loss: 1.0042 - val_loss: 0.6613
AUC: 0.8718

Epoch 42/80
 - 0s - loss: 1.0008 - val_loss: 0.6002
AUC: 0.8716

Epoch 43/80
 - 0s - loss: 0.9965 - val_loss: 0.6031
AUC: 0.8716

Epoch 44/80
 - 0s - loss: 0.9991 - val_loss: 0.6315
AUC: 0.8721

Epoch 45/80
 - 0s - loss: 1.0012 - val_loss: 0.6341
AUC: 0.8717

Epoch 46/80
 - 0s - loss: 1.0014 - val_loss: 0.5902
AUC: 0.8721

Epoch 47/80
 - 0s - loss: 1.0056 - val_loss: 0.6308
AUC: 0.8721

Epoch 48/80
 - 0s - loss: 0.9970 - val_loss: 0.5932
AUC: 0.8718

Epoch 49/80
 - 0s - loss: 0.9991 - val_loss: 0.6150
AUC: 0.8723

Epoch 50/80
 - 0s - loss: 0.9981 - val_loss: 0.6009
AUC: 0.8721

Epoch 51/80
 - 0s - loss: 0.9962 - val_loss: 0.6173
AUC: 0.8722

Epoch 52/80
 - 0s - loss: 0.9975 - val_loss: 0.6104
AUC: 0.8721

Epoch 53/80
 - 0s - loss: 0.9975 - val_loss: 0.6040
AUC: 0.8721

Epoch 54/80
 - 0s - loss: 0.9956 - val_loss: 0.6089
AUC: 0.8721

Epoch 55/80
 - 0s - loss: 0.9878 - val_loss: 0.6180
AUC: 0.8722

Epoch 56/80
 - 0s - loss: 0.9935 - val_loss: 0.6143
AUC: 0.8722

Epoch 57/80
 - 0s - loss: 0.9961 - val_loss: 0.6192
AUC: 0.8722

Epoch 58/80
 - 0s - loss: 0.9908 - val_loss: 0.6076
AUC: 0.8722

Epoch 59/80
 - 0s - loss: 0.9946 - val_loss: 0.6188
AUC: 0.8723

Epoch 60/80
 - 0s - loss: 0.9922 - val_loss: 0.6129
AUC: 0.8723

Epoch 61/80
 - 0s - loss: 0.9949 - val_loss: 0.6139
AUC: 0.8723

Epoch 62/80
 - 0s - loss: 0.9970 - val_loss: 0.6117
AUC: 0.8723

Epoch 63/80
 - 0s - loss: 0.9938 - val_loss: 0.6116
AUC: 0.8723

Epoch 64/80
 - 0s - loss: 1.0009 - val_loss: 0.6108
AUC: 0.8723

Epoch 65/80
 - 0s - loss: 0.9976 - val_loss: 0.6117
AUC: 0.8723

Epoch 66/80
 - 0s - loss: 0.9939 - val_loss: 0.6112
AUC: 0.8723

Epoch 67/80
 - 0s - loss: 0.9933 - val_loss: 0.6112
AUC: 0.8723

Epoch 68/80
 - 0s - loss: 0.9967 - val_loss: 0.6136
AUC: 0.8723

Epoch 69/80
 - 0s - loss: 0.9918 - val_loss: 0.6115
AUC: 0.8723

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9950 - val_loss: 0.6128
AUC: 0.8724

Epoch 2/30
 - 0s - loss: 0.9941 - val_loss: 0.6027
AUC: 0.8729

Epoch 3/30
 - 0s - loss: 0.9899 - val_loss: 0.6176
AUC: 0.8723

Epoch 4/30
 - 0s - loss: 0.9882 - val_loss: 0.5933
AUC: 0.8726

Epoch 5/30
 - 0s - loss: 0.9870 - val_loss: 0.6276
AUC: 0.8729

Epoch 6/30
 - 0s - loss: 0.9859 - val_loss: 0.6135
AUC: 0.8730

Epoch 7/30
 - 0s - loss: 0.9824 - val_loss: 0.6172
AUC: 0.8731

Epoch 8/30
 - 0s - loss: 0.9853 - val_loss: 0.6094
AUC: 0.8732

Epoch 9/30
 - 0s - loss: 0.9835 - val_loss: 0.6063
AUC: 0.8732

Epoch 10/30
 - 0s - loss: 0.9754 - val_loss: 0.6184
AUC: 0.8732

Epoch 11/30
 - 0s - loss: 0.9778 - val_loss: 0.6078
AUC: 0.8732

Epoch 12/30
 - 0s - loss: 0.9726 - val_loss: 0.6055
AUC: 0.8736

Epoch 13/30
 - 0s - loss: 0.9683 - val_loss: 0.5975
AUC: 0.8734

Epoch 14/30
 - 0s - loss: 0.9719 - val_loss: 0.6036
AUC: 0.8736

Epoch 15/30
 - 0s - loss: 0.9732 - val_loss: 0.6037
AUC: 0.8736

Epoch 16/30
 - 0s - loss: 0.9677 - val_loss: 0.6028
AUC: 0.8736

Epoch 17/30
 - 0s - loss: 0.9658 - val_loss: 0.6017
AUC: 0.8737

Epoch 18/30
 - 0s - loss: 0.9716 - val_loss: 0.5954
AUC: 0.8736

Epoch 19/30
 - 0s - loss: 0.9697 - val_loss: 0.6004
AUC: 0.8736

Epoch 20/30
 - 0s - loss: 0.9684 - val_loss: 0.5959
AUC: 0.8737

Epoch 21/30
 - 0s - loss: 0.9705 - val_loss: 0.6000
AUC: 0.8737

Epoch 22/30
 - 0s - loss: 0.9671 - val_loss: 0.6006
AUC: 0.8737

Epoch 23/30
 - 0s - loss: 0.9698 - val_loss: 0.5978
AUC: 0.8737

Epoch 24/30
 - 0s - loss: 0.9662 - val_loss: 0.6015
AUC: 0.8738

Epoch 25/30
 - 0s - loss: 0.9723 - val_loss: 0.6020
AUC: 0.8738

Epoch 26/30
 - 0s - loss: 0.9621 - val_loss: 0.6005
AUC: 0.8738

Epoch 27/30
 - 0s - loss: 0.9696 - val_loss: 0.6007
AUC: 0.8737

Epoch 28/30
 - 0s - loss: 0.9716 - val_loss: 0.6000
AUC: 0.8738

Epoch 29/30
 - 0s - loss: 0.9640 - val_loss: 0.6002
AUC: 0.8738

Epoch 30/30
 - 0s - loss: 0.9621 - val_loss: 0.5993
Using TensorFlow backend.
AUC: 0.8737

2019-03-08 09:51:31.245646: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:51:31.413977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:51:31.414025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:51:31.714498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:51:31.714554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:51:31.714563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:51:31.714837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9765
Epoch 2/80
 - 2s - loss: 0.1819
Epoch 3/80
 - 2s - loss: 0.1649
Epoch 4/80
 - 2s - loss: 0.1485
Epoch 5/80
 - 2s - loss: 0.1282
Epoch 6/80
 - 2s - loss: 0.1121
Epoch 7/80
 - 2s - loss: 0.0989
Epoch 8/80
 - 2s - loss: 0.0881
Epoch 9/80
 - 2s - loss: 0.0795
Epoch 10/80
 - 2s - loss: 0.0726
Epoch 11/80
 - 2s - loss: 0.0670
Epoch 12/80
 - 2s - loss: 0.0624
Epoch 13/80
 - 2s - loss: 0.0588
Epoch 14/80
 - 2s - loss: 0.0559
Epoch 15/80
 - 2s - loss: 0.0534
Epoch 16/80
 - 2s - loss: 0.0513
Epoch 17/80
 - 2s - loss: 0.0494
Epoch 18/80
 - 2s - loss: 0.0478
Epoch 19/80
 - 2s - loss: 0.0465
Epoch 20/80
 - 2s - loss: 0.0453
Epoch 21/80
 - 2s - loss: 0.0442
Epoch 22/80
 - 2s - loss: 0.0433
Epoch 23/80
 - 2s - loss: 0.0425
Epoch 24/80
 - 2s - loss: 0.0418
Epoch 25/80
 - 2s - loss: 0.0412
Epoch 26/80
 - 2s - loss: 0.0406
Epoch 27/80
 - 2s - loss: 0.0402
Epoch 28/80
 - 2s - loss: 0.0398
Epoch 29/80
 - 2s - loss: 0.0394
Epoch 30/80
 - 2s - loss: 0.0391
Epoch 31/80
 - 2s - loss: 0.0388
Epoch 32/80
 - 2s - loss: 0.0386
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:52:57.935629: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:52:58.103176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:52:58.103223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:52:58.405559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:52:58.405615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:52:58.405624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:52:58.405921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9895
Epoch 2/80
 - 2s - loss: 0.1829
Epoch 3/80
 - 2s - loss: 0.1614
Epoch 4/80
 - 2s - loss: 0.1403
Epoch 5/80
 - 2s - loss: 0.1202
Epoch 6/80
 - 2s - loss: 0.1053
Epoch 7/80
 - 2s - loss: 0.0940
Epoch 8/80
 - 2s - loss: 0.0847
Epoch 9/80
 - 2s - loss: 0.0769
Epoch 10/80
 - 2s - loss: 0.0706
Epoch 11/80
 - 2s - loss: 0.0655
Epoch 12/80
 - 2s - loss: 0.0614
Epoch 13/80
 - 2s - loss: 0.0580
Epoch 14/80
 - 2s - loss: 0.0551
Epoch 15/80
 - 2s - loss: 0.0528
Epoch 16/80
 - 2s - loss: 0.0507
Epoch 17/80
 - 2s - loss: 0.0489
Epoch 18/80
 - 2s - loss: 0.0474
Epoch 19/80
 - 2s - loss: 0.0460
Epoch 20/80
 - 2s - loss: 0.0448
Epoch 21/80
 - 2s - loss: 0.0438
Epoch 22/80
 - 2s - loss: 0.0429
Epoch 23/80
 - 2s - loss: 0.0422
Epoch 24/80
 - 2s - loss: 0.0415
Epoch 25/80
 - 2s - loss: 0.0409
Epoch 26/80
 - 2s - loss: 0.0404
Epoch 27/80
 - 2s - loss: 0.0400
Epoch 28/80
 - 2s - loss: 0.0396
Epoch 29/80
 - 2s - loss: 0.0393
Epoch 30/80
 - 2s - loss: 0.0390
Epoch 31/80
 - 2s - loss: 0.0387
Epoch 32/80
 - 2s - loss: 0.0385
Epoch 33/80
 - 2s - loss: 0.0383
Epoch 34/80
 - 2s - loss: 0.0381
Epoch 35/80
 - 2s - loss: 0.0379
Epoch 36/80
 - 2s - loss: 0.0378
Epoch 37/80
 - 2s - loss: 0.0376
Epoch 38/80
 - 2s - loss: 0.0375
Epoch 39/80
 - 2s - loss: 0.0374
Epoch 40/80
 - 2s - loss: 0.0373
Epoch 41/80
 - 2s - loss: 0.0372
Epoch 42/80
 - 2s - loss: 0.0371
Epoch 43/80
 - 2s - loss: 0.0370
Epoch 44/80
 - 2s - loss: 0.0369
Epoch 45/80
 - 2s - loss: 0.0369
Epoch 46/80
 - 2s - loss: 0.0368
Epoch 47/80
 - 2s - loss: 0.0367
Epoch 48/80
 - 2s - loss: 0.0367
Epoch 49/80
 - 2s - loss: 0.0366
Epoch 50/80
 - 2s - loss: 0.0366
Epoch 51/80
 - 2s - loss: 0.0365
Epoch 52/80
 - 2s - loss: 0.0365
Epoch 53/80
 - 2s - loss: 0.0365
Epoch 54/80
 - 2s - loss: 0.0364
Epoch 55/80
 - 2s - loss: 0.0364
Epoch 56/80
 - 2s - loss: 0.0363
Epoch 57/80
 - 2s - loss: 0.0363
Epoch 58/80
 - 2s - loss: 0.0363
Epoch 59/80
 - 2s - loss: 0.0347
Epoch 60/80
 - 2s - loss: 0.0346
Epoch 61/80
 - 2s - loss: 0.0346
Epoch 62/80
 - 2s - loss: 0.0346
Epoch 63/80
 - 2s - loss: 0.0346
Epoch 64/80
 - 2s - loss: 0.0342
Epoch 65/80
 - 2s - loss: 0.0342
Epoch 66/80
 - 2s - loss: 0.0342
Epoch 67/80
 - 2s - loss: 0.0342
Epoch 68/80
 - 2s - loss: 0.0341
Epoch 69/80
 - 2s - loss: 0.0341
Epoch 70/80
 - 2s - loss: 0.0341
Epoch 71/80
 - 2s - loss: 0.0341
Epoch 72/80
 - 2s - loss: 0.0341
Epoch 73/80
 - 2s - loss: 0.0341
Epoch 74/80
 - 2s - loss: 0.0341
Epoch 75/80
 - 2s - loss: 0.0341
Epoch 76/80
 - 2s - loss: 0.0341
Epoch 77/80
 - 2s - loss: 0.0341
Epoch 78/80
 - 2s - loss: 0.0341
Epoch 79/80
 - 2s - loss: 0.0341
Epoch 80/80
 - 2s - loss: 0.0341
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 6.0707 - val_loss: 2.6904
AUC: 0.7919

Epoch 2/80
 - 0s - loss: 4.3192 - val_loss: 1.4066
AUC: 0.8027

Epoch 3/80
 - 0s - loss: 3.0342 - val_loss: 1.1662
AUC: 0.8214

Epoch 4/80
 - 0s - loss: 2.0279 - val_loss: 1.0509
AUC: 0.8346

Epoch 5/80
 - 0s - loss: 1.4897 - val_loss: 0.7347
AUC: 0.8396

Epoch 6/80
 - 0s - loss: 1.2762 - val_loss: 0.6866
AUC: 0.8439

Epoch 7/80
 - 0s - loss: 1.2059 - val_loss: 0.6550
AUC: 0.8465

Epoch 8/80
 - 0s - loss: 1.1680 - val_loss: 0.6613
AUC: 0.8486

Epoch 9/80
 - 0s - loss: 1.1303 - val_loss: 0.6452
AUC: 0.8518

Epoch 10/80
 - 0s - loss: 1.1201 - val_loss: 0.6114
AUC: 0.8550

Epoch 11/80
 - 0s - loss: 1.1042 - val_loss: 0.6878
AUC: 0.8560

Epoch 12/80
 - 0s - loss: 1.1055 - val_loss: 0.6097
AUC: 0.8559

Epoch 13/80
 - 0s - loss: 1.0846 - val_loss: 0.6290
AUC: 0.8570

Epoch 14/80
 - 0s - loss: 1.0703 - val_loss: 0.6775
AUC: 0.8608

Epoch 15/80
 - 0s - loss: 1.0633 - val_loss: 0.6690
AUC: 0.8602

Epoch 16/80
 - 0s - loss: 1.0652 - val_loss: 0.6557
AUC: 0.8605

Epoch 17/80
 - 0s - loss: 1.0496 - val_loss: 0.6326
AUC: 0.8632

Epoch 18/80
 - 0s - loss: 1.0436 - val_loss: 0.6472
AUC: 0.8626

Epoch 19/80
 - 0s - loss: 1.0349 - val_loss: 0.5971
AUC: 0.8624

Epoch 20/80
 - 0s - loss: 1.0404 - val_loss: 0.6074
AUC: 0.8634

Epoch 21/80
 - 0s - loss: 1.0341 - val_loss: 0.6418
AUC: 0.8628

Epoch 22/80
 - 0s - loss: 1.0339 - val_loss: 0.6661
AUC: 0.8652

Epoch 23/80
 - 0s - loss: 1.0248 - val_loss: 0.6320
AUC: 0.8649

Epoch 24/80
 - 0s - loss: 1.0192 - val_loss: 0.6238
AUC: 0.8645

Epoch 25/80
 - 0s - loss: 1.0208 - val_loss: 0.6132
AUC: 0.8649

Epoch 26/80
 - 0s - loss: 1.0181 - val_loss: 0.6280
AUC: 0.8661

Epoch 27/80
 - 0s - loss: 1.0154 - val_loss: 0.5486
AUC: 0.8632

Epoch 28/80
 - 0s - loss: 1.0098 - val_loss: 0.6176
AUC: 0.8653

Epoch 29/80
 - 0s - loss: 1.0096 - val_loss: 0.6158
AUC: 0.8659

Epoch 30/80
 - 0s - loss: 1.0000 - val_loss: 0.6347
AUC: 0.8662

Epoch 31/80
 - 0s - loss: 1.0109 - val_loss: 0.6635
AUC: 0.8669

Epoch 32/80
 - 0s - loss: 0.9995 - val_loss: 0.6310
AUC: 0.8665

Epoch 33/80
 - 0s - loss: 0.9932 - val_loss: 0.5796
AUC: 0.8657

Epoch 34/80
 - 0s - loss: 0.9968 - val_loss: 0.6668
AUC: 0.8676

Epoch 35/80
 - 0s - loss: 0.9979 - val_loss: 0.6591
AUC: 0.8681

Epoch 36/80
 - 0s - loss: 0.9909 - val_loss: 0.5794
AUC: 0.8666

Epoch 37/80
 - 0s - loss: 0.9918 - val_loss: 0.6213
AUC: 0.8677

Epoch 38/80
 - 0s - loss: 0.9813 - val_loss: 0.5920
AUC: 0.8672

Epoch 39/80
 - 0s - loss: 0.9809 - val_loss: 0.6371
AUC: 0.8676

Epoch 40/80
 - 0s - loss: 0.9790 - val_loss: 0.6437
AUC: 0.8675

Epoch 41/80
 - 0s - loss: 0.9811 - val_loss: 0.6116
AUC: 0.8672

Epoch 42/80
 - 0s - loss: 0.9765 - val_loss: 0.5860
AUC: 0.8667

Epoch 43/80
 - 0s - loss: 0.9811 - val_loss: 0.6026
AUC: 0.8676

Epoch 44/80
 - 0s - loss: 0.9770 - val_loss: 0.5696
AUC: 0.8666

Epoch 45/80
 - 0s - loss: 0.9725 - val_loss: 0.6123
AUC: 0.8676

Epoch 46/80
 - 0s - loss: 0.9791 - val_loss: 0.6039
AUC: 0.8675

Epoch 47/80
 - 0s - loss: 0.9719 - val_loss: 0.5933
AUC: 0.8669

Epoch 48/80
 - 0s - loss: 0.9794 - val_loss: 0.6080
AUC: 0.8674

Epoch 49/80
 - 0s - loss: 0.9711 - val_loss: 0.6023
AUC: 0.8673

Epoch 50/80
 - 0s - loss: 0.9747 - val_loss: 0.6001
AUC: 0.8674

Epoch 51/80
 - 0s - loss: 0.9719 - val_loss: 0.6041
AUC: 0.8673

Epoch 52/80
 - 0s - loss: 0.9693 - val_loss: 0.6108
AUC: 0.8674

Epoch 53/80
 - 0s - loss: 0.9720 - val_loss: 0.6056
AUC: 0.8673

Epoch 54/80
 - 0s - loss: 0.9699 - val_loss: 0.6021
AUC: 0.8673

Epoch 55/80
 - 0s - loss: 0.9717 - val_loss: 0.6082
AUC: 0.8674

Epoch 56/80
 - 0s - loss: 0.9703 - val_loss: 0.6051
AUC: 0.8672

Epoch 57/80
 - 0s - loss: 0.9716 - val_loss: 0.6092
AUC: 0.8673

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9868 - val_loss: 0.6278
AUC: 0.8674

Epoch 2/30
 - 0s - loss: 0.9838 - val_loss: 0.6157
AUC: 0.8677

Epoch 3/30
 - 0s - loss: 0.9768 - val_loss: 0.5911
AUC: 0.8672

Epoch 4/30
 - 0s - loss: 0.9784 - val_loss: 0.6175
AUC: 0.8677

Epoch 5/30
 - 0s - loss: 0.9789 - val_loss: 0.6245
AUC: 0.8679

Epoch 6/30
 - 0s - loss: 0.9722 - val_loss: 0.6137
AUC: 0.8677

Epoch 7/30
 - 0s - loss: 0.9753 - val_loss: 0.6019
AUC: 0.8679

Epoch 8/30
 - 0s - loss: 0.9710 - val_loss: 0.6063
AUC: 0.8680

Epoch 9/30
 - 0s - loss: 0.9694 - val_loss: 0.6065
AUC: 0.8679

Epoch 10/30
 - 0s - loss: 0.9702 - val_loss: 0.5917
AUC: 0.8679

Epoch 11/30
 - 0s - loss: 0.9615 - val_loss: 0.6328
AUC: 0.8682

Epoch 12/30
 - 0s - loss: 0.9622 - val_loss: 0.6173
AUC: 0.8681

Epoch 13/30
 - 0s - loss: 0.9582 - val_loss: 0.6078
AUC: 0.8681

Epoch 14/30
 - 0s - loss: 0.9589 - val_loss: 0.5962
AUC: 0.8679

Epoch 15/30
 - 0s - loss: 0.9602 - val_loss: 0.5973
AUC: 0.8680

Epoch 16/30
 - 0s - loss: 0.9620 - val_loss: 0.6001
AUC: 0.8681

Epoch 17/30
 - 0s - loss: 0.9583 - val_loss: 0.5985
AUC: 0.8681

Epoch 18/30
 - 0s - loss: 0.9578 - val_loss: 0.5967
AUC: 0.8681

Epoch 19/30
 - 0s - loss: 0.9551 - val_loss: 0.5962
AUC: 0.8681

Epoch 20/30
 - 0s - loss: 0.9615 - val_loss: 0.5958
AUC: 0.8681

Epoch 21/30
 - 0s - loss: 0.9562 - val_loss: 0.6020
AUC: 0.8682

Epoch 22/30
 - 0s - loss: 0.9575 - val_loss: 0.5994
AUC: 0.8682

Epoch 23/30
 - 0s - loss: 0.9552 - val_loss: 0.6005
AUC: 0.8682

Epoch 24/30
 - 0s - loss: 0.9598 - val_loss: 0.6000
AUC: 0.8682

Epoch 25/30
 - 0s - loss: 0.9546 - val_loss: 0.5981
AUC: 0.8682

Epoch 26/30
 - 0s - loss: 0.9596 - val_loss: 0.5978
AUC: 0.8682

Epoch 27/30
 - 0s - loss: 0.9578 - val_loss: 0.5973
AUC: 0.8681

Epoch 28/30
 - 0s - loss: 0.9580 - val_loss: 0.5982
AUC: 0.8682

Epoch 29/30
 - 0s - loss: 0.9579 - val_loss: 0.5971
AUC: 0.8682

Epoch 30/30
 - 0s - loss: 0.9524 - val_loss: 0.5971
Using TensorFlow backend.
AUC: 0.8682

2019-03-08 09:56:56.461687: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:56:56.626965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:56:56.627030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:56:56.931305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:56:56.931362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:56:56.931372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:56:56.931637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9991
Epoch 2/80
 - 2s - loss: 0.1821
Epoch 3/80
 - 2s - loss: 0.1614
Epoch 4/80
 - 2s - loss: 0.1444
Epoch 5/80
 - 2s - loss: 0.1275
Epoch 6/80
 - 2s - loss: 0.1125
Epoch 7/80
 - 2s - loss: 0.0993
Epoch 8/80
 - 2s - loss: 0.0883
Epoch 9/80
 - 2s - loss: 0.0795
Epoch 10/80
 - 2s - loss: 0.0726
Epoch 11/80
 - 2s - loss: 0.0671
Epoch 12/80
 - 2s - loss: 0.0626
Epoch 13/80
 - 2s - loss: 0.0590
Epoch 14/80
 - 2s - loss: 0.0560
Epoch 15/80
 - 2s - loss: 0.0535
Epoch 16/80
 - 2s - loss: 0.0513
Epoch 17/80
 - 2s - loss: 0.0495
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 09:57:49.862584: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 09:57:50.029941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 09:57:50.029987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 09:57:50.333267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 09:57:50.333322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 09:57:50.333332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 09:57:50.333607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6102
Epoch 2/80
 - 2s - loss: 0.0842
Epoch 3/80
 - 2s - loss: 0.0657
Epoch 4/80
 - 2s - loss: 0.0597
Epoch 5/80
 - 2s - loss: 0.0529
Epoch 6/80
 - 2s - loss: 0.0473
Epoch 7/80
 - 2s - loss: 0.0422
Epoch 8/80
 - 2s - loss: 0.0375
Epoch 9/80
 - 2s - loss: 0.0332
Epoch 10/80
 - 2s - loss: 0.0297
Epoch 11/80
 - 2s - loss: 0.0270
Epoch 12/80
 - 2s - loss: 0.0247
Epoch 13/80
 - 2s - loss: 0.0228
Epoch 14/80
 - 2s - loss: 0.0213
Epoch 15/80
 - 2s - loss: 0.0200
Epoch 16/80
 - 2s - loss: 0.0189
Epoch 17/80
 - 2s - loss: 0.0180
Epoch 18/80
 - 2s - loss: 0.0172
Epoch 19/80
 - 2s - loss: 0.0166
Epoch 20/80
 - 2s - loss: 0.0160
Epoch 21/80
 - 2s - loss: 0.0155
Epoch 22/80
 - 2s - loss: 0.0151
Epoch 23/80
 - 2s - loss: 0.0147
Epoch 24/80
 - 2s - loss: 0.0144
Epoch 25/80
 - 2s - loss: 0.0141
Epoch 26/80
 - 2s - loss: 0.0138
Epoch 27/80
 - 2s - loss: 0.0136
Epoch 28/80
 - 2s - loss: 0.0134
Epoch 29/80
 - 2s - loss: 0.0132
Epoch 30/80
 - 2s - loss: 0.0131
Epoch 31/80
 - 2s - loss: 0.0129
Epoch 32/80
 - 2s - loss: 0.0128
Epoch 33/80
 - 2s - loss: 0.0127
Epoch 34/80
 - 2s - loss: 0.0126
Epoch 35/80
 - 2s - loss: 0.0125
Epoch 36/80
 - 2s - loss: 0.0124
Epoch 37/80
 - 2s - loss: 0.0124
Epoch 38/80
 - 2s - loss: 0.0123
Epoch 39/80
 - 2s - loss: 0.0122
Epoch 40/80
 - 2s - loss: 0.0122
Epoch 41/80
 - 2s - loss: 0.0121
Epoch 42/80
 - 2s - loss: 0.0121
Epoch 43/80
 - 2s - loss: 0.0120
Epoch 44/80
 - 2s - loss: 0.0120
Epoch 45/80
 - 2s - loss: 0.0120
Epoch 46/80
 - 2s - loss: 0.0120
Epoch 47/80
 - 2s - loss: 0.0119
Epoch 48/80
 - 2s - loss: 0.0114
Epoch 49/80
 - 2s - loss: 0.0113
Epoch 50/80
 - 2s - loss: 0.0113
Epoch 51/80
 - 2s - loss: 0.0113
Epoch 52/80
 - 2s - loss: 0.0112
Epoch 53/80
 - 2s - loss: 0.0112
Epoch 54/80
 - 2s - loss: 0.0112
Epoch 55/80
 - 2s - loss: 0.0112
Epoch 56/80
 - 2s - loss: 0.0112
Epoch 57/80
 - 2s - loss: 0.0112
Epoch 58/80
 - 2s - loss: 0.0112
Epoch 59/80
 - 2s - loss: 0.0111
Epoch 60/80
 - 2s - loss: 0.0111
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:00:08.989487: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:00:09.164152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:00:09.164199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:00:09.461883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:00:09.461941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:00:09.461951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:00:09.462243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6014
Epoch 2/80
 - 2s - loss: 0.0826
Epoch 3/80
 - 2s - loss: 0.0662
Epoch 4/80
 - 2s - loss: 0.0615
Epoch 5/80
 - 2s - loss: 0.0554
Epoch 6/80
 - 2s - loss: 0.0484
Epoch 7/80
 - 2s - loss: 0.0423
Epoch 8/80
 - 2s - loss: 0.0373
Epoch 9/80
 - 2s - loss: 0.0332
Epoch 10/80
 - 2s - loss: 0.0297
Epoch 11/80
 - 2s - loss: 0.0269
Epoch 12/80
 - 2s - loss: 0.0246
Epoch 13/80
 - 2s - loss: 0.0228
Epoch 14/80
 - 2s - loss: 0.0213
Epoch 15/80
 - 2s - loss: 0.0200
Epoch 16/80
 - 2s - loss: 0.0190
Epoch 17/80
 - 2s - loss: 0.0181
Epoch 18/80
 - 2s - loss: 0.0173
Epoch 19/80
 - 2s - loss: 0.0166
Epoch 20/80
 - 2s - loss: 0.0160
Epoch 21/80
 - 2s - loss: 0.0155
Epoch 22/80
 - 2s - loss: 0.0150
Epoch 23/80
 - 2s - loss: 0.0147
Epoch 24/80
 - 2s - loss: 0.0143
Epoch 25/80
 - 2s - loss: 0.0140
Epoch 26/80
 - 2s - loss: 0.0138
Epoch 27/80
 - 2s - loss: 0.0135
Epoch 28/80
 - 2s - loss: 0.0134
Epoch 29/80
 - 2s - loss: 0.0132
Epoch 30/80
 - 2s - loss: 0.0130
Epoch 31/80
 - 2s - loss: 0.0129
Epoch 32/80
 - 2s - loss: 0.0128
Epoch 33/80
 - 2s - loss: 0.0127
Epoch 34/80
 - 2s - loss: 0.0126
Epoch 35/80
 - 2s - loss: 0.0125
Epoch 36/80
 - 2s - loss: 0.0124
Epoch 37/80
 - 2s - loss: 0.0123
Epoch 38/80
 - 2s - loss: 0.0123
Epoch 39/80
 - 2s - loss: 0.0122
Epoch 40/80
 - 2s - loss: 0.0122
Epoch 41/80
 - 2s - loss: 0.0121
Epoch 42/80
 - 2s - loss: 0.0121
Epoch 43/80
 - 2s - loss: 0.0121
Epoch 44/80
 - 2s - loss: 0.0120
Epoch 45/80
 - 2s - loss: 0.0120
Epoch 46/80
 - 2s - loss: 0.0120
Epoch 47/80
 - 2s - loss: 0.0119
Epoch 48/80
 - 2s - loss: 0.0119
Epoch 49/80
 - 2s - loss: 0.0114
Epoch 50/80
 - 2s - loss: 0.0113
Epoch 51/80
 - 2s - loss: 0.0113
Epoch 52/80
 - 2s - loss: 0.0113
Epoch 53/80
 - 2s - loss: 0.0112
Epoch 54/80
 - 2s - loss: 0.0112
Epoch 55/80
 - 2s - loss: 0.0112
Epoch 56/80
 - 2s - loss: 0.0112
Epoch 57/80
 - 2s - loss: 0.0111
Epoch 58/80
 - 2s - loss: 0.0111
Epoch 59/80
 - 2s - loss: 0.0111
Epoch 60/80
 - 2s - loss: 0.0111
Epoch 61/80
 - 2s - loss: 0.0111
Epoch 62/80
 - 2s - loss: 0.0111
Epoch 63/80
 - 2s - loss: 0.0111
Epoch 64/80
 - 2s - loss: 0.0111
Epoch 65/80
 - 2s - loss: 0.0111
Epoch 66/80
 - 2s - loss: 0.0111
Epoch 67/80
 - 2s - loss: 0.0111
Epoch 68/80
 - 2s - loss: 0.0111
Epoch 69/80
 - 2s - loss: 0.0111
Epoch 70/80
 - 2s - loss: 0.0111
Epoch 71/80
 - 2s - loss: 0.0111
Epoch 72/80
 - 2s - loss: 0.0111
Epoch 73/80
 - 2s - loss: 0.0111
Epoch 74/80
 - 2s - loss: 0.0111
Epoch 75/80
 - 2s - loss: 0.0111
Epoch 76/80
 - 2s - loss: 0.0111
Epoch 77/80
 - 2s - loss: 0.0111
Epoch 78/80
 - 2s - loss: 0.0111
Epoch 79/80
 - 2s - loss: 0.0111
Epoch 80/80
 - 2s - loss: 0.0111
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.6908 - val_loss: 1.9203
AUC: 0.8067

Epoch 2/80
 - 0s - loss: 2.6770 - val_loss: 0.9818
AUC: 0.8198

Epoch 3/80
 - 0s - loss: 1.6753 - val_loss: 0.8470
AUC: 0.8260

Epoch 4/80
 - 0s - loss: 1.3541 - val_loss: 0.6651
AUC: 0.8359

Epoch 5/80
 - 0s - loss: 1.2284 - val_loss: 0.6018
AUC: 0.8409

Epoch 6/80
 - 0s - loss: 1.1772 - val_loss: 0.6610
AUC: 0.8492

Epoch 7/80
 - 0s - loss: 1.1407 - val_loss: 0.6639
AUC: 0.8518

Epoch 8/80
 - 0s - loss: 1.1292 - val_loss: 0.6481
AUC: 0.8548

Epoch 9/80
 - 0s - loss: 1.1003 - val_loss: 0.6753
AUC: 0.8610

Epoch 10/80
 - 0s - loss: 1.0950 - val_loss: 0.6063
AUC: 0.8607

Epoch 11/80
 - 0s - loss: 1.0808 - val_loss: 0.6361
AUC: 0.8622

Epoch 12/80
 - 0s - loss: 1.0734 - val_loss: 0.7152
AUC: 0.8657

Epoch 13/80
 - 0s - loss: 1.0624 - val_loss: 0.6233
AUC: 0.8658

Epoch 14/80
 - 0s - loss: 1.0604 - val_loss: 0.5668
AUC: 0.8669

Epoch 15/80
 - 0s - loss: 1.0490 - val_loss: 0.6229
AUC: 0.8682

Epoch 16/80
 - 0s - loss: 1.0473 - val_loss: 0.5927
AUC: 0.8689

Epoch 17/80
 - 0s - loss: 1.0369 - val_loss: 0.5733
AUC: 0.8685

Epoch 18/80
 - 0s - loss: 1.0304 - val_loss: 0.6246
AUC: 0.8707

Epoch 19/80
 - 0s - loss: 1.0281 - val_loss: 0.6262
AUC: 0.8712

Epoch 20/80
 - 0s - loss: 1.0198 - val_loss: 0.6447
AUC: 0.8729

Epoch 21/80
 - 0s - loss: 1.0174 - val_loss: 0.6490
AUC: 0.8729

Epoch 22/80
 - 0s - loss: 1.0136 - val_loss: 0.6368
AUC: 0.8739

Epoch 23/80
 - 0s - loss: 1.0211 - val_loss: 0.5547
AUC: 0.8707

Epoch 24/80
 - 0s - loss: 1.0148 - val_loss: 0.5853
AUC: 0.8720

Epoch 25/80
 - 0s - loss: 1.0144 - val_loss: 0.6546
AUC: 0.8738

Epoch 26/80
 - 0s - loss: 1.0097 - val_loss: 0.6445
AUC: 0.8728

Epoch 27/80
 - 0s - loss: 1.0052 - val_loss: 0.6471
AUC: 0.8743

Epoch 28/80
 - 0s - loss: 0.9974 - val_loss: 0.6054
AUC: 0.8735

Epoch 29/80
 - 0s - loss: 0.9978 - val_loss: 0.6226
AUC: 0.8742

Epoch 30/80
 - 0s - loss: 0.9960 - val_loss: 0.6059
AUC: 0.8732

Epoch 31/80
 - 0s - loss: 0.9947 - val_loss: 0.5721
AUC: 0.8744

Epoch 32/80
 - 0s - loss: 0.9895 - val_loss: 0.6049
AUC: 0.8743

Epoch 33/80
 - 0s - loss: 0.9879 - val_loss: 0.5542
AUC: 0.8745

Epoch 34/80
 - 0s - loss: 0.9812 - val_loss: 0.5888
AUC: 0.8755

Epoch 35/80
 - 0s - loss: 0.9850 - val_loss: 0.5118
AUC: 0.8744

Epoch 36/80
 - 0s - loss: 0.9853 - val_loss: 0.6111
AUC: 0.8761

Epoch 37/80
 - 0s - loss: 0.9873 - val_loss: 0.6608
AUC: 0.8764

Epoch 38/80
 - 0s - loss: 0.9852 - val_loss: 0.6153
AUC: 0.8758

Epoch 39/80
 - 0s - loss: 0.9680 - val_loss: 0.5508
AUC: 0.8745

Epoch 40/80
 - 0s - loss: 0.9764 - val_loss: 0.5681
AUC: 0.8754

Epoch 41/80
 - 0s - loss: 0.9714 - val_loss: 0.5925
AUC: 0.8765

Epoch 42/80
 - 0s - loss: 0.9662 - val_loss: 0.6187
AUC: 0.8770

Epoch 43/80
 - 0s - loss: 0.9739 - val_loss: 0.5776
AUC: 0.8762

Epoch 44/80
 - 0s - loss: 0.9699 - val_loss: 0.5786
AUC: 0.8764

Epoch 45/80
 - 0s - loss: 0.9726 - val_loss: 0.6208
AUC: 0.8768

Epoch 46/80
 - 0s - loss: 0.9607 - val_loss: 0.5907
AUC: 0.8769

Epoch 47/80
 - 0s - loss: 0.9562 - val_loss: 0.5933
AUC: 0.8769

Epoch 48/80
 - 0s - loss: 0.9513 - val_loss: 0.5552
AUC: 0.8761

Epoch 49/80
 - 0s - loss: 0.9546 - val_loss: 0.5753
AUC: 0.8770

Epoch 50/80
 - 0s - loss: 0.9543 - val_loss: 0.5947
AUC: 0.8773

Epoch 51/80
 - 0s - loss: 0.9482 - val_loss: 0.5909
AUC: 0.8769

Epoch 52/80
 - 0s - loss: 0.9551 - val_loss: 0.6261
AUC: 0.8774

Epoch 53/80
 - 0s - loss: 0.9541 - val_loss: 0.5886
AUC: 0.8768

Epoch 54/80
 - 0s - loss: 0.9507 - val_loss: 0.6046
AUC: 0.8771

Epoch 55/80
 - 0s - loss: 0.9468 - val_loss: 0.5613
AUC: 0.8765

Epoch 56/80
 - 0s - loss: 0.9533 - val_loss: 0.5955
AUC: 0.8771

Epoch 57/80
 - 0s - loss: 0.9528 - val_loss: 0.5890
AUC: 0.8770

Epoch 58/80
 - 0s - loss: 0.9502 - val_loss: 0.5790
AUC: 0.8770

Epoch 59/80
 - 0s - loss: 0.9489 - val_loss: 0.5825
AUC: 0.8770

Epoch 60/80
 - 0s - loss: 0.9481 - val_loss: 0.5924
AUC: 0.8772

Epoch 61/80
 - 0s - loss: 0.9442 - val_loss: 0.5886
AUC: 0.8771

Epoch 62/80
 - 0s - loss: 0.9460 - val_loss: 0.5881
AUC: 0.8771

Epoch 63/80
 - 0s - loss: 0.9491 - val_loss: 0.5857
AUC: 0.8771

Epoch 64/80
 - 0s - loss: 0.9502 - val_loss: 0.5868
AUC: 0.8771

Epoch 65/80
 - 0s - loss: 0.9514 - val_loss: 0.5897
AUC: 0.8772

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9517 - val_loss: 0.5900
AUC: 0.8772

Epoch 2/30
 - 0s - loss: 0.9489 - val_loss: 0.6024
AUC: 0.8775

Epoch 3/30
 - 0s - loss: 0.9438 - val_loss: 0.5800
AUC: 0.8771

Epoch 4/30
 - 0s - loss: 0.9470 - val_loss: 0.5817
AUC: 0.8773

Epoch 5/30
 - 0s - loss: 0.9477 - val_loss: 0.5851
AUC: 0.8775

Epoch 6/30
 - 0s - loss: 0.9421 - val_loss: 0.5782
AUC: 0.8774

Epoch 7/30
 - 0s - loss: 0.9414 - val_loss: 0.5837
AUC: 0.8777

Epoch 8/30
 - 0s - loss: 0.9394 - val_loss: 0.5943
AUC: 0.8779

Epoch 9/30
 - 0s - loss: 0.9373 - val_loss: 0.5764
AUC: 0.8777

Epoch 10/30
 - 0s - loss: 0.9316 - val_loss: 0.5749
AUC: 0.8778

Epoch 11/30
 - 0s - loss: 0.9363 - val_loss: 0.5842
AUC: 0.8779

Epoch 12/30
 - 0s - loss: 0.9331 - val_loss: 0.5808
AUC: 0.8780

Epoch 13/30
 - 0s - loss: 0.9293 - val_loss: 0.5857
AUC: 0.8781

Epoch 14/30
 - 0s - loss: 0.9289 - val_loss: 0.5954
AUC: 0.8783

Epoch 15/30
 - 0s - loss: 0.9311 - val_loss: 0.5803
AUC: 0.8783

Epoch 16/30
 - 0s - loss: 0.9263 - val_loss: 0.5825
AUC: 0.8783

Epoch 17/30
 - 0s - loss: 0.9228 - val_loss: 0.5686
AUC: 0.8783

Epoch 18/30
 - 0s - loss: 0.9227 - val_loss: 0.5877
AUC: 0.8785

Epoch 19/30
 - 0s - loss: 0.9221 - val_loss: 0.5813
AUC: 0.8784

Epoch 20/30
 - 0s - loss: 0.9185 - val_loss: 0.5665
AUC: 0.8783

Epoch 21/30
 - 0s - loss: 0.9157 - val_loss: 0.5791
AUC: 0.8786

Epoch 22/30
 - 0s - loss: 0.9171 - val_loss: 0.5679
AUC: 0.8785

Epoch 23/30
 - 0s - loss: 0.9158 - val_loss: 0.5836
AUC: 0.8788

Epoch 24/30
 - 0s - loss: 0.9122 - val_loss: 0.5569
AUC: 0.8783

Epoch 25/30
 - 0s - loss: 0.9148 - val_loss: 0.5860
AUC: 0.8788

Epoch 26/30
 - 0s - loss: 0.9101 - val_loss: 0.5774
AUC: 0.8788

Epoch 27/30
 - 0s - loss: 0.9048 - val_loss: 0.5622
AUC: 0.8785

Epoch 28/30
 - 0s - loss: 0.9070 - val_loss: 0.5635
AUC: 0.8787

Epoch 29/30
 - 0s - loss: 0.9056 - val_loss: 0.5646
AUC: 0.8788

Epoch 30/30
 - 0s - loss: 0.9031 - val_loss: 0.5722
Using TensorFlow backend.
AUC: 0.8789

2019-03-08 10:04:13.613420: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:04:13.784858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:04:13.784906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:04:14.086120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:04:14.086176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:04:14.086185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:04:14.086450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6000
Epoch 2/80
 - 2s - loss: 0.0828
Epoch 3/80
 - 2s - loss: 0.0639
Epoch 4/80
 - 2s - loss: 0.0563
Epoch 5/80
 - 2s - loss: 0.0501
Epoch 6/80
 - 2s - loss: 0.0448
Epoch 7/80
 - 2s - loss: 0.0402
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:04:45.973344: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:04:46.140652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:04:46.140698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:04:46.443341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:04:46.443395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:04:46.443403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:04:46.443669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2077
Epoch 2/80
 - 2s - loss: 0.3121
Epoch 3/80
 - 2s - loss: 0.2651
Epoch 4/80
 - 2s - loss: 0.2278
Epoch 5/80
 - 2s - loss: 0.2020
Epoch 6/80
 - 2s - loss: 0.1833
Epoch 7/80
 - 2s - loss: 0.1682
Epoch 8/80
 - 2s - loss: 0.1559
Epoch 9/80
 - 2s - loss: 0.1455
Epoch 10/80
 - 2s - loss: 0.1370
Epoch 11/80
 - 2s - loss: 0.1300
Epoch 12/80
 - 2s - loss: 0.1243
Epoch 13/80
 - 2s - loss: 0.1194
Epoch 14/80
 - 2s - loss: 0.1152
Epoch 15/80
 - 2s - loss: 0.1115
Epoch 16/80
 - 2s - loss: 0.1082
Epoch 17/80
 - 2s - loss: 0.1053
Epoch 18/80
 - 2s - loss: 0.1029
Epoch 19/80
 - 2s - loss: 0.1007
Epoch 20/80
 - 2s - loss: 0.0988
Epoch 21/80
 - 2s - loss: 0.0972
Epoch 22/80
 - 2s - loss: 0.0959
Epoch 23/80
 - 2s - loss: 0.0946
Epoch 24/80
 - 2s - loss: 0.0936
Epoch 25/80
 - 2s - loss: 0.0927
Epoch 26/80
 - 2s - loss: 0.0920
Epoch 27/80
 - 2s - loss: 0.0913
Epoch 28/80
 - 2s - loss: 0.0907
Epoch 29/80
 - 2s - loss: 0.0902
Epoch 30/80
 - 2s - loss: 0.0898
Epoch 31/80
 - 2s - loss: 0.0894
Epoch 32/80
 - 2s - loss: 0.0890
Epoch 33/80
 - 2s - loss: 0.0887
Epoch 34/80
 - 2s - loss: 0.0885
Epoch 35/80
 - 2s - loss: 0.0882
Epoch 36/80
 - 2s - loss: 0.0880
Epoch 37/80
 - 2s - loss: 0.0877
Epoch 38/80
 - 2s - loss: 0.0876
Epoch 39/80
 - 2s - loss: 0.0873
Epoch 40/80
 - 2s - loss: 0.0872
Epoch 41/80
 - 2s - loss: 0.0870
Epoch 42/80
 - 2s - loss: 0.0869
Epoch 43/80
 - 2s - loss: 0.0868
Epoch 44/80
 - 2s - loss: 0.0867
Epoch 45/80
 - 2s - loss: 0.0865
Epoch 46/80
 - 2s - loss: 0.0865
Epoch 47/80
 - 2s - loss: 0.0863
Epoch 48/80
 - 2s - loss: 0.0862
Epoch 49/80
 - 2s - loss: 0.0861
Epoch 50/80
 - 2s - loss: 0.0861
Epoch 51/80
 - 2s - loss: 0.0860
Epoch 52/80
 - 2s - loss: 0.0859
Epoch 53/80
 - 2s - loss: 0.0859
Epoch 54/80
 - 2s - loss: 0.0858
Epoch 55/80
 - 2s - loss: 0.0857
Epoch 56/80
 - 2s - loss: 0.0857
Epoch 57/80
 - 2s - loss: 0.0856
Epoch 58/80
 - 2s - loss: 0.0855
Epoch 59/80
 - 2s - loss: 0.0855
Epoch 60/80
 - 2s - loss: 0.0855
Epoch 61/80
 - 2s - loss: 0.0854
Epoch 62/80
 - 2s - loss: 0.0853
Epoch 63/80
 - 2s - loss: 0.0853
Epoch 64/80
 - 2s - loss: 0.0852
Epoch 65/80
 - 2s - loss: 0.0852
Epoch 66/80
 - 2s - loss: 0.0852
Epoch 67/80
 - 2s - loss: 0.0852
Epoch 68/80
 - 2s - loss: 0.0818
Epoch 69/80
 - 2s - loss: 0.0815
Epoch 70/80
 - 2s - loss: 0.0815
Epoch 71/80
 - 2s - loss: 0.0815
Epoch 72/80
 - 2s - loss: 0.0815
Epoch 73/80
 - 2s - loss: 0.0807
Epoch 74/80
 - 2s - loss: 0.0806
Epoch 75/80
 - 2s - loss: 0.0806
Epoch 76/80
 - 2s - loss: 0.0806
Epoch 77/80
 - 2s - loss: 0.0804
Epoch 78/80
 - 2s - loss: 0.0804
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:07:40.364680: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:07:40.533337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:07:40.533392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:07:40.832472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:07:40.832527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:07:40.832536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:07:40.832804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2292
Epoch 2/80
 - 2s - loss: 0.3140
Epoch 3/80
 - 2s - loss: 0.2603
Epoch 4/80
 - 2s - loss: 0.2233
Epoch 5/80
 - 2s - loss: 0.2007
Epoch 6/80
 - 2s - loss: 0.1833
Epoch 7/80
 - 2s - loss: 0.1688
Epoch 8/80
 - 2s - loss: 0.1564
Epoch 9/80
 - 2s - loss: 0.1458
Epoch 10/80
 - 2s - loss: 0.1370
Epoch 11/80
 - 2s - loss: 0.1299
Epoch 12/80
 - 2s - loss: 0.1241
Epoch 13/80
 - 2s - loss: 0.1193
Epoch 14/80
 - 2s - loss: 0.1152
Epoch 15/80
 - 2s - loss: 0.1116
Epoch 16/80
 - 2s - loss: 0.1084
Epoch 17/80
 - 2s - loss: 0.1057
Epoch 18/80
 - 2s - loss: 0.1032
Epoch 19/80
 - 2s - loss: 0.1011
Epoch 20/80
 - 2s - loss: 0.0992
Epoch 21/80
 - 2s - loss: 0.0975
Epoch 22/80
 - 2s - loss: 0.0961
Epoch 23/80
 - 2s - loss: 0.0949
Epoch 24/80
 - 2s - loss: 0.0938
Epoch 25/80
 - 2s - loss: 0.0929
Epoch 26/80
 - 2s - loss: 0.0921
Epoch 27/80
 - 2s - loss: 0.0915
Epoch 28/80
 - 2s - loss: 0.0909
Epoch 29/80
 - 2s - loss: 0.0904
Epoch 30/80
 - 2s - loss: 0.0899
Epoch 31/80
 - 2s - loss: 0.0895
Epoch 32/80
 - 2s - loss: 0.0891
Epoch 33/80
 - 2s - loss: 0.0888
Epoch 34/80
 - 2s - loss: 0.0885
Epoch 35/80
 - 2s - loss: 0.0882
Epoch 36/80
 - 2s - loss: 0.0880
Epoch 37/80
 - 2s - loss: 0.0878
Epoch 38/80
 - 2s - loss: 0.0876
Epoch 39/80
 - 2s - loss: 0.0874
Epoch 40/80
 - 2s - loss: 0.0872
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:09:19.941783: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:09:20.110026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:09:20.110086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:09:20.409795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:09:20.409852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:09:20.409861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:09:20.410148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2006
Epoch 2/80
 - 2s - loss: 0.3182
Epoch 3/80
 - 2s - loss: 0.2829
Epoch 4/80
 - 2s - loss: 0.2433
Epoch 5/80
 - 2s - loss: 0.2114
Epoch 6/80
 - 2s - loss: 0.1888
Epoch 7/80
 - 2s - loss: 0.1717
Epoch 8/80
 - 2s - loss: 0.1580
Epoch 9/80
 - 2s - loss: 0.1468
Epoch 10/80
 - 2s - loss: 0.1377
Epoch 11/80
 - 2s - loss: 0.1304
Epoch 12/80
 - 2s - loss: 0.1246
Epoch 13/80
 - 2s - loss: 0.1197
Epoch 14/80
 - 2s - loss: 0.1157
Epoch 15/80
 - 2s - loss: 0.1119
Epoch 16/80
 - 2s - loss: 0.1087
Epoch 17/80
 - 2s - loss: 0.1059
Epoch 18/80
 - 2s - loss: 0.1034
Epoch 19/80
 - 2s - loss: 0.1013
Epoch 20/80
 - 2s - loss: 0.0994
Epoch 21/80
 - 2s - loss: 0.0978
Epoch 22/80
 - 2s - loss: 0.0964
Epoch 23/80
 - 2s - loss: 0.0952
Epoch 24/80
 - 2s - loss: 0.0942
Epoch 25/80
 - 2s - loss: 0.0933
Epoch 26/80
 - 2s - loss: 0.0925
Epoch 27/80
 - 2s - loss: 0.0919
Epoch 28/80
 - 2s - loss: 0.0913
Epoch 29/80
 - 2s - loss: 0.0908
Epoch 30/80
 - 2s - loss: 0.0903
Epoch 31/80
 - 2s - loss: 0.0899
Epoch 32/80
 - 2s - loss: 0.0896
Epoch 33/80
 - 2s - loss: 0.0893
Epoch 34/80
 - 2s - loss: 0.0890
Epoch 35/80
 - 2s - loss: 0.0887
Epoch 36/80
 - 2s - loss: 0.0885
Epoch 37/80
 - 2s - loss: 0.0883
Epoch 38/80
 - 2s - loss: 0.0881
Epoch 39/80
 - 2s - loss: 0.0879
Epoch 40/80
 - 2s - loss: 0.0877
Epoch 41/80
 - 2s - loss: 0.0876
Epoch 42/80
 - 2s - loss: 0.0875
Epoch 43/80
 - 2s - loss: 0.0874
Epoch 44/80
 - 2s - loss: 0.0872
Epoch 45/80
 - 2s - loss: 0.0871
Epoch 46/80
 - 2s - loss: 0.0870
Epoch 47/80
 - 2s - loss: 0.0869
Epoch 48/80
 - 2s - loss: 0.0868
Epoch 49/80
 - 2s - loss: 0.0867
Epoch 50/80
 - 2s - loss: 0.0866
Epoch 51/80
 - 2s - loss: 0.0865
Epoch 52/80
 - 2s - loss: 0.0864
Epoch 53/80
 - 2s - loss: 0.0864
Epoch 54/80
 - 2s - loss: 0.0863
Epoch 55/80
 - 2s - loss: 0.0863
Epoch 56/80
 - 2s - loss: 0.0862
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:11:31.790528: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:11:31.958912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:11:31.958958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:11:32.261212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:11:32.261266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:11:32.261276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:11:32.261550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9728
Epoch 2/80
 - 2s - loss: 0.1818
Epoch 3/80
 - 2s - loss: 0.1622
Epoch 4/80
 - 2s - loss: 0.1433
Epoch 5/80
 - 2s - loss: 0.1231
Epoch 6/80
 - 2s - loss: 0.1075
Epoch 7/80
 - 2s - loss: 0.0953
Epoch 8/80
 - 2s - loss: 0.0858
Epoch 9/80
 - 2s - loss: 0.0781
Epoch 10/80
 - 2s - loss: 0.0717
Epoch 11/80
 - 2s - loss: 0.0663
Epoch 12/80
 - 2s - loss: 0.0620
Epoch 13/80
 - 2s - loss: 0.0585
Epoch 14/80
 - 2s - loss: 0.0555
Epoch 15/80
 - 2s - loss: 0.0530
Epoch 16/80
 - 2s - loss: 0.0509
Epoch 17/80
 - 2s - loss: 0.0491
Epoch 18/80
 - 2s - loss: 0.0475
Epoch 19/80
 - 2s - loss: 0.0462
Epoch 20/80
 - 2s - loss: 0.0450
Epoch 21/80
 - 2s - loss: 0.0440
Epoch 22/80
 - 2s - loss: 0.0431
Epoch 23/80
 - 2s - loss: 0.0423
Epoch 24/80
 - 2s - loss: 0.0417
Epoch 25/80
 - 2s - loss: 0.0410
Epoch 26/80
 - 2s - loss: 0.0405
Epoch 27/80
 - 2s - loss: 0.0401
Epoch 28/80
 - 2s - loss: 0.0397
Epoch 29/80
 - 2s - loss: 0.0393
Epoch 30/80
 - 2s - loss: 0.0390
Epoch 31/80
 - 2s - loss: 0.0387
Epoch 32/80
 - 2s - loss: 0.0385
Epoch 33/80
 - 2s - loss: 0.0382
Epoch 34/80
 - 2s - loss: 0.0380
Epoch 35/80
 - 2s - loss: 0.0379
Epoch 36/80
 - 2s - loss: 0.0377
Epoch 37/80
 - 2s - loss: 0.0376
Epoch 38/80
 - 2s - loss: 0.0374
Epoch 39/80
 - 2s - loss: 0.0373
Epoch 40/80
 - 2s - loss: 0.0372
Epoch 41/80
 - 2s - loss: 0.0371
Epoch 42/80
 - 2s - loss: 0.0370
Epoch 43/80
 - 2s - loss: 0.0369
Epoch 44/80
 - 2s - loss: 0.0368
Epoch 45/80
 - 2s - loss: 0.0368
Epoch 46/80
 - 2s - loss: 0.0367
Epoch 47/80
 - 2s - loss: 0.0367
Epoch 48/80
 - 2s - loss: 0.0366
Epoch 49/80
 - 2s - loss: 0.0366
Epoch 50/80
 - 2s - loss: 0.0365
Epoch 51/80
 - 2s - loss: 0.0364
Epoch 52/80
 - 2s - loss: 0.0364
Epoch 53/80
 - 2s - loss: 0.0363
Epoch 54/80
 - 2s - loss: 0.0363
Epoch 55/80
 - 2s - loss: 0.0363
Epoch 56/80
 - 2s - loss: 0.0363
Epoch 57/80
 - 2s - loss: 0.0362
Epoch 58/80
 - 2s - loss: 0.0362
Epoch 59/80
 - 2s - loss: 0.0362
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:13:49.757433: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:13:49.926406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:13:49.926453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:13:50.230488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:13:50.230546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:13:50.230555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:13:50.230827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9889
Epoch 2/80
 - 2s - loss: 0.1831
Epoch 3/80
 - 2s - loss: 0.1603
Epoch 4/80
 - 2s - loss: 0.1384
Epoch 5/80
 - 2s - loss: 0.1199
Epoch 6/80
 - 2s - loss: 0.1070
Epoch 7/80
 - 2s - loss: 0.0957
Epoch 8/80
 - 2s - loss: 0.0861
Epoch 9/80
 - 2s - loss: 0.0782
Epoch 10/80
 - 2s - loss: 0.0717
Epoch 11/80
 - 2s - loss: 0.0663
Epoch 12/80
 - 2s - loss: 0.0619
Epoch 13/80
 - 2s - loss: 0.0583
Epoch 14/80
 - 2s - loss: 0.0553
Epoch 15/80
 - 2s - loss: 0.0528
Epoch 16/80
 - 2s - loss: 0.0507
Epoch 17/80
 - 2s - loss: 0.0489
Epoch 18/80
 - 2s - loss: 0.0473
Epoch 19/80
 - 2s - loss: 0.0460
Epoch 20/80
 - 2s - loss: 0.0448
Epoch 21/80
 - 2s - loss: 0.0438
Epoch 22/80
 - 2s - loss: 0.0429
Epoch 23/80
 - 2s - loss: 0.0422
Epoch 24/80
 - 2s - loss: 0.0416
Epoch 25/80
 - 2s - loss: 0.0410
Epoch 26/80
 - 2s - loss: 0.0405
Epoch 27/80
 - 2s - loss: 0.0400
Epoch 28/80
 - 2s - loss: 0.0396
Epoch 29/80
 - 2s - loss: 0.0393
Epoch 30/80
 - 2s - loss: 0.0390
Epoch 31/80
 - 2s - loss: 0.0387
Epoch 32/80
 - 2s - loss: 0.0385
Epoch 33/80
 - 2s - loss: 0.0383
Epoch 34/80
 - 2s - loss: 0.0381
Epoch 35/80
 - 2s - loss: 0.0379
Epoch 36/80
 - 2s - loss: 0.0378
Epoch 37/80
 - 2s - loss: 0.0376
Epoch 38/80
 - 2s - loss: 0.0375
Epoch 39/80
 - 2s - loss: 0.0374
Epoch 40/80
 - 2s - loss: 0.0373
Epoch 41/80
 - 2s - loss: 0.0372
Epoch 42/80
 - 2s - loss: 0.0371
Epoch 43/80
 - 2s - loss: 0.0370
Epoch 44/80
 - 2s - loss: 0.0370
Epoch 45/80
 - 2s - loss: 0.0369
Epoch 46/80
 - 2s - loss: 0.0368
Epoch 47/80
 - 2s - loss: 0.0368
Epoch 48/80
 - 2s - loss: 0.0367
Epoch 49/80
 - 2s - loss: 0.0366
Epoch 50/80
 - 2s - loss: 0.0366
Epoch 51/80
 - 2s - loss: 0.0365
Epoch 52/80
 - 2s - loss: 0.0365
Epoch 53/80
 - 2s - loss: 0.0365
Epoch 54/80
 - 2s - loss: 0.0364
Epoch 55/80
 - 2s - loss: 0.0364
Epoch 56/80
 - 2s - loss: 0.0363
Epoch 57/80
 - 2s - loss: 0.0363
Epoch 58/80
 - 2s - loss: 0.0363
Epoch 59/80
 - 2s - loss: 0.0347
Epoch 60/80
 - 2s - loss: 0.0346
Epoch 61/80
 - 2s - loss: 0.0346
Epoch 62/80
 - 2s - loss: 0.0346
Epoch 63/80
 - 2s - loss: 0.0346
Epoch 64/80
 - 2s - loss: 0.0342
Epoch 65/80
 - 2s - loss: 0.0342
Epoch 66/80
 - 2s - loss: 0.0342
Epoch 67/80
 - 2s - loss: 0.0342
Epoch 68/80
 - 2s - loss: 0.0341
Epoch 69/80
 - 2s - loss: 0.0341
Epoch 70/80
 - 2s - loss: 0.0341
Epoch 71/80
 - 2s - loss: 0.0341
Epoch 72/80
 - 2s - loss: 0.0341
Epoch 73/80
 - 2s - loss: 0.0341
Epoch 74/80
 - 2s - loss: 0.0341
Epoch 75/80
 - 2s - loss: 0.0341
Epoch 76/80
 - 2s - loss: 0.0341
Epoch 77/80
 - 2s - loss: 0.0341
Epoch 78/80
 - 2s - loss: 0.0341
Epoch 79/80
 - 2s - loss: 0.0341
Epoch 80/80
 - 2s - loss: 0.0341
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.8962 - val_loss: 1.0187
AUC: 0.8150

Epoch 2/80
 - 0s - loss: 1.4816 - val_loss: 0.7390
AUC: 0.8369

Epoch 3/80
 - 0s - loss: 1.2250 - val_loss: 0.6016
AUC: 0.8457

Epoch 4/80
 - 0s - loss: 1.1536 - val_loss: 0.6442
AUC: 0.8519

Epoch 5/80
 - 0s - loss: 1.1200 - val_loss: 0.6591
AUC: 0.8561

Epoch 6/80
 - 0s - loss: 1.0976 - val_loss: 0.6726
AUC: 0.8580

Epoch 7/80
 - 0s - loss: 1.0703 - val_loss: 0.6432
AUC: 0.8608

Epoch 8/80
 - 0s - loss: 1.0668 - val_loss: 0.6335
AUC: 0.8624

Epoch 9/80
 - 0s - loss: 1.0521 - val_loss: 0.6270
AUC: 0.8632

Epoch 10/80
 - 0s - loss: 1.0477 - val_loss: 0.6482
AUC: 0.8633

Epoch 11/80
 - 0s - loss: 1.0443 - val_loss: 0.6353
AUC: 0.8661

Epoch 12/80
 - 0s - loss: 1.0330 - val_loss: 0.6161
AUC: 0.8657

Epoch 13/80
 - 0s - loss: 1.0259 - val_loss: 0.6407
AUC: 0.8668

Epoch 14/80
 - 0s - loss: 1.0146 - val_loss: 0.6070
AUC: 0.8666

Epoch 15/80
 - 0s - loss: 1.0088 - val_loss: 0.6175
AUC: 0.8672

Epoch 16/80
 - 0s - loss: 1.0141 - val_loss: 0.6064
AUC: 0.8670

Epoch 17/80
 - 0s - loss: 1.0039 - val_loss: 0.5925
AUC: 0.8671

Epoch 18/80
 - 0s - loss: 1.0029 - val_loss: 0.6214
AUC: 0.8675

Epoch 19/80
 - 0s - loss: 1.0047 - val_loss: 0.6115
AUC: 0.8677

Epoch 20/80
 - 0s - loss: 0.9994 - val_loss: 0.6278
AUC: 0.8680

Epoch 21/80
 - 0s - loss: 1.0001 - val_loss: 0.6149
AUC: 0.8679

Epoch 22/80
 - 0s - loss: 1.0024 - val_loss: 0.5894
AUC: 0.8675

Epoch 23/80
 - 0s - loss: 0.9990 - val_loss: 0.5960
AUC: 0.8676

Epoch 24/80
 - 0s - loss: 0.9990 - val_loss: 0.5872
AUC: 0.8676

Epoch 25/80
 - 0s - loss: 1.0003 - val_loss: 0.5900
AUC: 0.8678

Epoch 26/80
 - 0s - loss: 0.9939 - val_loss: 0.5968
AUC: 0.8680

Epoch 27/80
 - 0s - loss: 0.9987 - val_loss: 0.6281
AUC: 0.8688

Epoch 28/80
 - 0s - loss: 0.9932 - val_loss: 0.6358
AUC: 0.8688

Epoch 29/80
 - 0s - loss: 0.9958 - val_loss: 0.6040
AUC: 0.8686

Epoch 30/80
 - 0s - loss: 0.9889 - val_loss: 0.5897
AUC: 0.8684

Epoch 31/80
 - 0s - loss: 0.9934 - val_loss: 0.5674
AUC: 0.8677

Epoch 32/80
 - 0s - loss: 0.9903 - val_loss: 0.6038
AUC: 0.8687

Epoch 33/80
 - 0s - loss: 0.9961 - val_loss: 0.6105
AUC: 0.8685

Epoch 34/80
 - 0s - loss: 0.9853 - val_loss: 0.6231
AUC: 0.8688

Epoch 35/80
 - 0s - loss: 0.9890 - val_loss: 0.6075
AUC: 0.8687

Epoch 36/80
 - 0s - loss: 0.9818 - val_loss: 0.5920
AUC: 0.8688

Epoch 37/80
 - 0s - loss: 0.9843 - val_loss: 0.5686
AUC: 0.8685

Epoch 38/80
 - 0s - loss: 0.9780 - val_loss: 0.5793
AUC: 0.8687

Epoch 39/80
 - 0s - loss: 0.9818 - val_loss: 0.6054
AUC: 0.8691

Epoch 40/80
 - 0s - loss: 0.9782 - val_loss: 0.6261
AUC: 0.8694

Epoch 41/80
 - 0s - loss: 0.9787 - val_loss: 0.6053
AUC: 0.8691

Epoch 42/80
 - 0s - loss: 0.9767 - val_loss: 0.5882
AUC: 0.8689

Epoch 43/80
 - 0s - loss: 0.9774 - val_loss: 0.5950
AUC: 0.8691

Epoch 44/80
 - 0s - loss: 0.9750 - val_loss: 0.5859
AUC: 0.8688

Epoch 45/80
 - 0s - loss: 0.9774 - val_loss: 0.6044
AUC: 0.8692

Epoch 46/80
 - 0s - loss: 0.9757 - val_loss: 0.5959
AUC: 0.8692

Epoch 47/80
 - 0s - loss: 0.9744 - val_loss: 0.5951
AUC: 0.8691

Epoch 48/80
 - 0s - loss: 0.9775 - val_loss: 0.5940
AUC: 0.8692

Epoch 49/80
 - 0s - loss: 0.9787 - val_loss: 0.5964
AUC: 0.8692

Epoch 50/80
 - 0s - loss: 0.9721 - val_loss: 0.5882
AUC: 0.8691

Epoch 51/80
 - 0s - loss: 0.9795 - val_loss: 0.6007
AUC: 0.8693

Epoch 52/80
 - 0s - loss: 0.9715 - val_loss: 0.5971
AUC: 0.8693

Epoch 53/80
 - 0s - loss: 0.9721 - val_loss: 0.5954
AUC: 0.8693

Epoch 54/80
 - 0s - loss: 0.9746 - val_loss: 0.5933
AUC: 0.8692

Epoch 55/80
 - 0s - loss: 0.9753 - val_loss: 0.5948
AUC: 0.8693

Epoch 56/80
 - 0s - loss: 0.9735 - val_loss: 0.5958
AUC: 0.8693

Epoch 57/80
 - 0s - loss: 0.9742 - val_loss: 0.5945
AUC: 0.8692

Epoch 58/80
 - 0s - loss: 0.9723 - val_loss: 0.5919
AUC: 0.8692

Epoch 59/80
 - 0s - loss: 0.9758 - val_loss: 0.5936
AUC: 0.8692

Epoch 60/80
 - 0s - loss: 0.9735 - val_loss: 0.5930
AUC: 0.8692

Epoch 61/80
 - 0s - loss: 0.9807 - val_loss: 0.5948
AUC: 0.8693

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9816 - val_loss: 0.5861
AUC: 0.8689

Epoch 2/30
 - 0s - loss: 0.9768 - val_loss: 0.6091
AUC: 0.8694

Epoch 3/30
 - 0s - loss: 0.9712 - val_loss: 0.5914
AUC: 0.8694

Epoch 4/30
 - 0s - loss: 0.9714 - val_loss: 0.6244
AUC: 0.8698

Epoch 5/30
 - 0s - loss: 0.9782 - val_loss: 0.5917
AUC: 0.8694

Epoch 6/30
 - 0s - loss: 0.9670 - val_loss: 0.6041
AUC: 0.8699

Epoch 7/30
 - 0s - loss: 0.9707 - val_loss: 0.5737
AUC: 0.8696

Epoch 8/30
 - 0s - loss: 0.9671 - val_loss: 0.5924
AUC: 0.8699

Epoch 9/30
 - 0s - loss: 0.9676 - val_loss: 0.5930
AUC: 0.8700

Epoch 10/30
 - 0s - loss: 0.9582 - val_loss: 0.5945
AUC: 0.8702

Epoch 11/30
 - 0s - loss: 0.9585 - val_loss: 0.5654
AUC: 0.8699

Epoch 12/30
 - 0s - loss: 0.9566 - val_loss: 0.5837
AUC: 0.8702

Epoch 13/30
 - 0s - loss: 0.9558 - val_loss: 0.5874
AUC: 0.8705

Epoch 14/30
 - 0s - loss: 0.9494 - val_loss: 0.6002
AUC: 0.8706

Epoch 15/30
 - 0s - loss: 0.9548 - val_loss: 0.5700
AUC: 0.8704

Epoch 16/30
 - 0s - loss: 0.9522 - val_loss: 0.5628
AUC: 0.8702

Epoch 17/30
 - 0s - loss: 0.9515 - val_loss: 0.5735
AUC: 0.8708

Epoch 18/30
 - 0s - loss: 0.9505 - val_loss: 0.5906
AUC: 0.8709

Epoch 19/30
 - 0s - loss: 0.9481 - val_loss: 0.5810
AUC: 0.8708

Epoch 20/30
 - 0s - loss: 0.9471 - val_loss: 0.5592
AUC: 0.8705

Epoch 21/30
 - 0s - loss: 0.9406 - val_loss: 0.5791
AUC: 0.8709

Epoch 22/30
 - 0s - loss: 0.9433 - val_loss: 0.6095
AUC: 0.8714

Epoch 23/30
 - 0s - loss: 0.9377 - val_loss: 0.5810
AUC: 0.8711

Epoch 24/30
 - 0s - loss: 0.9373 - val_loss: 0.5709
AUC: 0.8709

Epoch 25/30
 - 0s - loss: 0.9355 - val_loss: 0.5845
AUC: 0.8715

Epoch 26/30
 - 0s - loss: 0.9338 - val_loss: 0.5741
AUC: 0.8713

Epoch 27/30
 - 0s - loss: 0.9324 - val_loss: 0.5879
AUC: 0.8715

Epoch 28/30
 - 0s - loss: 0.9305 - val_loss: 0.5549
AUC: 0.8711

Epoch 29/30
 - 0s - loss: 0.9312 - val_loss: 0.5777
AUC: 0.8714

Epoch 30/30
 - 0s - loss: 0.9282 - val_loss: 0.5593
Using TensorFlow backend.
AUC: 0.8710

2019-03-08 10:17:51.675206: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:17:51.843309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:17:51.843359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:17:52.145843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:17:52.145898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:17:52.145908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:17:52.146196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9823
Epoch 2/80
 - 2s - loss: 0.1828
Epoch 3/80
 - 2s - loss: 0.1636
Epoch 4/80
 - 2s - loss: 0.1446
Epoch 5/80
 - 2s - loss: 0.1241
Epoch 6/80
 - 2s - loss: 0.1087
Epoch 7/80
 - 2s - loss: 0.0967
Epoch 8/80
 - 2s - loss: 0.0869
Epoch 9/80
 - 2s - loss: 0.0788
Epoch 10/80
 - 2s - loss: 0.0721
Epoch 11/80
 - 2s - loss: 0.0666
Epoch 12/80
 - 2s - loss: 0.0622
Epoch 13/80
 - 2s - loss: 0.0586
Epoch 14/80
 - 2s - loss: 0.0556
Epoch 15/80
 - 2s - loss: 0.0531
Epoch 16/80
 - 2s - loss: 0.0509
Epoch 17/80
 - 2s - loss: 0.0491
Epoch 18/80
 - 2s - loss: 0.0475
Epoch 19/80
 - 2s - loss: 0.0461
Epoch 20/80
 - 2s - loss: 0.0449
Epoch 21/80
 - 2s - loss: 0.0439
Epoch 22/80
 - 2s - loss: 0.0430
Epoch 23/80
 - 2s - loss: 0.0423
Epoch 24/80
 - 2s - loss: 0.0416
Epoch 25/80
 - 2s - loss: 0.0410
Epoch 26/80
 - 2s - loss: 0.0405
Epoch 27/80
 - 2s - loss: 0.0400
Epoch 28/80
 - 2s - loss: 0.0396
Epoch 29/80
 - 2s - loss: 0.0393
Epoch 30/80
 - 2s - loss: 0.0390
Epoch 31/80
 - 2s - loss: 0.0387
Epoch 32/80
 - 2s - loss: 0.0385
Epoch 33/80
 - 2s - loss: 0.0383
Epoch 34/80
 - 2s - loss: 0.0381
Epoch 35/80
 - 2s - loss: 0.0379
Epoch 36/80
 - 2s - loss: 0.0378
Epoch 37/80
 - 2s - loss: 0.0376
Epoch 38/80
 - 2s - loss: 0.0375
Epoch 39/80
 - 2s - loss: 0.0374
Epoch 40/80
 - 2s - loss: 0.0373
Epoch 41/80
 - 2s - loss: 0.0372
Epoch 42/80
 - 2s - loss: 0.0371
Epoch 43/80
 - 2s - loss: 0.0370
Epoch 44/80
 - 2s - loss: 0.0369
Epoch 45/80
 - 2s - loss: 0.0369
Epoch 46/80
 - 2s - loss: 0.0368
Epoch 47/80
 - 2s - loss: 0.0368
Epoch 48/80
 - 2s - loss: 0.0367
Epoch 49/80
 - 2s - loss: 0.0366
Epoch 50/80
 - 2s - loss: 0.0366
Epoch 51/80
 - 2s - loss: 0.0366
Epoch 52/80
 - 2s - loss: 0.0365
Epoch 53/80
 - 2s - loss: 0.0365
Epoch 54/80
 - 2s - loss: 0.0364
Epoch 55/80
 - 2s - loss: 0.0364
Epoch 56/80
 - 2s - loss: 0.0364
Epoch 57/80
 - 2s - loss: 0.0363
Epoch 58/80
 - 2s - loss: 0.0363
Epoch 59/80
 - 2s - loss: 0.0362
Epoch 60/80
 - 2s - loss: 0.0362
Epoch 61/80
 - 2s - loss: 0.0362
Epoch 62/80
 - 2s - loss: 0.0347
Epoch 63/80
 - 2s - loss: 0.0345
Epoch 64/80
 - 2s - loss: 0.0345
Epoch 65/80
 - 2s - loss: 0.0345
Epoch 66/80
 - 2s - loss: 0.0345
Epoch 67/80
 - 2s - loss: 0.0341
Epoch 68/80
 - 2s - loss: 0.0341
Epoch 69/80
 - 2s - loss: 0.0341
Epoch 70/80
 - 2s - loss: 0.0341
Epoch 71/80
 - 2s - loss: 0.0340
Epoch 72/80
 - 2s - loss: 0.0340
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:20:32.113261: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:20:32.282494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:20:32.282539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:20:32.586466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:20:32.586521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:20:32.586530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:20:32.586794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9961
Epoch 2/80
 - 2s - loss: 0.1803
Epoch 3/80
 - 2s - loss: 0.1562
Epoch 4/80
 - 2s - loss: 0.1360
Epoch 5/80
 - 2s - loss: 0.1203
Epoch 6/80
 - 2s - loss: 0.1075
Epoch 7/80
 - 2s - loss: 0.0961
Epoch 8/80
 - 2s - loss: 0.0860
Epoch 9/80
 - 2s - loss: 0.0779
Epoch 10/80
 - 2s - loss: 0.0714
Epoch 11/80
 - 2s - loss: 0.0662
Epoch 12/80
 - 2s - loss: 0.0620
Epoch 13/80
 - 2s - loss: 0.0585
Epoch 14/80
 - 2s - loss: 0.0556
Epoch 15/80
 - 2s - loss: 0.0531
Epoch 16/80
 - 2s - loss: 0.0510
Epoch 17/80
 - 2s - loss: 0.0491
Epoch 18/80
 - 2s - loss: 0.0475
Epoch 19/80
 - 2s - loss: 0.0462
Epoch 20/80
 - 2s - loss: 0.0450
Epoch 21/80
 - 2s - loss: 0.0440
Epoch 22/80
 - 2s - loss: 0.0431
Epoch 23/80
 - 2s - loss: 0.0423
Epoch 24/80
 - 2s - loss: 0.0416
Epoch 25/80
 - 2s - loss: 0.0410
Epoch 26/80
 - 2s - loss: 0.0405
Epoch 27/80
 - 2s - loss: 0.0401
Epoch 28/80
 - 2s - loss: 0.0397
Epoch 29/80
 - 2s - loss: 0.0394
Epoch 30/80
 - 2s - loss: 0.0391
Epoch 31/80
 - 2s - loss: 0.0388
Epoch 32/80
 - 2s - loss: 0.0386
Epoch 33/80
 - 2s - loss: 0.0384
Epoch 34/80
 - 2s - loss: 0.0382
Epoch 35/80
 - 2s - loss: 0.0380
Epoch 36/80
 - 2s - loss: 0.0379
Epoch 37/80
 - 2s - loss: 0.0378
Epoch 38/80
 - 2s - loss: 0.0376
Epoch 39/80
 - 2s - loss: 0.0375
Epoch 40/80
 - 2s - loss: 0.0374
Epoch 41/80
 - 2s - loss: 0.0373
Epoch 42/80
 - 2s - loss: 0.0372
Epoch 43/80
 - 2s - loss: 0.0372
Epoch 44/80
 - 2s - loss: 0.0371
Epoch 45/80
 - 2s - loss: 0.0370
Epoch 46/80
 - 2s - loss: 0.0370
Epoch 47/80
 - 2s - loss: 0.0369
Epoch 48/80
 - 2s - loss: 0.0368
Epoch 49/80
 - 2s - loss: 0.0368
Epoch 50/80
 - 2s - loss: 0.0367
Epoch 51/80
 - 2s - loss: 0.0367
Epoch 52/80
 - 2s - loss: 0.0367
Epoch 53/80
 - 2s - loss: 0.0366
Epoch 54/80
 - 2s - loss: 0.0366
Epoch 55/80
 - 2s - loss: 0.0365
Epoch 56/80
 - 2s - loss: 0.0365
Epoch 57/80
 - 2s - loss: 0.0365
Epoch 58/80
 - 2s - loss: 0.0364
Epoch 59/80
 - 2s - loss: 0.0364
Epoch 60/80
 - 2s - loss: 0.0364
Epoch 61/80
 - 2s - loss: 0.0364
Epoch 62/80
 - 2s - loss: 0.0348
Epoch 63/80
 - 2s - loss: 0.0347
Epoch 64/80
 - 2s - loss: 0.0347
Epoch 65/80
 - 2s - loss: 0.0347
Epoch 66/80
 - 2s - loss: 0.0346
Epoch 67/80
 - 2s - loss: 0.0343
Epoch 68/80
 - 2s - loss: 0.0343
Epoch 69/80
 - 2s - loss: 0.0343
Epoch 70/80
 - 2s - loss: 0.0343
Epoch 71/80
 - 2s - loss: 0.0342
Epoch 72/80
 - 2s - loss: 0.0342
Epoch 73/80
 - 2s - loss: 0.0342
Epoch 74/80
 - 2s - loss: 0.0342
Epoch 75/80
 - 2s - loss: 0.0342
Epoch 76/80
 - 2s - loss: 0.0342
Epoch 77/80
 - 2s - loss: 0.0342
Epoch 78/80
 - 2s - loss: 0.0342
Epoch 79/80
 - 2s - loss: 0.0342
Epoch 80/80
 - 2s - loss: 0.0342
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 5.5026 - val_loss: 2.0225
AUC: 0.7641

Epoch 2/80
 - 0s - loss: 2.9606 - val_loss: 1.1080
AUC: 0.8045

Epoch 3/80
 - 0s - loss: 1.9909 - val_loss: 0.8132
AUC: 0.8276

Epoch 4/80
 - 0s - loss: 1.4654 - val_loss: 0.7446
AUC: 0.8389

Epoch 5/80
 - 0s - loss: 1.2622 - val_loss: 0.7924
AUC: 0.8475

Epoch 6/80
 - 0s - loss: 1.1771 - val_loss: 0.7113
AUC: 0.8501

Epoch 7/80
 - 0s - loss: 1.1403 - val_loss: 0.6739
AUC: 0.8528

Epoch 8/80
 - 0s - loss: 1.1160 - val_loss: 0.6494
AUC: 0.8539

Epoch 9/80
 - 0s - loss: 1.0895 - val_loss: 0.6392
AUC: 0.8555

Epoch 10/80
 - 0s - loss: 1.0834 - val_loss: 0.7149
AUC: 0.8573

Epoch 11/80
 - 0s - loss: 1.0788 - val_loss: 0.6681
AUC: 0.8580

Epoch 12/80
 - 0s - loss: 1.0624 - val_loss: 0.6082
AUC: 0.8591

Epoch 13/80
 - 0s - loss: 1.0594 - val_loss: 0.6546
AUC: 0.8596

Epoch 14/80
 - 0s - loss: 1.0474 - val_loss: 0.6310
AUC: 0.8605

Epoch 15/80
 - 0s - loss: 1.0539 - val_loss: 0.6744
AUC: 0.8613

Epoch 16/80
 - 0s - loss: 1.0270 - val_loss: 0.5964
AUC: 0.8614

Epoch 17/80
 - 0s - loss: 1.0331 - val_loss: 0.6062
AUC: 0.8632

Epoch 18/80
 - 0s - loss: 1.0321 - val_loss: 0.6998
AUC: 0.8622

Epoch 19/80
 - 0s - loss: 1.0172 - val_loss: 0.6101
AUC: 0.8637

Epoch 20/80
 - 0s - loss: 1.0260 - val_loss: 0.6921
AUC: 0.8648

Epoch 21/80
 - 0s - loss: 1.0140 - val_loss: 0.7228
AUC: 0.8650

Epoch 22/80
 - 0s - loss: 1.0135 - val_loss: 0.6692
AUC: 0.8642

Epoch 23/80
 - 0s - loss: 1.0055 - val_loss: 0.6077
AUC: 0.8642

Epoch 24/80
 - 0s - loss: 1.0137 - val_loss: 0.5636
AUC: 0.8639

Epoch 25/80
 - 0s - loss: 1.0011 - val_loss: 0.6858
AUC: 0.8671

Epoch 26/80
 - 0s - loss: 0.9979 - val_loss: 0.6334
AUC: 0.8657

Epoch 27/80
 - 0s - loss: 0.9954 - val_loss: 0.6665
AUC: 0.8663

Epoch 28/80
 - 0s - loss: 0.9929 - val_loss: 0.6458
AUC: 0.8662

Epoch 29/80
 - 0s - loss: 0.9892 - val_loss: 0.6119
AUC: 0.8664

Epoch 30/80
 - 0s - loss: 0.9896 - val_loss: 0.6316
AUC: 0.8647

Epoch 31/80
 - 0s - loss: 0.9884 - val_loss: 0.6536
AUC: 0.8673

Epoch 32/80
 - 0s - loss: 0.9845 - val_loss: 0.5258
AUC: 0.8664

Epoch 33/80
 - 0s - loss: 0.9767 - val_loss: 0.5944
AUC: 0.8679

Epoch 34/80
 - 0s - loss: 0.9696 - val_loss: 0.6236
AUC: 0.8679

Epoch 35/80
 - 0s - loss: 0.9713 - val_loss: 0.6101
AUC: 0.8672

Epoch 36/80
 - 0s - loss: 0.9722 - val_loss: 0.5970
AUC: 0.8667

Epoch 37/80
 - 0s - loss: 0.9690 - val_loss: 0.5735
AUC: 0.8681

Epoch 38/80
 - 0s - loss: 0.9685 - val_loss: 0.6185
AUC: 0.8680

Epoch 39/80
 - 0s - loss: 0.9669 - val_loss: 0.5879
AUC: 0.8673

Epoch 40/80
 - 0s - loss: 0.9566 - val_loss: 0.6047
AUC: 0.8691

Epoch 41/80
 - 0s - loss: 0.9578 - val_loss: 0.6889
AUC: 0.8676

Epoch 42/80
 - 0s - loss: 0.9626 - val_loss: 0.5608
AUC: 0.8673

Epoch 43/80
 - 0s - loss: 0.9484 - val_loss: 0.6261
AUC: 0.8683

Epoch 44/80
 - 0s - loss: 0.9388 - val_loss: 0.5850
AUC: 0.8687

Epoch 45/80
 - 0s - loss: 0.9438 - val_loss: 0.5680
AUC: 0.8685

Epoch 46/80
 - 0s - loss: 0.9403 - val_loss: 0.6050
AUC: 0.8689

Epoch 47/80
 - 0s - loss: 0.9368 - val_loss: 0.5795
AUC: 0.8687

Epoch 48/80
 - 0s - loss: 0.9369 - val_loss: 0.5803
AUC: 0.8686

Epoch 49/80
 - 0s - loss: 0.9373 - val_loss: 0.5898
AUC: 0.8689

Epoch 50/80
 - 0s - loss: 0.9379 - val_loss: 0.5830
AUC: 0.8685

Epoch 51/80
 - 0s - loss: 0.9356 - val_loss: 0.5797
AUC: 0.8689

Epoch 52/80
 - 0s - loss: 0.9387 - val_loss: 0.6167
AUC: 0.8686

Epoch 53/80
 - 0s - loss: 0.9343 - val_loss: 0.5976
AUC: 0.8686

Epoch 54/80
 - 0s - loss: 0.9367 - val_loss: 0.5926
AUC: 0.8687

Epoch 55/80
 - 0s - loss: 0.9367 - val_loss: 0.5904
AUC: 0.8688

Epoch 56/80
 - 0s - loss: 0.9322 - val_loss: 0.5925
AUC: 0.8687

Epoch 57/80
 - 0s - loss: 0.9351 - val_loss: 0.5851
AUC: 0.8688

Epoch 58/80
 - 0s - loss: 0.9293 - val_loss: 0.5886
AUC: 0.8688

Epoch 59/80
 - 0s - loss: 0.9311 - val_loss: 0.5968
AUC: 0.8689

Epoch 60/80
 - 0s - loss: 0.9362 - val_loss: 0.5897
AUC: 0.8689

Epoch 61/80
 - 0s - loss: 0.9302 - val_loss: 0.5890
AUC: 0.8689

Epoch 62/80
 - 0s - loss: 0.9334 - val_loss: 0.5856
AUC: 0.8688

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9464 - val_loss: 0.5923
AUC: 0.8688

Epoch 2/30
 - 0s - loss: 0.9464 - val_loss: 0.5970
AUC: 0.8690

Epoch 3/30
 - 0s - loss: 0.9431 - val_loss: 0.6038
AUC: 0.8689

Epoch 4/30
 - 0s - loss: 0.9429 - val_loss: 0.5815
AUC: 0.8688

Epoch 5/30
 - 0s - loss: 0.9398 - val_loss: 0.5796
AUC: 0.8690

Epoch 6/30
 - 0s - loss: 0.9432 - val_loss: 0.6017
AUC: 0.8689

Epoch 7/30
 - 0s - loss: 0.9341 - val_loss: 0.5909
AUC: 0.8692

Epoch 8/30
 - 0s - loss: 0.9302 - val_loss: 0.5884
AUC: 0.8692

Epoch 9/30
 - 0s - loss: 0.9305 - val_loss: 0.5925
AUC: 0.8693

Epoch 10/30
 - 0s - loss: 0.9316 - val_loss: 0.5881
AUC: 0.8696

Epoch 11/30
 - 0s - loss: 0.9280 - val_loss: 0.5603
AUC: 0.8693

Epoch 12/30
 - 0s - loss: 0.9304 - val_loss: 0.5806
AUC: 0.8694

Epoch 13/30
 - 0s - loss: 0.9290 - val_loss: 0.6050
AUC: 0.8698

Epoch 14/30
 - 0s - loss: 0.9251 - val_loss: 0.5841
AUC: 0.8696

Epoch 15/30
 - 0s - loss: 0.9210 - val_loss: 0.5730
AUC: 0.8695

Epoch 16/30
 - 0s - loss: 0.9178 - val_loss: 0.5677
AUC: 0.8694

Epoch 17/30
 - 0s - loss: 0.9135 - val_loss: 0.5856
AUC: 0.8695

Epoch 18/30
 - 0s - loss: 0.9155 - val_loss: 0.5562
AUC: 0.8695

Epoch 19/30
 - 0s - loss: 0.9205 - val_loss: 0.5668
AUC: 0.8694

Epoch 20/30
 - 0s - loss: 0.9156 - val_loss: 0.5774
AUC: 0.8697

Epoch 21/30
 - 0s - loss: 0.9116 - val_loss: 0.5823
AUC: 0.8698

Epoch 22/30
 - 0s - loss: 0.9098 - val_loss: 0.5626
AUC: 0.8696

Epoch 23/30
 - 0s - loss: 0.9053 - val_loss: 0.5642
AUC: 0.8696

Epoch 24/30
 - 0s - loss: 0.9112 - val_loss: 0.5807
AUC: 0.8699

Epoch 25/30
 - 0s - loss: 0.9088 - val_loss: 0.5621
AUC: 0.8698

Epoch 26/30
 - 0s - loss: 0.9067 - val_loss: 0.5870
AUC: 0.8699

Epoch 27/30
 - 0s - loss: 0.9035 - val_loss: 0.5749
AUC: 0.8698

Epoch 28/30
 - 0s - loss: 0.9003 - val_loss: 0.5679
AUC: 0.8698

Epoch 29/30
 - 0s - loss: 0.9032 - val_loss: 0.5793
AUC: 0.8699

Epoch 30/30
 - 0s - loss: 0.9059 - val_loss: 0.5776
Using TensorFlow backend.
AUC: 0.8699

2019-03-08 10:24:35.737380: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:24:35.901668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:24:35.901723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:24:36.202708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:24:36.202767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:24:36.202777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:24:36.203041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.5889
Epoch 2/80
 - 2s - loss: 0.0814
Epoch 3/80
 - 2s - loss: 0.0652
Epoch 4/80
 - 2s - loss: 0.0594
Epoch 5/80
 - 2s - loss: 0.0530
Epoch 6/80
 - 2s - loss: 0.0470
Epoch 7/80
 - 2s - loss: 0.0418
Epoch 8/80
 - 2s - loss: 0.0374
Epoch 9/80
 - 2s - loss: 0.0334
Epoch 10/80
 - 2s - loss: 0.0299
Epoch 11/80
 - 2s - loss: 0.0271
Epoch 12/80
 - 2s - loss: 0.0247
Epoch 13/80
 - 2s - loss: 0.0228
Epoch 14/80
 - 2s - loss: 0.0213
Epoch 15/80
 - 2s - loss: 0.0200
Epoch 16/80
 - 2s - loss: 0.0189
Epoch 17/80
 - 2s - loss: 0.0179
Epoch 18/80
 - 2s - loss: 0.0172
Epoch 19/80
 - 2s - loss: 0.0165
Epoch 20/80
 - 2s - loss: 0.0160
Epoch 21/80
 - 2s - loss: 0.0155
Epoch 22/80
 - 2s - loss: 0.0150
Epoch 23/80
 - 2s - loss: 0.0146
Epoch 24/80
 - 2s - loss: 0.0143
Epoch 25/80
 - 2s - loss: 0.0140
Epoch 26/80
 - 2s - loss: 0.0138
Epoch 27/80
 - 2s - loss: 0.0135
Epoch 28/80
 - 2s - loss: 0.0133
Epoch 29/80
 - 2s - loss: 0.0132
Epoch 30/80
 - 2s - loss: 0.0130
Epoch 31/80
 - 2s - loss: 0.0129
Epoch 32/80
 - 2s - loss: 0.0127
Epoch 33/80
 - 2s - loss: 0.0126
Epoch 34/80
 - 2s - loss: 0.0125
Epoch 35/80
 - 2s - loss: 0.0124
Epoch 36/80
 - 2s - loss: 0.0124
Epoch 37/80
 - 2s - loss: 0.0123
Epoch 38/80
 - 2s - loss: 0.0122
Epoch 39/80
 - 2s - loss: 0.0122
Epoch 40/80
 - 2s - loss: 0.0121
Epoch 41/80
 - 2s - loss: 0.0121
Epoch 42/80
 - 2s - loss: 0.0120
Epoch 43/80
 - 2s - loss: 0.0120
Epoch 44/80
 - 2s - loss: 0.0120
Epoch 45/80
 - 2s - loss: 0.0119
Epoch 46/80
 - 2s - loss: 0.0119
Epoch 47/80
 - 2s - loss: 0.0119
Epoch 48/80
 - 2s - loss: 0.0119
Epoch 49/80
 - 2s - loss: 0.0113
Epoch 50/80
 - 2s - loss: 0.0113
Epoch 51/80
 - 2s - loss: 0.0113
Epoch 52/80
 - 2s - loss: 0.0113
Epoch 53/80
 - 2s - loss: 0.0111
Epoch 54/80
 - 2s - loss: 0.0111
Epoch 55/80
 - 2s - loss: 0.0111
Epoch 56/80
 - 2s - loss: 0.0111
Epoch 57/80
 - 2s - loss: 0.0111
Epoch 58/80
 - 2s - loss: 0.0111
Epoch 59/80
 - 2s - loss: 0.0111
Epoch 60/80
 - 2s - loss: 0.0111
Epoch 61/80
 - 2s - loss: 0.0111
Epoch 62/80
 - 2s - loss: 0.0111
Epoch 63/80
 - 2s - loss: 0.0111
Epoch 64/80
 - 2s - loss: 0.0111
Epoch 65/80
 - 2s - loss: 0.0111
Epoch 66/80
 - 2s - loss: 0.0111
Epoch 67/80
 - 2s - loss: 0.0111
Epoch 68/80
 - 2s - loss: 0.0111
Epoch 69/80
 - 2s - loss: 0.0111
Epoch 70/80
 - 2s - loss: 0.0111
Epoch 71/80
 - 2s - loss: 0.0111
Epoch 72/80
 - 2s - loss: 0.0111
Epoch 73/80
 - 2s - loss: 0.0111
Epoch 74/80
 - 2s - loss: 0.0111
Epoch 75/80
 - 2s - loss: 0.0111
Epoch 76/80
 - 2s - loss: 0.0111
Epoch 77/80
 - 2s - loss: 0.0111
Epoch 78/80
 - 2s - loss: 0.0111
Epoch 79/80
 - 2s - loss: 0.0111
Epoch 80/80
 - 2s - loss: 0.0111
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.8088 - val_loss: 1.1786
AUC: 0.7710

Epoch 2/80
 - 0s - loss: 2.5750 - val_loss: 1.0323
AUC: 0.8213

Epoch 3/80
 - 0s - loss: 1.6427 - val_loss: 0.8133
AUC: 0.8235

Epoch 4/80
 - 0s - loss: 1.2919 - val_loss: 0.7364
AUC: 0.8319

Epoch 5/80
 - 0s - loss: 1.1900 - val_loss: 0.7002
AUC: 0.8402

Epoch 6/80
 - 0s - loss: 1.1239 - val_loss: 0.6789
AUC: 0.8437

Epoch 7/80
 - 0s - loss: 1.1169 - val_loss: 0.6426
AUC: 0.8471

Epoch 8/80
 - 0s - loss: 1.0798 - val_loss: 0.7133
AUC: 0.8513

Epoch 9/80
 - 0s - loss: 1.0706 - val_loss: 0.6494
AUC: 0.8522

Epoch 10/80
 - 0s - loss: 1.0625 - val_loss: 0.6761
AUC: 0.8542

Epoch 11/80
 - 0s - loss: 1.0499 - val_loss: 0.6667
AUC: 0.8557

Epoch 12/80
 - 0s - loss: 1.0380 - val_loss: 0.6389
AUC: 0.8576

Epoch 13/80
 - 0s - loss: 1.0341 - val_loss: 0.6568
AUC: 0.8567

Epoch 14/80
 - 0s - loss: 1.0275 - val_loss: 0.5723
AUC: 0.8557

Epoch 15/80
 - 0s - loss: 1.0219 - val_loss: 0.6732
AUC: 0.8599

Epoch 16/80
 - 0s - loss: 1.0094 - val_loss: 0.6241
AUC: 0.8589

Epoch 17/80
 - 0s - loss: 1.0039 - val_loss: 0.6107
AUC: 0.8593

Epoch 18/80
 - 0s - loss: 1.0057 - val_loss: 0.6709
AUC: 0.8603

Epoch 19/80
 - 0s - loss: 1.0022 - val_loss: 0.6093
AUC: 0.8617

Epoch 20/80
 - 0s - loss: 0.9999 - val_loss: 0.5472
AUC: 0.8575

Epoch 21/80
 - 0s - loss: 0.9999 - val_loss: 0.6486
AUC: 0.8628

Epoch 22/80
 - 0s - loss: 0.9829 - val_loss: 0.6855
AUC: 0.8645

Epoch 23/80
 - 0s - loss: 0.9886 - val_loss: 0.6104
AUC: 0.8622

Epoch 24/80
 - 0s - loss: 0.9797 - val_loss: 0.6071
AUC: 0.8637

Epoch 25/80
 - 0s - loss: 0.9727 - val_loss: 0.6197
AUC: 0.8637

Epoch 26/80
 - 0s - loss: 0.9685 - val_loss: 0.6580
AUC: 0.8637

Epoch 27/80
 - 0s - loss: 0.9720 - val_loss: 0.6053
AUC: 0.8634

Epoch 28/80
 - 0s - loss: 0.9669 - val_loss: 0.6346
AUC: 0.8638

Epoch 29/80
 - 0s - loss: 0.9693 - val_loss: 0.6299
AUC: 0.8654

Epoch 30/80
 - 0s - loss: 0.9642 - val_loss: 0.5631
AUC: 0.8643

Epoch 31/80
 - 0s - loss: 0.9599 - val_loss: 0.6097
AUC: 0.8652

Epoch 32/80
 - 0s - loss: 0.9469 - val_loss: 0.6056
AUC: 0.8650

Epoch 33/80
 - 0s - loss: 0.9525 - val_loss: 0.5788
AUC: 0.8643

Epoch 34/80
 - 0s - loss: 0.9494 - val_loss: 0.5895
AUC: 0.8647

Epoch 35/80
 - 0s - loss: 0.9484 - val_loss: 0.5958
AUC: 0.8649

Epoch 36/80
 - 0s - loss: 0.9414 - val_loss: 0.5951
AUC: 0.8644

Epoch 37/80
 - 0s - loss: 0.9461 - val_loss: 0.5678
AUC: 0.8642

Epoch 38/80
 - 0s - loss: 0.9468 - val_loss: 0.5944
AUC: 0.8649

Epoch 39/80
 - 0s - loss: 0.9391 - val_loss: 0.6021
AUC: 0.8650

Epoch 40/80
 - 0s - loss: 0.9473 - val_loss: 0.6211
AUC: 0.8656

Epoch 41/80
 - 0s - loss: 0.9407 - val_loss: 0.5989
AUC: 0.8651

Epoch 42/80
 - 0s - loss: 0.9389 - val_loss: 0.5958
AUC: 0.8650

Epoch 43/80
 - 0s - loss: 0.9392 - val_loss: 0.5924
AUC: 0.8648

Epoch 44/80
 - 0s - loss: 0.9347 - val_loss: 0.6003
AUC: 0.8649

Epoch 45/80
 - 0s - loss: 0.9420 - val_loss: 0.5960
AUC: 0.8648

Epoch 46/80
 - 0s - loss: 0.9392 - val_loss: 0.5991
AUC: 0.8648

Epoch 47/80
 - 0s - loss: 0.9437 - val_loss: 0.5988
AUC: 0.8649

Epoch 48/80
 - 0s - loss: 0.9373 - val_loss: 0.5999
AUC: 0.8648

Epoch 49/80
 - 0s - loss: 0.9417 - val_loss: 0.5979
AUC: 0.8647

Epoch 50/80
 - 0s - loss: 0.9372 - val_loss: 0.5918
AUC: 0.8645

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9378 - val_loss: 0.6200
AUC: 0.8651

Epoch 2/30
 - 1s - loss: 0.9375 - val_loss: 0.5786
AUC: 0.8645

Epoch 3/30
 - 1s - loss: 0.9428 - val_loss: 0.5794
AUC: 0.8644

Epoch 4/30
 - 1s - loss: 0.9361 - val_loss: 0.6089
AUC: 0.8654

Epoch 5/30
 - 1s - loss: 0.9302 - val_loss: 0.5956
AUC: 0.8650

Epoch 6/30
 - 1s - loss: 0.9321 - val_loss: 0.6189
AUC: 0.8659

Epoch 7/30
 - 0s - loss: 0.9293 - val_loss: 0.6002
AUC: 0.8654

Epoch 8/30
 - 0s - loss: 0.9285 - val_loss: 0.5916
AUC: 0.8654

Epoch 9/30
 - 1s - loss: 0.9306 - val_loss: 0.6085
AUC: 0.8657

Epoch 10/30
 - 0s - loss: 0.9263 - val_loss: 0.5855
AUC: 0.8651

Epoch 11/30
 - 0s - loss: 0.9275 - val_loss: 0.5810
AUC: 0.8653

Epoch 12/30
 - 0s - loss: 0.9221 - val_loss: 0.5830
AUC: 0.8656

Epoch 13/30
 - 0s - loss: 0.9224 - val_loss: 0.5900
AUC: 0.8657

Epoch 14/30
 - 0s - loss: 0.9206 - val_loss: 0.5914
AUC: 0.8657

Epoch 15/30
 - 0s - loss: 0.9167 - val_loss: 0.5883
AUC: 0.8657

Epoch 16/30
 - 0s - loss: 0.9235 - val_loss: 0.5912
AUC: 0.8657

Epoch 17/30
 - 1s - loss: 0.9181 - val_loss: 0.5889
AUC: 0.8657

Epoch 18/30
 - 1s - loss: 0.9160 - val_loss: 0.5875
AUC: 0.8656

Epoch 19/30
 - 0s - loss: 0.9178 - val_loss: 0.5879
AUC: 0.8657

Epoch 20/30
 - 0s - loss: 0.9146 - val_loss: 0.5877
AUC: 0.8656

Epoch 21/30
 - 0s - loss: 0.9134 - val_loss: 0.5848
AUC: 0.8655

Epoch 22/30
 - 0s - loss: 0.9226 - val_loss: 0.5932
AUC: 0.8657

Epoch 23/30
 - 0s - loss: 0.9158 - val_loss: 0.5912
AUC: 0.8657

Epoch 24/30
 - 0s - loss: 0.9129 - val_loss: 0.5892
AUC: 0.8657

Epoch 25/30
 - 0s - loss: 0.9182 - val_loss: 0.5888
AUC: 0.8656

Epoch 26/30
 - 0s - loss: 0.9155 - val_loss: 0.5888
AUC: 0.8657

Epoch 27/30
 - 0s - loss: 0.9144 - val_loss: 0.5875
AUC: 0.8656

Epoch 28/30
 - 0s - loss: 0.9132 - val_loss: 0.5873
AUC: 0.8656

Epoch 29/30
 - 0s - loss: 0.9137 - val_loss: 0.5862
AUC: 0.8656

Epoch 30/30
 - 0s - loss: 0.9175 - val_loss: 0.5875
Using TensorFlow backend.
AUC: 0.8657

2019-03-08 10:28:24.484098: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:28:24.650879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:28:24.650926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:28:24.952235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:28:24.952291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:28:24.952301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:28:24.952565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.5864
Epoch 2/80
 - 2s - loss: 0.0824
Epoch 3/80
 - 2s - loss: 0.0647
Epoch 4/80
 - 2s - loss: 0.0581
Epoch 5/80
 - 2s - loss: 0.0513
Epoch 6/80
 - 2s - loss: 0.0454
Epoch 7/80
 - 2s - loss: 0.0403
Epoch 8/80
 - 2s - loss: 0.0360
Epoch 9/80
 - 2s - loss: 0.0324
Epoch 10/80
 - 2s - loss: 0.0294
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:29:07.297992: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:29:07.465099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:29:07.465146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:29:07.766857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:29:07.766912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:29:07.766921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:29:07.767188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.5956
Epoch 2/80
 - 2s - loss: 0.0828
Epoch 3/80
 - 2s - loss: 0.0656
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:29:32.715487: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:29:32.881395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:29:32.881465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:29:33.178913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:29:33.178971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:29:33.178981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:29:33.179260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1743
Epoch 2/80
 - 2s - loss: 0.3169
Epoch 3/80
 - 2s - loss: 0.2809
Epoch 4/80
 - 2s - loss: 0.2414
Epoch 5/80
 - 2s - loss: 0.2104
Epoch 6/80
 - 2s - loss: 0.1897
Epoch 7/80
 - 2s - loss: 0.1737
Epoch 8/80
 - 2s - loss: 0.1606
Epoch 9/80
 - 2s - loss: 0.1492
Epoch 10/80
 - 2s - loss: 0.1397
Epoch 11/80
 - 2s - loss: 0.1318
Epoch 12/80
 - 2s - loss: 0.1254
Epoch 13/80
 - 2s - loss: 0.1202
Epoch 14/80
 - 2s - loss: 0.1158
Epoch 15/80
 - 2s - loss: 0.1121
Epoch 16/80
 - 2s - loss: 0.1087
Epoch 17/80
 - 2s - loss: 0.1058
Epoch 18/80
 - 2s - loss: 0.1034
Epoch 19/80
 - 2s - loss: 0.1012
Epoch 20/80
 - 2s - loss: 0.0993
Epoch 21/80
 - 2s - loss: 0.0977
Epoch 22/80
 - 2s - loss: 0.0963
Epoch 23/80
 - 2s - loss: 0.0950
Epoch 24/80
 - 2s - loss: 0.0940
Epoch 25/80
 - 2s - loss: 0.0931
Epoch 26/80
 - 2s - loss: 0.0923
Epoch 27/80
 - 2s - loss: 0.0917
Epoch 28/80
 - 2s - loss: 0.0911
Epoch 29/80
 - 2s - loss: 0.0905
Epoch 30/80
 - 2s - loss: 0.0901
Epoch 31/80
 - 2s - loss: 0.0897
Epoch 32/80
 - 2s - loss: 0.0893
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:30:57.877210: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:30:58.047281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:30:58.047329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:30:58.353531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:30:58.353587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:30:58.353596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:30:58.353870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2034
Epoch 2/80
 - 2s - loss: 0.3142
Epoch 3/80
 - 2s - loss: 0.2702
Epoch 4/80
 - 2s - loss: 0.2315
Epoch 5/80
 - 2s - loss: 0.2050
Epoch 6/80
 - 2s - loss: 0.1860
Epoch 7/80
 - 2s - loss: 0.1708
Epoch 8/80
 - 2s - loss: 0.1582
Epoch 9/80
 - 2s - loss: 0.1472
Epoch 10/80
 - 2s - loss: 0.1379
Epoch 11/80
 - 2s - loss: 0.1304
Epoch 12/80
 - 2s - loss: 0.1245
Epoch 13/80
 - 2s - loss: 0.1195
Epoch 14/80
 - 2s - loss: 0.1152
Epoch 15/80
 - 2s - loss: 0.1115
Epoch 16/80
 - 2s - loss: 0.1082
Epoch 17/80
 - 2s - loss: 0.1054
Epoch 18/80
 - 2s - loss: 0.1029
Epoch 19/80
 - 2s - loss: 0.1008
Epoch 20/80
 - 2s - loss: 0.0989
Epoch 21/80
 - 2s - loss: 0.0973
Epoch 22/80
 - 2s - loss: 0.0959
Epoch 23/80
 - 2s - loss: 0.0947
Epoch 24/80
 - 2s - loss: 0.0937
Epoch 25/80
 - 2s - loss: 0.0928
Epoch 26/80
 - 2s - loss: 0.0920
Epoch 27/80
 - 2s - loss: 0.0914
Epoch 28/80
 - 2s - loss: 0.0908
Epoch 29/80
 - 2s - loss: 0.0903
Epoch 30/80
 - 2s - loss: 0.0899
Epoch 31/80
 - 2s - loss: 0.0895
Epoch 32/80
 - 2s - loss: 0.0891
Epoch 33/80
 - 2s - loss: 0.0888
Epoch 34/80
 - 2s - loss: 0.0886
Epoch 35/80
 - 2s - loss: 0.0883
Epoch 36/80
 - 2s - loss: 0.0881
Epoch 37/80
 - 2s - loss: 0.0878
Epoch 38/80
 - 2s - loss: 0.0876
Epoch 39/80
 - 2s - loss: 0.0874
Epoch 40/80
 - 2s - loss: 0.0873
Epoch 41/80
 - 2s - loss: 0.0871
Epoch 42/80
 - 2s - loss: 0.0870
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:32:41.898152: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:32:42.069721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:32:42.069790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:32:42.371738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:32:42.371813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:32:42.371824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:32:42.372110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2163
Epoch 2/80
 - 2s - loss: 0.3141
Epoch 3/80
 - 2s - loss: 0.2649
Epoch 4/80
 - 2s - loss: 0.2260
Epoch 5/80
 - 2s - loss: 0.2015
Epoch 6/80
 - 2s - loss: 0.1837
Epoch 7/80
 - 2s - loss: 0.1691
Epoch 8/80
 - 2s - loss: 0.1569
Epoch 9/80
 - 2s - loss: 0.1467
Epoch 10/80
 - 2s - loss: 0.1381
Epoch 11/80
 - 2s - loss: 0.1311
Epoch 12/80
 - 2s - loss: 0.1251
Epoch 13/80
 - 2s - loss: 0.1201
Epoch 14/80
 - 2s - loss: 0.1157
Epoch 15/80
 - 2s - loss: 0.1119
Epoch 16/80
 - 2s - loss: 0.1086
Epoch 17/80
 - 2s - loss: 0.1057
Epoch 18/80
 - 2s - loss: 0.1032
Epoch 19/80
 - 2s - loss: 0.1010
Epoch 20/80
 - 2s - loss: 0.0992
Epoch 21/80
 - 2s - loss: 0.0976
Epoch 22/80
 - 2s - loss: 0.0962
Epoch 23/80
 - 2s - loss: 0.0951
Epoch 24/80
 - 2s - loss: 0.0941
Epoch 25/80
 - 2s - loss: 0.0932
Epoch 26/80
 - 2s - loss: 0.0925
Epoch 27/80
 - 2s - loss: 0.0918
Epoch 28/80
 - 2s - loss: 0.0913
Epoch 29/80
 - 2s - loss: 0.0908
Epoch 30/80
 - 2s - loss: 0.0904
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:34:04.835427: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:34:05.007036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:34:05.007083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:34:05.330880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:34:05.330933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:34:05.330943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:34:05.334954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.2 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0027
Epoch 2/80
 - 2s - loss: 0.1792
Epoch 3/80
 - 2s - loss: 0.1484
Epoch 4/80
 - 2s - loss: 0.1280
Epoch 5/80
 - 2s - loss: 0.1139
Epoch 6/80
 - 2s - loss: 0.1018
Epoch 7/80
 - 2s - loss: 0.0914
Epoch 8/80
 - 2s - loss: 0.0827
Epoch 9/80
 - 2s - loss: 0.0757
Epoch 10/80
 - 2s - loss: 0.0698
Epoch 11/80
 - 2s - loss: 0.0650
Epoch 12/80
 - 2s - loss: 0.0611
Epoch 13/80
 - 2s - loss: 0.0578
Epoch 14/80
 - 2s - loss: 0.0549
Epoch 15/80
 - 2s - loss: 0.0525
Epoch 16/80
 - 2s - loss: 0.0504
Epoch 17/80
 - 2s - loss: 0.0486
Epoch 18/80
 - 2s - loss: 0.0470
Epoch 19/80
 - 2s - loss: 0.0457
Epoch 20/80
 - 2s - loss: 0.0446
Epoch 21/80
 - 2s - loss: 0.0436
Epoch 22/80
 - 2s - loss: 0.0427
Epoch 23/80
 - 2s - loss: 0.0420
Epoch 24/80
 - 2s - loss: 0.0413
Epoch 25/80
 - 2s - loss: 0.0407
Epoch 26/80
 - 2s - loss: 0.0403
Epoch 27/80
 - 2s - loss: 0.0398
Epoch 28/80
 - 2s - loss: 0.0394
Epoch 29/80
 - 2s - loss: 0.0391
Epoch 30/80
 - 2s - loss: 0.0388
Epoch 31/80
 - 2s - loss: 0.0386
Epoch 32/80
 - 2s - loss: 0.0383
Epoch 33/80
 - 2s - loss: 0.0381
Epoch 34/80
 - 2s - loss: 0.0379
Epoch 35/80
 - 2s - loss: 0.0378
Epoch 36/80
 - 2s - loss: 0.0376
Epoch 37/80
 - 2s - loss: 0.0375
Epoch 38/80
 - 2s - loss: 0.0374
Epoch 39/80
 - 2s - loss: 0.0373
Epoch 40/80
 - 2s - loss: 0.0372
Epoch 41/80
 - 2s - loss: 0.0371
Epoch 42/80
 - 2s - loss: 0.0370
Epoch 43/80
 - 2s - loss: 0.0369
Epoch 44/80
 - 2s - loss: 0.0368
Epoch 45/80
 - 2s - loss: 0.0368
Epoch 46/80
 - 2s - loss: 0.0367
Epoch 47/80
 - 2s - loss: 0.0366
Epoch 48/80
 - 2s - loss: 0.0366
Epoch 49/80
 - 2s - loss: 0.0365
Epoch 50/80
 - 2s - loss: 0.0365
Epoch 51/80
 - 2s - loss: 0.0364
Epoch 52/80
 - 2s - loss: 0.0364
Epoch 53/80
 - 2s - loss: 0.0363
Epoch 54/80
 - 2s - loss: 0.0363
Epoch 55/80
 - 2s - loss: 0.0363
Epoch 56/80
 - 2s - loss: 0.0362
Epoch 57/80
 - 2s - loss: 0.0347
Epoch 58/80
 - 2s - loss: 0.0346
Epoch 59/80
 - 2s - loss: 0.0346
Epoch 60/80
 - 2s - loss: 0.0345
Epoch 61/80
 - 2s - loss: 0.0345
Epoch 62/80
 - 2s - loss: 0.0342
Epoch 63/80
 - 2s - loss: 0.0342
Epoch 64/80
 - 2s - loss: 0.0342
Epoch 65/80
 - 2s - loss: 0.0341
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:36:31.201953: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:36:31.370076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:36:31.370123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:36:31.672259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:36:31.672340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:36:31.672350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:36:31.672628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9769
Epoch 2/80
 - 2s - loss: 0.1819
Epoch 3/80
 - 2s - loss: 0.1572
Epoch 4/80
 - 2s - loss: 0.1389
Epoch 5/80
 - 2s - loss: 0.1234
Epoch 6/80
 - 2s - loss: 0.1097
Epoch 7/80
 - 2s - loss: 0.0973
Epoch 8/80
 - 2s - loss: 0.0866
Epoch 9/80
 - 2s - loss: 0.0780
Epoch 10/80
 - 2s - loss: 0.0712
Epoch 11/80
 - 2s - loss: 0.0658
Epoch 12/80
 - 2s - loss: 0.0616
Epoch 13/80
 - 2s - loss: 0.0582
Epoch 14/80
 - 2s - loss: 0.0553
Epoch 15/80
 - 2s - loss: 0.0529
Epoch 16/80
 - 2s - loss: 0.0508
Epoch 17/80
 - 2s - loss: 0.0490
Epoch 18/80
 - 2s - loss: 0.0474
Epoch 19/80
 - 2s - loss: 0.0461
Epoch 20/80
 - 2s - loss: 0.0449
Epoch 21/80
 - 2s - loss: 0.0438
Epoch 22/80
 - 2s - loss: 0.0429
Epoch 23/80
 - 2s - loss: 0.0422
Epoch 24/80
 - 2s - loss: 0.0415
Epoch 25/80
 - 2s - loss: 0.0409
Epoch 26/80
 - 2s - loss: 0.0404
Epoch 27/80
 - 2s - loss: 0.0400
Epoch 28/80
 - 2s - loss: 0.0396
Epoch 29/80
 - 2s - loss: 0.0392
Epoch 30/80
 - 2s - loss: 0.0389
Epoch 31/80
 - 2s - loss: 0.0387
Epoch 32/80
 - 2s - loss: 0.0384
Epoch 33/80
 - 2s - loss: 0.0382
Epoch 34/80
 - 2s - loss: 0.0381
Epoch 35/80
 - 2s - loss: 0.0379
Epoch 36/80
 - 2s - loss: 0.0377
Epoch 37/80
 - 2s - loss: 0.0376
Epoch 38/80
 - 2s - loss: 0.0375
Epoch 39/80
 - 2s - loss: 0.0374
Epoch 40/80
 - 2s - loss: 0.0373
Epoch 41/80
 - 2s - loss: 0.0372
Epoch 42/80
 - 2s - loss: 0.0371
Epoch 43/80
 - 2s - loss: 0.0370
Epoch 44/80
 - 2s - loss: 0.0369
Epoch 45/80
 - 2s - loss: 0.0369
Epoch 46/80
 - 2s - loss: 0.0368
Epoch 47/80
 - 2s - loss: 0.0367
Epoch 48/80
 - 2s - loss: 0.0367
Epoch 49/80
 - 2s - loss: 0.0366
Epoch 50/80
 - 2s - loss: 0.0366
Epoch 51/80
 - 2s - loss: 0.0365
Epoch 52/80
 - 2s - loss: 0.0365
Epoch 53/80
 - 2s - loss: 0.0365
Epoch 54/80
 - 2s - loss: 0.0364
Epoch 55/80
 - 2s - loss: 0.0364
Epoch 56/80
 - 2s - loss: 0.0363
Epoch 57/80
 - 2s - loss: 0.0363
Epoch 58/80
 - 2s - loss: 0.0363
Epoch 59/80
 - 2s - loss: 0.0363
Epoch 60/80
 - 2s - loss: 0.0347
Epoch 61/80
 - 2s - loss: 0.0346
Epoch 62/80
 - 2s - loss: 0.0346
Epoch 63/80
 - 2s - loss: 0.0346
Epoch 64/80
 - 2s - loss: 0.0346
Epoch 65/80
 - 2s - loss: 0.0342
Epoch 66/80
 - 2s - loss: 0.0342
Epoch 67/80
 - 2s - loss: 0.0342
Epoch 68/80
 - 2s - loss: 0.0342
Epoch 69/80
 - 2s - loss: 0.0341
Epoch 70/80
 - 2s - loss: 0.0341
Epoch 71/80
 - 2s - loss: 0.0341
Epoch 72/80
 - 2s - loss: 0.0341
Epoch 73/80
 - 2s - loss: 0.0341
Epoch 74/80
 - 2s - loss: 0.0341
Epoch 75/80
 - 2s - loss: 0.0341
Epoch 76/80
 - 2s - loss: 0.0341
Epoch 77/80
 - 2s - loss: 0.0341
Epoch 78/80
 - 2s - loss: 0.0341
Epoch 79/80
 - 2s - loss: 0.0341
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:39:29.675077: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:39:29.844827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:39:29.844885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:39:30.147076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:39:30.147130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:39:30.147139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:39:30.147406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9937
Epoch 2/80
 - 2s - loss: 0.1823
Epoch 3/80
 - 2s - loss: 0.1596
Epoch 4/80
 - 2s - loss: 0.1381
Epoch 5/80
 - 2s - loss: 0.1180
Epoch 6/80
 - 2s - loss: 0.1036
Epoch 7/80
 - 2s - loss: 0.0926
Epoch 8/80
 - 2s - loss: 0.0837
Epoch 9/80
 - 2s - loss: 0.0764
Epoch 10/80
 - 2s - loss: 0.0704
Epoch 11/80
 - 2s - loss: 0.0655
Epoch 12/80
 - 2s - loss: 0.0614
Epoch 13/80
 - 2s - loss: 0.0581
Epoch 14/80
 - 2s - loss: 0.0553
Epoch 15/80
 - 2s - loss: 0.0529
Epoch 16/80
 - 2s - loss: 0.0509
Epoch 17/80
 - 2s - loss: 0.0491
Epoch 18/80
 - 2s - loss: 0.0476
Epoch 19/80
 - 2s - loss: 0.0463
Epoch 20/80
 - 2s - loss: 0.0451
Epoch 21/80
 - 2s - loss: 0.0441
Epoch 22/80
 - 2s - loss: 0.0432
Epoch 23/80
 - 2s - loss: 0.0424
Epoch 24/80
 - 2s - loss: 0.0417
Epoch 25/80
 - 2s - loss: 0.0411
Epoch 26/80
 - 2s - loss: 0.0406
Epoch 27/80
 - 2s - loss: 0.0401
Epoch 28/80
 - 2s - loss: 0.0397
Epoch 29/80
 - 2s - loss: 0.0394
Epoch 30/80
 - 2s - loss: 0.0391
Epoch 31/80
 - 2s - loss: 0.0388
Epoch 32/80
 - 2s - loss: 0.0385
Epoch 33/80
 - 2s - loss: 0.0383
Epoch 34/80
 - 2s - loss: 0.0381
Epoch 35/80
 - 2s - loss: 0.0380
Epoch 36/80
 - 2s - loss: 0.0378
Epoch 37/80
 - 2s - loss: 0.0377
Epoch 38/80
 - 2s - loss: 0.0376
Epoch 39/80
 - 2s - loss: 0.0374
Epoch 40/80
 - 2s - loss: 0.0373
Epoch 41/80
 - 2s - loss: 0.0372
Epoch 42/80
 - 2s - loss: 0.0371
Epoch 43/80
 - 2s - loss: 0.0371
Epoch 44/80
 - 2s - loss: 0.0370
Epoch 45/80
 - 2s - loss: 0.0369
Epoch 46/80
 - 2s - loss: 0.0368
Epoch 47/80
 - 2s - loss: 0.0368
Epoch 48/80
 - 2s - loss: 0.0367
Epoch 49/80
 - 2s - loss: 0.0367
Epoch 50/80
 - 2s - loss: 0.0366
Epoch 51/80
 - 2s - loss: 0.0366
Epoch 52/80
 - 2s - loss: 0.0365
Epoch 53/80
 - 2s - loss: 0.0365
Epoch 54/80
 - 2s - loss: 0.0365
Epoch 55/80
 - 2s - loss: 0.0364
Epoch 56/80
 - 2s - loss: 0.0364
Epoch 57/80
 - 2s - loss: 0.0364
Epoch 58/80
 - 2s - loss: 0.0363
Epoch 59/80
 - 2s - loss: 0.0348
Epoch 60/80
 - 2s - loss: 0.0346
Epoch 61/80
 - 2s - loss: 0.0346
Epoch 62/80
 - 2s - loss: 0.0346
Epoch 63/80
 - 2s - loss: 0.0346
Epoch 64/80
 - 2s - loss: 0.0343
Epoch 65/80
 - 2s - loss: 0.0342
Epoch 66/80
 - 2s - loss: 0.0342
Epoch 67/80
 - 2s - loss: 0.0342
Epoch 68/80
 - 2s - loss: 0.0341
Epoch 69/80
 - 2s - loss: 0.0341
Epoch 70/80
 - 2s - loss: 0.0341
Epoch 71/80
 - 2s - loss: 0.0341
Epoch 72/80
 - 2s - loss: 0.0341
Epoch 73/80
 - 2s - loss: 0.0341
Epoch 74/80
 - 2s - loss: 0.0341
Epoch 75/80
 - 2s - loss: 0.0341
Epoch 76/80
 - 2s - loss: 0.0341
Epoch 77/80
 - 2s - loss: 0.0341
Epoch 78/80
 - 2s - loss: 0.0341
Epoch 79/80
 - 2s - loss: 0.0341
Epoch 80/80
 - 2s - loss: 0.0341
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.3476 - val_loss: 0.8789
AUC: 0.8090

Epoch 2/80
 - 0s - loss: 1.6420 - val_loss: 0.8147
AUC: 0.8366

Epoch 3/80
 - 0s - loss: 1.2587 - val_loss: 0.7152
AUC: 0.8420

Epoch 4/80
 - 0s - loss: 1.1557 - val_loss: 0.6566
AUC: 0.8444

Epoch 5/80
 - 0s - loss: 1.1266 - val_loss: 0.6639
AUC: 0.8520

Epoch 6/80
 - 0s - loss: 1.1015 - val_loss: 0.6464
AUC: 0.8568

Epoch 7/80
 - 0s - loss: 1.0688 - val_loss: 0.6776
AUC: 0.8547

Epoch 8/80
 - 0s - loss: 1.0533 - val_loss: 0.6628
AUC: 0.8616

Epoch 9/80
 - 0s - loss: 1.0416 - val_loss: 0.6412
AUC: 0.8606

Epoch 10/80
 - 0s - loss: 1.0382 - val_loss: 0.6799
AUC: 0.8632

Epoch 11/80
 - 0s - loss: 1.0422 - val_loss: 0.5766
AUC: 0.8602

Epoch 12/80
 - 0s - loss: 1.0283 - val_loss: 0.5811
AUC: 0.8600

Epoch 13/80
 - 0s - loss: 1.0134 - val_loss: 0.6539
AUC: 0.8638

Epoch 14/80
 - 0s - loss: 1.0150 - val_loss: 0.7018
AUC: 0.8656

Epoch 15/80
 - 0s - loss: 1.0127 - val_loss: 0.6084
AUC: 0.8639

Epoch 16/80
 - 0s - loss: 1.0023 - val_loss: 0.5958
AUC: 0.8639

Epoch 17/80
 - 0s - loss: 0.9913 - val_loss: 0.5901
AUC: 0.8633

Epoch 18/80
 - 0s - loss: 0.9925 - val_loss: 0.7230
AUC: 0.8665

Epoch 19/80
 - 0s - loss: 0.9887 - val_loss: 0.7011
AUC: 0.8661

Epoch 20/80
 - 0s - loss: 0.9808 - val_loss: 0.5720
AUC: 0.8655

Epoch 21/80
 - 0s - loss: 0.9822 - val_loss: 0.5612
AUC: 0.8662

Epoch 22/80
 - 0s - loss: 0.9724 - val_loss: 0.6030
AUC: 0.8666

Epoch 23/80
 - 0s - loss: 0.9690 - val_loss: 0.5689
AUC: 0.8661

Epoch 24/80
 - 0s - loss: 0.9688 - val_loss: 0.5474
AUC: 0.8638

Epoch 25/80
 - 0s - loss: 0.9635 - val_loss: 0.5837
AUC: 0.8659

Epoch 26/80
 - 0s - loss: 0.9589 - val_loss: 0.6308
AUC: 0.8685

Epoch 27/80
 - 0s - loss: 0.9550 - val_loss: 0.6005
AUC: 0.8659

Epoch 28/80
 - 0s - loss: 0.9606 - val_loss: 0.6023
AUC: 0.8665

Epoch 29/80
 - 0s - loss: 0.9543 - val_loss: 0.5782
AUC: 0.8668

Epoch 30/80
 - 0s - loss: 0.9544 - val_loss: 0.5882
AUC: 0.8668

Epoch 31/80
 - 0s - loss: 0.9423 - val_loss: 0.5928
AUC: 0.8661

Epoch 32/80
 - 0s - loss: 0.9402 - val_loss: 0.5680
AUC: 0.8659

Epoch 33/80
 - 0s - loss: 0.9358 - val_loss: 0.6586
AUC: 0.8684

Epoch 34/80
 - 0s - loss: 0.9332 - val_loss: 0.6182
AUC: 0.8662

Epoch 35/80
 - 0s - loss: 0.9198 - val_loss: 0.5987
AUC: 0.8675

Epoch 36/80
 - 0s - loss: 0.9166 - val_loss: 0.6064
AUC: 0.8682

Epoch 37/80
 - 0s - loss: 0.9157 - val_loss: 0.6053
AUC: 0.8679

Epoch 38/80
 - 0s - loss: 0.9126 - val_loss: 0.5658
AUC: 0.8672

Epoch 39/80
 - 0s - loss: 0.9089 - val_loss: 0.6117
AUC: 0.8683

Epoch 40/80
 - 0s - loss: 0.9057 - val_loss: 0.5980
AUC: 0.8678

Epoch 41/80
 - 0s - loss: 0.9114 - val_loss: 0.5974
AUC: 0.8678

Epoch 42/80
 - 0s - loss: 0.9058 - val_loss: 0.5756
AUC: 0.8668

Epoch 43/80
 - 0s - loss: 0.9096 - val_loss: 0.6173
AUC: 0.8681

Epoch 44/80
 - 0s - loss: 0.9123 - val_loss: 0.5823
AUC: 0.8674

Epoch 45/80
 - 0s - loss: 0.9005 - val_loss: 0.5825
AUC: 0.8674

Epoch 46/80
 - 0s - loss: 0.9023 - val_loss: 0.5816
AUC: 0.8673

Epoch 47/80
 - 0s - loss: 0.9008 - val_loss: 0.5874
AUC: 0.8676

Epoch 48/80
 - 0s - loss: 0.8975 - val_loss: 0.5737
AUC: 0.8672

Epoch 49/80
 - 0s - loss: 0.8993 - val_loss: 0.5698
AUC: 0.8671

Epoch 50/80
 - 0s - loss: 0.9038 - val_loss: 0.5821
AUC: 0.8673

Epoch 51/80
 - 0s - loss: 0.9022 - val_loss: 0.5759
AUC: 0.8672

Epoch 52/80
 - 0s - loss: 0.9036 - val_loss: 0.5868
AUC: 0.8673

Epoch 53/80
 - 0s - loss: 0.9022 - val_loss: 0.5857
AUC: 0.8673

Epoch 54/80
 - 0s - loss: 0.8990 - val_loss: 0.5918
AUC: 0.8674

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9473 - val_loss: 0.5910
AUC: 0.8675

Epoch 2/30
 - 1s - loss: 0.9371 - val_loss: 0.5951
AUC: 0.8675

Epoch 3/30
 - 1s - loss: 0.9356 - val_loss: 0.6147
AUC: 0.8676

Epoch 4/30
 - 1s - loss: 0.9316 - val_loss: 0.5714
AUC: 0.8668

Epoch 5/30
 - 1s - loss: 0.9284 - val_loss: 0.5823
AUC: 0.8671

Epoch 6/30
 - 1s - loss: 0.9278 - val_loss: 0.5933
AUC: 0.8671

Epoch 7/30
 - 1s - loss: 0.9321 - val_loss: 0.5769
AUC: 0.8670

Epoch 8/30
 - 1s - loss: 0.9246 - val_loss: 0.5849
AUC: 0.8672

Epoch 9/30
 - 1s - loss: 0.9248 - val_loss: 0.5670
AUC: 0.8669

Epoch 10/30
 - 1s - loss: 0.9240 - val_loss: 0.5808
AUC: 0.8670

Epoch 11/30
 - 1s - loss: 0.9207 - val_loss: 0.5961
AUC: 0.8671

Epoch 12/30
 - 1s - loss: 0.9179 - val_loss: 0.5980
AUC: 0.8675

Epoch 13/30
 - 1s - loss: 0.9163 - val_loss: 0.5935
AUC: 0.8670

Epoch 14/30
 - 1s - loss: 0.9142 - val_loss: 0.5927
AUC: 0.8672

Epoch 15/30
 - 1s - loss: 0.9124 - val_loss: 0.5870
AUC: 0.8675

Epoch 16/30
 - 1s - loss: 0.9135 - val_loss: 0.5846
AUC: 0.8671

Epoch 17/30
 - 1s - loss: 0.9079 - val_loss: 0.5875
AUC: 0.8671

Epoch 18/30
 - 1s - loss: 0.9078 - val_loss: 0.5734
AUC: 0.8672

Epoch 19/30
 - 1s - loss: 0.9051 - val_loss: 0.5822
AUC: 0.8673

Epoch 20/30
 - 1s - loss: 0.9027 - val_loss: 0.5815
AUC: 0.8674

Epoch 21/30
 - 1s - loss: 0.8987 - val_loss: 0.5779
AUC: 0.8673

Epoch 22/30
 - 1s - loss: 0.9018 - val_loss: 0.5852
AUC: 0.8676

Epoch 23/30
 - 1s - loss: 0.9049 - val_loss: 0.5789
AUC: 0.8674

Epoch 24/30
 - 1s - loss: 0.9025 - val_loss: 0.5834
AUC: 0.8675

Epoch 25/30
 - 1s - loss: 0.8998 - val_loss: 0.5833
AUC: 0.8675

Epoch 26/30
 - 1s - loss: 0.8970 - val_loss: 0.5835
AUC: 0.8675

Epoch 27/30
 - 1s - loss: 0.8984 - val_loss: 0.5921
AUC: 0.8676

Epoch 28/30
 - 1s - loss: 0.8967 - val_loss: 0.5888
AUC: 0.8675

Epoch 29/30
 - 1s - loss: 0.8997 - val_loss: 0.5868
AUC: 0.8675

Epoch 30/30
 - 1s - loss: 0.9002 - val_loss: 0.5840
Using TensorFlow backend.
AUC: 0.8674

2019-03-08 10:43:33.784970: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:43:33.953907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:43:33.953954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:43:34.257109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:43:34.257164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:43:34.257173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:43:34.257438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9936
Epoch 2/80
 - 2s - loss: 0.1807
Epoch 3/80
 - 2s - loss: 0.1504
Epoch 4/80
 - 2s - loss: 0.1294
Epoch 5/80
 - 2s - loss: 0.1142
Epoch 6/80
 - 2s - loss: 0.1021
Epoch 7/80
 - 2s - loss: 0.0921
Epoch 8/80
 - 2s - loss: 0.0835
Epoch 9/80
 - 2s - loss: 0.0760
Epoch 10/80
 - 2s - loss: 0.0699
Epoch 11/80
 - 2s - loss: 0.0648
Epoch 12/80
 - 2s - loss: 0.0608
Epoch 13/80
 - 2s - loss: 0.0576
Epoch 14/80
 - 2s - loss: 0.0549
Epoch 15/80
 - 2s - loss: 0.0526
Epoch 16/80
 - 2s - loss: 0.0506
Epoch 17/80
 - 2s - loss: 0.0489
Epoch 18/80
 - 2s - loss: 0.0474
Epoch 19/80
 - 2s - loss: 0.0461
Epoch 20/80
 - 2s - loss: 0.0450
Epoch 21/80
 - 2s - loss: 0.0440
Epoch 22/80
 - 2s - loss: 0.0431
Epoch 23/80
 - 2s - loss: 0.0424
Epoch 24/80
 - 2s - loss: 0.0417
Epoch 25/80
 - 2s - loss: 0.0411
Epoch 26/80
 - 2s - loss: 0.0406
Epoch 27/80
 - 2s - loss: 0.0402
Epoch 28/80
 - 2s - loss: 0.0398
Epoch 29/80
 - 2s - loss: 0.0395
Epoch 30/80
 - 2s - loss: 0.0392
Epoch 31/80
 - 2s - loss: 0.0389
Epoch 32/80
 - 2s - loss: 0.0387
Epoch 33/80
 - 2s - loss: 0.0384
Epoch 34/80
 - 2s - loss: 0.0382
Epoch 35/80
 - 2s - loss: 0.0381
Epoch 36/80
 - 2s - loss: 0.0379
Epoch 37/80
 - 2s - loss: 0.0378
Epoch 38/80
 - 2s - loss: 0.0377
Epoch 39/80
 - 2s - loss: 0.0375
Epoch 40/80
 - 2s - loss: 0.0374
Epoch 41/80
 - 2s - loss: 0.0373
Epoch 42/80
 - 2s - loss: 0.0372
Epoch 43/80
 - 2s - loss: 0.0372
Epoch 44/80
 - 2s - loss: 0.0371
Epoch 45/80
 - 2s - loss: 0.0370
Epoch 46/80
 - 2s - loss: 0.0369
Epoch 47/80
 - 2s - loss: 0.0369
Epoch 48/80
 - 2s - loss: 0.0368
Epoch 49/80
 - 2s - loss: 0.0368
Epoch 50/80
 - 2s - loss: 0.0367
Epoch 51/80
 - 2s - loss: 0.0367
Epoch 52/80
 - 2s - loss: 0.0366
Epoch 53/80
 - 2s - loss: 0.0366
Epoch 54/80
 - 2s - loss: 0.0365
Epoch 55/80
 - 2s - loss: 0.0365
Epoch 56/80
 - 2s - loss: 0.0365
Epoch 57/80
 - 2s - loss: 0.0364
Epoch 58/80
 - 2s - loss: 0.0364
Epoch 59/80
 - 2s - loss: 0.0364
Epoch 60/80
 - 2s - loss: 0.0363
Epoch 61/80
 - 2s - loss: 0.0348
Epoch 62/80
 - 2s - loss: 0.0347
Epoch 63/80
 - 2s - loss: 0.0346
Epoch 64/80
 - 2s - loss: 0.0346
Epoch 65/80
 - 2s - loss: 0.0346
Epoch 66/80
 - 2s - loss: 0.0343
Epoch 67/80
 - 2s - loss: 0.0343
Epoch 68/80
 - 2s - loss: 0.0343
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:46:07.373874: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:46:07.540278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:46:07.540326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:46:07.839699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:46:07.839761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:46:07.839772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:46:07.840038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6052
Epoch 2/80
 - 2s - loss: 0.0847
Epoch 3/80
 - 2s - loss: 0.0647
Epoch 4/80
 - 2s - loss: 0.0572
Epoch 5/80
 - 2s - loss: 0.0507
Epoch 6/80
 - 2s - loss: 0.0452
Epoch 7/80
 - 2s - loss: 0.0400
Epoch 8/80
 - 2s - loss: 0.0353
Epoch 9/80
 - 2s - loss: 0.0315
Epoch 10/80
 - 2s - loss: 0.0284
Epoch 11/80
 - 2s - loss: 0.0260
Epoch 12/80
 - 2s - loss: 0.0240
Epoch 13/80
 - 2s - loss: 0.0224
Epoch 14/80
 - 2s - loss: 0.0210
Epoch 15/80
 - 2s - loss: 0.0198
Epoch 16/80
 - 2s - loss: 0.0188
Epoch 17/80
 - 2s - loss: 0.0179
Epoch 18/80
 - 2s - loss: 0.0171
Epoch 19/80
 - 2s - loss: 0.0165
Epoch 20/80
 - 2s - loss: 0.0159
Epoch 21/80
 - 2s - loss: 0.0154
Epoch 22/80
 - 2s - loss: 0.0150
Epoch 23/80
 - 2s - loss: 0.0146
Epoch 24/80
 - 2s - loss: 0.0142
Epoch 25/80
 - 2s - loss: 0.0139
Epoch 26/80
 - 2s - loss: 0.0137
Epoch 27/80
 - 2s - loss: 0.0135
Epoch 28/80
 - 2s - loss: 0.0133
Epoch 29/80
 - 2s - loss: 0.0131
Epoch 30/80
 - 2s - loss: 0.0130
Epoch 31/80
 - 2s - loss: 0.0128
Epoch 32/80
 - 2s - loss: 0.0127
Epoch 33/80
 - 2s - loss: 0.0126
Epoch 34/80
 - 2s - loss: 0.0125
Epoch 35/80
 - 2s - loss: 0.0124
Epoch 36/80
 - 2s - loss: 0.0123
Epoch 37/80
 - 2s - loss: 0.0123
Epoch 38/80
 - 2s - loss: 0.0122
Epoch 39/80
 - 2s - loss: 0.0122
Epoch 40/80
 - 2s - loss: 0.0121
Epoch 41/80
 - 2s - loss: 0.0121
Epoch 42/80
 - 2s - loss: 0.0120
Epoch 43/80
 - 2s - loss: 0.0120
Epoch 44/80
 - 2s - loss: 0.0120
Epoch 45/80
 - 2s - loss: 0.0119
Epoch 46/80
 - 2s - loss: 0.0119
Epoch 47/80
 - 2s - loss: 0.0114
Epoch 48/80
 - 2s - loss: 0.0113
Epoch 49/80
 - 2s - loss: 0.0113
Epoch 50/80
 - 2s - loss: 0.0113
Epoch 51/80
 - 2s - loss: 0.0112
Epoch 52/80
 - 2s - loss: 0.0112
Epoch 53/80
 - 2s - loss: 0.0112
Epoch 54/80
 - 2s - loss: 0.0112
Epoch 55/80
 - 2s - loss: 0.0111
Epoch 56/80
 - 2s - loss: 0.0111
Epoch 57/80
 - 2s - loss: 0.0111
Epoch 58/80
 - 2s - loss: 0.0111
Epoch 59/80
 - 2s - loss: 0.0111
Epoch 60/80
 - 2s - loss: 0.0111
Epoch 61/80
 - 2s - loss: 0.0111
Epoch 62/80
 - 2s - loss: 0.0111
Epoch 63/80
 - 2s - loss: 0.0111
Epoch 64/80
 - 2s - loss: 0.0111
Epoch 65/80
 - 2s - loss: 0.0111
Epoch 66/80
 - 2s - loss: 0.0111
Epoch 67/80
 - 2s - loss: 0.0111
Epoch 68/80
 - 2s - loss: 0.0111
Epoch 69/80
 - 2s - loss: 0.0111
Epoch 70/80
 - 2s - loss: 0.0111
Epoch 71/80
 - 2s - loss: 0.0111
Epoch 72/80
 - 2s - loss: 0.0111
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:48:50.338444: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:48:50.508357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:48:50.508402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:48:50.810222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:48:50.810295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:48:50.810305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:48:50.810590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.5983
Epoch 2/80
 - 2s - loss: 0.0828
Epoch 3/80
 - 2s - loss: 0.0638
Epoch 4/80
 - 2s - loss: 0.0558
Epoch 5/80
 - 2s - loss: 0.0484
Epoch 6/80
 - 2s - loss: 0.0432
Epoch 7/80
 - 2s - loss: 0.0390
Epoch 8/80
 - 2s - loss: 0.0353
Epoch 9/80
 - 2s - loss: 0.0320
Epoch 10/80
 - 2s - loss: 0.0292
Epoch 11/80
 - 2s - loss: 0.0268
Epoch 12/80
 - 2s - loss: 0.0248
Epoch 13/80
 - 2s - loss: 0.0230
Epoch 14/80
 - 2s - loss: 0.0214
Epoch 15/80
 - 2s - loss: 0.0201
Epoch 16/80
 - 2s - loss: 0.0190
Epoch 17/80
 - 2s - loss: 0.0180
Epoch 18/80
 - 2s - loss: 0.0172
Epoch 19/80
 - 2s - loss: 0.0165
Epoch 20/80
 - 2s - loss: 0.0159
Epoch 21/80
 - 2s - loss: 0.0154
Epoch 22/80
 - 2s - loss: 0.0150
Epoch 23/80
 - 2s - loss: 0.0146
Epoch 24/80
 - 2s - loss: 0.0143
Epoch 25/80
 - 2s - loss: 0.0140
Epoch 26/80
 - 2s - loss: 0.0137
Epoch 27/80
 - 2s - loss: 0.0135
Epoch 28/80
 - 2s - loss: 0.0133
Epoch 29/80
 - 2s - loss: 0.0131
Epoch 30/80
 - 2s - loss: 0.0130
Epoch 31/80
 - 2s - loss: 0.0129
Epoch 32/80
 - 2s - loss: 0.0127
Epoch 33/80
 - 2s - loss: 0.0126
Epoch 34/80
 - 2s - loss: 0.0125
Epoch 35/80
 - 2s - loss: 0.0125
Epoch 36/80
 - 2s - loss: 0.0124
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:50:24.353572: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:50:24.520385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:50:24.520433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:50:24.822541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:50:24.822595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:50:24.822604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:50:24.822827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6163
Epoch 2/80
 - 2s - loss: 0.0843
Epoch 3/80
 - 2s - loss: 0.0645
Epoch 4/80
 - 2s - loss: 0.0575
Epoch 5/80
 - 2s - loss: 0.0505
Epoch 6/80
 - 2s - loss: 0.0444
Epoch 7/80
 - 2s - loss: 0.0395
Epoch 8/80
 - 2s - loss: 0.0353
Epoch 9/80
 - 2s - loss: 0.0319
Epoch 10/80
 - 2s - loss: 0.0290
Epoch 11/80
 - 2s - loss: 0.0265
Epoch 12/80
 - 2s - loss: 0.0244
Epoch 13/80
 - 2s - loss: 0.0227
Epoch 14/80
 - 2s - loss: 0.0212
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:51:10.691211: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:51:10.862174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:51:10.862221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:51:11.162283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:51:11.162341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:51:11.162350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:51:11.162643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2040
Epoch 2/80
 - 2s - loss: 0.3142
Epoch 3/80
 - 2s - loss: 0.2686
Epoch 4/80
 - 2s - loss: 0.2320
Epoch 5/80
 - 2s - loss: 0.2065
Epoch 6/80
 - 2s - loss: 0.1862
Epoch 7/80
 - 2s - loss: 0.1696
Epoch 8/80
 - 2s - loss: 0.1563
Epoch 9/80
 - 2s - loss: 0.1455
Epoch 10/80
 - 2s - loss: 0.1367
Epoch 11/80
 - 2s - loss: 0.1296
Epoch 12/80
 - 2s - loss: 0.1239
Epoch 13/80
 - 2s - loss: 0.1191
Epoch 14/80
 - 2s - loss: 0.1149
Epoch 15/80
 - 2s - loss: 0.1113
Epoch 16/80
 - 2s - loss: 0.1082
Epoch 17/80
 - 2s - loss: 0.1055
Epoch 18/80
 - 2s - loss: 0.1030
Epoch 19/80
 - 2s - loss: 0.1009
Epoch 20/80
 - 2s - loss: 0.0991
Epoch 21/80
 - 2s - loss: 0.0975
Epoch 22/80
 - 2s - loss: 0.0960
Epoch 23/80
 - 2s - loss: 0.0948
Epoch 24/80
 - 2s - loss: 0.0938
Epoch 25/80
 - 2s - loss: 0.0929
Epoch 26/80
 - 2s - loss: 0.0921
Epoch 27/80
 - 2s - loss: 0.0914
Epoch 28/80
 - 2s - loss: 0.0909
Epoch 29/80
 - 2s - loss: 0.0904
Epoch 30/80
 - 2s - loss: 0.0899
Epoch 31/80
 - 2s - loss: 0.0895
Epoch 32/80
 - 2s - loss: 0.0892
Epoch 33/80
 - 2s - loss: 0.0888
Epoch 34/80
 - 2s - loss: 0.0886
Epoch 35/80
 - 2s - loss: 0.0883
Epoch 36/80
 - 2s - loss: 0.0881
Epoch 37/80
 - 2s - loss: 0.0879
Epoch 38/80
 - 2s - loss: 0.0877
Epoch 39/80
 - 2s - loss: 0.0875
Epoch 40/80
 - 2s - loss: 0.0873
Epoch 41/80
 - 2s - loss: 0.0871
Epoch 42/80
 - 2s - loss: 0.0870
Epoch 43/80
 - 2s - loss: 0.0869
Epoch 44/80
 - 2s - loss: 0.0867
Epoch 45/80
 - 2s - loss: 0.0866
Epoch 46/80
 - 2s - loss: 0.0865
Epoch 47/80
 - 2s - loss: 0.0864
Epoch 48/80
 - 2s - loss: 0.0863
Epoch 49/80
 - 2s - loss: 0.0862
Epoch 50/80
 - 2s - loss: 0.0861
Epoch 51/80
 - 2s - loss: 0.0860
Epoch 52/80
 - 2s - loss: 0.0859
Epoch 53/80
 - 2s - loss: 0.0859
Epoch 54/80
 - 2s - loss: 0.0858
Epoch 55/80
 - 2s - loss: 0.0858
Epoch 56/80
 - 2s - loss: 0.0857
Epoch 57/80
 - 2s - loss: 0.0856
Epoch 58/80
 - 2s - loss: 0.0856
Epoch 59/80
 - 2s - loss: 0.0855
Epoch 60/80
 - 2s - loss: 0.0855
Epoch 61/80
 - 2s - loss: 0.0854
Epoch 62/80
 - 2s - loss: 0.0854
Epoch 63/80
 - 2s - loss: 0.0853
Epoch 64/80
 - 2s - loss: 0.0853
Epoch 65/80
 - 2s - loss: 0.0852
Epoch 66/80
 - 2s - loss: 0.0852
Epoch 67/80
 - 2s - loss: 0.0851
Epoch 68/80
 - 2s - loss: 0.0851
Epoch 69/80
 - 2s - loss: 0.0850
Epoch 70/80
 - 2s - loss: 0.0850
Epoch 71/80
 - 2s - loss: 0.0850
Epoch 72/80
 - 2s - loss: 0.0850
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:53:55.205529: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:53:55.373633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:53:55.373681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:53:55.683764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:53:55.683821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:53:55.683831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:53:55.684104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.4 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1900
Epoch 2/80
 - 2s - loss: 0.3156
Epoch 3/80
 - 2s - loss: 0.2700
Epoch 4/80
 - 2s - loss: 0.2352
Epoch 5/80
 - 2s - loss: 0.2088
Epoch 6/80
 - 2s - loss: 0.1876
Epoch 7/80
 - 2s - loss: 0.1711
Epoch 8/80
 - 2s - loss: 0.1583
Epoch 9/80
 - 2s - loss: 0.1475
Epoch 10/80
 - 2s - loss: 0.1384
Epoch 11/80
 - 2s - loss: 0.1307
Epoch 12/80
 - 2s - loss: 0.1245
Epoch 13/80
 - 2s - loss: 0.1193
Epoch 14/80
 - 2s - loss: 0.1151
Epoch 15/80
 - 2s - loss: 0.1114
Epoch 16/80
 - 2s - loss: 0.1082
Epoch 17/80
 - 2s - loss: 0.1054
Epoch 18/80
 - 2s - loss: 0.1029
Epoch 19/80
 - 2s - loss: 0.1008
Epoch 20/80
 - 2s - loss: 0.0989
Epoch 21/80
 - 2s - loss: 0.0974
Epoch 22/80
 - 2s - loss: 0.0960
Epoch 23/80
 - 2s - loss: 0.0948
Epoch 24/80
 - 2s - loss: 0.0938
Epoch 25/80
 - 2s - loss: 0.0929
Epoch 26/80
 - 2s - loss: 0.0921
Epoch 27/80
 - 2s - loss: 0.0914
Epoch 28/80
 - 2s - loss: 0.0909
Epoch 29/80
 - 2s - loss: 0.0903
Epoch 30/80
 - 2s - loss: 0.0899
Epoch 31/80
 - 2s - loss: 0.0895
Epoch 32/80
 - 2s - loss: 0.0891
Epoch 33/80
 - 2s - loss: 0.0888
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 10:55:22.279348: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:55:22.450745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:55:22.450814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:55:22.758111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:55:22.758167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:55:22.758176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:55:22.758492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1962
Epoch 2/80
 - 2s - loss: 0.3167
Epoch 3/80
 - 2s - loss: 0.2784
Epoch 4/80
 - 2s - loss: 0.2402
Epoch 5/80
 - 2s - loss: 0.2138
Epoch 6/80
 - 2s - loss: 0.1923
Epoch 7/80
 - 2s - loss: 0.1743
Epoch 8/80
 - 2s - loss: 0.1600
Epoch 9/80
 - 2s - loss: 0.1482
Epoch 10/80
 - 2s - loss: 0.1388
Epoch 11/80
 - 2s - loss: 0.1313
Epoch 12/80
 - 2s - loss: 0.1253
Epoch 13/80
 - 2s - loss: 0.1202
Epoch 14/80
 - 2s - loss: 0.1160
Epoch 15/80
 - 2s - loss: 0.1122
Epoch 16/80
 - 2s - loss: 0.1090
Epoch 17/80
 - 2s - loss: 0.1062
Epoch 18/80
 - 2s - loss: 0.1037
Epoch 19/80
 - 2s - loss: 0.1015
Epoch 20/80
 - 2s - loss: 0.0997
Epoch 21/80
 - 2s - loss: 0.0981
Epoch 22/80
 - 2s - loss: 0.0967
Epoch 23/80
 - 2s - loss: 0.0955
Epoch 24/80
 - 2s - loss: 0.0944
Epoch 25/80
 - 2s - loss: 0.0935
Epoch 26/80
 - 2s - loss: 0.0927
Epoch 27/80
 - 2s - loss: 0.0921
Epoch 28/80
 - 2s - loss: 0.0914
Epoch 29/80
 - 2s - loss: 0.0909
Epoch 30/80
 - 2s - loss: 0.0905
Epoch 31/80
 - 2s - loss: 0.0900
Epoch 32/80
 - 2s - loss: 0.0897
Epoch 33/80
 - 2s - loss: 0.0894
Epoch 34/80
 - 2s - loss: 0.0891
Epoch 35/80
 - 2s - loss: 0.0888
Epoch 36/80
 - 2s - loss: 0.0885
Epoch 37/80
 - 2s - loss: 0.0883
Epoch 38/80
 - 2s - loss: 0.0881
Epoch 39/80
 - 2s - loss: 0.0879
Epoch 40/80
 - 2s - loss: 0.0878
Epoch 41/80
 - 2s - loss: 0.0876
Epoch 42/80
 - 2s - loss: 0.0875
Epoch 43/80
 - 2s - loss: 0.0874
Epoch 44/80
 - 2s - loss: 0.0872
Epoch 45/80
 - 2s - loss: 0.0871
Epoch 46/80
 - 2s - loss: 0.0870
Epoch 47/80
 - 2s - loss: 0.0869
Epoch 48/80
 - 2s - loss: 0.0868
Epoch 49/80
 - 2s - loss: 0.0867
Epoch 50/80
 - 2s - loss: 0.0866
Epoch 51/80
 - 2s - loss: 0.0865
Epoch 52/80
 - 2s - loss: 0.0864
Epoch 53/80
 - 2s - loss: 0.0864
Epoch 54/80
 - 2s - loss: 0.0863
Epoch 55/80
 - 2s - loss: 0.0862
Epoch 56/80
 - 2s - loss: 0.0862
Epoch 57/80
 - 2s - loss: 0.0861
Epoch 58/80
 - 2s - loss: 0.0860
Epoch 59/80
 - 2s - loss: 0.0860
Epoch 60/80
 - 2s - loss: 0.0859
Epoch 61/80
 - 2s - loss: 0.0859
Epoch 62/80
 - 2s - loss: 0.0858
Epoch 63/80
 - 2s - loss: 0.0858
Epoch 64/80
 - 2s - loss: 0.0858
Epoch 65/80
 - 2s - loss: 0.0857
Epoch 66/80
 - 2s - loss: 0.0857
Epoch 67/80
 - 2s - loss: 0.0857
Epoch 68/80
 - 2s - loss: 0.0856
Epoch 69/80
 - 2s - loss: 0.0856
Epoch 70/80
 - 2s - loss: 0.0822
Epoch 71/80
 - 2s - loss: 0.0819
Epoch 72/80
 - 2s - loss: 0.0819
Epoch 73/80
 - 2s - loss: 0.0819
Epoch 74/80
 - 2s - loss: 0.0818
Epoch 75/80
 - 2s - loss: 0.0810
Epoch 76/80
 - 2s - loss: 0.0810
Epoch 77/80
 - 2s - loss: 0.0810
Epoch 78/80
 - 2s - loss: 0.0810
Epoch 79/80
 - 2s - loss: 0.0808
Epoch 80/80
 - 2s - loss: 0.0808
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.8032 - val_loss: 1.0697
AUC: 0.7991

Epoch 2/80
 - 0s - loss: 2.3736 - val_loss: 1.0153
AUC: 0.8357

Epoch 3/80
 - 0s - loss: 1.6815 - val_loss: 0.7828
AUC: 0.8386

Epoch 4/80
 - 0s - loss: 1.3578 - val_loss: 0.8212
AUC: 0.8457

Epoch 5/80
 - 0s - loss: 1.2049 - val_loss: 0.6755
AUC: 0.8434

Epoch 6/80
 - 0s - loss: 1.1529 - val_loss: 0.6482
AUC: 0.8455

Epoch 7/80
 - 0s - loss: 1.1242 - val_loss: 0.7818
AUC: 0.8499

Epoch 8/80
 - 0s - loss: 1.1098 - val_loss: 0.7164
AUC: 0.8518

Epoch 9/80
 - 0s - loss: 1.0829 - val_loss: 0.5678
AUC: 0.8490

Epoch 10/80
 - 0s - loss: 1.0712 - val_loss: 0.6711
AUC: 0.8544

Epoch 11/80
 - 0s - loss: 1.0595 - val_loss: 0.6279
AUC: 0.8532

Epoch 12/80
 - 0s - loss: 1.0484 - val_loss: 0.6032
AUC: 0.8549

Epoch 13/80
 - 0s - loss: 1.0451 - val_loss: 0.6112
AUC: 0.8553

Epoch 14/80
 - 0s - loss: 1.0315 - val_loss: 0.6133
AUC: 0.8556

Epoch 15/80
 - 0s - loss: 1.0338 - val_loss: 0.6149
AUC: 0.8563

Epoch 16/80
 - 0s - loss: 1.0279 - val_loss: 0.5709
AUC: 0.8560

Epoch 17/80
 - 0s - loss: 1.0176 - val_loss: 0.6093
AUC: 0.8570

Epoch 18/80
 - 0s - loss: 1.0142 - val_loss: 0.6185
AUC: 0.8570

Epoch 19/80
 - 0s - loss: 1.0138 - val_loss: 0.6126
AUC: 0.8584

Epoch 20/80
 - 0s - loss: 1.0011 - val_loss: 0.5952
AUC: 0.8589

Epoch 21/80
 - 0s - loss: 0.9959 - val_loss: 0.6525
AUC: 0.8595

Epoch 22/80
 - 0s - loss: 0.9991 - val_loss: 0.6339
AUC: 0.8589

Epoch 23/80
 - 0s - loss: 1.0021 - val_loss: 0.6165
AUC: 0.8589

Epoch 24/80
 - 0s - loss: 0.9940 - val_loss: 0.5989
AUC: 0.8585

Epoch 25/80
 - 0s - loss: 0.9923 - val_loss: 0.5964
AUC: 0.8589

Epoch 26/80
 - 0s - loss: 0.9979 - val_loss: 0.6599
AUC: 0.8597

Epoch 27/80
 - 0s - loss: 0.9919 - val_loss: 0.6363
AUC: 0.8591

Epoch 28/80
 - 0s - loss: 0.9936 - val_loss: 0.6192
AUC: 0.8587

Epoch 29/80
 - 0s - loss: 0.9919 - val_loss: 0.6227
AUC: 0.8593

Epoch 30/80
 - 0s - loss: 0.9855 - val_loss: 0.6295
AUC: 0.8593

Epoch 31/80
 - 0s - loss: 0.9867 - val_loss: 0.6135
AUC: 0.8590

Epoch 32/80
 - 0s - loss: 0.9907 - val_loss: 0.6232
AUC: 0.8593

Epoch 33/80
 - 0s - loss: 0.9878 - val_loss: 0.6211
AUC: 0.8593

Epoch 34/80
 - 0s - loss: 0.9834 - val_loss: 0.6134
AUC: 0.8591

Epoch 35/80
 - 0s - loss: 0.9844 - val_loss: 0.6147
AUC: 0.8593

Epoch 36/80
 - 0s - loss: 0.9877 - val_loss: 0.6203
AUC: 0.8593

Epoch 37/80
 - 0s - loss: 0.9831 - val_loss: 0.6220
AUC: 0.8594

Epoch 38/80
 - 0s - loss: 0.9857 - val_loss: 0.6135
AUC: 0.8593

Epoch 39/80
 - 0s - loss: 0.9842 - val_loss: 0.6141
AUC: 0.8594

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9946 - val_loss: 0.6146
AUC: 0.8594

Epoch 2/30
 - 1s - loss: 0.9893 - val_loss: 0.6140
AUC: 0.8599

Epoch 3/30
 - 1s - loss: 0.9886 - val_loss: 0.5938
AUC: 0.8595

Epoch 4/30
 - 1s - loss: 0.9867 - val_loss: 0.6149
AUC: 0.8597

Epoch 5/30
 - 0s - loss: 0.9811 - val_loss: 0.6251
AUC: 0.8603

Epoch 6/30
 - 0s - loss: 0.9747 - val_loss: 0.6194
AUC: 0.8608

Epoch 7/30
 - 1s - loss: 0.9766 - val_loss: 0.6087
AUC: 0.8604

Epoch 8/30
 - 0s - loss: 0.9746 - val_loss: 0.6061
AUC: 0.8608

Epoch 9/30
 - 0s - loss: 0.9717 - val_loss: 0.6056
AUC: 0.8608

Epoch 10/30
 - 0s - loss: 0.9742 - val_loss: 0.5749
AUC: 0.8602

Epoch 11/30
 - 0s - loss: 0.9700 - val_loss: 0.6205
AUC: 0.8617

Epoch 12/30
 - 0s - loss: 0.9705 - val_loss: 0.6041
AUC: 0.8616

Epoch 13/30
 - 0s - loss: 0.9655 - val_loss: 0.6085
AUC: 0.8620

Epoch 14/30
 - 0s - loss: 0.9672 - val_loss: 0.5806
AUC: 0.8616

Epoch 15/30
 - 0s - loss: 0.9656 - val_loss: 0.6150
AUC: 0.8624

Epoch 16/30
 - 0s - loss: 0.9598 - val_loss: 0.6068
AUC: 0.8622

Epoch 17/30
 - 0s - loss: 0.9578 - val_loss: 0.6110
AUC: 0.8627

Epoch 18/30
 - 0s - loss: 0.9556 - val_loss: 0.6121
AUC: 0.8631

Epoch 19/30
 - 0s - loss: 0.9527 - val_loss: 0.6121
AUC: 0.8631

Epoch 20/30
 - 0s - loss: 0.9618 - val_loss: 0.6119
AUC: 0.8633

Epoch 21/30
 - 0s - loss: 0.9515 - val_loss: 0.6089
AUC: 0.8632

Epoch 22/30
 - 0s - loss: 0.9539 - val_loss: 0.6005
AUC: 0.8631

Epoch 23/30
 - 0s - loss: 0.9497 - val_loss: 0.5943
AUC: 0.8630

Epoch 24/30
 - 0s - loss: 0.9514 - val_loss: 0.6045
AUC: 0.8632

Epoch 25/30
 - 0s - loss: 0.9524 - val_loss: 0.6017
AUC: 0.8632

Epoch 26/30
 - 0s - loss: 0.9476 - val_loss: 0.6032
AUC: 0.8633

Epoch 27/30
 - 0s - loss: 0.9475 - val_loss: 0.6046
AUC: 0.8633

Epoch 28/30
 - 0s - loss: 0.9495 - val_loss: 0.5983
AUC: 0.8632

Epoch 29/30
 - 0s - loss: 0.9516 - val_loss: 0.6041
AUC: 0.8634

Epoch 30/30
 - 0s - loss: 0.9505 - val_loss: 0.5942
Using TensorFlow backend.
AUC: 0.8633

2019-03-08 10:59:08.338077: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 10:59:08.507015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 10:59:08.507062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 10:59:08.812880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 10:59:08.812929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 10:59:08.812940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 10:59:08.813259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0114
Epoch 2/80
 - 2s - loss: 0.1804
Epoch 3/80
 - 2s - loss: 0.1493
Epoch 4/80
 - 2s - loss: 0.1267
Epoch 5/80
 - 2s - loss: 0.1125
Epoch 6/80
 - 2s - loss: 0.1011
Epoch 7/80
 - 2s - loss: 0.0911
Epoch 8/80
 - 2s - loss: 0.0829
Epoch 9/80
 - 2s - loss: 0.0758
Epoch 10/80
 - 2s - loss: 0.0700
Epoch 11/80
 - 2s - loss: 0.0650
Epoch 12/80
 - 2s - loss: 0.0610
Epoch 13/80
 - 2s - loss: 0.0577
Epoch 14/80
 - 2s - loss: 0.0549
Epoch 15/80
 - 2s - loss: 0.0525
Epoch 16/80
 - 2s - loss: 0.0505
Epoch 17/80
 - 2s - loss: 0.0487
Epoch 18/80
 - 2s - loss: 0.0472
Epoch 19/80
 - 2s - loss: 0.0459
Epoch 20/80
 - 2s - loss: 0.0447
Epoch 21/80
 - 2s - loss: 0.0437
Epoch 22/80
 - 2s - loss: 0.0428
Epoch 23/80
 - 2s - loss: 0.0421
Epoch 24/80
 - 2s - loss: 0.0414
Epoch 25/80
 - 2s - loss: 0.0408
Epoch 26/80
 - 2s - loss: 0.0403
Epoch 27/80
 - 2s - loss: 0.0398
Epoch 28/80
 - 2s - loss: 0.0395
Epoch 29/80
 - 2s - loss: 0.0391
Epoch 30/80
 - 2s - loss: 0.0388
Epoch 31/80
 - 2s - loss: 0.0386
Epoch 32/80
 - 2s - loss: 0.0384
Epoch 33/80
 - 2s - loss: 0.0381
Epoch 34/80
 - 2s - loss: 0.0380
Epoch 35/80
 - 2s - loss: 0.0378
Epoch 36/80
 - 2s - loss: 0.0377
Epoch 37/80
 - 2s - loss: 0.0375
Epoch 38/80
 - 2s - loss: 0.0374
Epoch 39/80
 - 2s - loss: 0.0373
Epoch 40/80
 - 2s - loss: 0.0372
Epoch 41/80
 - 2s - loss: 0.0371
Epoch 42/80
 - 2s - loss: 0.0370
Epoch 43/80
 - 2s - loss: 0.0369
Epoch 44/80
 - 2s - loss: 0.0368
Epoch 45/80
 - 2s - loss: 0.0368
Epoch 46/80
 - 2s - loss: 0.0367
Epoch 47/80
 - 2s - loss: 0.0367
Epoch 48/80
 - 2s - loss: 0.0366
Epoch 49/80
 - 2s - loss: 0.0365
Epoch 50/80
 - 2s - loss: 0.0365
Epoch 51/80
 - 2s - loss: 0.0365
Epoch 52/80
 - 2s - loss: 0.0364
Epoch 53/80
 - 2s - loss: 0.0364
Epoch 54/80
 - 2s - loss: 0.0363
Epoch 55/80
 - 2s - loss: 0.0363
Epoch 56/80
 - 2s - loss: 0.0363
Epoch 57/80
 - 2s - loss: 0.0362
Epoch 58/80
 - 2s - loss: 0.0362
Epoch 59/80
 - 2s - loss: 0.0347
Epoch 60/80
 - 2s - loss: 0.0345
Epoch 61/80
 - 2s - loss: 0.0345
Epoch 62/80
 - 2s - loss: 0.0345
Epoch 63/80
 - 2s - loss: 0.0345
Epoch 64/80
 - 2s - loss: 0.0341
Epoch 65/80
 - 2s - loss: 0.0341
Epoch 66/80
 - 2s - loss: 0.0341
Epoch 67/80
 - 2s - loss: 0.0341
Epoch 68/80
 - 2s - loss: 0.0340
Epoch 69/80
 - 2s - loss: 0.0340
Epoch 70/80
 - 2s - loss: 0.0340
Epoch 71/80
 - 2s - loss: 0.0340
Epoch 72/80
 - 2s - loss: 0.0340
Epoch 73/80
 - 2s - loss: 0.0340
Epoch 74/80
 - 2s - loss: 0.0340
Epoch 75/80
 - 2s - loss: 0.0340
Epoch 76/80
 - 2s - loss: 0.0340
Epoch 77/80
 - 2s - loss: 0.0340
Epoch 78/80
 - 2s - loss: 0.0340
Epoch 79/80
 - 2s - loss: 0.0340
Epoch 80/80
 - 2s - loss: 0.0340
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.2936 - val_loss: 1.3674
AUC: 0.8007

Epoch 2/80
 - 0s - loss: 2.2847 - val_loss: 0.8459
AUC: 0.8331

Epoch 3/80
 - 0s - loss: 1.6388 - val_loss: 0.7207
AUC: 0.8477

Epoch 4/80
 - 0s - loss: 1.3199 - val_loss: 0.7146
AUC: 0.8521

Epoch 5/80
 - 0s - loss: 1.2026 - val_loss: 0.5994
AUC: 0.8543

Epoch 6/80
 - 0s - loss: 1.1354 - val_loss: 0.6411
AUC: 0.8591

Epoch 7/80
 - 0s - loss: 1.1141 - val_loss: 0.6522
AUC: 0.8608

Epoch 8/80
 - 0s - loss: 1.0902 - val_loss: 0.6696
AUC: 0.8625

Epoch 9/80
 - 0s - loss: 1.0755 - val_loss: 0.6477
AUC: 0.8631

Epoch 10/80
 - 0s - loss: 1.0626 - val_loss: 0.5940
AUC: 0.8635

Epoch 11/80
 - 0s - loss: 1.0506 - val_loss: 0.6404
AUC: 0.8660

Epoch 12/80
 - 0s - loss: 1.0487 - val_loss: 0.6380
AUC: 0.8664

Epoch 13/80
 - 0s - loss: 1.0424 - val_loss: 0.7276
AUC: 0.8686

Epoch 14/80
 - 0s - loss: 1.0393 - val_loss: 0.5824
AUC: 0.8671

Epoch 15/80
 - 0s - loss: 1.0326 - val_loss: 0.6615
AUC: 0.8688

Epoch 16/80
 - 0s - loss: 1.0265 - val_loss: 0.5818
AUC: 0.8682

Epoch 17/80
 - 0s - loss: 1.0156 - val_loss: 0.6519
AUC: 0.8707

Epoch 18/80
 - 0s - loss: 1.0249 - val_loss: 0.5832
AUC: 0.8686

Epoch 19/80
 - 0s - loss: 1.0115 - val_loss: 0.6403
AUC: 0.8704

Epoch 20/80
 - 0s - loss: 1.0101 - val_loss: 0.6151
AUC: 0.8701

Epoch 21/80
 - 0s - loss: 1.0091 - val_loss: 0.6696
AUC: 0.8713

Epoch 22/80
 - 0s - loss: 1.0042 - val_loss: 0.6723
AUC: 0.8720

Epoch 23/80
 - 0s - loss: 1.0002 - val_loss: 0.6826
AUC: 0.8716

Epoch 24/80
 - 0s - loss: 0.9972 - val_loss: 0.6053
AUC: 0.8712

Epoch 25/80
 - 0s - loss: 1.0008 - val_loss: 0.5896
AUC: 0.8720

Epoch 26/80
 - 0s - loss: 0.9982 - val_loss: 0.7278
AUC: 0.8717

Epoch 27/80
 - 0s - loss: 0.9869 - val_loss: 0.6022
AUC: 0.8723

Epoch 28/80
 - 0s - loss: 0.9800 - val_loss: 0.6012
AUC: 0.8724

Epoch 29/80
 - 0s - loss: 0.9777 - val_loss: 0.6280
AUC: 0.8727

Epoch 30/80
 - 0s - loss: 0.9788 - val_loss: 0.6082
AUC: 0.8731

Epoch 31/80
 - 0s - loss: 0.9786 - val_loss: 0.6192
AUC: 0.8730

Epoch 32/80
 - 0s - loss: 0.9794 - val_loss: 0.6106
AUC: 0.8733

Epoch 33/80
 - 0s - loss: 0.9748 - val_loss: 0.5938
AUC: 0.8731

Epoch 34/80
 - 0s - loss: 0.9782 - val_loss: 0.6219
AUC: 0.8734

Epoch 35/80
 - 0s - loss: 0.9723 - val_loss: 0.5954
AUC: 0.8729

Epoch 36/80
 - 0s - loss: 0.9700 - val_loss: 0.6204
AUC: 0.8733

Epoch 37/80
 - 0s - loss: 0.9720 - val_loss: 0.6079
AUC: 0.8732

Epoch 38/80
 - 0s - loss: 0.9712 - val_loss: 0.6013
AUC: 0.8731

Epoch 39/80
 - 0s - loss: 0.9706 - val_loss: 0.6152
AUC: 0.8732

Epoch 40/80
 - 0s - loss: 0.9656 - val_loss: 0.6077
AUC: 0.8732

Epoch 41/80
 - 0s - loss: 0.9696 - val_loss: 0.5934
AUC: 0.8731

Epoch 42/80
 - 0s - loss: 0.9683 - val_loss: 0.5970
AUC: 0.8731

Epoch 43/80
 - 0s - loss: 0.9699 - val_loss: 0.6012
AUC: 0.8731

Epoch 44/80
 - 0s - loss: 0.9676 - val_loss: 0.5963
AUC: 0.8731

Epoch 45/80
 - 0s - loss: 0.9746 - val_loss: 0.6119
AUC: 0.8732

Epoch 46/80
 - 0s - loss: 0.9685 - val_loss: 0.6135
AUC: 0.8733

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9730 - val_loss: 0.6196
AUC: 0.8733

Epoch 2/30
 - 0s - loss: 0.9722 - val_loss: 0.5937
AUC: 0.8732

Epoch 3/30
 - 0s - loss: 0.9694 - val_loss: 0.6001
AUC: 0.8734

Epoch 4/30
 - 0s - loss: 0.9631 - val_loss: 0.6200
AUC: 0.8736

Epoch 5/30
 - 0s - loss: 0.9651 - val_loss: 0.6158
AUC: 0.8738

Epoch 6/30
 - 0s - loss: 0.9638 - val_loss: 0.6245
AUC: 0.8741

Epoch 7/30
 - 0s - loss: 0.9631 - val_loss: 0.6022
AUC: 0.8739

Epoch 8/30
 - 0s - loss: 0.9579 - val_loss: 0.6055
AUC: 0.8742

Epoch 9/30
 - 0s - loss: 0.9558 - val_loss: 0.5882
AUC: 0.8742

Epoch 10/30
 - 0s - loss: 0.9592 - val_loss: 0.6138
AUC: 0.8744

Epoch 11/30
 - 0s - loss: 0.9579 - val_loss: 0.5893
AUC: 0.8745

Epoch 12/30
 - 0s - loss: 0.9527 - val_loss: 0.5876
AUC: 0.8746

Epoch 13/30
 - 0s - loss: 0.9505 - val_loss: 0.5713
AUC: 0.8746

Epoch 14/30
 - 0s - loss: 0.9499 - val_loss: 0.5756
AUC: 0.8744

Epoch 15/30
 - 0s - loss: 0.9469 - val_loss: 0.5928
AUC: 0.8749

Epoch 16/30
 - 0s - loss: 0.9431 - val_loss: 0.6050
AUC: 0.8752

Epoch 17/30
 - 0s - loss: 0.9452 - val_loss: 0.5732
AUC: 0.8748

Epoch 18/30
 - 0s - loss: 0.9423 - val_loss: 0.5917
AUC: 0.8751

Epoch 19/30
 - 0s - loss: 0.9425 - val_loss: 0.5944
AUC: 0.8753

Epoch 20/30
 - 0s - loss: 0.9398 - val_loss: 0.5930
AUC: 0.8755

Epoch 21/30
 - 0s - loss: 0.9392 - val_loss: 0.5726
AUC: 0.8753

Epoch 22/30
 - 0s - loss: 0.9362 - val_loss: 0.5897
AUC: 0.8754

Epoch 23/30
 - 0s - loss: 0.9365 - val_loss: 0.6143
AUC: 0.8759

Epoch 24/30
 - 0s - loss: 0.9302 - val_loss: 0.5832
AUC: 0.8757

Epoch 25/30
 - 0s - loss: 0.9308 - val_loss: 0.5876
AUC: 0.8757

Epoch 26/30
 - 0s - loss: 0.9318 - val_loss: 0.5907
AUC: 0.8758

Epoch 27/30
 - 0s - loss: 0.9351 - val_loss: 0.5889
AUC: 0.8758

Epoch 28/30
 - 0s - loss: 0.9313 - val_loss: 0.5823
AUC: 0.8757

Epoch 29/30
 - 0s - loss: 0.9328 - val_loss: 0.5910
AUC: 0.8757

Epoch 30/30
 - 0s - loss: 0.9315 - val_loss: 0.5810
Using TensorFlow backend.
AUC: 0.8757

2019-03-08 11:03:01.654727: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:03:01.826038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:03:01.826084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:03:02.176134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:03:02.176195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:03:02.176205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:03:02.176477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9991
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:03:23.021711: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:03:23.189344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:03:23.189389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:03:23.492961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:03:23.493017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:03:23.493040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:03:23.493306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9798
Epoch 2/80
 - 2s - loss: 0.1831
Epoch 3/80
 - 2s - loss: 0.1650
Epoch 4/80
 - 2s - loss: 0.1488
Epoch 5/80
 - 2s - loss: 0.1278
Epoch 6/80
 - 2s - loss: 0.1106
Epoch 7/80
 - 2s - loss: 0.0982
Epoch 8/80
 - 2s - loss: 0.0880
Epoch 9/80
 - 2s - loss: 0.0797
Epoch 10/80
 - 2s - loss: 0.0728
Epoch 11/80
 - 2s - loss: 0.0672
Epoch 12/80
 - 2s - loss: 0.0627
Epoch 13/80
 - 2s - loss: 0.0591
Epoch 14/80
 - 2s - loss: 0.0561
Epoch 15/80
 - 2s - loss: 0.0535
Epoch 16/80
 - 2s - loss: 0.0513
Epoch 17/80
 - 2s - loss: 0.0494
Epoch 18/80
 - 2s - loss: 0.0477
Epoch 19/80
 - 2s - loss: 0.0463
Epoch 20/80
 - 2s - loss: 0.0451
Epoch 21/80
 - 2s - loss: 0.0441
Epoch 22/80
 - 2s - loss: 0.0432
Epoch 23/80
 - 2s - loss: 0.0423
Epoch 24/80
 - 2s - loss: 0.0417
Epoch 25/80
 - 2s - loss: 0.0411
Epoch 26/80
 - 2s - loss: 0.0406
Epoch 27/80
 - 2s - loss: 0.0401
Epoch 28/80
 - 2s - loss: 0.0397
Epoch 29/80
 - 2s - loss: 0.0393
Epoch 30/80
 - 2s - loss: 0.0390
Epoch 31/80
 - 2s - loss: 0.0388
Epoch 32/80
 - 2s - loss: 0.0385
Epoch 33/80
 - 2s - loss: 0.0383
Epoch 34/80
 - 2s - loss: 0.0381
Epoch 35/80
 - 2s - loss: 0.0379
Epoch 36/80
 - 2s - loss: 0.0378
Epoch 37/80
 - 2s - loss: 0.0377
Epoch 38/80
 - 2s - loss: 0.0375
Epoch 39/80
 - 2s - loss: 0.0374
Epoch 40/80
 - 2s - loss: 0.0373
Epoch 41/80
 - 2s - loss: 0.0372
Epoch 42/80
 - 2s - loss: 0.0371
Epoch 43/80
 - 2s - loss: 0.0370
Epoch 44/80
 - 2s - loss: 0.0369
Epoch 45/80
 - 2s - loss: 0.0369
Epoch 46/80
 - 2s - loss: 0.0368
Epoch 47/80
 - 2s - loss: 0.0367
Epoch 48/80
 - 2s - loss: 0.0367
Epoch 49/80
 - 2s - loss: 0.0366
Epoch 50/80
 - 2s - loss: 0.0366
Epoch 51/80
 - 2s - loss: 0.0365
Epoch 52/80
 - 2s - loss: 0.0365
Epoch 53/80
 - 2s - loss: 0.0364
Epoch 54/80
 - 2s - loss: 0.0364
Epoch 55/80
 - 2s - loss: 0.0364
Epoch 56/80
 - 2s - loss: 0.0363
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:05:35.428048: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:05:35.598212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:05:35.598266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:05:35.905211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:05:35.905265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:05:35.905274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:05:35.905539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9894
Epoch 2/80
 - 2s - loss: 0.1813
Epoch 3/80
 - 2s - loss: 0.1517
Epoch 4/80
 - 2s - loss: 0.1298
Epoch 5/80
 - 2s - loss: 0.1125
Epoch 6/80
 - 2s - loss: 0.0998
Epoch 7/80
 - 2s - loss: 0.0901
Epoch 8/80
 - 2s - loss: 0.0818
Epoch 9/80
 - 2s - loss: 0.0748
Epoch 10/80
 - 2s - loss: 0.0691
Epoch 11/80
 - 2s - loss: 0.0647
Epoch 12/80
 - 2s - loss: 0.0610
Epoch 13/80
 - 2s - loss: 0.0579
Epoch 14/80
 - 2s - loss: 0.0552
Epoch 15/80
 - 2s - loss: 0.0530
Epoch 16/80
 - 2s - loss: 0.0510
Epoch 17/80
 - 2s - loss: 0.0492
Epoch 18/80
 - 2s - loss: 0.0476
Epoch 19/80
 - 2s - loss: 0.0463
Epoch 20/80
 - 2s - loss: 0.0451
Epoch 21/80
 - 2s - loss: 0.0441
Epoch 22/80
 - 2s - loss: 0.0432
Epoch 23/80
 - 2s - loss: 0.0424
Epoch 24/80
 - 2s - loss: 0.0417
Epoch 25/80
 - 2s - loss: 0.0411
Epoch 26/80
 - 2s - loss: 0.0406
Epoch 27/80
 - 2s - loss: 0.0402
Epoch 28/80
 - 2s - loss: 0.0398
Epoch 29/80
 - 2s - loss: 0.0394
Epoch 30/80
 - 2s - loss: 0.0391
Epoch 31/80
 - 2s - loss: 0.0389
Epoch 32/80
 - 2s - loss: 0.0386
Epoch 33/80
 - 2s - loss: 0.0384
Epoch 34/80
 - 2s - loss: 0.0382
Epoch 35/80
 - 2s - loss: 0.0381
Epoch 36/80
 - 2s - loss: 0.0379
Epoch 37/80
 - 2s - loss: 0.0378
Epoch 38/80
 - 2s - loss: 0.0376
Epoch 39/80
 - 2s - loss: 0.0376
Epoch 40/80
 - 2s - loss: 0.0374
Epoch 41/80
 - 2s - loss: 0.0373
Epoch 42/80
 - 2s - loss: 0.0373
Epoch 43/80
 - 2s - loss: 0.0372
Epoch 44/80
 - 2s - loss: 0.0371
Epoch 45/80
 - 2s - loss: 0.0370
Epoch 46/80
 - 2s - loss: 0.0370
Epoch 47/80
 - 2s - loss: 0.0369
Epoch 48/80
 - 2s - loss: 0.0368
Epoch 49/80
 - 2s - loss: 0.0368
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2b8ff83170f0>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 11:07:30.352332: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:07:30.521605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:07:30.521651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:07:30.827629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:07:30.827680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:07:30.827689: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:07:30.827963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6119
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2b82daf4c6a0>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 11:07:52.196283: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:07:52.365939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:07:52.365986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:07:52.674121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:07:52.674178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:07:52.674188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:07:52.674463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.5 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6074
Epoch 2/80
 - 2s - loss: 0.0827
Epoch 3/80
 - 2s - loss: 0.0595
Epoch 4/80
 - 2s - loss: 0.0505
Epoch 5/80
 - 2s - loss: 0.0441
Epoch 6/80
 - 2s - loss: 0.0394
Epoch 7/80
 - 2s - loss: 0.0358
Epoch 8/80
 - 2s - loss: 0.0327
Epoch 9/80
 - 2s - loss: 0.0300
Epoch 10/80
 - 2s - loss: 0.0278
Epoch 11/80
 - 2s - loss: 0.0258
Epoch 12/80
 - 2s - loss: 0.0240
Epoch 13/80
 - 2s - loss: 0.0225
Epoch 14/80
 - 2s - loss: 0.0211
Epoch 15/80
 - 2s - loss: 0.0199
Epoch 16/80
 - 2s - loss: 0.0189
Epoch 17/80
 - 2s - loss: 0.0180
Epoch 18/80
 - 2s - loss: 0.0172
Epoch 19/80
 - 2s - loss: 0.0165
Epoch 20/80
 - 2s - loss: 0.0160
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:08:54.005561: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:08:54.178730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:08:54.178784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:08:54.482960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:08:54.483016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:08:54.483026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:08:54.483294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.5962
Epoch 2/80
 - 2s - loss: 0.0833
Epoch 3/80
 - 2s - loss: 0.0650
Epoch 4/80
 - 2s - loss: 0.0574
Epoch 5/80
 - 2s - loss: 0.0507
Epoch 6/80
 - 2s - loss: 0.0448
Epoch 7/80
 - 2s - loss: 0.0397
Epoch 8/80
 - 2s - loss: 0.0355
Epoch 9/80
 - 2s - loss: 0.0320
Epoch 10/80
 - 2s - loss: 0.0290
Epoch 11/80
 - 2s - loss: 0.0264
Epoch 12/80
 - 2s - loss: 0.0243
Epoch 13/80
 - 2s - loss: 0.0225
Epoch 14/80
 - 2s - loss: 0.0210
Epoch 15/80
 - 2s - loss: 0.0197
Epoch 16/80
 - 2s - loss: 0.0187
Epoch 17/80
 - 2s - loss: 0.0178
Epoch 18/80
 - 2s - loss: 0.0171
Epoch 19/80
 - 2s - loss: 0.0165
Epoch 20/80
 - 2s - loss: 0.0159
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:09:56.685487: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:09:56.865199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:09:56.865256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:09:57.209204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:09:57.209264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:09:57.209273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:09:57.209538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2066
Epoch 2/80
 - 2s - loss: 0.3172
Epoch 3/80
 - 2s - loss: 0.2726
Epoch 4/80
 - 2s - loss: 0.2332
Epoch 5/80
 - 2s - loss: 0.2089
Epoch 6/80
 - 2s - loss: 0.1888
Epoch 7/80
 - 2s - loss: 0.1722
Epoch 8/80
 - 2s - loss: 0.1591
Epoch 9/80
 - 2s - loss: 0.1483
Epoch 10/80
 - 2s - loss: 0.1391
Epoch 11/80
 - 2s - loss: 0.1314
Epoch 12/80
 - 2s - loss: 0.1249
Epoch 13/80
 - 2s - loss: 0.1197
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:10:40.709548: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:10:40.878108: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:10:40.878163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:10:41.185597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:10:41.185653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:10:41.185662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:10:41.185958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2337
Epoch 2/80
 - 2s - loss: 0.3116
Epoch 3/80
 - 2s - loss: 0.2567
Epoch 4/80
 - 2s - loss: 0.2216
Epoch 5/80
 - 2s - loss: 0.1983
Epoch 6/80
 - 2s - loss: 0.1807
Epoch 7/80
 - 2s - loss: 0.1663
Epoch 8/80
 - 2s - loss: 0.1544
Epoch 9/80
 - 2s - loss: 0.1444
Epoch 10/80
 - 2s - loss: 0.1362
Epoch 11/80
 - 2s - loss: 0.1294
Epoch 12/80
 - 2s - loss: 0.1239
Epoch 13/80
 - 2s - loss: 0.1190
Epoch 14/80
 - 2s - loss: 0.1149
Epoch 15/80
 - 2s - loss: 0.1113
Epoch 16/80
 - 2s - loss: 0.1081
Epoch 17/80
 - 2s - loss: 0.1053
Epoch 18/80
 - 2s - loss: 0.1030
Epoch 19/80
 - 2s - loss: 0.1008
Epoch 20/80
 - 2s - loss: 0.0990
Epoch 21/80
 - 2s - loss: 0.0975
Epoch 22/80
 - 2s - loss: 0.0961
Epoch 23/80
 - 2s - loss: 0.0950
Epoch 24/80
 - 2s - loss: 0.0939
Epoch 25/80
 - 2s - loss: 0.0930
Epoch 26/80
 - 2s - loss: 0.0923
Epoch 27/80
 - 2s - loss: 0.0916
Epoch 28/80
 - 2s - loss: 0.0910
Epoch 29/80
 - 2s - loss: 0.0905
Epoch 30/80
 - 2s - loss: 0.0901
Epoch 31/80
 - 2s - loss: 0.0897
Epoch 32/80
 - 2s - loss: 0.0893
Epoch 33/80
 - 2s - loss: 0.0890
Epoch 34/80
 - 2s - loss: 0.0887
Epoch 35/80
 - 2s - loss: 0.0884
Epoch 36/80
 - 2s - loss: 0.0882
Epoch 37/80
 - 2s - loss: 0.0880
Epoch 38/80
 - 2s - loss: 0.0878
Epoch 39/80
 - 2s - loss: 0.0876
Epoch 40/80
 - 2s - loss: 0.0874
Epoch 41/80
 - 2s - loss: 0.0872
Epoch 42/80
 - 2s - loss: 0.0871
Epoch 43/80
 - 2s - loss: 0.0870
Epoch 44/80
 - 2s - loss: 0.0868
Epoch 45/80
 - 2s - loss: 0.0867
Epoch 46/80
 - 2s - loss: 0.0865
Epoch 47/80
 - 2s - loss: 0.0865
Epoch 48/80
 - 2s - loss: 0.0864
Epoch 49/80
 - 2s - loss: 0.0863
Epoch 50/80
 - 2s - loss: 0.0862
Epoch 51/80
 - 2s - loss: 0.0861
Epoch 52/80
 - 2s - loss: 0.0860
Epoch 53/80
 - 2s - loss: 0.0859
Epoch 54/80
 - 2s - loss: 0.0858
Epoch 55/80
 - 2s - loss: 0.0858
Epoch 56/80
 - 2s - loss: 0.0857
Epoch 57/80
 - 2s - loss: 0.0856
Epoch 58/80
 - 2s - loss: 0.0856
Epoch 59/80
 - 2s - loss: 0.0855
Epoch 60/80
 - 2s - loss: 0.0855
Epoch 61/80
 - 2s - loss: 0.0854
Epoch 62/80
 - 2s - loss: 0.0854
Epoch 63/80
 - 2s - loss: 0.0853
Epoch 64/80
 - 2s - loss: 0.0853
Epoch 65/80
 - 2s - loss: 0.0853
Epoch 66/80
 - 2s - loss: 0.0852
Epoch 67/80
 - 2s - loss: 0.0851
Epoch 68/80
 - 2s - loss: 0.0851
Epoch 69/80
 - 2s - loss: 0.0851
Epoch 70/80
 - 2s - loss: 0.0850
Epoch 71/80
 - 2s - loss: 0.0850
Epoch 72/80
 - 2s - loss: 0.0817
Epoch 73/80
 - 2s - loss: 0.0814
Epoch 74/80
 - 2s - loss: 0.0813
Epoch 75/80
 - 2s - loss: 0.0813
Epoch 76/80
 - 2s - loss: 0.0813
Epoch 77/80
 - 2s - loss: 0.0805
Epoch 78/80
 - 2s - loss: 0.0805
Epoch 79/80
 - 2s - loss: 0.0805
Epoch 80/80
 - 2s - loss: 0.0805
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.4738 - val_loss: 1.3245
AUC: 0.8073

Epoch 2/80
 - 0s - loss: 2.2322 - val_loss: 0.7594
AUC: 0.8373

Epoch 3/80
 - 0s - loss: 1.5552 - val_loss: 0.6691
AUC: 0.8524

Epoch 4/80
 - 0s - loss: 1.2435 - val_loss: 0.6895
AUC: 0.8544

Epoch 5/80
 - 0s - loss: 1.1331 - val_loss: 0.7031
AUC: 0.8578

Epoch 6/80
 - 0s - loss: 1.0990 - val_loss: 0.6523
AUC: 0.8593

Epoch 7/80
 - 0s - loss: 1.0818 - val_loss: 0.6843
AUC: 0.8611

Epoch 8/80
 - 0s - loss: 1.0579 - val_loss: 0.6051
AUC: 0.8618

Epoch 9/80
 - 0s - loss: 1.0480 - val_loss: 0.6425
AUC: 0.8636

Epoch 10/80
 - 0s - loss: 1.0409 - val_loss: 0.6412
AUC: 0.8637

Epoch 11/80
 - 0s - loss: 1.0247 - val_loss: 0.6098
AUC: 0.8647

Epoch 12/80
 - 0s - loss: 1.0262 - val_loss: 0.7092
AUC: 0.8659

Epoch 13/80
 - 0s - loss: 1.0170 - val_loss: 0.6438
AUC: 0.8649

Epoch 14/80
 - 0s - loss: 1.0072 - val_loss: 0.5903
AUC: 0.8672

Epoch 15/80
 - 0s - loss: 1.0041 - val_loss: 0.6389
AUC: 0.8682

Epoch 16/80
 - 0s - loss: 0.9914 - val_loss: 0.6224
AUC: 0.8676

Epoch 17/80
 - 0s - loss: 0.9960 - val_loss: 0.6200
AUC: 0.8686

Epoch 18/80
 - 0s - loss: 0.9885 - val_loss: 0.6099
AUC: 0.8694

Epoch 19/80
 - 0s - loss: 0.9790 - val_loss: 0.5962
AUC: 0.8688

Epoch 20/80
 - 0s - loss: 0.9750 - val_loss: 0.5870
AUC: 0.8696

Epoch 21/80
 - 0s - loss: 0.9744 - val_loss: 0.5918
AUC: 0.8699

Epoch 22/80
 - 0s - loss: 0.9752 - val_loss: 0.6161
AUC: 0.8714

Epoch 23/80
 - 0s - loss: 0.9667 - val_loss: 0.6277
AUC: 0.8711

Epoch 24/80
 - 0s - loss: 0.9604 - val_loss: 0.5631
AUC: 0.8707

Epoch 25/80
 - 0s - loss: 0.9623 - val_loss: 0.5898
AUC: 0.8708

Epoch 26/80
 - 0s - loss: 0.9620 - val_loss: 0.5967
AUC: 0.8697

Epoch 27/80
 - 0s - loss: 0.9590 - val_loss: 0.5723
AUC: 0.8715

Epoch 28/80
 - 0s - loss: 0.9506 - val_loss: 0.5802
AUC: 0.8708

Epoch 29/80
 - 0s - loss: 0.9475 - val_loss: 0.5845
AUC: 0.8720

Epoch 30/80
 - 0s - loss: 0.9448 - val_loss: 0.6393
AUC: 0.8707

Epoch 31/80
 - 0s - loss: 0.9496 - val_loss: 0.5986
AUC: 0.8705

Epoch 32/80
 - 0s - loss: 0.9420 - val_loss: 0.6525
AUC: 0.8717

Epoch 33/80
 - 0s - loss: 0.9374 - val_loss: 0.5330
AUC: 0.8714

Epoch 34/80
 - 0s - loss: 0.9421 - val_loss: 0.6141
AUC: 0.8729

Epoch 35/80
 - 0s - loss: 0.9268 - val_loss: 0.5411
AUC: 0.8695

Epoch 36/80
 - 0s - loss: 0.9210 - val_loss: 0.5873
AUC: 0.8717

Epoch 37/80
 - 0s - loss: 0.9224 - val_loss: 0.6856
AUC: 0.8718

Epoch 38/80
 - 0s - loss: 0.9187 - val_loss: 0.6124
AUC: 0.8724

Epoch 39/80
 - 0s - loss: 0.9160 - val_loss: 0.6278
AUC: 0.8712

Epoch 40/80
 - 0s - loss: 0.9163 - val_loss: 0.5907
AUC: 0.8705

Epoch 41/80
 - 0s - loss: 0.9148 - val_loss: 0.6027
AUC: 0.8719

Epoch 42/80
 - 0s - loss: 0.9021 - val_loss: 0.5749
AUC: 0.8714

Epoch 43/80
 - 0s - loss: 0.9026 - val_loss: 0.5935
AUC: 0.8719

Epoch 44/80
 - 0s - loss: 0.8922 - val_loss: 0.5646
AUC: 0.8727

Epoch 45/80
 - 0s - loss: 0.8874 - val_loss: 0.5618
AUC: 0.8723

Epoch 46/80
 - 0s - loss: 0.8813 - val_loss: 0.5694
AUC: 0.8724

Epoch 47/80
 - 0s - loss: 0.8866 - val_loss: 0.5964
AUC: 0.8722

Epoch 48/80
 - 0s - loss: 0.8843 - val_loss: 0.5661
AUC: 0.8723

Epoch 49/80
 - 0s - loss: 0.8781 - val_loss: 0.6160
AUC: 0.8725

Epoch 50/80
 - 0s - loss: 0.8844 - val_loss: 0.5950
AUC: 0.8723

Epoch 51/80
 - 0s - loss: 0.8796 - val_loss: 0.5554
AUC: 0.8725

Epoch 52/80
 - 0s - loss: 0.8806 - val_loss: 0.5622
AUC: 0.8728

Epoch 53/80
 - 0s - loss: 0.8799 - val_loss: 0.5735
AUC: 0.8723

Epoch 54/80
 - 0s - loss: 0.8714 - val_loss: 0.5729
AUC: 0.8723

Epoch 55/80
 - 0s - loss: 0.8748 - val_loss: 0.5668
AUC: 0.8723

Epoch 56/80
 - 0s - loss: 0.8743 - val_loss: 0.5715
AUC: 0.8724

Epoch 57/80
 - 0s - loss: 0.8718 - val_loss: 0.5770
AUC: 0.8724

Epoch 58/80
 - 0s - loss: 0.8761 - val_loss: 0.5718
AUC: 0.8724

Epoch 59/80
 - 0s - loss: 0.8760 - val_loss: 0.5581
AUC: 0.8724

Epoch 60/80
 - 0s - loss: 0.8732 - val_loss: 0.5679
AUC: 0.8724

Epoch 61/80
 - 0s - loss: 0.8725 - val_loss: 0.5624
AUC: 0.8724

Epoch 62/80
 - 0s - loss: 0.8732 - val_loss: 0.5618
AUC: 0.8723

Epoch 63/80
 - 0s - loss: 0.8713 - val_loss: 0.5737
AUC: 0.8724

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9186 - val_loss: 0.5985
AUC: 0.8727

Epoch 2/30
 - 0s - loss: 0.9148 - val_loss: 0.5862
AUC: 0.8724

Epoch 3/30
 - 0s - loss: 0.9101 - val_loss: 0.5664
AUC: 0.8725

Epoch 4/30
 - 0s - loss: 0.9040 - val_loss: 0.5719
AUC: 0.8726

Epoch 5/30
 - 0s - loss: 0.9064 - val_loss: 0.6116
AUC: 0.8727

Epoch 6/30
 - 0s - loss: 0.9009 - val_loss: 0.5881
AUC: 0.8727

Epoch 7/30
 - 0s - loss: 0.8988 - val_loss: 0.5699
AUC: 0.8726

Epoch 8/30
 - 0s - loss: 0.8978 - val_loss: 0.5627
AUC: 0.8727

Epoch 9/30
 - 0s - loss: 0.8965 - val_loss: 0.5912
AUC: 0.8727

Epoch 10/30
 - 0s - loss: 0.8941 - val_loss: 0.5827
AUC: 0.8729

Epoch 11/30
 - 0s - loss: 0.8973 - val_loss: 0.5505
AUC: 0.8727

Epoch 12/30
 - 0s - loss: 0.8931 - val_loss: 0.5584
AUC: 0.8726

Epoch 13/30
 - 0s - loss: 0.8893 - val_loss: 0.5446
AUC: 0.8728

Epoch 14/30
 - 0s - loss: 0.8860 - val_loss: 0.5659
AUC: 0.8728

Epoch 15/30
 - 0s - loss: 0.8881 - val_loss: 0.5522
AUC: 0.8727

Epoch 16/30
 - 0s - loss: 0.8818 - val_loss: 0.5785
AUC: 0.8730

Epoch 17/30
 - 0s - loss: 0.8842 - val_loss: 0.5808
AUC: 0.8731

Epoch 18/30
 - 0s - loss: 0.8846 - val_loss: 0.5609
AUC: 0.8729

Epoch 19/30
 - 0s - loss: 0.8800 - val_loss: 0.5655
AUC: 0.8731

Epoch 20/30
 - 0s - loss: 0.8795 - val_loss: 0.5631
AUC: 0.8730

Epoch 21/30
 - 0s - loss: 0.8775 - val_loss: 0.5769
AUC: 0.8730

Epoch 22/30
 - 0s - loss: 0.8751 - val_loss: 0.5452
AUC: 0.8727

Epoch 23/30
 - 0s - loss: 0.8753 - val_loss: 0.5596
AUC: 0.8731

Epoch 24/30
 - 0s - loss: 0.8690 - val_loss: 0.5684
AUC: 0.8732

Epoch 25/30
 - 0s - loss: 0.8709 - val_loss: 0.5622
AUC: 0.8731

Epoch 26/30
 - 0s - loss: 0.8689 - val_loss: 0.5679
AUC: 0.8732

Epoch 27/30
 - 0s - loss: 0.8704 - val_loss: 0.5656
AUC: 0.8732

Epoch 28/30
 - 0s - loss: 0.8716 - val_loss: 0.5640
AUC: 0.8731

Epoch 29/30
 - 0s - loss: 0.8653 - val_loss: 0.5593
AUC: 0.8731

Epoch 30/30
 - 0s - loss: 0.8662 - val_loss: 0.5701
Using TensorFlow backend.
AUC: 0.8731

2019-03-08 11:14:43.413274: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:14:43.589357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:14:43.589405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:14:43.945932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:14:43.945979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:14:43.945989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:14:43.946299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1912
Epoch 2/80
 - 2s - loss: 0.3164
Epoch 3/80
 - 2s - loss: 0.2799
Epoch 4/80
 - 2s - loss: 0.2481
Epoch 5/80
 - 2s - loss: 0.2207
Epoch 6/80
 - 2s - loss: 0.1965
Epoch 7/80
 - 2s - loss: 0.1758
Epoch 8/80
 - 2s - loss: 0.1596
Epoch 9/80
 - 2s - loss: 0.1476
Epoch 10/80
 - 2s - loss: 0.1384
Epoch 11/80
 - 2s - loss: 0.1311
Epoch 12/80
 - 2s - loss: 0.1251
Epoch 13/80
 - 2s - loss: 0.1200
Epoch 14/80
 - 2s - loss: 0.1157
Epoch 15/80
 - 2s - loss: 0.1120
Epoch 16/80
 - 2s - loss: 0.1088
Epoch 17/80
 - 2s - loss: 0.1060
Epoch 18/80
 - 2s - loss: 0.1036
Epoch 19/80
 - 2s - loss: 0.1015
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:15:43.812822: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:15:43.983186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:15:43.983231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:15:44.291724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:15:44.291802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:15:44.291813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:15:44.292132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0097
Epoch 2/80
 - 2s - loss: 0.1819
Epoch 3/80
 - 2s - loss: 0.1550
Epoch 4/80
 - 2s - loss: 0.1327
Epoch 5/80
 - 2s - loss: 0.1156
Epoch 6/80
 - 2s - loss: 0.1029
Epoch 7/80
 - 2s - loss: 0.0922
Epoch 8/80
 - 2s - loss: 0.0833
Epoch 9/80
 - 2s - loss: 0.0760
Epoch 10/80
 - 2s - loss: 0.0700
Epoch 11/80
 - 2s - loss: 0.0652
Epoch 12/80
 - 2s - loss: 0.0612
Epoch 13/80
 - 2s - loss: 0.0578
Epoch 14/80
 - 2s - loss: 0.0551
Epoch 15/80
 - 2s - loss: 0.0527
Epoch 16/80
 - 2s - loss: 0.0506
Epoch 17/80
 - 2s - loss: 0.0488
Epoch 18/80
 - 2s - loss: 0.0473
Epoch 19/80
 - 2s - loss: 0.0459
Epoch 20/80
 - 2s - loss: 0.0448
Epoch 21/80
 - 2s - loss: 0.0438
Epoch 22/80
 - 2s - loss: 0.0429
Epoch 23/80
 - 2s - loss: 0.0422
Epoch 24/80
 - 2s - loss: 0.0415
Epoch 25/80
 - 2s - loss: 0.0409
Epoch 26/80
 - 2s - loss: 0.0404
Epoch 27/80
 - 2s - loss: 0.0400
Epoch 28/80
 - 2s - loss: 0.0396
Epoch 29/80
 - 2s - loss: 0.0392
Epoch 30/80
 - 2s - loss: 0.0389
Epoch 31/80
 - 2s - loss: 0.0387
Epoch 32/80
 - 2s - loss: 0.0384
Epoch 33/80
 - 2s - loss: 0.0382
Epoch 34/80
 - 2s - loss: 0.0380
Epoch 35/80
 - 2s - loss: 0.0379
Epoch 36/80
 - 2s - loss: 0.0377
Epoch 37/80
 - 2s - loss: 0.0376
Epoch 38/80
 - 2s - loss: 0.0375
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:17:20.786359: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:17:20.956431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:17:20.956509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:17:21.264544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:17:21.264594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:17:21.264604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:17:21.264907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9973
Epoch 2/80
 - 2s - loss: 0.1807
Epoch 3/80
 - 2s - loss: 0.1520
Epoch 4/80
 - 2s - loss: 0.1319
Epoch 5/80
 - 2s - loss: 0.1168
Epoch 6/80
 - 2s - loss: 0.1039
Epoch 7/80
 - 2s - loss: 0.0927
Epoch 8/80
 - 2s - loss: 0.0836
Epoch 9/80
 - 2s - loss: 0.0763
Epoch 10/80
 - 2s - loss: 0.0703
Epoch 11/80
 - 2s - loss: 0.0652
Epoch 12/80
 - 2s - loss: 0.0612
Epoch 13/80
 - 2s - loss: 0.0579
Epoch 14/80
 - 2s - loss: 0.0551
Epoch 15/80
 - 2s - loss: 0.0528
Epoch 16/80
 - 2s - loss: 0.0508
Epoch 17/80
 - 2s - loss: 0.0490
Epoch 18/80
 - 2s - loss: 0.0474
Epoch 19/80
 - 2s - loss: 0.0461
Epoch 20/80
 - 2s - loss: 0.0449
Epoch 21/80
 - 2s - loss: 0.0439
Epoch 22/80
 - 2s - loss: 0.0430
Epoch 23/80
 - 2s - loss: 0.0422
Epoch 24/80
 - 2s - loss: 0.0415
Epoch 25/80
 - 2s - loss: 0.0409
Epoch 26/80
 - 2s - loss: 0.0404
Epoch 27/80
 - 2s - loss: 0.0399
Epoch 28/80
 - 2s - loss: 0.0395
Epoch 29/80
 - 2s - loss: 0.0392
Epoch 30/80
 - 2s - loss: 0.0389
Epoch 31/80
 - 2s - loss: 0.0387
Epoch 32/80
 - 2s - loss: 0.0384
Epoch 33/80
 - 2s - loss: 0.0382
Epoch 34/80
 - 2s - loss: 0.0380
Epoch 35/80
 - 2s - loss: 0.0379
Epoch 36/80
 - 2s - loss: 0.0377
Epoch 37/80
 - 2s - loss: 0.0376
Epoch 38/80
 - 2s - loss: 0.0375
Epoch 39/80
 - 2s - loss: 0.0374
Epoch 40/80
 - 2s - loss: 0.0373
Epoch 41/80
 - 2s - loss: 0.0372
Epoch 42/80
 - 2s - loss: 0.0371
Epoch 43/80
 - 2s - loss: 0.0370
Epoch 44/80
 - 2s - loss: 0.0369
Epoch 45/80
 - 2s - loss: 0.0369
Epoch 46/80
 - 2s - loss: 0.0368
Epoch 47/80
 - 2s - loss: 0.0367
Epoch 48/80
 - 2s - loss: 0.0367
Epoch 49/80
 - 2s - loss: 0.0366
Epoch 50/80
 - 2s - loss: 0.0366
Epoch 51/80
 - 2s - loss: 0.0365
Epoch 52/80
 - 2s - loss: 0.0365
Epoch 53/80
 - 2s - loss: 0.0365
Epoch 54/80
 - 2s - loss: 0.0364
Epoch 55/80
 - 2s - loss: 0.0364
Epoch 56/80
 - 2s - loss: 0.0364
Epoch 57/80
 - 2s - loss: 0.0363
Epoch 58/80
 - 2s - loss: 0.0363
Epoch 59/80
 - 2s - loss: 0.0363
Epoch 60/80
 - 2s - loss: 0.0362
Epoch 61/80
 - 2s - loss: 0.0347
Epoch 62/80
 - 2s - loss: 0.0346
Epoch 63/80
 - 2s - loss: 0.0346
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:19:47.952390: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:19:48.122440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:19:48.122486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:19:48.429286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:19:48.429356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:19:48.429366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:19:48.429644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9975
Epoch 2/80
 - 2s - loss: 0.1830
Epoch 3/80
 - 2s - loss: 0.1557
Epoch 4/80
 - 2s - loss: 0.1327
Epoch 5/80
 - 2s - loss: 0.1160
Epoch 6/80
 - 2s - loss: 0.1032
Epoch 7/80
 - 2s - loss: 0.0927
Epoch 8/80
 - 2s - loss: 0.0841
Epoch 9/80
 - 2s - loss: 0.0769
Epoch 10/80
 - 2s - loss: 0.0707
Epoch 11/80
 - 2s - loss: 0.0657
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:20:28.833852: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:20:29.002963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:20:29.003012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:20:29.312197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:20:29.312256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:20:29.312266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:20:29.312641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.2 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0013
Epoch 2/80
 - 2s - loss: 0.1809
Epoch 3/80
 - 2s - loss: 0.1556
Epoch 4/80
 - 2s - loss: 0.1328
Epoch 5/80
 - 2s - loss: 0.1160
Epoch 6/80
 - 2s - loss: 0.1044
Epoch 7/80
 - 2s - loss: 0.0946
Epoch 8/80
 - 2s - loss: 0.0859
Epoch 9/80
 - 2s - loss: 0.0784
Epoch 10/80
 - 2s - loss: 0.0719
Epoch 11/80
 - 2s - loss: 0.0664
Epoch 12/80
 - 2s - loss: 0.0620
Epoch 13/80
 - 2s - loss: 0.0584
Epoch 14/80
 - 2s - loss: 0.0554
Epoch 15/80
 - 2s - loss: 0.0530
Epoch 16/80
 - 2s - loss: 0.0508
Epoch 17/80
 - 2s - loss: 0.0490
Epoch 18/80
 - 2s - loss: 0.0474
Epoch 19/80
 - 2s - loss: 0.0461
Epoch 20/80
 - 2s - loss: 0.0450
Epoch 21/80
 - 2s - loss: 0.0440
Epoch 22/80
 - 2s - loss: 0.0431
Epoch 23/80
 - 2s - loss: 0.0423
Epoch 24/80
 - 2s - loss: 0.0416
Epoch 25/80
 - 2s - loss: 0.0411
Epoch 26/80
 - 2s - loss: 0.0406
Epoch 27/80
 - 2s - loss: 0.0401
Epoch 28/80
 - 2s - loss: 0.0397
Epoch 29/80
 - 2s - loss: 0.0394
Epoch 30/80
 - 2s - loss: 0.0391
Epoch 31/80
 - 2s - loss: 0.0388
Epoch 32/80
 - 2s - loss: 0.0386
Epoch 33/80
 - 2s - loss: 0.0384
Epoch 34/80
 - 2s - loss: 0.0382
Epoch 35/80
 - 2s - loss: 0.0381
Epoch 36/80
 - 2s - loss: 0.0379
Epoch 37/80
 - 2s - loss: 0.0378
Epoch 38/80
 - 2s - loss: 0.0376
Epoch 39/80
 - 2s - loss: 0.0376
Epoch 40/80
 - 2s - loss: 0.0374
Epoch 41/80
 - 2s - loss: 0.0373
Epoch 42/80
 - 2s - loss: 0.0373
Epoch 43/80
 - 2s - loss: 0.0372
Epoch 44/80
 - 2s - loss: 0.0371
Epoch 45/80
 - 2s - loss: 0.0370
Epoch 46/80
 - 2s - loss: 0.0370
Epoch 47/80
 - 2s - loss: 0.0369
Epoch 48/80
 - 2s - loss: 0.0368
Epoch 49/80
 - 2s - loss: 0.0368
Epoch 50/80
 - 2s - loss: 0.0367
Epoch 51/80
 - 2s - loss: 0.0367
Epoch 52/80
 - 2s - loss: 0.0366
Epoch 53/80
 - 2s - loss: 0.0366
Epoch 54/80
 - 2s - loss: 0.0366
Epoch 55/80
 - 2s - loss: 0.0365
Epoch 56/80
 - 2s - loss: 0.0365
Epoch 57/80
 - 2s - loss: 0.0364
Epoch 58/80
 - 2s - loss: 0.0364
Epoch 59/80
 - 2s - loss: 0.0364
Epoch 60/80
 - 2s - loss: 0.0364
Epoch 61/80
 - 2s - loss: 0.0363
Epoch 62/80
 - 2s - loss: 0.0348
Epoch 63/80
 - 2s - loss: 0.0347
Epoch 64/80
 - 2s - loss: 0.0346
Epoch 65/80
 - 2s - loss: 0.0346
Epoch 66/80
 - 2s - loss: 0.0346
Epoch 67/80
 - 2s - loss: 0.0343
Epoch 68/80
 - 2s - loss: 0.0343
Epoch 69/80
 - 2s - loss: 0.0343
Epoch 70/80
 - 2s - loss: 0.0343
Epoch 71/80
 - 2s - loss: 0.0342
Epoch 72/80
 - 2s - loss: 0.0342
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:23:13.225572: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:23:13.393027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:23:13.393073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:23:13.699894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:23:13.699949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:23:13.699958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:23:13.700223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6198
Epoch 2/80
 - 2s - loss: 0.0831
Epoch 3/80
 - 2s - loss: 0.0590
Epoch 4/80
 - 2s - loss: 0.0506
Epoch 5/80
 - 2s - loss: 0.0449
Epoch 6/80
 - 2s - loss: 0.0403
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:23:44.006236: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:23:44.177208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:23:44.177264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:23:44.484511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:23:44.484566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:23:44.484575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:23:44.484848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.5967
Epoch 2/80
 - 2s - loss: 0.0829
Epoch 3/80
 - 2s - loss: 0.0641
Epoch 4/80
 - 2s - loss: 0.0573
Epoch 5/80
 - 2s - loss: 0.0516
Epoch 6/80
 - 2s - loss: 0.0464
Epoch 7/80
 - 2s - loss: 0.0415
Epoch 8/80
 - 2s - loss: 0.0369
Epoch 9/80
 - 2s - loss: 0.0329
Epoch 10/80
 - 2s - loss: 0.0296
Epoch 11/80
 - 2s - loss: 0.0268
Epoch 12/80
 - 2s - loss: 0.0246
Epoch 13/80
 - 2s - loss: 0.0227
Epoch 14/80
 - 2s - loss: 0.0212
Epoch 15/80
 - 2s - loss: 0.0199
Epoch 16/80
 - 2s - loss: 0.0188
Epoch 17/80
 - 2s - loss: 0.0179
Epoch 18/80
 - 2s - loss: 0.0171
Epoch 19/80
 - 2s - loss: 0.0165
Epoch 20/80
 - 2s - loss: 0.0159
Epoch 21/80
 - 2s - loss: 0.0154
Epoch 22/80
 - 2s - loss: 0.0150
Epoch 23/80
 - 2s - loss: 0.0146
Epoch 24/80
 - 2s - loss: 0.0143
Epoch 25/80
 - 2s - loss: 0.0140
Epoch 26/80
 - 2s - loss: 0.0137
Epoch 27/80
 - 2s - loss: 0.0135
Epoch 28/80
 - 2s - loss: 0.0133
Epoch 29/80
 - 2s - loss: 0.0132
Epoch 30/80
 - 2s - loss: 0.0130
Epoch 31/80
 - 2s - loss: 0.0129
Epoch 32/80
 - 2s - loss: 0.0128
Epoch 33/80
 - 2s - loss: 0.0127
Epoch 34/80
 - 2s - loss: 0.0126
Epoch 35/80
 - 2s - loss: 0.0125
Epoch 36/80
 - 2s - loss: 0.0124
Epoch 37/80
 - 2s - loss: 0.0123
Epoch 38/80
 - 2s - loss: 0.0123
Epoch 39/80
 - 2s - loss: 0.0122
Epoch 40/80
 - 2s - loss: 0.0122
Epoch 41/80
 - 2s - loss: 0.0121
Epoch 42/80
 - 2s - loss: 0.0121
Epoch 43/80
 - 2s - loss: 0.0121
Epoch 44/80
 - 2s - loss: 0.0120
Epoch 45/80
 - 2s - loss: 0.0120
Epoch 46/80
 - 2s - loss: 0.0120
Epoch 47/80
 - 2s - loss: 0.0119
Epoch 48/80
 - 2s - loss: 0.0119
Epoch 49/80
 - 2s - loss: 0.0114
Epoch 50/80
 - 2s - loss: 0.0113
Epoch 51/80
 - 2s - loss: 0.0113
Epoch 52/80
 - 2s - loss: 0.0113
Epoch 53/80
 - 2s - loss: 0.0112
Epoch 54/80
 - 2s - loss: 0.0112
Epoch 55/80
 - 2s - loss: 0.0112
Epoch 56/80
 - 2s - loss: 0.0112
Epoch 57/80
 - 2s - loss: 0.0112
Epoch 58/80
 - 2s - loss: 0.0112
Epoch 59/80
 - 2s - loss: 0.0112
Epoch 60/80
 - 2s - loss: 0.0112
Epoch 61/80
 - 2s - loss: 0.0112
Epoch 62/80
 - 2s - loss: 0.0112
Epoch 63/80
 - 2s - loss: 0.0111
Epoch 64/80
 - 2s - loss: 0.0111
Epoch 65/80
 - 2s - loss: 0.0111
Epoch 66/80
 - 2s - loss: 0.0111
Epoch 67/80
 - 2s - loss: 0.0111
Epoch 68/80
 - 2s - loss: 0.0111
Epoch 69/80
 - 2s - loss: 0.0111
Epoch 70/80
 - 2s - loss: 0.0111
Epoch 71/80
 - 2s - loss: 0.0111
Epoch 72/80
 - 2s - loss: 0.0111
Epoch 73/80
 - 2s - loss: 0.0111
Epoch 74/80
 - 2s - loss: 0.0111
Epoch 75/80
 - 2s - loss: 0.0111
Epoch 76/80
 - 2s - loss: 0.0111
Epoch 77/80
 - 2s - loss: 0.0111
Epoch 78/80
 - 2s - loss: 0.0111
Epoch 79/80
 - 2s - loss: 0.0111
Epoch 80/80
 - 2s - loss: 0.0111
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.8796 - val_loss: 1.1014
AUC: 0.8251

Epoch 2/80
 - 0s - loss: 2.0885 - val_loss: 0.8840
AUC: 0.8531

Epoch 3/80
 - 0s - loss: 1.4527 - val_loss: 0.7637
AUC: 0.8586

Epoch 4/80
 - 0s - loss: 1.2411 - val_loss: 0.7822
AUC: 0.8628

Epoch 5/80
 - 0s - loss: 1.1432 - val_loss: 0.6854
AUC: 0.8645

Epoch 6/80
 - 0s - loss: 1.1069 - val_loss: 0.5882
AUC: 0.8637

Epoch 7/80
 - 0s - loss: 1.0856 - val_loss: 0.6128
AUC: 0.8670

Epoch 8/80
 - 0s - loss: 1.0683 - val_loss: 0.6781
AUC: 0.8681

Epoch 9/80
 - 0s - loss: 1.0581 - val_loss: 0.6185
AUC: 0.8688

Epoch 10/80
 - 0s - loss: 1.0412 - val_loss: 0.6465
AUC: 0.8707

Epoch 11/80
 - 0s - loss: 1.0429 - val_loss: 0.5999
AUC: 0.8712

Epoch 12/80
 - 0s - loss: 1.0296 - val_loss: 0.5939
AUC: 0.8706

Epoch 13/80
 - 0s - loss: 1.0301 - val_loss: 0.6708
AUC: 0.8731

Epoch 14/80
 - 0s - loss: 1.0188 - val_loss: 0.6124
AUC: 0.8739

Epoch 15/80
 - 0s - loss: 1.0148 - val_loss: 0.6769
AUC: 0.8737

Epoch 16/80
 - 0s - loss: 1.0141 - val_loss: 0.5704
AUC: 0.8730

Epoch 17/80
 - 0s - loss: 1.0044 - val_loss: 0.6592
AUC: 0.8735

Epoch 18/80
 - 0s - loss: 1.0002 - val_loss: 0.6601
AUC: 0.8751

Epoch 19/80
 - 0s - loss: 0.9865 - val_loss: 0.5802
AUC: 0.8749

Epoch 20/80
 - 0s - loss: 0.9930 - val_loss: 0.5977
AUC: 0.8757

Epoch 21/80
 - 0s - loss: 0.9876 - val_loss: 0.5526
AUC: 0.8747

Epoch 22/80
 - 0s - loss: 0.9817 - val_loss: 0.6942
AUC: 0.8768

Epoch 23/80
 - 0s - loss: 0.9886 - val_loss: 0.6362
AUC: 0.8754

Epoch 24/80
 - 0s - loss: 0.9804 - val_loss: 0.5661
AUC: 0.8758

Epoch 25/80
 - 0s - loss: 0.9769 - val_loss: 0.6510
AUC: 0.8769

Epoch 26/80
 - 0s - loss: 0.9703 - val_loss: 0.5786
AUC: 0.8768

Epoch 27/80
 - 0s - loss: 0.9689 - val_loss: 0.6541
AUC: 0.8772

Epoch 28/80
 - 0s - loss: 0.9602 - val_loss: 0.5899
AUC: 0.8767

Epoch 29/80
 - 0s - loss: 0.9662 - val_loss: 0.6604
AUC: 0.8770

Epoch 30/80
 - 0s - loss: 0.9599 - val_loss: 0.6092
AUC: 0.8779

Epoch 31/80
 - 0s - loss: 0.9583 - val_loss: 0.4963
AUC: 0.8751

Epoch 32/80
 - 0s - loss: 0.9500 - val_loss: 0.5594
AUC: 0.8773

Epoch 33/80
 - 0s - loss: 0.9555 - val_loss: 0.5731
AUC: 0.8774

Epoch 34/80
 - 0s - loss: 0.9453 - val_loss: 0.5283
AUC: 0.8770

Epoch 35/80
 - 0s - loss: 0.9472 - val_loss: 0.5977
AUC: 0.8771

Epoch 36/80
 - 0s - loss: 0.9440 - val_loss: 0.5529
AUC: 0.8771

Epoch 37/80
 - 0s - loss: 0.9397 - val_loss: 0.5709
AUC: 0.8782

Epoch 38/80
 - 0s - loss: 0.9346 - val_loss: 0.5964
AUC: 0.8786

Epoch 39/80
 - 0s - loss: 0.9337 - val_loss: 0.5654
AUC: 0.8776

Epoch 40/80
 - 0s - loss: 0.9264 - val_loss: 0.5536
AUC: 0.8776

Epoch 41/80
 - 0s - loss: 0.9277 - val_loss: 0.5222
AUC: 0.8773

Epoch 42/80
 - 0s - loss: 0.9127 - val_loss: 0.5469
AUC: 0.8785

Epoch 43/80
 - 0s - loss: 0.9072 - val_loss: 0.5481
AUC: 0.8781

Epoch 44/80
 - 0s - loss: 0.9078 - val_loss: 0.5793
AUC: 0.8787

Epoch 45/80
 - 0s - loss: 0.9081 - val_loss: 0.5645
AUC: 0.8787

Epoch 46/80
 - 0s - loss: 0.9054 - val_loss: 0.5567
AUC: 0.8782

Epoch 47/80
 - 0s - loss: 0.9077 - val_loss: 0.5496
AUC: 0.8785

Epoch 48/80
 - 0s - loss: 0.8974 - val_loss: 0.5675
AUC: 0.8784

Epoch 49/80
 - 0s - loss: 0.8993 - val_loss: 0.5718
AUC: 0.8787

Epoch 50/80
 - 0s - loss: 0.8994 - val_loss: 0.5764
AUC: 0.8789

Epoch 51/80
 - 0s - loss: 0.8984 - val_loss: 0.5472
AUC: 0.8779

Epoch 52/80
 - 0s - loss: 0.8985 - val_loss: 0.5721
AUC: 0.8783

Epoch 53/80
 - 0s - loss: 0.8998 - val_loss: 0.5708
AUC: 0.8783

Epoch 54/80
 - 0s - loss: 0.8940 - val_loss: 0.5556
AUC: 0.8783

Epoch 55/80
 - 0s - loss: 0.8954 - val_loss: 0.5704
AUC: 0.8786

Epoch 56/80
 - 0s - loss: 0.8988 - val_loss: 0.5827
AUC: 0.8787

Epoch 57/80
 - 0s - loss: 0.8978 - val_loss: 0.5748
AUC: 0.8786

Epoch 58/80
 - 0s - loss: 0.8958 - val_loss: 0.5646
AUC: 0.8786

Epoch 59/80
 - 0s - loss: 0.8968 - val_loss: 0.5727
AUC: 0.8786

Epoch 60/80
 - 0s - loss: 0.8989 - val_loss: 0.5599
AUC: 0.8785

Epoch 61/80
 - 0s - loss: 0.8950 - val_loss: 0.5635
AUC: 0.8785

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9019 - val_loss: 0.5861
AUC: 0.8791

Epoch 2/30
 - 0s - loss: 0.8953 - val_loss: 0.5625
AUC: 0.8786

Epoch 3/30
 - 0s - loss: 0.8956 - val_loss: 0.5689
AUC: 0.8788

Epoch 4/30
 - 0s - loss: 0.8984 - val_loss: 0.5655
AUC: 0.8788

Epoch 5/30
 - 0s - loss: 0.8913 - val_loss: 0.5563
AUC: 0.8789

Epoch 6/30
 - 0s - loss: 0.8899 - val_loss: 0.5557
AUC: 0.8787

Epoch 7/30
 - 0s - loss: 0.8888 - val_loss: 0.5710
AUC: 0.8787

Epoch 8/30
 - 0s - loss: 0.8841 - val_loss: 0.5706
AUC: 0.8791

Epoch 9/30
 - 0s - loss: 0.8879 - val_loss: 0.5781
AUC: 0.8790

Epoch 10/30
 - 0s - loss: 0.8812 - val_loss: 0.5454
AUC: 0.8789

Epoch 11/30
 - 0s - loss: 0.8807 - val_loss: 0.5397
AUC: 0.8788

Epoch 12/30
 - 0s - loss: 0.8800 - val_loss: 0.5663
AUC: 0.8791

Epoch 13/30
 - 1s - loss: 0.8755 - val_loss: 0.5496
AUC: 0.8792

Epoch 14/30
 - 0s - loss: 0.8761 - val_loss: 0.5563
AUC: 0.8793

Epoch 15/30
 - 1s - loss: 0.8740 - val_loss: 0.5613
AUC: 0.8790

Epoch 16/30
 - 0s - loss: 0.8704 - val_loss: 0.5608
AUC: 0.8791

Epoch 17/30
 - 0s - loss: 0.8700 - val_loss: 0.5427
AUC: 0.8788

Epoch 18/30
 - 1s - loss: 0.8686 - val_loss: 0.5500
AUC: 0.8792

Epoch 19/30
 - 1s - loss: 0.8655 - val_loss: 0.5441
AUC: 0.8794

Epoch 20/30
 - 0s - loss: 0.8659 - val_loss: 0.5717
AUC: 0.8795

Epoch 21/30
 - 0s - loss: 0.8646 - val_loss: 0.5567
AUC: 0.8789

Epoch 22/30
 - 0s - loss: 0.8608 - val_loss: 0.5510
AUC: 0.8790

Epoch 23/30
 - 0s - loss: 0.8563 - val_loss: 0.5465
AUC: 0.8791

Epoch 24/30
 - 0s - loss: 0.8586 - val_loss: 0.5482
AUC: 0.8792

Epoch 25/30
 - 0s - loss: 0.8619 - val_loss: 0.5551
AUC: 0.8792

Epoch 26/30
 - 0s - loss: 0.8589 - val_loss: 0.5479
AUC: 0.8791

Epoch 27/30
 - 0s - loss: 0.8593 - val_loss: 0.5569
AUC: 0.8793

Epoch 28/30
 - 0s - loss: 0.8554 - val_loss: 0.5480
AUC: 0.8791

Epoch 29/30
 - 0s - loss: 0.8572 - val_loss: 0.5523
AUC: 0.8792

Epoch 30/30
 - 0s - loss: 0.8542 - val_loss: 0.5477
Using TensorFlow backend.
AUC: 0.8792

2019-03-08 11:27:46.484959: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:27:46.650924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:27:46.650971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:27:46.949019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:27:46.949073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:27:46.949083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:27:46.949347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6099
Epoch 2/80
 - 2s - loss: 0.0845
Epoch 3/80
 - 2s - loss: 0.0644
Epoch 4/80
 - 2s - loss: 0.0572
Epoch 5/80
 - 2s - loss: 0.0514
Epoch 6/80
 - 2s - loss: 0.0463
Epoch 7/80
 - 2s - loss: 0.0413
Epoch 8/80
 - 2s - loss: 0.0364
Epoch 9/80
 - 2s - loss: 0.0324
Epoch 10/80
 - 2s - loss: 0.0291
Epoch 11/80
 - 2s - loss: 0.0265
Epoch 12/80
 - 2s - loss: 0.0243
Epoch 13/80
 - 2s - loss: 0.0225
Epoch 14/80
 - 2s - loss: 0.0210
Epoch 15/80
 - 2s - loss: 0.0197
Epoch 16/80
 - 2s - loss: 0.0187
Epoch 17/80
 - 2s - loss: 0.0178
Epoch 18/80
 - 2s - loss: 0.0170
Epoch 19/80
 - 2s - loss: 0.0164
Epoch 20/80
 - 2s - loss: 0.0158
Epoch 21/80
 - 2s - loss: 0.0153
Epoch 22/80
 - 2s - loss: 0.0149
Epoch 23/80
 - 2s - loss: 0.0145
Epoch 24/80
 - 2s - loss: 0.0142
Epoch 25/80
 - 2s - loss: 0.0139
Epoch 26/80
 - 2s - loss: 0.0137
Epoch 27/80
 - 2s - loss: 0.0135
Epoch 28/80
 - 2s - loss: 0.0133
Epoch 29/80
 - 2s - loss: 0.0131
Epoch 30/80
 - 2s - loss: 0.0129
Epoch 31/80
 - 2s - loss: 0.0128
Epoch 32/80
 - 2s - loss: 0.0127
Epoch 33/80
 - 2s - loss: 0.0126
Epoch 34/80
 - 2s - loss: 0.0125
Epoch 35/80
 - 2s - loss: 0.0124
Epoch 36/80
 - 2s - loss: 0.0123
Epoch 37/80
 - 2s - loss: 0.0123
Epoch 38/80
 - 2s - loss: 0.0122
Epoch 39/80
 - 2s - loss: 0.0121
Epoch 40/80
 - 2s - loss: 0.0121
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:29:24.484922: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:29:24.652952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:29:24.652999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:29:24.952315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:29:24.952370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:29:24.952378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:29:24.952644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1972
Epoch 2/80
 - 2s - loss: 0.3168
Epoch 3/80
 - 2s - loss: 0.2778
Epoch 4/80
 - 2s - loss: 0.2386
Epoch 5/80
 - 2s - loss: 0.2091
Epoch 6/80
 - 2s - loss: 0.1877
Epoch 7/80
 - 2s - loss: 0.1716
Epoch 8/80
 - 2s - loss: 0.1585
Epoch 9/80
 - 2s - loss: 0.1474
Epoch 10/80
 - 2s - loss: 0.1381
Epoch 11/80
 - 2s - loss: 0.1307
Epoch 12/80
 - 2s - loss: 0.1247
Epoch 13/80
 - 2s - loss: 0.1196
Epoch 14/80
 - 2s - loss: 0.1154
Epoch 15/80
 - 2s - loss: 0.1116
Epoch 16/80
 - 2s - loss: 0.1083
Epoch 17/80
 - 2s - loss: 0.1054
Epoch 18/80
 - 2s - loss: 0.1029
Epoch 19/80
 - 2s - loss: 0.1007
Epoch 20/80
 - 2s - loss: 0.0988
Epoch 21/80
 - 2s - loss: 0.0972
Epoch 22/80
 - 2s - loss: 0.0958
Epoch 23/80
 - 2s - loss: 0.0946
Epoch 24/80
 - 2s - loss: 0.0936
Epoch 25/80
 - 2s - loss: 0.0928
Epoch 26/80
 - 2s - loss: 0.0920
Epoch 27/80
 - 2s - loss: 0.0914
Epoch 28/80
 - 2s - loss: 0.0908
Epoch 29/80
 - 2s - loss: 0.0903
Epoch 30/80
 - 2s - loss: 0.0898
Epoch 31/80
 - 2s - loss: 0.0895
Epoch 32/80
 - 2s - loss: 0.0891
Epoch 33/80
 - 2s - loss: 0.0888
Epoch 34/80
 - 2s - loss: 0.0885
Epoch 35/80
 - 2s - loss: 0.0882
Epoch 36/80
 - 2s - loss: 0.0880
Epoch 37/80
 - 2s - loss: 0.0878
Epoch 38/80
 - 2s - loss: 0.0876
Epoch 39/80
 - 2s - loss: 0.0874
Epoch 40/80
 - 2s - loss: 0.0872
Epoch 41/80
 - 2s - loss: 0.0870
Epoch 42/80
 - 2s - loss: 0.0869
Epoch 43/80
 - 2s - loss: 0.0868
Epoch 44/80
 - 2s - loss: 0.0867
Epoch 45/80
 - 2s - loss: 0.0866
Epoch 46/80
 - 2s - loss: 0.0865
Epoch 47/80
 - 2s - loss: 0.0863
Epoch 48/80
 - 2s - loss: 0.0862
Epoch 49/80
 - 2s - loss: 0.0862
Epoch 50/80
 - 2s - loss: 0.0861
Epoch 51/80
 - 2s - loss: 0.0860
Epoch 52/80
 - 2s - loss: 0.0859
Epoch 53/80
 - 2s - loss: 0.0859
Epoch 54/80
 - 2s - loss: 0.0858
Epoch 55/80
 - 2s - loss: 0.0857
Epoch 56/80
 - 2s - loss: 0.0856
Epoch 57/80
 - 2s - loss: 0.0856
Epoch 58/80
 - 2s - loss: 0.0855
Epoch 59/80
 - 2s - loss: 0.0855
Epoch 60/80
 - 2s - loss: 0.0854
Epoch 61/80
 - 2s - loss: 0.0853
Epoch 62/80
 - 2s - loss: 0.0853
Epoch 63/80
 - 2s - loss: 0.0853
Epoch 64/80
 - 2s - loss: 0.0852
Epoch 65/80
 - 2s - loss: 0.0852
Epoch 66/80
 - 2s - loss: 0.0852
Epoch 67/80
 - 2s - loss: 0.0851
Epoch 68/80
 - 2s - loss: 0.0851
Epoch 69/80
 - 2s - loss: 0.0850
Epoch 70/80
 - 2s - loss: 0.0850
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:32:05.041947: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:32:05.215460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:32:05.215506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:32:05.515549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:32:05.515596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:32:05.515606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:32:05.515872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1901
Epoch 2/80
 - 2s - loss: 0.3133
Epoch 3/80
 - 2s - loss: 0.2696
Epoch 4/80
 - 2s - loss: 0.2367
Epoch 5/80
 - 2s - loss: 0.2098
Epoch 6/80
 - 2s - loss: 0.1886
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:32:35.729034: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:32:35.897462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:32:35.897507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:32:36.197733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:32:36.197792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:32:36.197801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:32:36.198067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.2169
Epoch 2/80
 - 2s - loss: 0.3123
Epoch 3/80
 - 2s - loss: 0.2614
Epoch 4/80
 - 2s - loss: 0.2251
Epoch 5/80
 - 2s - loss: 0.2027
Epoch 6/80
 - 2s - loss: 0.1840
Epoch 7/80
 - 2s - loss: 0.1689
Epoch 8/80
 - 2s - loss: 0.1567
Epoch 9/80
 - 2s - loss: 0.1466
Epoch 10/80
 - 2s - loss: 0.1381
Epoch 11/80
 - 2s - loss: 0.1310
Epoch 12/80
 - 2s - loss: 0.1252
Epoch 13/80
 - 2s - loss: 0.1202
Epoch 14/80
 - 2s - loss: 0.1158
Epoch 15/80
 - 2s - loss: 0.1120
Epoch 16/80
 - 2s - loss: 0.1087
Epoch 17/80
 - 2s - loss: 0.1058
Epoch 18/80
 - 2s - loss: 0.1033
Epoch 19/80
 - 2s - loss: 0.1011
Epoch 20/80
 - 2s - loss: 0.0993
Epoch 21/80
 - 2s - loss: 0.0977
Epoch 22/80
 - 2s - loss: 0.0964
Epoch 23/80
 - 2s - loss: 0.0952
Epoch 24/80
 - 2s - loss: 0.0942
Epoch 25/80
 - 2s - loss: 0.0933
Epoch 26/80
 - 2s - loss: 0.0926
Epoch 27/80
 - 2s - loss: 0.0919
Epoch 28/80
 - 2s - loss: 0.0913
Epoch 29/80
 - 2s - loss: 0.0909
Epoch 30/80
 - 2s - loss: 0.0904
Epoch 31/80
 - 2s - loss: 0.0900
Epoch 32/80
 - 2s - loss: 0.0896
Epoch 33/80
 - 2s - loss: 0.0893
Epoch 34/80
 - 2s - loss: 0.0890
Epoch 35/80
 - 2s - loss: 0.0887
Epoch 36/80
 - 2s - loss: 0.0885
Epoch 37/80
 - 2s - loss: 0.0883
Epoch 38/80
 - 2s - loss: 0.0881
Epoch 39/80
 - 2s - loss: 0.0879
Epoch 40/80
 - 2s - loss: 0.0877
Epoch 41/80
 - 2s - loss: 0.0875
Epoch 42/80
 - 2s - loss: 0.0875
Epoch 43/80
 - 2s - loss: 0.0873
Epoch 44/80
 - 2s - loss: 0.0871
Epoch 45/80
 - 2s - loss: 0.0870
Epoch 46/80
 - 2s - loss: 0.0869
Epoch 47/80
 - 2s - loss: 0.0868
Epoch 48/80
 - 2s - loss: 0.0867
Epoch 49/80
 - 2s - loss: 0.0867
Epoch 50/80
 - 2s - loss: 0.0865
Epoch 51/80
 - 2s - loss: 0.0865
Epoch 52/80
 - 2s - loss: 0.0864
Epoch 53/80
 - 2s - loss: 0.0863
Epoch 54/80
 - 2s - loss: 0.0862
Epoch 55/80
 - 2s - loss: 0.0862
Epoch 56/80
 - 2s - loss: 0.0861
Epoch 57/80
 - 2s - loss: 0.0861
Epoch 58/80
 - 2s - loss: 0.0860
Epoch 59/80
 - 2s - loss: 0.0860
Epoch 60/80
 - 2s - loss: 0.0859
Epoch 61/80
 - 2s - loss: 0.0858
Epoch 62/80
 - 2s - loss: 0.0858
Epoch 63/80
 - 2s - loss: 0.0857
Epoch 64/80
 - 2s - loss: 0.0857
Epoch 65/80
 - 2s - loss: 0.0857
Epoch 66/80
 - 2s - loss: 0.0856
Epoch 67/80
 - 2s - loss: 0.0856
Epoch 68/80
 - 2s - loss: 0.0856
Epoch 69/80
 - 2s - loss: 0.0855
Epoch 70/80
 - 2s - loss: 0.0855
Epoch 71/80
 - 2s - loss: 0.0854
Epoch 72/80
 - 2s - loss: 0.0854
Epoch 73/80
 - 2s - loss: 0.0820
Epoch 74/80
 - 2s - loss: 0.0818
Epoch 75/80
 - 2s - loss: 0.0817
Epoch 76/80
 - 2s - loss: 0.0817
Epoch 77/80
 - 2s - loss: 0.0817
Epoch 78/80
 - 2s - loss: 0.0809
Epoch 79/80
 - 2s - loss: 0.0809
Epoch 80/80
 - 2s - loss: 0.0809
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.9426 - val_loss: 1.2614
AUC: 0.7951

Epoch 2/80
 - 0s - loss: 2.0425 - val_loss: 0.9025
AUC: 0.8342

Epoch 3/80
 - 0s - loss: 1.5143 - val_loss: 0.7979
AUC: 0.8476

Epoch 4/80
 - 0s - loss: 1.2523 - val_loss: 0.7623
AUC: 0.8508

Epoch 5/80
 - 0s - loss: 1.1437 - val_loss: 0.5898
AUC: 0.8510

Epoch 6/80
 - 0s - loss: 1.1019 - val_loss: 0.6823
AUC: 0.8564

Epoch 7/80
 - 0s - loss: 1.0745 - val_loss: 0.6773
AUC: 0.8564

Epoch 8/80
 - 0s - loss: 1.0581 - val_loss: 0.7104
AUC: 0.8595

Epoch 9/80
 - 0s - loss: 1.0533 - val_loss: 0.6091
AUC: 0.8589

Epoch 10/80
 - 0s - loss: 1.0374 - val_loss: 0.6647
AUC: 0.8595

Epoch 11/80
 - 0s - loss: 1.0316 - val_loss: 0.6197
AUC: 0.8609

Epoch 12/80
 - 0s - loss: 1.0162 - val_loss: 0.5915
AUC: 0.8606

Epoch 13/80
 - 0s - loss: 1.0158 - val_loss: 0.6356
AUC: 0.8617

Epoch 14/80
 - 0s - loss: 1.0108 - val_loss: 0.6049
AUC: 0.8599

Epoch 15/80
 - 0s - loss: 0.9992 - val_loss: 0.6049
AUC: 0.8622

Epoch 16/80
 - 0s - loss: 0.9839 - val_loss: 0.6044
AUC: 0.8623

Epoch 17/80
 - 0s - loss: 0.9851 - val_loss: 0.6457
AUC: 0.8634

Epoch 18/80
 - 0s - loss: 0.9836 - val_loss: 0.6238
AUC: 0.8628

Epoch 19/80
 - 0s - loss: 0.9767 - val_loss: 0.6085
AUC: 0.8635

Epoch 20/80
 - 0s - loss: 0.9762 - val_loss: 0.6538
AUC: 0.8637

Epoch 21/80
 - 0s - loss: 0.9738 - val_loss: 0.6358
AUC: 0.8638

Epoch 22/80
 - 0s - loss: 0.9726 - val_loss: 0.5948
AUC: 0.8632

Epoch 23/80
 - 0s - loss: 0.9715 - val_loss: 0.6220
AUC: 0.8638

Epoch 24/80
 - 0s - loss: 0.9712 - val_loss: 0.6489
AUC: 0.8644

Epoch 25/80
 - 0s - loss: 0.9761 - val_loss: 0.6707
AUC: 0.8647

Epoch 26/80
 - 0s - loss: 0.9642 - val_loss: 0.6128
AUC: 0.8640

Epoch 27/80
 - 0s - loss: 0.9657 - val_loss: 0.6090
AUC: 0.8638

Epoch 28/80
 - 0s - loss: 0.9669 - val_loss: 0.6040
AUC: 0.8638

Epoch 29/80
 - 0s - loss: 0.9644 - val_loss: 0.6008
AUC: 0.8639

Epoch 30/80
 - 0s - loss: 0.9674 - val_loss: 0.5966
AUC: 0.8638

Epoch 31/80
 - 0s - loss: 0.9641 - val_loss: 0.6065
AUC: 0.8639

Epoch 32/80
 - 0s - loss: 0.9613 - val_loss: 0.6126
AUC: 0.8640

Epoch 33/80
 - 0s - loss: 0.9636 - val_loss: 0.6175
AUC: 0.8640

Epoch 34/80
 - 0s - loss: 0.9642 - val_loss: 0.6111
AUC: 0.8641

Epoch 35/80
 - 0s - loss: 0.9594 - val_loss: 0.6008
AUC: 0.8640

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9706 - val_loss: 0.6234
AUC: 0.8639

Epoch 2/30
 - 1s - loss: 0.9650 - val_loss: 0.6117
AUC: 0.8644

Epoch 3/30
 - 1s - loss: 0.9709 - val_loss: 0.6042
AUC: 0.8649

Epoch 4/30
 - 1s - loss: 0.9590 - val_loss: 0.6123
AUC: 0.8649

Epoch 5/30
 - 1s - loss: 0.9641 - val_loss: 0.5932
AUC: 0.8643

Epoch 6/30
 - 1s - loss: 0.9547 - val_loss: 0.5866
AUC: 0.8643

Epoch 7/30
 - 1s - loss: 0.9517 - val_loss: 0.6149
AUC: 0.8653

Epoch 8/30
 - 1s - loss: 0.9475 - val_loss: 0.6201
AUC: 0.8656

Epoch 9/30
 - 1s - loss: 0.9475 - val_loss: 0.6022
AUC: 0.8648

Epoch 10/30
 - 1s - loss: 0.9470 - val_loss: 0.5828
AUC: 0.8645

Epoch 11/30
 - 1s - loss: 0.9446 - val_loss: 0.6077
AUC: 0.8651

Epoch 12/30
 - 1s - loss: 0.9460 - val_loss: 0.6115
AUC: 0.8658

Epoch 13/30
 - 1s - loss: 0.9462 - val_loss: 0.6025
AUC: 0.8652

Epoch 14/30
 - 1s - loss: 0.9398 - val_loss: 0.5939
AUC: 0.8654

Epoch 15/30
 - 1s - loss: 0.9337 - val_loss: 0.5771
AUC: 0.8652

Epoch 16/30
 - 1s - loss: 0.9309 - val_loss: 0.6033
AUC: 0.8658

Epoch 17/30
 - 1s - loss: 0.9360 - val_loss: 0.6109
AUC: 0.8663

Epoch 18/30
 - 1s - loss: 0.9348 - val_loss: 0.5866
AUC: 0.8657

Epoch 19/30
 - 1s - loss: 0.9258 - val_loss: 0.5924
AUC: 0.8658

Epoch 20/30
 - 1s - loss: 0.9269 - val_loss: 0.6063
AUC: 0.8663

Epoch 21/30
 - 1s - loss: 0.9222 - val_loss: 0.5995
AUC: 0.8662

Epoch 22/30
 - 1s - loss: 0.9243 - val_loss: 0.5722
AUC: 0.8652

Epoch 23/30
 - 1s - loss: 0.9187 - val_loss: 0.5968
AUC: 0.8665

Epoch 24/30
 - 1s - loss: 0.9218 - val_loss: 0.5810
AUC: 0.8662

Epoch 25/30
 - 1s - loss: 0.9181 - val_loss: 0.5703
AUC: 0.8661

Epoch 26/30
 - 1s - loss: 0.9158 - val_loss: 0.5907
AUC: 0.8664

Epoch 27/30
 - 1s - loss: 0.9169 - val_loss: 0.5850
AUC: 0.8668

Epoch 28/30
 - 1s - loss: 0.9141 - val_loss: 0.5828
AUC: 0.8664

Epoch 29/30
 - 1s - loss: 0.9087 - val_loss: 0.5761
AUC: 0.8660

Epoch 30/30
 - 1s - loss: 0.9085 - val_loss: 0.5725
Using TensorFlow backend.
AUC: 0.8667

2019-03-08 11:36:27.364135: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:36:27.535808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:36:27.535855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:36:27.835545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:36:27.835600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:36:27.835610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:36:27.835900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.0000
Epoch 2/80
 - 2s - loss: 0.1820
Epoch 3/80
 - 2s - loss: 0.1558
Epoch 4/80
 - 2s - loss: 0.1340
Epoch 5/80
 - 2s - loss: 0.1175
Epoch 6/80
 - 2s - loss: 0.1051
Epoch 7/80
 - 2s - loss: 0.0943
Epoch 8/80
 - 2s - loss: 0.0849
Epoch 9/80
 - 2s - loss: 0.0768
Epoch 10/80
 - 2s - loss: 0.0704
Epoch 11/80
 - 2s - loss: 0.0653
Epoch 12/80
 - 2s - loss: 0.0611
Epoch 13/80
 - 2s - loss: 0.0577
Epoch 14/80
 - 2s - loss: 0.0549
Epoch 15/80
 - 2s - loss: 0.0525
Epoch 16/80
 - 2s - loss: 0.0505
Epoch 17/80
 - 2s - loss: 0.0487
Epoch 18/80
 - 2s - loss: 0.0472
Epoch 19/80
 - 2s - loss: 0.0458
Epoch 20/80
 - 2s - loss: 0.0447
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:37:29.964332: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:37:30.133707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:37:30.133762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:37:30.435392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:37:30.435447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:37:30.435457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:37:30.435722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9781
Epoch 2/80
 - 2s - loss: 0.1812
Epoch 3/80
 - 2s - loss: 0.1581
Epoch 4/80
 - 2s - loss: 0.1338
Epoch 5/80
 - 2s - loss: 0.1153
Epoch 6/80
 - 2s - loss: 0.1034
Epoch 7/80
 - 2s - loss: 0.0937
Epoch 8/80
 - 2s - loss: 0.0853
Epoch 9/80
 - 2s - loss: 0.0778
Epoch 10/80
 - 2s - loss: 0.0713
Epoch 11/80
 - 2s - loss: 0.0659
Epoch 12/80
 - 2s - loss: 0.0615
Epoch 13/80
 - 2s - loss: 0.0580
Epoch 14/80
 - 2s - loss: 0.0551
Epoch 15/80
 - 2s - loss: 0.0527
Epoch 16/80
 - 2s - loss: 0.0506
Epoch 17/80
 - 2s - loss: 0.0489
Epoch 18/80
 - 2s - loss: 0.0474
Epoch 19/80
 - 2s - loss: 0.0461
Epoch 20/80
 - 2s - loss: 0.0450
Epoch 21/80
 - 2s - loss: 0.0440
Epoch 22/80
 - 2s - loss: 0.0431
Epoch 23/80
 - 2s - loss: 0.0423
Epoch 24/80
 - 2s - loss: 0.0416
Epoch 25/80
 - 2s - loss: 0.0410
Epoch 26/80
 - 2s - loss: 0.0405
Epoch 27/80
 - 2s - loss: 0.0401
Epoch 28/80
 - 2s - loss: 0.0397
Epoch 29/80
 - 2s - loss: 0.0393
Epoch 30/80
 - 2s - loss: 0.0391
Epoch 31/80
 - 2s - loss: 0.0388
Epoch 32/80
 - 2s - loss: 0.0386
Epoch 33/80
 - 2s - loss: 0.0383
Epoch 34/80
 - 2s - loss: 0.0381
Epoch 35/80
 - 2s - loss: 0.0380
Epoch 36/80
 - 2s - loss: 0.0378
Epoch 37/80
 - 2s - loss: 0.0377
Epoch 38/80
 - 2s - loss: 0.0375
Epoch 39/80
 - 2s - loss: 0.0374
Epoch 40/80
 - 2s - loss: 0.0373
Epoch 41/80
 - 2s - loss: 0.0372
Epoch 42/80
 - 2s - loss: 0.0371
Epoch 43/80
 - 2s - loss: 0.0370
Epoch 44/80
 - 2s - loss: 0.0370
Epoch 45/80
 - 2s - loss: 0.0369
Epoch 46/80
 - 2s - loss: 0.0368
Epoch 47/80
 - 2s - loss: 0.0368
Epoch 48/80
 - 2s - loss: 0.0367
Epoch 49/80
 - 2s - loss: 0.0366
Epoch 50/80
 - 2s - loss: 0.0366
Epoch 51/80
 - 2s - loss: 0.0366
Epoch 52/80
 - 2s - loss: 0.0365
Epoch 53/80
 - 2s - loss: 0.0365
Epoch 54/80
 - 2s - loss: 0.0364
Epoch 55/80
 - 2s - loss: 0.0364
Epoch 56/80
 - 2s - loss: 0.0364
Epoch 57/80
 - 2s - loss: 0.0363
Epoch 58/80
 - 2s - loss: 0.0363
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:39:42.851517: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:39:43.022144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:39:43.022189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:39:43.322734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:39:43.322790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:39:43.322801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:39:43.323113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9650
Epoch 2/80
 - 2s - loss: 0.1811
Epoch 3/80
 - 2s - loss: 0.1602
Epoch 4/80
 - 2s - loss: 0.1395
Epoch 5/80
 - 2s - loss: 0.1222
Epoch 6/80
 - 2s - loss: 0.1096
Epoch 7/80
 - 2s - loss: 0.0983
Epoch 8/80
 - 2s - loss: 0.0881
Epoch 9/80
 - 2s - loss: 0.0797
Epoch 10/80
 - 2s - loss: 0.0729
Epoch 11/80
 - 2s - loss: 0.0674
Epoch 12/80
 - 2s - loss: 0.0629
Epoch 13/80
 - 2s - loss: 0.0593
Epoch 14/80
 - 2s - loss: 0.0562
Epoch 15/80
 - 2s - loss: 0.0536
Epoch 16/80
 - 2s - loss: 0.0513
Epoch 17/80
 - 2s - loss: 0.0494
Epoch 18/80
 - 2s - loss: 0.0478
Epoch 19/80
 - 2s - loss: 0.0464
Epoch 20/80
 - 2s - loss: 0.0451
Epoch 21/80
 - 2s - loss: 0.0441
Epoch 22/80
 - 2s - loss: 0.0431
Epoch 23/80
 - 2s - loss: 0.0423
Epoch 24/80
 - 2s - loss: 0.0417
Epoch 25/80
 - 2s - loss: 0.0410
Epoch 26/80
 - 2s - loss: 0.0405
Epoch 27/80
 - 2s - loss: 0.0400
Epoch 28/80
 - 2s - loss: 0.0396
Epoch 29/80
 - 2s - loss: 0.0393
Epoch 30/80
 - 2s - loss: 0.0390
Epoch 31/80
 - 2s - loss: 0.0387
Epoch 32/80
 - 2s - loss: 0.0385
Epoch 33/80
 - 2s - loss: 0.0383
Epoch 34/80
 - 2s - loss: 0.0380
Epoch 35/80
 - 2s - loss: 0.0379
Epoch 36/80
 - 2s - loss: 0.0377
Epoch 37/80
 - 2s - loss: 0.0376
Epoch 38/80
 - 2s - loss: 0.0375
Epoch 39/80
 - 2s - loss: 0.0373
Epoch 40/80
 - 2s - loss: 0.0372
Epoch 41/80
 - 2s - loss: 0.0372
Epoch 42/80
 - 2s - loss: 0.0371
Epoch 43/80
 - 2s - loss: 0.0370
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:41:26.942705: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:41:27.110421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:41:27.110468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:41:27.409695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:41:27.409750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:41:27.409764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:41:27.410030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9703
Epoch 2/80
 - 2s - loss: 0.1821
Epoch 3/80
 - 2s - loss: 0.1643
Epoch 4/80
 - 2s - loss: 0.1478
Epoch 5/80
 - 2s - loss: 0.1270
Epoch 6/80
 - 2s - loss: 0.1100
Epoch 7/80
 - 2s - loss: 0.0980
Epoch 8/80
 - 2s - loss: 0.0882
Epoch 9/80
 - 2s - loss: 0.0799
Epoch 10/80
 - 2s - loss: 0.0731
Epoch 11/80
 - 2s - loss: 0.0675
Epoch 12/80
 - 2s - loss: 0.0628
Epoch 13/80
 - 2s - loss: 0.0590
Epoch 14/80
 - 2s - loss: 0.0559
Epoch 15/80
 - 2s - loss: 0.0533
Epoch 16/80
 - 2s - loss: 0.0511
Epoch 17/80
 - 2s - loss: 0.0493
Epoch 18/80
 - 2s - loss: 0.0477
Epoch 19/80
 - 2s - loss: 0.0463
Epoch 20/80
 - 2s - loss: 0.0451
Epoch 21/80
 - 2s - loss: 0.0441
Epoch 22/80
 - 2s - loss: 0.0431
Epoch 23/80
 - 2s - loss: 0.0424
Epoch 24/80
 - 2s - loss: 0.0417
Epoch 25/80
 - 2s - loss: 0.0411
Epoch 26/80
 - 2s - loss: 0.0406
Epoch 27/80
 - 2s - loss: 0.0401
Epoch 28/80
 - 2s - loss: 0.0397
Epoch 29/80
 - 2s - loss: 0.0394
Epoch 30/80
 - 2s - loss: 0.0391
Epoch 31/80
 - 2s - loss: 0.0388
Epoch 32/80
 - 2s - loss: 0.0386
Epoch 33/80
 - 2s - loss: 0.0384
Epoch 34/80
 - 2s - loss: 0.0382
Epoch 35/80
 - 2s - loss: 0.0380
Epoch 36/80
 - 2s - loss: 0.0379
Epoch 37/80
 - 2s - loss: 0.0377
Epoch 38/80
 - 2s - loss: 0.0376
Epoch 39/80
 - 2s - loss: 0.0375
Epoch 40/80
 - 2s - loss: 0.0374
Epoch 41/80
 - 2s - loss: 0.0373
Epoch 42/80
 - 2s - loss: 0.0372
Epoch 43/80
 - 2s - loss: 0.0371
Epoch 44/80
 - 2s - loss: 0.0371
Epoch 45/80
 - 2s - loss: 0.0370
Epoch 46/80
 - 2s - loss: 0.0369
Epoch 47/80
 - 2s - loss: 0.0369
Epoch 48/80
 - 2s - loss: 0.0368
Epoch 49/80
 - 2s - loss: 0.0367
Epoch 50/80
 - 2s - loss: 0.0367
Epoch 51/80
 - 2s - loss: 0.0367
Epoch 52/80
 - 2s - loss: 0.0366
Epoch 53/80
 - 2s - loss: 0.0366
Epoch 54/80
 - 2s - loss: 0.0365
Epoch 55/80
 - 2s - loss: 0.0365
Epoch 56/80
 - 2s - loss: 0.0365
Epoch 57/80
 - 2s - loss: 0.0349
Epoch 58/80
 - 2s - loss: 0.0348
Epoch 59/80
 - 2s - loss: 0.0348
Epoch 60/80
 - 2s - loss: 0.0348
Epoch 61/80
 - 2s - loss: 0.0348
Epoch 62/80
 - 2s - loss: 0.0344
Epoch 63/80
 - 2s - loss: 0.0344
Epoch 64/80
 - 2s - loss: 0.0344
Epoch 65/80
 - 2s - loss: 0.0344
Epoch 66/80
 - 2s - loss: 0.0343
Epoch 67/80
 - 2s - loss: 0.0343
Epoch 68/80
 - 2s - loss: 0.0343
Epoch 69/80
 - 2s - loss: 0.0343
Epoch 70/80
 - 2s - loss: 0.0343
Epoch 71/80
 - 2s - loss: 0.0343
Epoch 72/80
 - 2s - loss: 0.0343
Epoch 73/80
 - 2s - loss: 0.0343
Epoch 74/80
 - 2s - loss: 0.0343
Epoch 75/80
 - 2s - loss: 0.0343
Epoch 76/80
 - 2s - loss: 0.0343
Epoch 77/80
 - 2s - loss: 0.0343
Epoch 78/80
 - 2s - loss: 0.0343
Epoch 79/80
 - 2s - loss: 0.0343
Epoch 80/80
 - 2s - loss: 0.0343
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.3221 - val_loss: 1.0260
AUC: 0.8117

Epoch 2/80
 - 0s - loss: 1.9195 - val_loss: 0.9837
AUC: 0.8378

Epoch 3/80
 - 0s - loss: 1.4122 - val_loss: 0.6305
AUC: 0.8476

Epoch 4/80
 - 0s - loss: 1.1976 - val_loss: 0.6863
AUC: 0.8514

Epoch 5/80
 - 0s - loss: 1.1291 - val_loss: 0.6195
AUC: 0.8559

Epoch 6/80
 - 0s - loss: 1.0882 - val_loss: 0.6780
AUC: 0.8592

Epoch 7/80
 - 0s - loss: 1.0648 - val_loss: 0.7371
AUC: 0.8601

Epoch 8/80
 - 0s - loss: 1.0535 - val_loss: 0.6747
AUC: 0.8617

Epoch 9/80
 - 0s - loss: 1.0424 - val_loss: 0.7198
AUC: 0.8593

Epoch 10/80
 - 0s - loss: 1.0232 - val_loss: 0.6241
AUC: 0.8612

Epoch 11/80
 - 0s - loss: 1.0213 - val_loss: 0.6677
AUC: 0.8638

Epoch 12/80
 - 0s - loss: 1.0077 - val_loss: 0.6469
AUC: 0.8658

Epoch 13/80
 - 0s - loss: 0.9902 - val_loss: 0.6065
AUC: 0.8639

Epoch 14/80
 - 0s - loss: 1.0077 - val_loss: 0.6241
AUC: 0.8665

Epoch 15/80
 - 0s - loss: 0.9999 - val_loss: 0.6062
AUC: 0.8674

Epoch 16/80
 - 0s - loss: 0.9913 - val_loss: 0.7034
AUC: 0.8686

Epoch 17/80
 - 0s - loss: 0.9816 - val_loss: 0.6631
AUC: 0.8663

Epoch 18/80
 - 0s - loss: 0.9747 - val_loss: 0.7373
AUC: 0.8692

Epoch 19/80
 - 0s - loss: 0.9741 - val_loss: 0.5575
AUC: 0.8663

Epoch 20/80
 - 0s - loss: 0.9692 - val_loss: 0.6285
AUC: 0.8691

Epoch 21/80
 - 0s - loss: 0.9623 - val_loss: 0.6348
AUC: 0.8678

Epoch 22/80
 - 0s - loss: 0.9562 - val_loss: 0.5884
AUC: 0.8691

Epoch 23/80
 - 0s - loss: 0.9561 - val_loss: 0.6227
AUC: 0.8697

Epoch 24/80
 - 0s - loss: 0.9487 - val_loss: 0.6005
AUC: 0.8682

Epoch 25/80
 - 0s - loss: 0.9494 - val_loss: 0.6521
AUC: 0.8713

Epoch 26/80
 - 0s - loss: 0.9443 - val_loss: 0.5909
AUC: 0.8709

Epoch 27/80
 - 0s - loss: 0.9376 - val_loss: 0.5037
AUC: 0.8676

Epoch 28/80
 - 0s - loss: 0.9468 - val_loss: 0.6523
AUC: 0.8693

Epoch 29/80
 - 0s - loss: 0.9320 - val_loss: 0.6107
AUC: 0.8713

Epoch 30/80
 - 0s - loss: 0.9292 - val_loss: 0.6113
AUC: 0.8701

Epoch 31/80
 - 0s - loss: 0.9282 - val_loss: 0.7194
AUC: 0.8713

Epoch 32/80
 - 0s - loss: 0.9320 - val_loss: 0.5203
AUC: 0.8690

Epoch 33/80
 - 0s - loss: 0.9255 - val_loss: 0.6450
AUC: 0.8705

Epoch 34/80
 - 0s - loss: 0.9161 - val_loss: 0.5121
AUC: 0.8695

Epoch 35/80
 - 0s - loss: 0.9182 - val_loss: 0.6785
AUC: 0.8712

Epoch 36/80
 - 0s - loss: 0.9111 - val_loss: 0.5454
AUC: 0.8690

Epoch 37/80
 - 0s - loss: 0.9043 - val_loss: 0.5776
AUC: 0.8681

Epoch 38/80
 - 0s - loss: 0.8937 - val_loss: 0.5768
AUC: 0.8717

Epoch 39/80
 - 0s - loss: 0.8839 - val_loss: 0.5706
AUC: 0.8707

Epoch 40/80
 - 0s - loss: 0.8857 - val_loss: 0.5687
AUC: 0.8714

Epoch 41/80
 - 0s - loss: 0.8809 - val_loss: 0.5832
AUC: 0.8715

Epoch 42/80
 - 0s - loss: 0.8816 - val_loss: 0.5586
AUC: 0.8710

Epoch 43/80
 - 0s - loss: 0.8763 - val_loss: 0.5797
AUC: 0.8710

Epoch 44/80
 - 0s - loss: 0.8778 - val_loss: 0.5807
AUC: 0.8713

Epoch 45/80
 - 0s - loss: 0.8736 - val_loss: 0.5693
AUC: 0.8714

Epoch 46/80
 - 0s - loss: 0.8770 - val_loss: 0.5635
AUC: 0.8710

Epoch 47/80
 - 0s - loss: 0.8719 - val_loss: 0.5698
AUC: 0.8710

Epoch 48/80
 - 0s - loss: 0.8682 - val_loss: 0.5626
AUC: 0.8711

Epoch 49/80
 - 0s - loss: 0.8669 - val_loss: 0.5670
AUC: 0.8712

Epoch 50/80
 - 0s - loss: 0.8692 - val_loss: 0.5615
AUC: 0.8712

Epoch 51/80
 - 0s - loss: 0.8688 - val_loss: 0.5782
AUC: 0.8714

Epoch 52/80
 - 0s - loss: 0.8627 - val_loss: 0.5669
AUC: 0.8714

Epoch 53/80
 - 0s - loss: 0.8650 - val_loss: 0.5745
AUC: 0.8715

Epoch 54/80
 - 0s - loss: 0.8672 - val_loss: 0.5737
AUC: 0.8713

Epoch 55/80
 - 0s - loss: 0.8640 - val_loss: 0.5549
AUC: 0.8713

Epoch 56/80
 - 0s - loss: 0.8671 - val_loss: 0.5671
AUC: 0.8714

Epoch 57/80
 - 0s - loss: 0.8630 - val_loss: 0.5780
AUC: 0.8714

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.8857 - val_loss: 0.5605
AUC: 0.8713

Epoch 2/30
 - 1s - loss: 0.8822 - val_loss: 0.5941
AUC: 0.8717

Epoch 3/30
 - 1s - loss: 0.8745 - val_loss: 0.5776
AUC: 0.8712

Epoch 4/30
 - 1s - loss: 0.8737 - val_loss: 0.5725
AUC: 0.8714

Epoch 5/30
 - 1s - loss: 0.8753 - val_loss: 0.5873
AUC: 0.8713

Epoch 6/30
 - 1s - loss: 0.8677 - val_loss: 0.6089
AUC: 0.8719

Epoch 7/30
 - 1s - loss: 0.8681 - val_loss: 0.5668
AUC: 0.8715

Epoch 8/30
 - 1s - loss: 0.8634 - val_loss: 0.5902
AUC: 0.8716

Epoch 9/30
 - 1s - loss: 0.8625 - val_loss: 0.5639
AUC: 0.8714

Epoch 10/30
 - 1s - loss: 0.8671 - val_loss: 0.6027
AUC: 0.8722

Epoch 11/30
 - 1s - loss: 0.8649 - val_loss: 0.5953
AUC: 0.8720

Epoch 12/30
 - 1s - loss: 0.8565 - val_loss: 0.5659
AUC: 0.8718

Epoch 13/30
 - 1s - loss: 0.8578 - val_loss: 0.5639
AUC: 0.8718

Epoch 14/30
 - 1s - loss: 0.8597 - val_loss: 0.5761
AUC: 0.8718

Epoch 15/30
 - 1s - loss: 0.8565 - val_loss: 0.5692
AUC: 0.8717

Epoch 16/30
 - 1s - loss: 0.8534 - val_loss: 0.5639
AUC: 0.8717

Epoch 17/30
 - 1s - loss: 0.8530 - val_loss: 0.5673
AUC: 0.8717

Epoch 18/30
 - 1s - loss: 0.8558 - val_loss: 0.5702
AUC: 0.8718

Epoch 19/30
 - 1s - loss: 0.8549 - val_loss: 0.5613
AUC: 0.8716

Epoch 20/30
 - 1s - loss: 0.8508 - val_loss: 0.5669
AUC: 0.8716

Epoch 21/30
 - 1s - loss: 0.8531 - val_loss: 0.5678
AUC: 0.8717

Epoch 22/30
 - 1s - loss: 0.8552 - val_loss: 0.5685
AUC: 0.8717

Epoch 23/30
 - 1s - loss: 0.8549 - val_loss: 0.5686
AUC: 0.8717

Epoch 24/30
 - 1s - loss: 0.8509 - val_loss: 0.5673
AUC: 0.8716

Epoch 25/30
 - 1s - loss: 0.8509 - val_loss: 0.5671
AUC: 0.8717

Epoch 26/30
 - 1s - loss: 0.8497 - val_loss: 0.5653
AUC: 0.8716

Epoch 27/30
 - 1s - loss: 0.8451 - val_loss: 0.5637
AUC: 0.8716

Epoch 28/30
 - 1s - loss: 0.8536 - val_loss: 0.5659
AUC: 0.8716

Epoch 29/30
 - 1s - loss: 0.8515 - val_loss: 0.5667
AUC: 0.8717

Epoch 30/30
 - 1s - loss: 0.8494 - val_loss: 0.5657
Using TensorFlow backend.
AUC: 0.8716

2019-03-08 11:45:35.026574: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:45:35.203297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:45:35.203336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:45:35.504547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:45:35.504604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:45:35.504614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:45:35.504946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6034
Epoch 2/80
 - 2s - loss: 0.0830
Epoch 3/80
 - 2s - loss: 0.0623
Epoch 4/80
 - 2s - loss: 0.0541
Epoch 5/80
 - 2s - loss: 0.0484
Epoch 6/80
 - 2s - loss: 0.0435
Epoch 7/80
 - 2s - loss: 0.0390
Epoch 8/80
 - 2s - loss: 0.0350
Epoch 9/80
 - 2s - loss: 0.0317
Epoch 10/80
 - 2s - loss: 0.0288
Epoch 11/80
 - 2s - loss: 0.0264
Epoch 12/80
 - 2s - loss: 0.0243
Epoch 13/80
 - 2s - loss: 0.0225
Epoch 14/80
 - 2s - loss: 0.0210
Epoch 15/80
 - 2s - loss: 0.0197
Epoch 16/80
 - 2s - loss: 0.0187
Epoch 17/80
 - 2s - loss: 0.0178
Epoch 18/80
 - 2s - loss: 0.0170
Epoch 19/80
 - 2s - loss: 0.0164
Epoch 20/80
 - 2s - loss: 0.0158
Epoch 21/80
 - 2s - loss: 0.0154
Epoch 22/80
 - 2s - loss: 0.0149
Epoch 23/80
 - 2s - loss: 0.0146
Epoch 24/80
 - 2s - loss: 0.0142
Epoch 25/80
 - 2s - loss: 0.0140
Epoch 26/80
 - 2s - loss: 0.0137
Epoch 27/80
 - 2s - loss: 0.0135
Epoch 28/80
 - 2s - loss: 0.0133
Epoch 29/80
 - 2s - loss: 0.0131
Epoch 30/80
 - 2s - loss: 0.0130
Epoch 31/80
 - 2s - loss: 0.0128
Epoch 32/80
 - 2s - loss: 0.0127
Epoch 33/80
 - 2s - loss: 0.0126
Epoch 34/80
 - 2s - loss: 0.0125
Epoch 35/80
 - 2s - loss: 0.0124
Epoch 36/80
 - 2s - loss: 0.0124
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2b3e19b280f0>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 11:47:07.658630: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:47:07.828550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:47:07.828597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:47:08.128195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:47:08.128250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:47:08.128260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:47:08.128526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6030
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:47:28.820815: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:47:28.988157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:47:28.988203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:47:29.290412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:47:29.290459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:47:29.290468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:47:29.290733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.6093
Epoch 2/80
 - 2s - loss: 0.0841
Epoch 3/80
 - 2s - loss: 0.0632
Epoch 4/80
 - 2s - loss: 0.0553
Epoch 5/80
 - 2s - loss: 0.0487
Epoch 6/80
 - 2s - loss: 0.0433
Epoch 7/80
 - 2s - loss: 0.0389
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:48:07.428617: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:48:07.594440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:48:07.594486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:48:07.885795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:48:07.885852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:48:07.885862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:48:07.886128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36264 rows...
Finished. It takes 5.6 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 4s - loss: 0.4738
Epoch 2/80
 - 4s - loss: 0.1114
Epoch 3/80
 - 4s - loss: 0.1013
Epoch 4/80
 - 4s - loss: 0.0932
Epoch 5/80
 - 4s - loss: 0.0846
Epoch 6/80
 - 4s - loss: 0.0768
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:48:54.003333: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:48:54.175337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:48:54.175383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:48:54.489150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:48:54.489194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:48:54.489205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:48:54.489513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36115 rows...
Finished. It takes 5.6 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 4s - loss: 0.6492
Epoch 2/80
 - 3s - loss: 0.1384
Epoch 3/80
 - 3s - loss: 0.1247
Epoch 4/80
 - 3s - loss: 0.1151
Epoch 5/80
 - 3s - loss: 0.1030
Epoch 6/80
 - 3s - loss: 0.0922
Epoch 7/80
 - 3s - loss: 0.0843
Epoch 8/80
 - 3s - loss: 0.0780
Epoch 9/80
 - 3s - loss: 0.0725
Epoch 10/80
 - 3s - loss: 0.0678
Epoch 11/80
 - 3s - loss: 0.0638
Epoch 12/80
 - 3s - loss: 0.0602
Epoch 13/80
 - 3s - loss: 0.0572
Epoch 14/80
 - 3s - loss: 0.0546
Epoch 15/80
 - 3s - loss: 0.0525
Epoch 16/80
 - 3s - loss: 0.0509
Epoch 17/80
 - 3s - loss: 0.0495
Epoch 18/80
 - 3s - loss: 0.0484
Epoch 19/80
 - 3s - loss: 0.0474
Epoch 20/80
 - 3s - loss: 0.0467
Epoch 21/80
 - 3s - loss: 0.0460
Epoch 22/80
 - 3s - loss: 0.0455
Epoch 23/80
 - 3s - loss: 0.0450
Epoch 24/80
 - 3s - loss: 0.0446
Epoch 25/80
 - 3s - loss: 0.0442
Epoch 26/80
 - 3s - loss: 0.0439
Epoch 27/80
 - 3s - loss: 0.0437
Epoch 28/80
 - 3s - loss: 0.0434
Epoch 29/80
 - 3s - loss: 0.0432
Epoch 30/80
 - 3s - loss: 0.0431
Epoch 31/80
 - 3s - loss: 0.0429
Epoch 32/80
 - 3s - loss: 0.0428
Epoch 33/80
 - 3s - loss: 0.0426
Epoch 34/80
 - 3s - loss: 0.0425
Epoch 35/80
 - 3s - loss: 0.0424
Epoch 36/80
 - 3s - loss: 0.0423
Epoch 37/80
 - 3s - loss: 0.0423
Epoch 38/80
 - 3s - loss: 0.0422
Epoch 39/80
 - 3s - loss: 0.0421
Epoch 40/80
 - 3s - loss: 0.0420
Epoch 41/80
 - 3s - loss: 0.0420
Epoch 42/80
 - 3s - loss: 0.0419
Epoch 43/80
 - 3s - loss: 0.0419
Epoch 44/80
 - 3s - loss: 0.0418
Epoch 45/80
 - 3s - loss: 0.0418
Epoch 46/80
 - 3s - loss: 0.0417
Epoch 47/80
 - 3s - loss: 0.0417
Epoch 48/80
 - 3s - loss: 0.0416
Epoch 49/80
 - 3s - loss: 0.0416
Epoch 50/80
 - 3s - loss: 0.0416
Epoch 51/80
 - 3s - loss: 0.0416
Epoch 52/80
 - 3s - loss: 0.0415
Epoch 53/80
 - 3s - loss: 0.0404
Epoch 54/80
 - 3s - loss: 0.0402
Epoch 55/80
 - 3s - loss: 0.0402
Epoch 56/80
 - 3s - loss: 0.0402
Epoch 57/80
 - 3s - loss: 0.0402
Epoch 58/80
 - 3s - loss: 0.0399
Epoch 59/80
 - 3s - loss: 0.0399
Epoch 60/80
 - 3s - loss: 0.0399
Epoch 61/80
 - 3s - loss: 0.0399
Epoch 62/80
 - 3s - loss: 0.0398
Epoch 63/80
 - 3s - loss: 0.0398
Epoch 64/80
 - 3s - loss: 0.0398
Epoch 65/80
 - 3s - loss: 0.0398
Epoch 66/80
 - 3s - loss: 0.0398
Epoch 67/80
 - 3s - loss: 0.0398
Epoch 68/80
 - 3s - loss: 0.0398
Epoch 69/80
 - 3s - loss: 0.0398
Epoch 70/80
 - 3s - loss: 0.0398
Epoch 71/80
 - 3s - loss: 0.0398
Epoch 72/80
 - 3s - loss: 0.0398
Epoch 73/80
 - 3s - loss: 0.0398
Epoch 74/80
 - 3s - loss: 0.0398
Epoch 75/80
 - 3s - loss: 0.0398
Epoch 76/80
 - 3s - loss: 0.0398
Epoch 77/80
 - 3s - loss: 0.0398
Epoch 78/80
 - 3s - loss: 0.0398
Epoch 79/80
 - 3s - loss: 0.0398
Epoch 80/80
 - 3s - loss: 0.0398
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28892 samples, validate on 7223 samples
Epoch 1/80
 - 1s - loss: 5.8499 - val_loss: 2.1444
AUC: 0.7686

Epoch 2/80
 - 0s - loss: 3.6951 - val_loss: 1.5468
AUC: 0.8030

Epoch 3/80
 - 0s - loss: 2.6298 - val_loss: 1.0968
AUC: 0.8152

Epoch 4/80
 - 0s - loss: 1.8341 - val_loss: 0.9122
AUC: 0.8196

Epoch 5/80
 - 0s - loss: 1.4489 - val_loss: 0.7805
AUC: 0.8312

Epoch 6/80
 - 0s - loss: 1.2741 - val_loss: 0.7182
AUC: 0.8359

Epoch 7/80
 - 0s - loss: 1.2021 - val_loss: 0.7277
AUC: 0.8401

Epoch 8/80
 - 0s - loss: 1.1625 - val_loss: 0.6922
AUC: 0.8446

Epoch 9/80
 - 0s - loss: 1.1391 - val_loss: 0.7368
AUC: 0.8451

Epoch 10/80
 - 0s - loss: 1.1187 - val_loss: 0.7023
AUC: 0.8470

Epoch 11/80
 - 0s - loss: 1.1160 - val_loss: 0.7186
AUC: 0.8510

Epoch 12/80
 - 0s - loss: 1.1016 - val_loss: 0.6607
AUC: 0.8518

Epoch 13/80
 - 0s - loss: 1.0779 - val_loss: 0.6710
AUC: 0.8516

Epoch 14/80
 - 0s - loss: 1.0790 - val_loss: 0.7279
AUC: 0.8559

Epoch 15/80
 - 0s - loss: 1.0671 - val_loss: 0.6969
AUC: 0.8568

Epoch 16/80
 - 0s - loss: 1.0620 - val_loss: 0.6827
AUC: 0.8578

Epoch 17/80
 - 0s - loss: 1.0569 - val_loss: 0.5992
AUC: 0.8575

Epoch 18/80
 - 0s - loss: 1.0474 - val_loss: 0.6246
AUC: 0.8559

Epoch 19/80
 - 0s - loss: 1.0528 - val_loss: 0.6377
AUC: 0.8586

Epoch 20/80
 - 0s - loss: 1.0466 - val_loss: 0.6640
AUC: 0.8599

Epoch 21/80
 - 0s - loss: 1.0413 - val_loss: 0.6715
AUC: 0.8588

Epoch 22/80
 - 0s - loss: 1.0362 - val_loss: 0.7097
AUC: 0.8605

Epoch 23/80
 - 0s - loss: 1.0305 - val_loss: 0.6682
AUC: 0.8617

Epoch 24/80
 - 0s - loss: 1.0343 - val_loss: 0.6591
AUC: 0.8610

Epoch 25/80
 - 0s - loss: 1.0265 - val_loss: 0.6595
AUC: 0.8606

Epoch 26/80
 - 0s - loss: 1.0355 - val_loss: 0.6937
AUC: 0.8580

Epoch 27/80
 - 0s - loss: 1.0216 - val_loss: 0.6571
AUC: 0.8632

Epoch 28/80
 - 0s - loss: 1.0169 - val_loss: 0.6646
AUC: 0.8631

Epoch 29/80
 - 0s - loss: 1.0127 - val_loss: 0.6144
AUC: 0.8630

Epoch 30/80
 - 0s - loss: 1.0082 - val_loss: 0.6075
AUC: 0.8629

Epoch 31/80
 - 0s - loss: 1.0154 - val_loss: 0.6447
AUC: 0.8634

Epoch 32/80
 - 0s - loss: 1.0144 - val_loss: 0.6306
AUC: 0.8631

Epoch 33/80
 - 0s - loss: 1.0105 - val_loss: 0.6343
AUC: 0.8631

Epoch 34/80
 - 0s - loss: 1.0098 - val_loss: 0.6561
AUC: 0.8635

Epoch 35/80
 - 0s - loss: 1.0081 - val_loss: 0.6311
AUC: 0.8633

Epoch 36/80
 - 0s - loss: 1.0166 - val_loss: 0.6510
AUC: 0.8637

Epoch 37/80
 - 0s - loss: 1.0093 - val_loss: 0.6365
AUC: 0.8634

Epoch 38/80
 - 0s - loss: 1.0095 - val_loss: 0.6397
AUC: 0.8634

Epoch 39/80
 - 0s - loss: 1.0115 - val_loss: 0.6404
AUC: 0.8635

Epoch 40/80
 - 0s - loss: 1.0066 - val_loss: 0.6392
AUC: 0.8635

Epoch 41/80
 - 0s - loss: 1.0134 - val_loss: 0.6369
AUC: 0.8635

Epoch 42/80
 - 0s - loss: 1.0073 - val_loss: 0.6330
AUC: 0.8635

Epoch 43/80
 - 0s - loss: 1.0042 - val_loss: 0.6357
AUC: 0.8635

Epoch 44/80
 - 0s - loss: 1.0053 - val_loss: 0.6348
AUC: 0.8636

Epoch 45/80
 - 0s - loss: 1.0074 - val_loss: 0.6381
AUC: 0.8636

Epoch 46/80
 - 0s - loss: 1.0074 - val_loss: 0.6360
AUC: 0.8638

Epoch 47/80
 - 0s - loss: 1.0053 - val_loss: 0.6349
AUC: 0.8638

Train on 28892 samples, validate on 7223 samples
Epoch 1/30
 - 1s - loss: 1.0038 - val_loss: 0.6278
AUC: 0.8639

Epoch 2/30
 - 0s - loss: 1.0050 - val_loss: 0.6346
AUC: 0.8640

Epoch 3/30
 - 0s - loss: 1.0005 - val_loss: 0.6595
AUC: 0.8646

Epoch 4/30
 - 0s - loss: 0.9990 - val_loss: 0.6349
AUC: 0.8644

Epoch 5/30
 - 0s - loss: 1.0010 - val_loss: 0.6181
AUC: 0.8646

Epoch 6/30
 - 0s - loss: 1.0003 - val_loss: 0.6306
AUC: 0.8650

Epoch 7/30
 - 0s - loss: 0.9938 - val_loss: 0.6241
AUC: 0.8650

Epoch 8/30
 - 0s - loss: 0.9964 - val_loss: 0.6416
AUC: 0.8653

Epoch 9/30
 - 0s - loss: 0.9993 - val_loss: 0.6276
AUC: 0.8654

Epoch 10/30
 - 0s - loss: 0.9870 - val_loss: 0.6350
AUC: 0.8655

Epoch 11/30
 - 0s - loss: 0.9902 - val_loss: 0.6343
AUC: 0.8657

Epoch 12/30
 - 0s - loss: 0.9898 - val_loss: 0.6230
AUC: 0.8660

Epoch 13/30
 - 0s - loss: 0.9816 - val_loss: 0.6313
AUC: 0.8661

Epoch 14/30
 - 0s - loss: 0.9883 - val_loss: 0.6333
AUC: 0.8661

Epoch 15/30
 - 0s - loss: 0.9855 - val_loss: 0.6257
AUC: 0.8662

Epoch 16/30
 - 0s - loss: 0.9834 - val_loss: 0.6245
AUC: 0.8663

Epoch 17/30
 - 0s - loss: 0.9853 - val_loss: 0.6196
AUC: 0.8663

Epoch 18/30
 - 0s - loss: 0.9816 - val_loss: 0.6216
AUC: 0.8664

Epoch 19/30
 - 0s - loss: 0.9886 - val_loss: 0.6237
AUC: 0.8664

Epoch 20/30
 - 0s - loss: 0.9829 - val_loss: 0.6208
AUC: 0.8664

Epoch 21/30
 - 0s - loss: 0.9835 - val_loss: 0.6251
AUC: 0.8664

Epoch 22/30
 - 0s - loss: 0.9792 - val_loss: 0.6196
AUC: 0.8663

Epoch 23/30
 - 0s - loss: 0.9810 - val_loss: 0.6206
AUC: 0.8664

Epoch 24/30
 - 0s - loss: 0.9786 - val_loss: 0.6260
AUC: 0.8664

Epoch 25/30
 - 0s - loss: 0.9815 - val_loss: 0.6228
AUC: 0.8664

Epoch 26/30
 - 0s - loss: 0.9759 - val_loss: 0.6222
AUC: 0.8665

Epoch 27/30
 - 0s - loss: 0.9760 - val_loss: 0.6220
AUC: 0.8665

Epoch 28/30
 - 0s - loss: 0.9832 - val_loss: 0.6218
AUC: 0.8665

Epoch 29/30
 - 0s - loss: 0.9804 - val_loss: 0.6221
AUC: 0.8665

Epoch 30/30
 - 0s - loss: 0.9839 - val_loss: 0.6232
Using TensorFlow backend.
AUC: 0.8665

2019-03-08 11:54:05.953496: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:54:06.124690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:54:06.124737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:54:06.428685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:54:06.428743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:54:06.428758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:54:06.429078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1614
Epoch 2/80
 - 2s - loss: 0.2161
Epoch 3/80
 - 2s - loss: 0.1681
Epoch 4/80
 - 2s - loss: 0.1545
Epoch 5/80
 - 2s - loss: 0.1444
Epoch 6/80
 - 2s - loss: 0.1367
Epoch 7/80
 - 2s - loss: 0.1296
Epoch 8/80
 - 2s - loss: 0.1221
Epoch 9/80
 - 2s - loss: 0.1140
Epoch 10/80
 - 2s - loss: 0.1057
Epoch 11/80
 - 2s - loss: 0.0982
Epoch 12/80
 - 2s - loss: 0.0916
Epoch 13/80
 - 2s - loss: 0.0861
Epoch 14/80
 - 2s - loss: 0.0814
Epoch 15/80
 - 2s - loss: 0.0774
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:55:03.880862: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:55:04.054461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:55:04.054510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:55:04.351637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:55:04.351692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:55:04.351701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:55:04.351982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36278 rows...
Finished. It takes 5.6 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 5s - loss: 0.4536
Epoch 2/80
 - 4s - loss: 0.1077
Epoch 3/80
 - 4s - loss: 0.1003
Epoch 4/80
 - 4s - loss: 0.0948
Epoch 5/80
 - 4s - loss: 0.0873
Epoch 6/80
 - 4s - loss: 0.0783
Epoch 7/80
 - 4s - loss: 0.0695
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 11:55:54.475664: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 11:55:54.642997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 11:55:54.643043: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 11:55:54.938767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 11:55:54.938821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 11:55:54.938831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 11:55:54.939096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36194 rows...
Finished. It takes 5.5 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 4s - loss: 0.5373
Epoch 2/80
 - 3s - loss: 0.1239
Epoch 3/80
 - 3s - loss: 0.1107
Epoch 4/80
 - 3s - loss: 0.0994
Epoch 5/80
 - 3s - loss: 0.0903
Epoch 6/80
 - 3s - loss: 0.0837
Epoch 7/80
 - 3s - loss: 0.0781
Epoch 8/80
 - 3s - loss: 0.0723
Epoch 9/80
 - 3s - loss: 0.0666
Epoch 10/80
 - 4s - loss: 0.0616
Epoch 11/80
 - 4s - loss: 0.0574
Epoch 12/80
 - 3s - loss: 0.0541
Epoch 13/80
 - 3s - loss: 0.0516
Epoch 14/80
 - 3s - loss: 0.0495
Epoch 15/80
 - 3s - loss: 0.0478
Epoch 16/80
 - 3s - loss: 0.0464
Epoch 17/80
 - 3s - loss: 0.0453
Epoch 18/80
 - 3s - loss: 0.0443
Epoch 19/80
 - 3s - loss: 0.0435
Epoch 20/80
 - 3s - loss: 0.0429
Epoch 21/80
 - 3s - loss: 0.0423
Epoch 22/80
 - 3s - loss: 0.0419
Epoch 23/80
 - 3s - loss: 0.0415
Epoch 24/80
 - 3s - loss: 0.0412
Epoch 25/80
 - 3s - loss: 0.0409
Epoch 26/80
 - 3s - loss: 0.0406
Epoch 27/80
 - 3s - loss: 0.0404
Epoch 28/80
 - 3s - loss: 0.0402
Epoch 29/80
 - 3s - loss: 0.0400
Epoch 30/80
 - 3s - loss: 0.0399
Epoch 31/80
 - 3s - loss: 0.0398
Epoch 32/80
 - 3s - loss: 0.0396
Epoch 33/80
 - 3s - loss: 0.0395
Epoch 34/80
 - 3s - loss: 0.0394
Epoch 35/80
 - 3s - loss: 0.0393
Epoch 36/80
 - 3s - loss: 0.0393
Epoch 37/80
 - 3s - loss: 0.0392
Epoch 38/80
 - 3s - loss: 0.0391
Epoch 39/80
 - 3s - loss: 0.0391
Epoch 40/80
 - 3s - loss: 0.0390
Epoch 41/80
 - 3s - loss: 0.0389
Epoch 42/80
 - 3s - loss: 0.0389
Epoch 43/80
 - 3s - loss: 0.0389
Epoch 44/80
 - 3s - loss: 0.0388
Epoch 45/80
 - 3s - loss: 0.0388
Epoch 46/80
 - 3s - loss: 0.0387
Epoch 47/80
 - 3s - loss: 0.0387
Epoch 48/80
 - 3s - loss: 0.0387
Epoch 49/80
 - 3s - loss: 0.0387
Epoch 50/80
 - 3s - loss: 0.0386
Epoch 51/80
 - 3s - loss: 0.0375
Epoch 52/80
 - 3s - loss: 0.0373
Epoch 53/80
 - 3s - loss: 0.0373
Epoch 54/80
 - 3s - loss: 0.0373
Epoch 55/80
 - 3s - loss: 0.0373
Epoch 56/80
 - 3s - loss: 0.0370
Epoch 57/80
 - 3s - loss: 0.0370
Epoch 58/80
 - 3s - loss: 0.0370
Epoch 59/80
 - 3s - loss: 0.0370
Epoch 60/80
 - 3s - loss: 0.0369
Epoch 61/80
 - 3s - loss: 0.0369
Epoch 62/80
 - 3s - loss: 0.0369
Epoch 63/80
 - 3s - loss: 0.0369
Epoch 64/80
 - 3s - loss: 0.0369
Epoch 65/80
 - 3s - loss: 0.0369
Epoch 66/80
 - 3s - loss: 0.0369
Epoch 67/80
 - 3s - loss: 0.0369
Epoch 68/80
 - 3s - loss: 0.0369
Epoch 69/80
 - 3s - loss: 0.0369
Epoch 70/80
 - 3s - loss: 0.0369
Epoch 71/80
 - 3s - loss: 0.0369
Epoch 72/80
 - 3s - loss: 0.0369
Epoch 73/80
 - 3s - loss: 0.0369
Epoch 74/80
 - 3s - loss: 0.0369
Epoch 75/80
 - 3s - loss: 0.0369
Epoch 76/80
 - 3s - loss: 0.0369
Epoch 77/80
 - 3s - loss: 0.0369
Epoch 78/80
 - 3s - loss: 0.0369
Epoch 79/80
 - 3s - loss: 0.0369
Epoch 80/80
 - 3s - loss: 0.0369
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28955 samples, validate on 7239 samples
Epoch 1/80
 - 1s - loss: 9.7728 - val_loss: 1.7035
AUC: 0.6621

Epoch 2/80
 - 0s - loss: 4.3734 - val_loss: 1.8549
AUC: 0.7808

Epoch 3/80
 - 0s - loss: 3.1962 - val_loss: 1.1974
AUC: 0.8009

Epoch 4/80
 - 0s - loss: 2.3468 - val_loss: 0.9263
AUC: 0.8141

Epoch 5/80
 - 0s - loss: 1.7532 - val_loss: 0.8752
AUC: 0.8241

Epoch 6/80
 - 0s - loss: 1.4509 - val_loss: 0.7780
AUC: 0.8315

Epoch 7/80
 - 0s - loss: 1.3207 - val_loss: 0.6781
AUC: 0.8380

Epoch 8/80
 - 0s - loss: 1.2350 - val_loss: 0.7200
AUC: 0.8425

Epoch 9/80
 - 0s - loss: 1.1776 - val_loss: 0.6823
AUC: 0.8467

Epoch 10/80
 - 0s - loss: 1.1611 - val_loss: 0.6628
AUC: 0.8498

Epoch 11/80
 - 0s - loss: 1.1453 - val_loss: 0.6128
AUC: 0.8505

Epoch 12/80
 - 0s - loss: 1.1259 - val_loss: 0.6637
AUC: 0.8536

Epoch 13/80
 - 0s - loss: 1.1141 - val_loss: 0.6666
AUC: 0.8572

Epoch 14/80
 - 0s - loss: 1.1055 - val_loss: 0.6441
AUC: 0.8576

Epoch 15/80
 - 0s - loss: 1.0815 - val_loss: 0.6348
AUC: 0.8586

Epoch 16/80
 - 0s - loss: 1.0753 - val_loss: 0.6065
AUC: 0.8593

Epoch 17/80
 - 0s - loss: 1.0707 - val_loss: 0.6728
AUC: 0.8606

Epoch 18/80
 - 0s - loss: 1.0631 - val_loss: 0.6402
AUC: 0.8618

Epoch 19/80
 - 0s - loss: 1.0511 - val_loss: 0.6570
AUC: 0.8635

Epoch 20/80
 - 0s - loss: 1.0480 - val_loss: 0.6077
AUC: 0.8628

Epoch 21/80
 - 0s - loss: 1.0384 - val_loss: 0.6396
AUC: 0.8636

Epoch 22/80
 - 0s - loss: 1.0419 - val_loss: 0.6410
AUC: 0.8648

Epoch 23/80
 - 0s - loss: 1.0394 - val_loss: 0.6453
AUC: 0.8649

Epoch 24/80
 - 0s - loss: 1.0281 - val_loss: 0.5973
AUC: 0.8648

Epoch 25/80
 - 0s - loss: 1.0343 - val_loss: 0.5546
AUC: 0.8635

Epoch 26/80
 - 0s - loss: 1.0223 - val_loss: 0.6264
AUC: 0.8661

Epoch 27/80
 - 0s - loss: 1.0163 - val_loss: 0.6214
AUC: 0.8665

Epoch 28/80
 - 0s - loss: 1.0233 - val_loss: 0.5944
AUC: 0.8665

Epoch 29/80
 - 0s - loss: 1.0145 - val_loss: 0.6304
AUC: 0.8666

Epoch 30/80
 - 0s - loss: 1.0078 - val_loss: 0.5610
AUC: 0.8651

Epoch 31/80
 - 0s - loss: 1.0154 - val_loss: 0.6286
AUC: 0.8677

Epoch 32/80
 - 0s - loss: 1.0089 - val_loss: 0.6575
AUC: 0.8656

Epoch 33/80
 - 0s - loss: 1.0051 - val_loss: 0.6494
AUC: 0.8671

Epoch 34/80
 - 0s - loss: 1.0009 - val_loss: 0.5822
AUC: 0.8674

Epoch 35/80
 - 0s - loss: 0.9973 - val_loss: 0.5755
AUC: 0.8671

Epoch 36/80
 - 0s - loss: 0.9956 - val_loss: 0.5894
AUC: 0.8683

Epoch 37/80
 - 0s - loss: 0.9889 - val_loss: 0.5902
AUC: 0.8682

Epoch 38/80
 - 0s - loss: 0.9845 - val_loss: 0.5859
AUC: 0.8680

Epoch 39/80
 - 0s - loss: 0.9897 - val_loss: 0.6025
AUC: 0.8682

Epoch 40/80
 - 0s - loss: 0.9919 - val_loss: 0.5999
AUC: 0.8681

Epoch 41/80
 - 0s - loss: 0.9844 - val_loss: 0.5881
AUC: 0.8680

Epoch 42/80
 - 0s - loss: 0.9890 - val_loss: 0.6124
AUC: 0.8681

Epoch 43/80
 - 0s - loss: 0.9865 - val_loss: 0.6086
AUC: 0.8682

Epoch 44/80
 - 0s - loss: 0.9874 - val_loss: 0.6052
AUC: 0.8684

Epoch 45/80
 - 0s - loss: 0.9874 - val_loss: 0.6163
AUC: 0.8683

Epoch 46/80
 - 0s - loss: 0.9890 - val_loss: 0.6026
AUC: 0.8682

Epoch 47/80
 - 0s - loss: 0.9790 - val_loss: 0.6063
AUC: 0.8683

Epoch 48/80
 - 0s - loss: 0.9812 - val_loss: 0.6035
AUC: 0.8683

Epoch 49/80
 - 0s - loss: 0.9821 - val_loss: 0.6017
AUC: 0.8683

Epoch 50/80
 - 0s - loss: 0.9820 - val_loss: 0.5968
AUC: 0.8683

Epoch 51/80
 - 0s - loss: 0.9860 - val_loss: 0.6006
AUC: 0.8683

Epoch 52/80
 - 0s - loss: 0.9818 - val_loss: 0.6035
AUC: 0.8684

Epoch 53/80
 - 0s - loss: 0.9817 - val_loss: 0.6081
AUC: 0.8684

Epoch 54/80
 - 0s - loss: 0.9901 - val_loss: 0.6038
AUC: 0.8683

Epoch 55/80
 - 0s - loss: 0.9838 - val_loss: 0.5984
AUC: 0.8683

Train on 28955 samples, validate on 7239 samples
Epoch 1/30
 - 1s - loss: 0.9857 - val_loss: 0.6164
AUC: 0.8685

Epoch 2/30
 - 0s - loss: 0.9799 - val_loss: 0.6043
AUC: 0.8684

Epoch 3/30
 - 0s - loss: 0.9855 - val_loss: 0.6094
AUC: 0.8686

Epoch 4/30
 - 0s - loss: 0.9810 - val_loss: 0.5986
AUC: 0.8687

Epoch 5/30
 - 0s - loss: 0.9764 - val_loss: 0.6074
AUC: 0.8689

Epoch 6/30
 - 0s - loss: 0.9766 - val_loss: 0.6016
AUC: 0.8689

Epoch 7/30
 - 0s - loss: 0.9745 - val_loss: 0.5997
AUC: 0.8689

Epoch 8/30
 - 0s - loss: 0.9633 - val_loss: 0.5768
AUC: 0.8687

Epoch 9/30
 - 0s - loss: 0.9723 - val_loss: 0.6069
AUC: 0.8690

Epoch 10/30
 - 0s - loss: 0.9721 - val_loss: 0.5749
AUC: 0.8689

Epoch 11/30
 - 0s - loss: 0.9692 - val_loss: 0.5781
AUC: 0.8690

Epoch 12/30
 - 0s - loss: 0.9661 - val_loss: 0.6004
AUC: 0.8694

Epoch 13/30
 - 0s - loss: 0.9612 - val_loss: 0.6042
AUC: 0.8694

Epoch 14/30
 - 0s - loss: 0.9637 - val_loss: 0.6088
AUC: 0.8695

Epoch 15/30
 - 0s - loss: 0.9635 - val_loss: 0.6170
AUC: 0.8698

Epoch 16/30
 - 0s - loss: 0.9591 - val_loss: 0.6060
AUC: 0.8698

Epoch 17/30
 - 0s - loss: 0.9600 - val_loss: 0.5893
AUC: 0.8698

Epoch 18/30
 - 0s - loss: 0.9574 - val_loss: 0.5959
AUC: 0.8698

Epoch 19/30
 - 0s - loss: 0.9546 - val_loss: 0.5850
AUC: 0.8699

Epoch 20/30
 - 0s - loss: 0.9585 - val_loss: 0.5961
AUC: 0.8699

Epoch 21/30
 - 0s - loss: 0.9527 - val_loss: 0.5941
AUC: 0.8699

Epoch 22/30
 - 0s - loss: 0.9566 - val_loss: 0.5914
AUC: 0.8700

Epoch 23/30
 - 0s - loss: 0.9531 - val_loss: 0.5886
AUC: 0.8700

Epoch 24/30
 - 0s - loss: 0.9500 - val_loss: 0.5862
AUC: 0.8700

Epoch 25/30
 - 0s - loss: 0.9543 - val_loss: 0.5935
AUC: 0.8700

Epoch 26/30
 - 0s - loss: 0.9502 - val_loss: 0.5914
AUC: 0.8700

Epoch 27/30
 - 0s - loss: 0.9549 - val_loss: 0.5900
AUC: 0.8700

Epoch 28/30
 - 0s - loss: 0.9515 - val_loss: 0.5911
AUC: 0.8700

Epoch 29/30
 - 0s - loss: 0.9526 - val_loss: 0.5901
AUC: 0.8700

Epoch 30/30
 - 0s - loss: 0.9520 - val_loss: 0.5888
Using TensorFlow backend.
AUC: 0.8700

2019-03-08 12:01:46.750690: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:01:46.922160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:01:46.922206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:01:47.222549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:01:47.222604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:01:47.222614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:01:47.222885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35874 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9440
Epoch 2/80
 - 2s - loss: 0.1858
Epoch 3/80
 - 2s - loss: 0.1608
Epoch 4/80
 - 2s - loss: 0.1554
Epoch 5/80
 - 2s - loss: 0.1501
Epoch 6/80
 - 2s - loss: 0.1428
Epoch 7/80
 - 2s - loss: 0.1327
Epoch 8/80
 - 2s - loss: 0.1208
Epoch 9/80
 - 2s - loss: 0.1098
Epoch 10/80
 - 2s - loss: 0.1007
Epoch 11/80
 - 2s - loss: 0.0928
Epoch 12/80
 - 2s - loss: 0.0859
Epoch 13/80
 - 2s - loss: 0.0800
Epoch 14/80
 - 2s - loss: 0.0753
Epoch 15/80
 - 2s - loss: 0.0714
Epoch 16/80
 - 2s - loss: 0.0680
Epoch 17/80
 - 2s - loss: 0.0651
Epoch 18/80
 - 2s - loss: 0.0626
Epoch 19/80
 - 2s - loss: 0.0604
Epoch 20/80
 - 2s - loss: 0.0586
Epoch 21/80
 - 2s - loss: 0.0571
Epoch 22/80
 - 2s - loss: 0.0558
Epoch 23/80
 - 2s - loss: 0.0547
Epoch 24/80
 - 2s - loss: 0.0538
Epoch 25/80
 - 2s - loss: 0.0531
Epoch 26/80
 - 2s - loss: 0.0524
Epoch 27/80
 - 2s - loss: 0.0519
Epoch 28/80
 - 2s - loss: 0.0514
Epoch 29/80
 - 2s - loss: 0.0511
Epoch 30/80
 - 2s - loss: 0.0507
Epoch 31/80
 - 2s - loss: 0.0504
Epoch 32/80
 - 2s - loss: 0.0502
Epoch 33/80
 - 2s - loss: 0.0499
Epoch 34/80
 - 2s - loss: 0.0498
Epoch 35/80
 - 2s - loss: 0.0496
Epoch 36/80
 - 2s - loss: 0.0494
Epoch 37/80
 - 2s - loss: 0.0493
Epoch 38/80
 - 2s - loss: 0.0492
Epoch 39/80
 - 2s - loss: 0.0490
Epoch 40/80
 - 2s - loss: 0.0489
Epoch 41/80
 - 2s - loss: 0.0488
Epoch 42/80
 - 2s - loss: 0.0488
Epoch 43/80
 - 2s - loss: 0.0487
Epoch 44/80
 - 2s - loss: 0.0486
Epoch 45/80
 - 2s - loss: 0.0485
Epoch 46/80
 - 2s - loss: 0.0485
Epoch 47/80
 - 2s - loss: 0.0484
Epoch 48/80
 - 2s - loss: 0.0484
Epoch 49/80
 - 2s - loss: 0.0483
Epoch 50/80
 - 2s - loss: 0.0483
Epoch 51/80
 - 2s - loss: 0.0482
Epoch 52/80
 - 2s - loss: 0.0482
Epoch 53/80
 - 2s - loss: 0.0481
Epoch 54/80
 - 2s - loss: 0.0481
Epoch 55/80
 - 2s - loss: 0.0481
Epoch 56/80
 - 2s - loss: 0.0480
Epoch 57/80
 - 2s - loss: 0.0480
Epoch 58/80
 - 2s - loss: 0.0480
Epoch 59/80
 - 2s - loss: 0.0479
Epoch 60/80
 - 2s - loss: 0.0479
Epoch 61/80
 - 2s - loss: 0.0479
Epoch 62/80
 - 2s - loss: 0.0479
Epoch 63/80
 - 2s - loss: 0.0468
Epoch 64/80
 - 2s - loss: 0.0466
Epoch 65/80
 - 2s - loss: 0.0466
Epoch 66/80
 - 2s - loss: 0.0466
Epoch 67/80
 - 2s - loss: 0.0466
Epoch 68/80
 - 2s - loss: 0.0463
Epoch 69/80
 - 2s - loss: 0.0463
Epoch 70/80
 - 2s - loss: 0.0463
Epoch 71/80
 - 2s - loss: 0.0463
Epoch 72/80
 - 2s - loss: 0.0463
Epoch 73/80
 - 2s - loss: 0.0462
Epoch 74/80
 - 2s - loss: 0.0462
Epoch 75/80
 - 2s - loss: 0.0462
Epoch 76/80
 - 2s - loss: 0.0462
Epoch 77/80
 - 2s - loss: 0.0462
Epoch 78/80
 - 2s - loss: 0.0462
Epoch 79/80
 - 2s - loss: 0.0462
Epoch 80/80
 - 2s - loss: 0.0462
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28699 samples, validate on 7175 samples
Epoch 1/80
 - 1s - loss: 3.3432 - val_loss: 1.4033
AUC: 0.7958

Epoch 2/80
 - 0s - loss: 2.1562 - val_loss: 0.9244
AUC: 0.8104

Epoch 3/80
 - 0s - loss: 1.5419 - val_loss: 0.7174
AUC: 0.8240

Epoch 4/80
 - 0s - loss: 1.3112 - val_loss: 0.7076
AUC: 0.8312

Epoch 5/80
 - 0s - loss: 1.1786 - val_loss: 0.6746
AUC: 0.8340

Epoch 6/80
 - 0s - loss: 1.1533 - val_loss: 0.6607
AUC: 0.8387

Epoch 7/80
 - 0s - loss: 1.1110 - val_loss: 0.7487
AUC: 0.8437

Epoch 8/80
 - 0s - loss: 1.0884 - val_loss: 0.6376
AUC: 0.8437

Epoch 9/80
 - 0s - loss: 1.0780 - val_loss: 0.5822
AUC: 0.8449

Epoch 10/80
 - 0s - loss: 1.0728 - val_loss: 0.6329
AUC: 0.8488

Epoch 11/80
 - 0s - loss: 1.0594 - val_loss: 0.6409
AUC: 0.8493

Epoch 12/80
 - 0s - loss: 1.0508 - val_loss: 0.6091
AUC: 0.8502

Epoch 13/80
 - 0s - loss: 1.0388 - val_loss: 0.6642
AUC: 0.8523

Epoch 14/80
 - 0s - loss: 1.0360 - val_loss: 0.7033
AUC: 0.8535

Epoch 15/80
 - 0s - loss: 1.0298 - val_loss: 0.5984
AUC: 0.8518

Epoch 16/80
 - 0s - loss: 1.0282 - val_loss: 0.6831
AUC: 0.8561

Epoch 17/80
 - 0s - loss: 1.0196 - val_loss: 0.6215
AUC: 0.8550

Epoch 18/80
 - 0s - loss: 1.0124 - val_loss: 0.6293
AUC: 0.8557

Epoch 19/80
 - 0s - loss: 1.0070 - val_loss: 0.6380
AUC: 0.8558

Epoch 20/80
 - 0s - loss: 1.0081 - val_loss: 0.6223
AUC: 0.8562

Epoch 21/80
 - 0s - loss: 1.0056 - val_loss: 0.6152
AUC: 0.8562

Epoch 22/80
 - 0s - loss: 1.0097 - val_loss: 0.6193
AUC: 0.8566

Epoch 23/80
 - 0s - loss: 1.0042 - val_loss: 0.6356
AUC: 0.8572

Epoch 24/80
 - 0s - loss: 0.9943 - val_loss: 0.6424
AUC: 0.8576

Epoch 25/80
 - 0s - loss: 0.9999 - val_loss: 0.6180
AUC: 0.8572

Epoch 26/80
 - 0s - loss: 1.0015 - val_loss: 0.5960
AUC: 0.8570

Epoch 27/80
 - 0s - loss: 0.9927 - val_loss: 0.6101
AUC: 0.8572

Epoch 28/80
 - 0s - loss: 1.0012 - val_loss: 0.6141
AUC: 0.8574

Epoch 29/80
 - 0s - loss: 1.0002 - val_loss: 0.6193
AUC: 0.8579

Epoch 30/80
 - 0s - loss: 0.9942 - val_loss: 0.6249
AUC: 0.8580

Epoch 31/80
 - 0s - loss: 0.9915 - val_loss: 0.6216
AUC: 0.8580

Epoch 32/80
 - 0s - loss: 0.9934 - val_loss: 0.6228
AUC: 0.8580

Epoch 33/80
 - 0s - loss: 0.9928 - val_loss: 0.6195
AUC: 0.8579

Epoch 34/80
 - 0s - loss: 0.9920 - val_loss: 0.6181
AUC: 0.8578

Epoch 35/80
 - 0s - loss: 0.9936 - val_loss: 0.6214
AUC: 0.8580

Epoch 36/80
 - 0s - loss: 0.9997 - val_loss: 0.6164
AUC: 0.8578

Epoch 37/80
 - 0s - loss: 0.9956 - val_loss: 0.6264
AUC: 0.8581

Epoch 38/80
 - 0s - loss: 0.9959 - val_loss: 0.6247
AUC: 0.8580

Epoch 39/80
 - 0s - loss: 0.9983 - val_loss: 0.6237
AUC: 0.8580

Train on 28699 samples, validate on 7175 samples
Epoch 1/30
 - 1s - loss: 0.9920 - val_loss: 0.6457
AUC: 0.8586

Epoch 2/30
 - 0s - loss: 0.9957 - val_loss: 0.6154
AUC: 0.8585

Epoch 3/30
 - 0s - loss: 0.9893 - val_loss: 0.6183
AUC: 0.8583

Epoch 4/30
 - 0s - loss: 0.9908 - val_loss: 0.6226
AUC: 0.8588

Epoch 5/30
 - 0s - loss: 0.9907 - val_loss: 0.6340
AUC: 0.8589

Epoch 6/30
 - 0s - loss: 0.9875 - val_loss: 0.6299
AUC: 0.8591

Epoch 7/30
 - 0s - loss: 0.9867 - val_loss: 0.6035
AUC: 0.8588

Epoch 8/30
 - 0s - loss: 0.9829 - val_loss: 0.6151
AUC: 0.8592

Epoch 9/30
 - 0s - loss: 0.9876 - val_loss: 0.6162
AUC: 0.8594

Epoch 10/30
 - 0s - loss: 0.9772 - val_loss: 0.6321
AUC: 0.8597

Epoch 11/30
 - 0s - loss: 0.9770 - val_loss: 0.6179
AUC: 0.8596

Epoch 12/30
 - 0s - loss: 0.9772 - val_loss: 0.6092
AUC: 0.8595

Epoch 13/30
 - 0s - loss: 0.9786 - val_loss: 0.6194
AUC: 0.8599

Epoch 14/30
 - 0s - loss: 0.9777 - val_loss: 0.6222
AUC: 0.8601

Epoch 15/30
 - 0s - loss: 0.9766 - val_loss: 0.6156
AUC: 0.8603

Epoch 16/30
 - 0s - loss: 0.9701 - val_loss: 0.6331
AUC: 0.8606

Epoch 17/30
 - 0s - loss: 0.9727 - val_loss: 0.6049
AUC: 0.8603

Epoch 18/30
 - 0s - loss: 0.9701 - val_loss: 0.6088
AUC: 0.8604

Epoch 19/30
 - 0s - loss: 0.9689 - val_loss: 0.6121
AUC: 0.8605

Epoch 20/30
 - 0s - loss: 0.9716 - val_loss: 0.6094
AUC: 0.8605

Epoch 21/30
 - 0s - loss: 0.9720 - val_loss: 0.6095
AUC: 0.8606

Epoch 22/30
 - 0s - loss: 0.9724 - val_loss: 0.6160
AUC: 0.8607

Epoch 23/30
 - 0s - loss: 0.9691 - val_loss: 0.6125
AUC: 0.8606

Epoch 24/30
 - 0s - loss: 0.9679 - val_loss: 0.6091
AUC: 0.8606

Epoch 25/30
 - 0s - loss: 0.9736 - val_loss: 0.6123
AUC: 0.8606

Epoch 26/30
 - 0s - loss: 0.9721 - val_loss: 0.6142
AUC: 0.8607

Epoch 27/30
 - 0s - loss: 0.9714 - val_loss: 0.6121
AUC: 0.8607

Epoch 28/30
 - 0s - loss: 0.9650 - val_loss: 0.6107
AUC: 0.8607

Epoch 29/30
 - 0s - loss: 0.9696 - val_loss: 0.6110
AUC: 0.8607

Epoch 30/30
 - 0s - loss: 0.9693 - val_loss: 0.6105
Using TensorFlow backend.
AUC: 0.8607

2019-03-08 12:05:55.490301: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:05:55.659543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:05:55.659589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:05:55.971946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:05:55.972002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:05:55.972012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:05:55.972307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35230 rows...
Finished. It takes 4.4 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 2s - loss: 2.3911
Epoch 2/80
 - 1s - loss: 0.7416
Epoch 3/80
 - 1s - loss: 0.2682
Epoch 4/80
 - 1s - loss: 0.2227
Epoch 5/80
 - 1s - loss: 0.2044
Epoch 6/80
 - 1s - loss: 0.1911
Epoch 7/80
 - 1s - loss: 0.1811
Epoch 8/80
 - 1s - loss: 0.1735
Epoch 9/80
 - 1s - loss: 0.1672
Epoch 10/80
 - 1s - loss: 0.1619
Epoch 11/80
 - 1s - loss: 0.1570
Epoch 12/80
 - 1s - loss: 0.1525
Epoch 13/80
 - 1s - loss: 0.1478
Epoch 14/80
 - 1s - loss: 0.1430
Epoch 15/80
 - 1s - loss: 0.1380
Epoch 16/80
 - 1s - loss: 0.1327
Epoch 17/80
 - 1s - loss: 0.1273
Epoch 18/80
 - 1s - loss: 0.1218
Epoch 19/80
 - 1s - loss: 0.1165
Epoch 20/80
 - 1s - loss: 0.1114
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 12:06:41.562617: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:06:41.728530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:06:41.728577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:06:42.019473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:06:42.019529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:06:42.019539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:06:42.019804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36244 rows...
Finished. It takes 5.6 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 4s - loss: 0.4940
Epoch 2/80
 - 4s - loss: 0.1141
Epoch 3/80
 - 4s - loss: 0.1037
Epoch 4/80
 - 4s - loss: 0.0943
Epoch 5/80
 - 4s - loss: 0.0849
Epoch 6/80
 - 4s - loss: 0.0778
Epoch 7/80
 - 4s - loss: 0.0717
Epoch 8/80
 - 4s - loss: 0.0658
Epoch 9/80
 - 4s - loss: 0.0605
Epoch 10/80
 - 4s - loss: 0.0561
Epoch 11/80
 - 4s - loss: 0.0526
Epoch 12/80
 - 4s - loss: 0.0498
Epoch 13/80
 - 4s - loss: 0.0475
Epoch 14/80
 - 4s - loss: 0.0456
Epoch 15/80
 - 4s - loss: 0.0440
Epoch 16/80
 - 4s - loss: 0.0428
Epoch 17/80
 - 4s - loss: 0.0418
Epoch 18/80
 - 4s - loss: 0.0410
Epoch 19/80
 - 4s - loss: 0.0403
Epoch 20/80
 - 4s - loss: 0.0398
Epoch 21/80
 - 4s - loss: 0.0394
Epoch 22/80
 - 4s - loss: 0.0390
Epoch 23/80
 - 4s - loss: 0.0387
Epoch 24/80
 - 4s - loss: 0.0384
Epoch 25/80
 - 4s - loss: 0.0382
Epoch 26/80
 - 4s - loss: 0.0380
Epoch 27/80
 - 4s - loss: 0.0378
Epoch 28/80
 - 4s - loss: 0.0377
Epoch 29/80
 - 4s - loss: 0.0375
Epoch 30/80
 - 4s - loss: 0.0374
Epoch 31/80
 - 4s - loss: 0.0373
Epoch 32/80
 - 4s - loss: 0.0372
Epoch 33/80
 - 4s - loss: 0.0371
Epoch 34/80
 - 4s - loss: 0.0371
Epoch 35/80
 - 4s - loss: 0.0370
Epoch 36/80
 - 4s - loss: 0.0369
Epoch 37/80
 - 4s - loss: 0.0369
Epoch 38/80
 - 4s - loss: 0.0368
Epoch 39/80
 - 4s - loss: 0.0368
Epoch 40/80
 - 4s - loss: 0.0367
Epoch 41/80
 - 4s - loss: 0.0367
Epoch 42/80
 - 4s - loss: 0.0366
Epoch 43/80
 - 4s - loss: 0.0366
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 12:09:43.019951: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:09:43.188975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:09:43.189032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:09:43.489863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:09:43.489921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:09:43.489930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:09:43.490188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35997 rows...
Finished. It takes 5.3 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.8094
Epoch 2/80
 - 3s - loss: 0.1630
Epoch 3/80
 - 3s - loss: 0.1451
Epoch 4/80
 - 3s - loss: 0.1383
Epoch 5/80
 - 3s - loss: 0.1295
Epoch 6/80
 - 3s - loss: 0.1184
Epoch 7/80
 - 3s - loss: 0.1079
Epoch 8/80
 - 3s - loss: 0.0992
Epoch 9/80
 - 3s - loss: 0.0915
Epoch 10/80
 - 3s - loss: 0.0847
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 12:10:28.671284: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:10:28.843165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:10:28.843211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:10:29.161272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:10:29.161318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:10:29.161328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:10:29.161624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35692 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3215
Epoch 2/80
 - 2s - loss: 0.2483
Epoch 3/80
 - 2s - loss: 0.1854
Epoch 4/80
 - 2s - loss: 0.1772
Epoch 5/80
 - 2s - loss: 0.1717
Epoch 6/80
 - 2s - loss: 0.1652
Epoch 7/80
 - 2s - loss: 0.1570
Epoch 8/80
 - 2s - loss: 0.1467
Epoch 9/80
 - 2s - loss: 0.1351
Epoch 10/80
 - 2s - loss: 0.1236
Epoch 11/80
 - 2s - loss: 0.1133
Epoch 12/80
 - 2s - loss: 0.1046
Epoch 13/80
 - 2s - loss: 0.0975
Epoch 14/80
 - 2s - loss: 0.0916
Epoch 15/80
 - 2s - loss: 0.0865
Epoch 16/80
 - 2s - loss: 0.0821
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 12:11:26.147007: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:11:26.324233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:11:26.324279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:11:26.618485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:11:26.618542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:11:26.618551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:11:26.618823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36264 rows...
Finished. It takes 5.6 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 5s - loss: 0.4664
Epoch 2/80
 - 4s - loss: 0.1118
Epoch 3/80
 - 4s - loss: 0.1036
Epoch 4/80
 - 4s - loss: 0.0983
Epoch 5/80
 - 4s - loss: 0.0912
Epoch 6/80
 - 4s - loss: 0.0821
Epoch 7/80
 - 4s - loss: 0.0726
Epoch 8/80
 - 4s - loss: 0.0647
Epoch 9/80
 - 4s - loss: 0.0587
Epoch 10/80
 - 4s - loss: 0.0542
Epoch 11/80
 - 4s - loss: 0.0506
Epoch 12/80
 - 4s - loss: 0.0478
Epoch 13/80
 - 4s - loss: 0.0456
Epoch 14/80
 - 4s - loss: 0.0439
Epoch 15/80
 - 4s - loss: 0.0426
Epoch 16/80
 - 4s - loss: 0.0415
Epoch 17/80
 - 4s - loss: 0.0407
Epoch 18/80
 - 4s - loss: 0.0400
Epoch 19/80
 - 4s - loss: 0.0394
Epoch 20/80
 - 4s - loss: 0.0389
Epoch 21/80
 - 4s - loss: 0.0385
Epoch 22/80
 - 4s - loss: 0.0382
Epoch 23/80
 - 4s - loss: 0.0379
Epoch 24/80
 - 4s - loss: 0.0376
Epoch 25/80
 - 4s - loss: 0.0374
Epoch 26/80
 - 4s - loss: 0.0372
Epoch 27/80
 - 4s - loss: 0.0371
Epoch 28/80
 - 4s - loss: 0.0369
Epoch 29/80
 - 4s - loss: 0.0368
Epoch 30/80
 - 4s - loss: 0.0367
Epoch 31/80
 - 4s - loss: 0.0366
Epoch 32/80
 - 4s - loss: 0.0365
Epoch 33/80
 - 4s - loss: 0.0364
Epoch 34/80
 - 4s - loss: 0.0363
Epoch 35/80
 - 4s - loss: 0.0362
Epoch 36/80
 - 4s - loss: 0.0362
Epoch 37/80
 - 4s - loss: 0.0361
Epoch 38/80
 - 4s - loss: 0.0360
Epoch 39/80
 - 4s - loss: 0.0360
Epoch 40/80
 - 4s - loss: 0.0360
Epoch 41/80
 - 4s - loss: 0.0359
Epoch 42/80
 - 4s - loss: 0.0359
Epoch 43/80
 - 4s - loss: 0.0358
Epoch 44/80
 - 4s - loss: 0.0358
Epoch 45/80
 - 4s - loss: 0.0358
Epoch 46/80
 - 4s - loss: 0.0357
Epoch 47/80
 - 4s - loss: 0.0357
Epoch 48/80
 - 4s - loss: 0.0346
Epoch 49/80
 - 4s - loss: 0.0344
Epoch 50/80
 - 4s - loss: 0.0344
Epoch 51/80
 - 4s - loss: 0.0344
Epoch 52/80
 - 4s - loss: 0.0344
Epoch 53/80
 - 4s - loss: 0.0341
Epoch 54/80
 - 4s - loss: 0.0341
Epoch 55/80
 - 4s - loss: 0.0341
Epoch 56/80
 - 4s - loss: 0.0341
Epoch 57/80
 - 4s - loss: 0.0340
Epoch 58/80
 - 4s - loss: 0.0340
Epoch 59/80
 - 4s - loss: 0.0340
Epoch 60/80
 - 4s - loss: 0.0340
Epoch 61/80
 - 4s - loss: 0.0340
Epoch 62/80
 - 4s - loss: 0.0340
Epoch 63/80
 - 4s - loss: 0.0340
Epoch 64/80
 - 4s - loss: 0.0340
Epoch 65/80
 - 4s - loss: 0.0340
Epoch 66/80
 - 4s - loss: 0.0340
Epoch 67/80
 - 4s - loss: 0.0340
Epoch 68/80
 - 4s - loss: 0.0340
Epoch 69/80
 - 4s - loss: 0.0340
Epoch 70/80
 - 4s - loss: 0.0340
Epoch 71/80
 - 4s - loss: 0.0340
Epoch 72/80
 - 4s - loss: 0.0340
Epoch 73/80
 - 4s - loss: 0.0340
Epoch 74/80
 - 4s - loss: 0.0340
Epoch 75/80
 - 4s - loss: 0.0340
Epoch 76/80
 - 4s - loss: 0.0340
Epoch 77/80
 - 4s - loss: 0.0340
Epoch 78/80
 - 4s - loss: 0.0340
Epoch 79/80
 - 4s - loss: 0.0340
Epoch 80/80
 - 4s - loss: 0.0340
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 29011 samples, validate on 7253 samples
Epoch 1/80
 - 1s - loss: 3.4835 - val_loss: 1.5633
AUC: 0.7891

Epoch 2/80
 - 0s - loss: 2.0829 - val_loss: 1.0079
AUC: 0.8142

Epoch 3/80
 - 0s - loss: 1.4598 - val_loss: 0.7619
AUC: 0.8267

Epoch 4/80
 - 0s - loss: 1.2384 - val_loss: 0.7197
AUC: 0.8388

Epoch 5/80
 - 0s - loss: 1.1584 - val_loss: 0.6671
AUC: 0.8442

Epoch 6/80
 - 0s - loss: 1.1260 - val_loss: 0.7024
AUC: 0.8473

Epoch 7/80
 - 0s - loss: 1.1018 - val_loss: 0.6421
AUC: 0.8494

Epoch 8/80
 - 0s - loss: 1.0928 - val_loss: 0.6430
AUC: 0.8520

Epoch 9/80
 - 0s - loss: 1.0750 - val_loss: 0.6850
AUC: 0.8567

Epoch 10/80
 - 0s - loss: 1.0663 - val_loss: 0.6134
AUC: 0.8566

Epoch 11/80
 - 0s - loss: 1.0610 - val_loss: 0.7427
AUC: 0.8593

Epoch 12/80
 - 0s - loss: 1.0516 - val_loss: 0.7270
AUC: 0.8610

Epoch 13/80
 - 0s - loss: 1.0416 - val_loss: 0.7085
AUC: 0.8634

Epoch 14/80
 - 0s - loss: 1.0437 - val_loss: 0.6526
AUC: 0.8635

Epoch 15/80
 - 0s - loss: 1.0338 - val_loss: 0.5926
AUC: 0.8635

Epoch 16/80
 - 0s - loss: 1.0304 - val_loss: 0.6474
AUC: 0.8641

Epoch 17/80
 - 0s - loss: 1.0277 - val_loss: 0.6310
AUC: 0.8639

Epoch 18/80
 - 0s - loss: 1.0194 - val_loss: 0.6339
AUC: 0.8654

Epoch 19/80
 - 0s - loss: 1.0188 - val_loss: 0.6459
AUC: 0.8672

Epoch 20/80
 - 0s - loss: 1.0188 - val_loss: 0.6210
AUC: 0.8671

Epoch 21/80
 - 0s - loss: 1.0143 - val_loss: 0.6945
AUC: 0.8678

Epoch 22/80
 - 0s - loss: 1.0143 - val_loss: 0.6108
AUC: 0.8676

Epoch 23/80
 - 0s - loss: 1.0054 - val_loss: 0.5928
AUC: 0.8673

Epoch 24/80
 - 0s - loss: 1.0036 - val_loss: 0.6273
AUC: 0.8689

Epoch 25/80
 - 0s - loss: 1.0008 - val_loss: 0.6255
AUC: 0.8706

Epoch 26/80
 - 0s - loss: 0.9949 - val_loss: 0.6545
AUC: 0.8701

Epoch 27/80
 - 0s - loss: 0.9967 - val_loss: 0.6370
AUC: 0.8702

Epoch 28/80
 - 0s - loss: 0.9922 - val_loss: 0.6790
AUC: 0.8706

Epoch 29/80
 - 0s - loss: 0.9897 - val_loss: 0.6431
AUC: 0.8702

Epoch 30/80
 - 0s - loss: 0.9889 - val_loss: 0.6343
AUC: 0.8703

Epoch 31/80
 - 0s - loss: 0.9891 - val_loss: 0.6768
AUC: 0.8706

Epoch 32/80
 - 0s - loss: 0.9880 - val_loss: 0.6154
AUC: 0.8707

Epoch 33/80
 - 0s - loss: 0.9851 - val_loss: 0.6505
AUC: 0.8706

Epoch 34/80
 - 0s - loss: 0.9866 - val_loss: 0.6398
AUC: 0.8705

Epoch 35/80
 - 0s - loss: 0.9848 - val_loss: 0.6087
AUC: 0.8704

Epoch 36/80
 - 0s - loss: 0.9842 - val_loss: 0.6342
AUC: 0.8705

Epoch 37/80
 - 0s - loss: 0.9854 - val_loss: 0.6250
AUC: 0.8705

Epoch 38/80
 - 0s - loss: 0.9857 - val_loss: 0.6286
AUC: 0.8706

Epoch 39/80
 - 0s - loss: 0.9831 - val_loss: 0.6305
AUC: 0.8707

Epoch 40/80
 - 0s - loss: 0.9843 - val_loss: 0.6360
AUC: 0.8707

Epoch 41/80
 - 0s - loss: 0.9871 - val_loss: 0.6310
AUC: 0.8708

Epoch 42/80
 - 0s - loss: 0.9847 - val_loss: 0.6296
AUC: 0.8709

Epoch 43/80
 - 0s - loss: 0.9846 - val_loss: 0.6307
AUC: 0.8708

Epoch 44/80
 - 0s - loss: 0.9844 - val_loss: 0.6228
AUC: 0.8708

Epoch 45/80
 - 0s - loss: 0.9860 - val_loss: 0.6349
AUC: 0.8709

Train on 29011 samples, validate on 7253 samples
Epoch 1/30
 - 1s - loss: 0.9889 - val_loss: 0.6148
AUC: 0.8708

Epoch 2/30
 - 0s - loss: 0.9795 - val_loss: 0.6140
AUC: 0.8710

Epoch 3/30
 - 0s - loss: 0.9813 - val_loss: 0.6138
AUC: 0.8711

Epoch 4/30
 - 0s - loss: 0.9801 - val_loss: 0.6080
AUC: 0.8713

Epoch 5/30
 - 0s - loss: 0.9733 - val_loss: 0.6223
AUC: 0.8717

Epoch 6/30
 - 0s - loss: 0.9794 - val_loss: 0.6303
AUC: 0.8717

Epoch 7/30
 - 0s - loss: 0.9743 - val_loss: 0.6265
AUC: 0.8718

Epoch 8/30
 - 0s - loss: 0.9732 - val_loss: 0.6321
AUC: 0.8721

Epoch 9/30
 - 0s - loss: 0.9703 - val_loss: 0.6200
AUC: 0.8721

Epoch 10/30
 - 0s - loss: 0.9722 - val_loss: 0.6127
AUC: 0.8723

Epoch 11/30
 - 0s - loss: 0.9664 - val_loss: 0.6097
AUC: 0.8724

Epoch 12/30
 - 0s - loss: 0.9659 - val_loss: 0.6175
AUC: 0.8726

Epoch 13/30
 - 0s - loss: 0.9641 - val_loss: 0.6215
AUC: 0.8727

Epoch 14/30
 - 0s - loss: 0.9635 - val_loss: 0.6174
AUC: 0.8727

Epoch 15/30
 - 0s - loss: 0.9635 - val_loss: 0.6176
AUC: 0.8728

Epoch 16/30
 - 0s - loss: 0.9642 - val_loss: 0.6214
AUC: 0.8728

Epoch 17/30
 - 0s - loss: 0.9616 - val_loss: 0.6182
AUC: 0.8728

Epoch 18/30
 - 0s - loss: 0.9574 - val_loss: 0.6207
AUC: 0.8728

Epoch 19/30
 - 0s - loss: 0.9646 - val_loss: 0.6141
AUC: 0.8728

Epoch 20/30
 - 0s - loss: 0.9628 - val_loss: 0.6178
AUC: 0.8729

Epoch 21/30
 - 0s - loss: 0.9583 - val_loss: 0.6166
AUC: 0.8729

Epoch 22/30
 - 0s - loss: 0.9613 - val_loss: 0.6178
AUC: 0.8730

Epoch 23/30
 - 0s - loss: 0.9553 - val_loss: 0.6138
AUC: 0.8730

Epoch 24/30
 - 0s - loss: 0.9591 - val_loss: 0.6146
AUC: 0.8730

Epoch 25/30
 - 0s - loss: 0.9580 - val_loss: 0.6153
AUC: 0.8730

Epoch 26/30
 - 0s - loss: 0.9630 - val_loss: 0.6165
AUC: 0.8730

Epoch 27/30
 - 0s - loss: 0.9569 - val_loss: 0.6164
AUC: 0.8730

Epoch 28/30
 - 0s - loss: 0.9564 - val_loss: 0.6163
AUC: 0.8730

Epoch 29/30
 - 0s - loss: 0.9576 - val_loss: 0.6162
AUC: 0.8730

Epoch 30/30
 - 0s - loss: 0.9546 - val_loss: 0.6150
Using TensorFlow backend.
AUC: 0.8730

2019-03-08 12:17:46.368573: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:17:46.541555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:17:46.541611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:17:46.843313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:17:46.843369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:17:46.843378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:17:46.843669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36115 rows...
Finished. It takes 5.6 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 4s - loss: 0.6425
Epoch 2/80
 - 3s - loss: 0.1377
Epoch 3/80
 - 3s - loss: 0.1240
Epoch 4/80
 - 3s - loss: 0.1161
Epoch 5/80
 - 3s - loss: 0.1075
Epoch 6/80
 - 3s - loss: 0.0977
Epoch 7/80
 - 3s - loss: 0.0878
Epoch 8/80
 - 3s - loss: 0.0798
Epoch 9/80
 - 3s - loss: 0.0733
Epoch 10/80
 - 3s - loss: 0.0679
Epoch 11/80
 - 3s - loss: 0.0634
Epoch 12/80
 - 3s - loss: 0.0597
Epoch 13/80
 - 3s - loss: 0.0565
Epoch 14/80
 - 3s - loss: 0.0540
Epoch 15/80
 - 3s - loss: 0.0519
Epoch 16/80
 - 3s - loss: 0.0503
Epoch 17/80
 - 3s - loss: 0.0489
Epoch 18/80
 - 3s - loss: 0.0478
Epoch 19/80
 - 3s - loss: 0.0469
Epoch 20/80
 - 3s - loss: 0.0462
Epoch 21/80
 - 3s - loss: 0.0456
Epoch 22/80
 - 3s - loss: 0.0451
Epoch 23/80
 - 3s - loss: 0.0447
Epoch 24/80
 - 3s - loss: 0.0443
Epoch 25/80
 - 3s - loss: 0.0440
Epoch 26/80
 - 3s - loss: 0.0437
Epoch 27/80
 - 3s - loss: 0.0435
Epoch 28/80
 - 3s - loss: 0.0433
Epoch 29/80
 - 3s - loss: 0.0431
Epoch 30/80
 - 3s - loss: 0.0430
Epoch 31/80
 - 3s - loss: 0.0428
Epoch 32/80
 - 3s - loss: 0.0427
Epoch 33/80
 - 3s - loss: 0.0426
Epoch 34/80
 - 3s - loss: 0.0425
Epoch 35/80
 - 3s - loss: 0.0423
Epoch 36/80
 - 3s - loss: 0.0423
Epoch 37/80
 - 3s - loss: 0.0422
Epoch 38/80
 - 3s - loss: 0.0421
Epoch 39/80
 - 3s - loss: 0.0420
Epoch 40/80
 - 3s - loss: 0.0420
Epoch 41/80
 - 3s - loss: 0.0419
Epoch 42/80
 - 3s - loss: 0.0419
Epoch 43/80
 - 3s - loss: 0.0418
Epoch 44/80
 - 3s - loss: 0.0418
Epoch 45/80
 - 3s - loss: 0.0417
Epoch 46/80
 - 3s - loss: 0.0417
Epoch 47/80
 - 3s - loss: 0.0417
Epoch 48/80
 - 3s - loss: 0.0416
Epoch 49/80
 - 3s - loss: 0.0416
Epoch 50/80
 - 3s - loss: 0.0416
Epoch 51/80
 - 3s - loss: 0.0415
Epoch 52/80
 - 3s - loss: 0.0415
Epoch 53/80
 - 3s - loss: 0.0415
Epoch 54/80
 - 3s - loss: 0.0403
Epoch 55/80
 - 3s - loss: 0.0402
Epoch 56/80
 - 3s - loss: 0.0402
Epoch 57/80
 - 3s - loss: 0.0402
Epoch 58/80
 - 3s - loss: 0.0402
Epoch 59/80
 - 3s - loss: 0.0399
Epoch 60/80
 - 3s - loss: 0.0399
Epoch 61/80
 - 3s - loss: 0.0399
Epoch 62/80
 - 3s - loss: 0.0399
Epoch 63/80
 - 3s - loss: 0.0398
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 12:21:20.498333: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:21:20.665051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:21:20.665096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:21:20.973776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:21:20.973834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:21:20.973843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:21:20.974118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1642
Epoch 2/80
 - 2s - loss: 0.2204
Epoch 3/80
 - 2s - loss: 0.1730
Epoch 4/80
 - 2s - loss: 0.1646
Epoch 5/80
 - 2s - loss: 0.1573
Epoch 6/80
 - 2s - loss: 0.1474
Epoch 7/80
 - 2s - loss: 0.1350
Epoch 8/80
 - 2s - loss: 0.1231
Epoch 9/80
 - 2s - loss: 0.1136
Epoch 10/80
 - 2s - loss: 0.1058
Epoch 11/80
 - 2s - loss: 0.0988
Epoch 12/80
 - 2s - loss: 0.0922
Epoch 13/80
 - 2s - loss: 0.0862
Epoch 14/80
 - 2s - loss: 0.0810
Epoch 15/80
 - 2s - loss: 0.0765
Epoch 16/80
 - 2s - loss: 0.0728
Epoch 17/80
 - 2s - loss: 0.0696
Epoch 18/80
 - 2s - loss: 0.0669
Epoch 19/80
 - 2s - loss: 0.0645
Epoch 20/80
 - 2s - loss: 0.0626
Epoch 21/80
 - 2s - loss: 0.0609
Epoch 22/80
 - 2s - loss: 0.0594
Epoch 23/80
 - 2s - loss: 0.0583
Epoch 24/80
 - 2s - loss: 0.0572
Epoch 25/80
 - 2s - loss: 0.0564
Epoch 26/80
 - 2s - loss: 0.0556
Epoch 27/80
 - 2s - loss: 0.0550
Epoch 28/80
 - 2s - loss: 0.0545
Epoch 29/80
 - 2s - loss: 0.0540
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 12:22:46.811959: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:22:46.983224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:22:46.983271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:22:47.277816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:22:47.277873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:22:47.277883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:22:47.278148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36278 rows...
Finished. It takes 5.7 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 5s - loss: 0.4448
Epoch 2/80
 - 4s - loss: 0.1070
Epoch 3/80
 - 4s - loss: 0.0958
Epoch 4/80
 - 4s - loss: 0.0878
Epoch 5/80
 - 4s - loss: 0.0816
Epoch 6/80
 - 4s - loss: 0.0757
Epoch 7/80
 - 4s - loss: 0.0693
Epoch 8/80
 - 4s - loss: 0.0630
Epoch 9/80
 - 4s - loss: 0.0577
Epoch 10/80
 - 4s - loss: 0.0534
Epoch 11/80
 - 4s - loss: 0.0497
Epoch 12/80
 - 4s - loss: 0.0467
Epoch 13/80
 - 4s - loss: 0.0444
Epoch 14/80
 - 4s - loss: 0.0427
Epoch 15/80
 - 4s - loss: 0.0413
Epoch 16/80
 - 4s - loss: 0.0402
Epoch 17/80
 - 4s - loss: 0.0393
Epoch 18/80
 - 4s - loss: 0.0386
Epoch 19/80
 - 4s - loss: 0.0381
Epoch 20/80
 - 4s - loss: 0.0376
Epoch 21/80
 - 4s - loss: 0.0372
Epoch 22/80
 - 4s - loss: 0.0369
Epoch 23/80
 - 4s - loss: 0.0366
Epoch 24/80
 - 4s - loss: 0.0364
Epoch 25/80
 - 4s - loss: 0.0362
Epoch 26/80
 - 4s - loss: 0.0360
Epoch 27/80
 - 4s - loss: 0.0359
Epoch 28/80
 - 4s - loss: 0.0357
Epoch 29/80
 - 4s - loss: 0.0356
Epoch 30/80
 - 4s - loss: 0.0355
Epoch 31/80
 - 4s - loss: 0.0354
Epoch 32/80
 - 4s - loss: 0.0353
Epoch 33/80
 - 4s - loss: 0.0352
Epoch 34/80
 - 4s - loss: 0.0352
Epoch 35/80
 - 4s - loss: 0.0351
Epoch 36/80
 - 4s - loss: 0.0350
Epoch 37/80
 - 4s - loss: 0.0350
Epoch 38/80
 - 4s - loss: 0.0349
Epoch 39/80
 - 4s - loss: 0.0349
Epoch 40/80
 - 4s - loss: 0.0348
Epoch 41/80
 - 4s - loss: 0.0348
Epoch 42/80
 - 4s - loss: 0.0348
Epoch 43/80
 - 4s - loss: 0.0347
Epoch 44/80
 - 4s - loss: 0.0347
Epoch 45/80
 - 4s - loss: 0.0347
Epoch 46/80
 - 4s - loss: 0.0346
Epoch 47/80
 - 4s - loss: 0.0335
Epoch 48/80
 - 4s - loss: 0.0334
Epoch 49/80
 - 4s - loss: 0.0333
Epoch 50/80
 - 4s - loss: 0.0333
Epoch 51/80
 - 4s - loss: 0.0333
Epoch 52/80
 - 4s - loss: 0.0330
Epoch 53/80
 - 4s - loss: 0.0330
Epoch 54/80
 - 4s - loss: 0.0330
Epoch 55/80
 - 4s - loss: 0.0330
Epoch 56/80
 - 4s - loss: 0.0330
Epoch 57/80
 - 4s - loss: 0.0330
Epoch 58/80
 - 4s - loss: 0.0330
Epoch 59/80
 - 4s - loss: 0.0329
Epoch 60/80
 - 4s - loss: 0.0329
Epoch 61/80
 - 4s - loss: 0.0329
Epoch 62/80
 - 4s - loss: 0.0329
Epoch 63/80
 - 4s - loss: 0.0329
Epoch 64/80
 - 4s - loss: 0.0329
Epoch 65/80
 - 4s - loss: 0.0329
Epoch 66/80
 - 4s - loss: 0.0329
Epoch 67/80
 - 4s - loss: 0.0329
Epoch 68/80
 - 4s - loss: 0.0329
Epoch 69/80
 - 4s - loss: 0.0329
Epoch 70/80
 - 4s - loss: 0.0329
Epoch 71/80
 - 4s - loss: 0.0329
Epoch 72/80
 - 4s - loss: 0.0329
Epoch 73/80
 - 4s - loss: 0.0329
Epoch 74/80
 - 4s - loss: 0.0329
Epoch 75/80
 - 4s - loss: 0.0329
Epoch 76/80
 - 4s - loss: 0.0329
Epoch 77/80
 - 4s - loss: 0.0329
Epoch 78/80
 - 4s - loss: 0.0329
Epoch 79/80
 - 4s - loss: 0.0329
Epoch 80/80
 - 4s - loss: 0.0329
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 29022 samples, validate on 7256 samples
Epoch 1/80
 - 1s - loss: 6.1419 - val_loss: 2.5188
AUC: 0.7881

Epoch 2/80
 - 0s - loss: 4.1269 - val_loss: 1.3584
AUC: 0.8078

Epoch 3/80
 - 0s - loss: 2.9467 - val_loss: 1.2710
AUC: 0.8261

Epoch 4/80
 - 0s - loss: 1.8768 - val_loss: 0.7505
AUC: 0.8313

Epoch 5/80
 - 0s - loss: 1.4782 - val_loss: 0.7708
AUC: 0.8363

Epoch 6/80
 - 0s - loss: 1.2677 - val_loss: 0.7415
AUC: 0.8383

Epoch 7/80
 - 0s - loss: 1.2063 - val_loss: 0.6940
AUC: 0.8408

Epoch 8/80
 - 0s - loss: 1.1739 - val_loss: 0.6555
AUC: 0.8415

Epoch 9/80
 - 0s - loss: 1.1374 - val_loss: 0.7168
AUC: 0.8476

Epoch 10/80
 - 0s - loss: 1.1235 - val_loss: 0.7570
AUC: 0.8494

Epoch 11/80
 - 0s - loss: 1.1088 - val_loss: 0.7602
AUC: 0.8506

Epoch 12/80
 - 0s - loss: 1.1061 - val_loss: 0.6784
AUC: 0.8497

Epoch 13/80
 - 0s - loss: 1.0861 - val_loss: 0.6676
AUC: 0.8526

Epoch 14/80
 - 0s - loss: 1.0798 - val_loss: 0.6760
AUC: 0.8524

Epoch 15/80
 - 0s - loss: 1.0720 - val_loss: 0.6589
AUC: 0.8536

Epoch 16/80
 - 0s - loss: 1.0609 - val_loss: 0.6448
AUC: 0.8543

Epoch 17/80
 - 0s - loss: 1.0547 - val_loss: 0.6771
AUC: 0.8564

Epoch 18/80
 - 0s - loss: 1.0546 - val_loss: 0.6709
AUC: 0.8571

Epoch 19/80
 - 0s - loss: 1.0455 - val_loss: 0.6498
AUC: 0.8563

Epoch 20/80
 - 0s - loss: 1.0415 - val_loss: 0.6225
AUC: 0.8563

Epoch 21/80
 - 0s - loss: 1.0479 - val_loss: 0.6219
AUC: 0.8570

Epoch 22/80
 - 0s - loss: 1.0407 - val_loss: 0.6393
AUC: 0.8568

Epoch 23/80
 - 0s - loss: 1.0364 - val_loss: 0.6679
AUC: 0.8589

Epoch 24/80
 - 0s - loss: 1.0307 - val_loss: 0.6299
AUC: 0.8590

Epoch 25/80
 - 0s - loss: 1.0214 - val_loss: 0.6672
AUC: 0.8596

Epoch 26/80
 - 0s - loss: 1.0292 - val_loss: 0.6047
AUC: 0.8592

Epoch 27/80
 - 0s - loss: 1.0178 - val_loss: 0.6434
AUC: 0.8592

Epoch 28/80
 - 0s - loss: 1.0219 - val_loss: 0.6824
AUC: 0.8606

Epoch 29/80
 - 0s - loss: 1.0151 - val_loss: 0.6498
AUC: 0.8610

Epoch 30/80
 - 0s - loss: 1.0176 - val_loss: 0.6555
AUC: 0.8620

Epoch 31/80
 - 0s - loss: 1.0100 - val_loss: 0.6112
AUC: 0.8606

Epoch 32/80
 - 0s - loss: 1.0076 - val_loss: 0.5960
AUC: 0.8601

Epoch 33/80
 - 0s - loss: 1.0084 - val_loss: 0.6929
AUC: 0.8617

Epoch 34/80
 - 0s - loss: 1.0082 - val_loss: 0.6722
AUC: 0.8616

Epoch 35/80
 - 0s - loss: 1.0058 - val_loss: 0.6446
AUC: 0.8620

Epoch 36/80
 - 0s - loss: 1.0044 - val_loss: 0.6092
AUC: 0.8624

Epoch 37/80
 - 0s - loss: 1.0018 - val_loss: 0.5807
AUC: 0.8614

Epoch 38/80
 - 0s - loss: 0.9965 - val_loss: 0.6538
AUC: 0.8619

Epoch 39/80
 - 0s - loss: 0.9932 - val_loss: 0.6072
AUC: 0.8618

Epoch 40/80
 - 0s - loss: 0.9976 - val_loss: 0.5847
AUC: 0.8619

Epoch 41/80
 - 0s - loss: 0.9893 - val_loss: 0.6264
AUC: 0.8623

Epoch 42/80
 - 0s - loss: 0.9971 - val_loss: 0.6491
AUC: 0.8623

Epoch 43/80
 - 0s - loss: 0.9929 - val_loss: 0.6128
AUC: 0.8625

Epoch 44/80
 - 0s - loss: 0.9920 - val_loss: 0.6413
AUC: 0.8633

Epoch 45/80
 - 0s - loss: 0.9882 - val_loss: 0.5764
AUC: 0.8629

Epoch 46/80
 - 0s - loss: 0.9867 - val_loss: 0.6332
AUC: 0.8631

Epoch 47/80
 - 0s - loss: 0.9859 - val_loss: 0.6497
AUC: 0.8643

Epoch 48/80
 - 0s - loss: 0.9840 - val_loss: 0.6271
AUC: 0.8642

Epoch 49/80
 - 0s - loss: 0.9842 - val_loss: 0.5923
AUC: 0.8639

Epoch 50/80
 - 0s - loss: 0.9778 - val_loss: 0.6215
AUC: 0.8631

Epoch 51/80
 - 0s - loss: 0.9785 - val_loss: 0.5887
AUC: 0.8634

Epoch 52/80
 - 0s - loss: 0.9737 - val_loss: 0.5969
AUC: 0.8641

Epoch 53/80
 - 0s - loss: 0.9750 - val_loss: 0.6268
AUC: 0.8644

Epoch 54/80
 - 0s - loss: 0.9763 - val_loss: 0.6236
AUC: 0.8642

Epoch 55/80
 - 0s - loss: 0.9757 - val_loss: 0.6264
AUC: 0.8638

Epoch 56/80
 - 0s - loss: 0.9671 - val_loss: 0.6078
AUC: 0.8641

Epoch 57/80
 - 0s - loss: 0.9649 - val_loss: 0.6235
AUC: 0.8641

Epoch 58/80
 - 0s - loss: 0.9631 - val_loss: 0.6359
AUC: 0.8641

Epoch 59/80
 - 0s - loss: 0.9571 - val_loss: 0.6185
AUC: 0.8641

Epoch 60/80
 - 0s - loss: 0.9613 - val_loss: 0.6129
AUC: 0.8641

Epoch 61/80
 - 0s - loss: 0.9587 - val_loss: 0.6082
AUC: 0.8641

Epoch 62/80
 - 0s - loss: 0.9614 - val_loss: 0.6120
AUC: 0.8642

Epoch 63/80
 - 0s - loss: 0.9624 - val_loss: 0.6135
AUC: 0.8642

Epoch 64/80
 - 0s - loss: 0.9591 - val_loss: 0.6024
AUC: 0.8643

Epoch 65/80
 - 0s - loss: 0.9574 - val_loss: 0.6152
AUC: 0.8647

Epoch 66/80
 - 0s - loss: 0.9623 - val_loss: 0.6041
AUC: 0.8644

Epoch 67/80
 - 0s - loss: 0.9564 - val_loss: 0.6020
AUC: 0.8644

Epoch 68/80
 - 0s - loss: 0.9575 - val_loss: 0.6043
AUC: 0.8644

Epoch 69/80
 - 0s - loss: 0.9539 - val_loss: 0.6046
AUC: 0.8643

Epoch 70/80
 - 0s - loss: 0.9582 - val_loss: 0.6035
AUC: 0.8642

Epoch 71/80
 - 0s - loss: 0.9515 - val_loss: 0.6066
AUC: 0.8642

Epoch 72/80
 - 0s - loss: 0.9551 - val_loss: 0.6028
AUC: 0.8643

Epoch 73/80
 - 0s - loss: 0.9575 - val_loss: 0.5999
AUC: 0.8643

Epoch 74/80
 - 0s - loss: 0.9585 - val_loss: 0.6030
AUC: 0.8644

Epoch 75/80
 - 0s - loss: 0.9579 - val_loss: 0.6081
AUC: 0.8644

Train on 29022 samples, validate on 7256 samples
Epoch 1/30
 - 1s - loss: 0.9567 - val_loss: 0.5948
AUC: 0.8643

Epoch 2/30
 - 0s - loss: 0.9539 - val_loss: 0.6063
AUC: 0.8647

Epoch 3/30
 - 0s - loss: 0.9591 - val_loss: 0.6189
AUC: 0.8650

Epoch 4/30
 - 0s - loss: 0.9535 - val_loss: 0.6039
AUC: 0.8647

Epoch 5/30
 - 0s - loss: 0.9551 - val_loss: 0.5989
AUC: 0.8649

Epoch 6/30
 - 0s - loss: 0.9547 - val_loss: 0.6037
AUC: 0.8652

Epoch 7/30
 - 0s - loss: 0.9512 - val_loss: 0.5979
AUC: 0.8652

Epoch 8/30
 - 0s - loss: 0.9536 - val_loss: 0.6055
AUC: 0.8654

Epoch 9/30
 - 0s - loss: 0.9473 - val_loss: 0.5966
AUC: 0.8654

Epoch 10/30
 - 0s - loss: 0.9437 - val_loss: 0.6013
AUC: 0.8656

Epoch 11/30
 - 0s - loss: 0.9416 - val_loss: 0.5986
AUC: 0.8656

Epoch 12/30
 - 0s - loss: 0.9462 - val_loss: 0.5985
AUC: 0.8657

Epoch 13/30
 - 0s - loss: 0.9414 - val_loss: 0.5980
AUC: 0.8657

Epoch 14/30
 - 0s - loss: 0.9468 - val_loss: 0.5985
AUC: 0.8658

Epoch 15/30
 - 0s - loss: 0.9426 - val_loss: 0.6000
AUC: 0.8658

Epoch 16/30
 - 0s - loss: 0.9422 - val_loss: 0.5970
AUC: 0.8657

Epoch 17/30
 - 0s - loss: 0.9393 - val_loss: 0.5948
AUC: 0.8657

Epoch 18/30
 - 0s - loss: 0.9419 - val_loss: 0.5983
AUC: 0.8658

Epoch 19/30
 - 0s - loss: 0.9405 - val_loss: 0.5965
AUC: 0.8658

Epoch 20/30
 - 0s - loss: 0.9390 - val_loss: 0.5951
AUC: 0.8659

Epoch 21/30
 - 0s - loss: 0.9406 - val_loss: 0.5967
AUC: 0.8658

Epoch 22/30
 - 0s - loss: 0.9454 - val_loss: 0.5966
AUC: 0.8658

Epoch 23/30
 - 0s - loss: 0.9406 - val_loss: 0.5967
AUC: 0.8658

Epoch 24/30
 - 0s - loss: 0.9418 - val_loss: 0.5966
AUC: 0.8658

Epoch 25/30
 - 0s - loss: 0.9394 - val_loss: 0.5971
AUC: 0.8658

Epoch 26/30
 - 0s - loss: 0.9390 - val_loss: 0.5963
AUC: 0.8658

Epoch 27/30
 - 0s - loss: 0.9395 - val_loss: 0.5968
AUC: 0.8658

Epoch 28/30
 - 0s - loss: 0.9407 - val_loss: 0.5967
AUC: 0.8658

Epoch 29/30
 - 0s - loss: 0.9408 - val_loss: 0.5967
AUC: 0.8659

Epoch 30/30
 - 0s - loss: 0.9361 - val_loss: 0.5965
Using TensorFlow backend.
AUC: 0.8658

2019-03-08 12:29:29.945644: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:29:30.115887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:29:30.115936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:29:30.414996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:29:30.415065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:29:30.415074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:29:30.415340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36194 rows...
Finished. It takes 5.5 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 4s - loss: 0.5491
Epoch 2/80
 - 3s - loss: 0.1234
Epoch 3/80
 - 3s - loss: 0.1142
Epoch 4/80
 - 3s - loss: 0.1072
Epoch 5/80
 - 3s - loss: 0.0980
Epoch 6/80
 - 3s - loss: 0.0888
Epoch 7/80
 - 3s - loss: 0.0801
Epoch 8/80
 - 3s - loss: 0.0725
Epoch 9/80
 - 3s - loss: 0.0663
Epoch 10/80
 - 3s - loss: 0.0612
Epoch 11/80
 - 3s - loss: 0.0572
Epoch 12/80
 - 3s - loss: 0.0540
Epoch 13/80
 - 3s - loss: 0.0515
Epoch 14/80
 - 3s - loss: 0.0495
Epoch 15/80
 - 3s - loss: 0.0478
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 12:30:44.663031: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:30:44.841653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:30:44.841708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:30:45.183841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:30:45.183889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:30:45.183900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:30:45.184217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35874 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9465
Epoch 2/80
 - 2s - loss: 0.1851
Epoch 3/80
 - 2s - loss: 0.1605
Epoch 4/80
 - 2s - loss: 0.1556
Epoch 5/80
 - 2s - loss: 0.1513
Epoch 6/80
 - 2s - loss: 0.1454
Epoch 7/80
 - 2s - loss: 0.1371
Epoch 8/80
 - 2s - loss: 0.1260
Epoch 9/80
 - 2s - loss: 0.1137
Epoch 10/80
 - 2s - loss: 0.1026
Epoch 11/80
 - 2s - loss: 0.0934
Epoch 12/80
 - 2s - loss: 0.0859
Epoch 13/80
 - 2s - loss: 0.0796
Epoch 14/80
 - 2s - loss: 0.0746
Epoch 15/80
 - 2s - loss: 0.0705
Epoch 16/80
 - 2s - loss: 0.0672
Epoch 17/80
 - 2s - loss: 0.0644
Epoch 18/80
 - 2s - loss: 0.0621
Epoch 19/80
 - 2s - loss: 0.0602
Epoch 20/80
 - 2s - loss: 0.0585
Epoch 21/80
 - 2s - loss: 0.0571
Epoch 22/80
 - 2s - loss: 0.0559
Epoch 23/80
 - 2s - loss: 0.0549
Epoch 24/80
 - 2s - loss: 0.0540
Epoch 25/80
 - 2s - loss: 0.0533
Epoch 26/80
 - 2s - loss: 0.0526
Epoch 27/80
 - 2s - loss: 0.0521
Epoch 28/80
 - 2s - loss: 0.0516
Epoch 29/80
 - 2s - loss: 0.0512
Epoch 30/80
 - 2s - loss: 0.0509
Epoch 31/80
 - 2s - loss: 0.0506
Epoch 32/80
 - 2s - loss: 0.0503
Epoch 33/80
 - 2s - loss: 0.0500
Epoch 34/80
 - 2s - loss: 0.0498
Epoch 35/80
 - 2s - loss: 0.0496
Epoch 36/80
 - 2s - loss: 0.0495
Epoch 37/80
 - 2s - loss: 0.0493
Epoch 38/80
 - 2s - loss: 0.0492
Epoch 39/80
 - 2s - loss: 0.0491
Epoch 40/80
 - 2s - loss: 0.0490
Epoch 41/80
 - 2s - loss: 0.0488
Epoch 42/80
 - 2s - loss: 0.0487
Epoch 43/80
 - 2s - loss: 0.0487
Epoch 44/80
 - 2s - loss: 0.0486
Epoch 45/80
 - 2s - loss: 0.0485
Epoch 46/80
 - 2s - loss: 0.0484
Epoch 47/80
 - 2s - loss: 0.0484
Epoch 48/80
 - 2s - loss: 0.0483
Epoch 49/80
 - 2s - loss: 0.0483
Epoch 50/80
 - 2s - loss: 0.0482
Epoch 51/80
 - 2s - loss: 0.0482
Epoch 52/80
 - 2s - loss: 0.0481
Epoch 53/80
 - 2s - loss: 0.0481
Epoch 54/80
 - 2s - loss: 0.0480
Epoch 55/80
 - 2s - loss: 0.0480
Epoch 56/80
 - 2s - loss: 0.0480
Epoch 57/80
 - 2s - loss: 0.0479
Epoch 58/80
 - 2s - loss: 0.0468
Epoch 59/80
 - 2s - loss: 0.0467
Epoch 60/80
 - 2s - loss: 0.0467
Epoch 61/80
 - 2s - loss: 0.0467
Epoch 62/80
 - 2s - loss: 0.0466
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 12:33:22.881261: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:33:23.051892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:33:23.051938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:33:23.365673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:33:23.365726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:33:23.365735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:33:23.366007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35230 rows...
Finished. It takes 4.3 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 2s - loss: 2.3429
Epoch 2/80
 - 1s - loss: 0.6762
Epoch 3/80
 - 1s - loss: 0.2662
Epoch 4/80
 - 1s - loss: 0.2334
Epoch 5/80
 - 1s - loss: 0.2267
Epoch 6/80
 - 1s - loss: 0.2234
Epoch 7/80
 - 1s - loss: 0.2199
Epoch 8/80
 - 1s - loss: 0.2148
Epoch 9/80
 - 1s - loss: 0.2074
Epoch 10/80
 - 1s - loss: 0.1973
Epoch 11/80
 - 1s - loss: 0.1856
Epoch 12/80
 - 1s - loss: 0.1742
Epoch 13/80
 - 1s - loss: 0.1641
Epoch 14/80
 - 1s - loss: 0.1553
Epoch 15/80
 - 1s - loss: 0.1472
Epoch 16/80
 - 1s - loss: 0.1397
Epoch 17/80
 - 1s - loss: 0.1326
Epoch 18/80
 - 1s - loss: 0.1259
Epoch 19/80
 - 1s - loss: 0.1195
Epoch 20/80
 - 1s - loss: 0.1137
Epoch 21/80
 - 1s - loss: 0.1084
Epoch 22/80
 - 1s - loss: 0.1037
Epoch 23/80
 - 1s - loss: 0.0994
Epoch 24/80
 - 1s - loss: 0.0956
Epoch 25/80
 - 1s - loss: 0.0921
Epoch 26/80
 - 1s - loss: 0.0888
Epoch 27/80
 - 1s - loss: 0.0859
Epoch 28/80
 - 1s - loss: 0.0831
Epoch 29/80
 - 1s - loss: 0.0806
Epoch 30/80
 - 1s - loss: 0.0784
Epoch 31/80
 - 1s - loss: 0.0765
Epoch 32/80
 - 1s - loss: 0.0747
Epoch 33/80
 - 1s - loss: 0.0732
Epoch 34/80
 - 1s - loss: 0.0718
Epoch 35/80
 - 1s - loss: 0.0706
Epoch 36/80
 - 1s - loss: 0.0695
Epoch 37/80
 - 1s - loss: 0.0686
Epoch 38/80
 - 1s - loss: 0.0677
Epoch 39/80
 - 1s - loss: 0.0669
Epoch 40/80
 - 1s - loss: 0.0662
Epoch 41/80
 - 1s - loss: 0.0655
Epoch 42/80
 - 1s - loss: 0.0649
Epoch 43/80
 - 1s - loss: 0.0644
Epoch 44/80
 - 1s - loss: 0.0639
Epoch 45/80
 - 1s - loss: 0.0634
Epoch 46/80
 - 1s - loss: 0.0630
Epoch 47/80
 - 1s - loss: 0.0627
Epoch 48/80
 - 1s - loss: 0.0623
Epoch 49/80
 - 1s - loss: 0.0620
Epoch 50/80
 - 1s - loss: 0.0617
Epoch 51/80
 - 1s - loss: 0.0614
Epoch 52/80
 - 1s - loss: 0.0612
Epoch 53/80
 - 1s - loss: 0.0609
Epoch 54/80
 - 1s - loss: 0.0607
Epoch 55/80
 - 1s - loss: 0.0605
Epoch 56/80
 - 1s - loss: 0.0603
Epoch 57/80
 - 1s - loss: 0.0602
Epoch 58/80
 - 1s - loss: 0.0600
Epoch 59/80
 - 1s - loss: 0.0599
Epoch 60/80
 - 1s - loss: 0.0597
Epoch 61/80
 - 1s - loss: 0.0596
Epoch 62/80
 - 1s - loss: 0.0595
Epoch 63/80
 - 1s - loss: 0.0594
Epoch 64/80
 - 1s - loss: 0.0593
Epoch 65/80
 - 1s - loss: 0.0592
Epoch 66/80
 - 1s - loss: 0.0591
Epoch 67/80
 - 1s - loss: 0.0590
Epoch 68/80
 - 1s - loss: 0.0589
Epoch 69/80
 - 1s - loss: 0.0589
Epoch 70/80
 - 1s - loss: 0.0588
Epoch 71/80
 - 1s - loss: 0.0587
Epoch 72/80
 - 1s - loss: 0.0587
Epoch 73/80
 - 1s - loss: 0.0587
Epoch 74/80
 - 1s - loss: 0.0586
Epoch 75/80
 - 1s - loss: 0.0585
Epoch 76/80
 - 1s - loss: 0.0585
Epoch 77/80
 - 1s - loss: 0.0585
Epoch 78/80
 - 1s - loss: 0.0584
Epoch 79/80
 - 1s - loss: 0.0583
Epoch 80/80
 - 1s - loss: 0.0583
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28184 samples, validate on 7046 samples
Epoch 1/80
 - 1s - loss: 4.5232 - val_loss: 1.9320
AUC: 0.7864

Epoch 2/80
 - 0s - loss: 2.9381 - val_loss: 1.0399
AUC: 0.8056

Epoch 3/80
 - 0s - loss: 1.9253 - val_loss: 0.7693
AUC: 0.8193

Epoch 4/80
 - 0s - loss: 1.4618 - val_loss: 0.7130
AUC: 0.8242

Epoch 5/80
 - 0s - loss: 1.2828 - val_loss: 0.7570
AUC: 0.8291

Epoch 6/80
 - 0s - loss: 1.1946 - val_loss: 0.6815
AUC: 0.8325

Epoch 7/80
 - 0s - loss: 1.1616 - val_loss: 0.6111
AUC: 0.8347

Epoch 8/80
 - 0s - loss: 1.1454 - val_loss: 0.6508
AUC: 0.8389

Epoch 9/80
 - 0s - loss: 1.1119 - val_loss: 0.7131
AUC: 0.8411

Epoch 10/80
 - 0s - loss: 1.0987 - val_loss: 0.6422
AUC: 0.8421

Epoch 11/80
 - 0s - loss: 1.0909 - val_loss: 0.6904
AUC: 0.8437

Epoch 12/80
 - 0s - loss: 1.0826 - val_loss: 0.6753
AUC: 0.8443

Epoch 13/80
 - 0s - loss: 1.0748 - val_loss: 0.6725
AUC: 0.8458

Epoch 14/80
 - 0s - loss: 1.0674 - val_loss: 0.6726
AUC: 0.8463

Epoch 15/80
 - 0s - loss: 1.0647 - val_loss: 0.6669
AUC: 0.8479

Epoch 16/80
 - 0s - loss: 1.0606 - val_loss: 0.5942
AUC: 0.8466

Epoch 17/80
 - 0s - loss: 1.0584 - val_loss: 0.6431
AUC: 0.8490

Epoch 18/80
 - 0s - loss: 1.0462 - val_loss: 0.6158
AUC: 0.8483

Epoch 19/80
 - 0s - loss: 1.0386 - val_loss: 0.6475
AUC: 0.8500

Epoch 20/80
 - 0s - loss: 1.0503 - val_loss: 0.6803
AUC: 0.8510

Epoch 21/80
 - 0s - loss: 1.0394 - val_loss: 0.6340
AUC: 0.8503

Epoch 22/80
 - 0s - loss: 1.0409 - val_loss: 0.6466
AUC: 0.8512

Epoch 23/80
 - 0s - loss: 1.0330 - val_loss: 0.6038
AUC: 0.8517

Epoch 24/80
 - 0s - loss: 1.0295 - val_loss: 0.6476
AUC: 0.8527

Epoch 25/80
 - 0s - loss: 1.0330 - val_loss: 0.6449
AUC: 0.8526

Epoch 26/80
 - 0s - loss: 1.0128 - val_loss: 0.6515
AUC: 0.8521

Epoch 27/80
 - 0s - loss: 1.0133 - val_loss: 0.6452
AUC: 0.8524

Epoch 28/80
 - 0s - loss: 1.0117 - val_loss: 0.6395
AUC: 0.8524

Epoch 29/80
 - 0s - loss: 1.0134 - val_loss: 0.6262
AUC: 0.8524

Epoch 30/80
 - 0s - loss: 1.0168 - val_loss: 0.6536
AUC: 0.8529

Epoch 31/80
 - 0s - loss: 1.0114 - val_loss: 0.6265
AUC: 0.8527

Epoch 32/80
 - 0s - loss: 1.0116 - val_loss: 0.6368
AUC: 0.8527

Epoch 33/80
 - 0s - loss: 1.0131 - val_loss: 0.6233
AUC: 0.8527

Epoch 34/80
 - 0s - loss: 1.0110 - val_loss: 0.6013
AUC: 0.8525

Epoch 35/80
 - 0s - loss: 1.0129 - val_loss: 0.6443
AUC: 0.8532

Epoch 36/80
 - 0s - loss: 1.0109 - val_loss: 0.6306
AUC: 0.8531

Epoch 37/80
 - 0s - loss: 1.0069 - val_loss: 0.6347
AUC: 0.8531

Epoch 38/80
 - 0s - loss: 1.0009 - val_loss: 0.6283
AUC: 0.8530

Epoch 39/80
 - 0s - loss: 1.0069 - val_loss: 0.6312
AUC: 0.8531

Epoch 40/80
 - 0s - loss: 1.0053 - val_loss: 0.6332
AUC: 0.8531

Epoch 41/80
 - 0s - loss: 1.0035 - val_loss: 0.6232
AUC: 0.8531

Epoch 42/80
 - 0s - loss: 1.0049 - val_loss: 0.6143
AUC: 0.8530

Epoch 43/80
 - 0s - loss: 1.0047 - val_loss: 0.6255
AUC: 0.8531

Epoch 44/80
 - 0s - loss: 1.0063 - val_loss: 0.6265
AUC: 0.8531

Epoch 45/80
 - 0s - loss: 1.0066 - val_loss: 0.6284
AUC: 0.8532

Epoch 46/80
 - 0s - loss: 1.0046 - val_loss: 0.6294
AUC: 0.8533

Train on 28184 samples, validate on 7046 samples
Epoch 1/30
 - 1s - loss: 1.0066 - val_loss: 0.6179
AUC: 0.8530

Epoch 2/30
 - 0s - loss: 1.0055 - val_loss: 0.6346
AUC: 0.8533

Epoch 3/30
 - 0s - loss: 1.0013 - val_loss: 0.6212
AUC: 0.8536

Epoch 4/30
 - 0s - loss: 0.9972 - val_loss: 0.6175
AUC: 0.8536

Epoch 5/30
 - 0s - loss: 1.0011 - val_loss: 0.6401
AUC: 0.8540

Epoch 6/30
 - 0s - loss: 0.9989 - val_loss: 0.6300
AUC: 0.8539

Epoch 7/30
 - 0s - loss: 0.9979 - val_loss: 0.6117
AUC: 0.8538

Epoch 8/30
 - 0s - loss: 0.9965 - val_loss: 0.6263
AUC: 0.8540

Epoch 9/30
 - 0s - loss: 0.9970 - val_loss: 0.6288
AUC: 0.8541

Epoch 10/30
 - 0s - loss: 0.9925 - val_loss: 0.6018
AUC: 0.8540

Epoch 11/30
 - 0s - loss: 0.9940 - val_loss: 0.6334
AUC: 0.8546

Epoch 12/30
 - 0s - loss: 0.9941 - val_loss: 0.6251
AUC: 0.8548

Epoch 13/30
 - 0s - loss: 0.9949 - val_loss: 0.6343
AUC: 0.8549

Epoch 14/30
 - 0s - loss: 0.9904 - val_loss: 0.6123
AUC: 0.8547

Epoch 15/30
 - 0s - loss: 0.9928 - val_loss: 0.6199
AUC: 0.8549

Epoch 16/30
 - 0s - loss: 0.9858 - val_loss: 0.6314
AUC: 0.8550

Epoch 17/30
 - 0s - loss: 0.9925 - val_loss: 0.6279
AUC: 0.8553

Epoch 18/30
 - 0s - loss: 0.9857 - val_loss: 0.6107
AUC: 0.8551

Epoch 19/30
 - 0s - loss: 0.9852 - val_loss: 0.6159
AUC: 0.8551

Epoch 20/30
 - 0s - loss: 0.9858 - val_loss: 0.6219
AUC: 0.8552

Epoch 21/30
 - 0s - loss: 0.9853 - val_loss: 0.6198
AUC: 0.8552

Epoch 22/30
 - 0s - loss: 0.9877 - val_loss: 0.6155
AUC: 0.8552

Epoch 23/30
 - 0s - loss: 0.9851 - val_loss: 0.6169
AUC: 0.8553

Epoch 24/30
 - 0s - loss: 0.9848 - val_loss: 0.6131
AUC: 0.8552

Epoch 25/30
 - 0s - loss: 0.9853 - val_loss: 0.6182
AUC: 0.8553

Epoch 26/30
 - 0s - loss: 0.9825 - val_loss: 0.6172
AUC: 0.8553

Epoch 27/30
 - 0s - loss: 0.9825 - val_loss: 0.6141
AUC: 0.8553

Epoch 28/30
 - 0s - loss: 0.9800 - val_loss: 0.6124
AUC: 0.8553

Epoch 29/30
 - 0s - loss: 0.9821 - val_loss: 0.6107
AUC: 0.8553

Epoch 30/30
 - 0s - loss: 0.9854 - val_loss: 0.6188
Using TensorFlow backend.
AUC: 0.8555

2019-03-08 12:36:09.315026: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:36:09.484944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:36:09.485007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:36:09.783622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:36:09.783677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:36:09.783687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:36:09.783992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36244 rows...
Finished. It takes 5.6 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 4s - loss: 0.4990
Epoch 2/80
 - 4s - loss: 0.1145
Epoch 3/80
 - 4s - loss: 0.1051
Epoch 4/80
 - 4s - loss: 0.0975
Epoch 5/80
 - 4s - loss: 0.0887
Epoch 6/80
 - 4s - loss: 0.0802
Epoch 7/80
 - 4s - loss: 0.0722
Epoch 8/80
 - 4s - loss: 0.0653
Epoch 9/80
 - 4s - loss: 0.0597
Epoch 10/80
 - 4s - loss: 0.0553
Epoch 11/80
 - 4s - loss: 0.0519
Epoch 12/80
 - 4s - loss: 0.0492
Epoch 13/80
 - 4s - loss: 0.0470
Epoch 14/80
 - 4s - loss: 0.0453
Epoch 15/80
 - 4s - loss: 0.0439
Epoch 16/80
 - 4s - loss: 0.0428
Epoch 17/80
 - 4s - loss: 0.0419
Epoch 18/80
 - 4s - loss: 0.0411
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1116, in save_weights
    saving.save_weights_to_hdf5_group(f, self.layers)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/saving.py", line 446, in save_weights_to_hdf5_group
    g = f.create_group(layer.name)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/group.py", line 60, in create_group
    gid = h5g.create(self.id, name, lcpl=lcpl, gcpl=gcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5g.pyx", line 161, in h5py.h5g.create
ValueError: Unable to create group (name already exists)
2019-03-08 12:37:40.696110: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:37:40.866517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:37:40.866563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:37:41.170390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:37:41.170437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:37:41.170447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:37:41.170706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35997 rows...
Finished. It takes 5.3 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.8063
Epoch 2/80
 - 2s - loss: 0.1629
Epoch 3/80
 - 2s - loss: 0.1449
Epoch 4/80
 - 2s - loss: 0.1384
Epoch 5/80
 - 2s - loss: 0.1295
Epoch 6/80
 - 2s - loss: 0.1182
Epoch 7/80
 - 2s - loss: 0.1085
Epoch 8/80
 - 2s - loss: 0.1004
Epoch 9/80
 - 2s - loss: 0.0927
Epoch 10/80
 - 2s - loss: 0.0853
Epoch 11/80
 - 2s - loss: 0.0785
Epoch 12/80
 - 2s - loss: 0.0729
Epoch 13/80
 - 2s - loss: 0.0682
Epoch 14/80
 - 2s - loss: 0.0644
Epoch 15/80
 - 2s - loss: 0.0612
Epoch 16/80
 - 2s - loss: 0.0587
Epoch 17/80
 - 2s - loss: 0.0567
Epoch 18/80
 - 2s - loss: 0.0550
Epoch 19/80
 - 3s - loss: 0.0537
Epoch 20/80
 - 3s - loss: 0.0525
Epoch 21/80
 - 3s - loss: 0.0515
Epoch 22/80
 - 3s - loss: 0.0507
Epoch 23/80
 - 3s - loss: 0.0500
Epoch 24/80
 - 2s - loss: 0.0494
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 12:39:00.580329: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:39:00.746830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:39:00.746875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:39:01.049693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:39:01.049748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:39:01.049763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:39:01.050031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35692 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3354
Epoch 2/80
 - 2s - loss: 0.2578
Epoch 3/80
 - 2s - loss: 0.1715
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2adc1c015208>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 12:39:30.921470: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:39:31.091378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:39:31.091424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:39:31.383588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:39:31.383628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:39:31.383637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:39:31.383944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36264 rows...
Finished. It takes 5.6 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 5s - loss: 0.4840
Epoch 2/80
 - 4s - loss: 0.1092
Epoch 3/80
 - 4s - loss: 0.0939
Epoch 4/80
 - 4s - loss: 0.0848
Epoch 5/80
 - 4s - loss: 0.0783
Epoch 6/80
 - 4s - loss: 0.0729
Epoch 7/80
 - 4s - loss: 0.0676
Epoch 8/80
 - 4s - loss: 0.0625
Epoch 9/80
 - 4s - loss: 0.0579
Epoch 10/80
 - 4s - loss: 0.0541
Epoch 11/80
 - 4s - loss: 0.0509
Epoch 12/80
 - 4s - loss: 0.0484
Epoch 13/80
 - 4s - loss: 0.0464
Epoch 14/80
 - 4s - loss: 0.0447
Epoch 15/80
 - 4s - loss: 0.0433
Epoch 16/80
 - 4s - loss: 0.0422
Epoch 17/80
 - 4s - loss: 0.0413
Epoch 18/80
 - 4s - loss: 0.0405
Epoch 19/80
 - 4s - loss: 0.0399
Epoch 20/80
 - 4s - loss: 0.0393
Epoch 21/80
 - 4s - loss: 0.0389
Epoch 22/80
 - 4s - loss: 0.0385
Epoch 23/80
 - 4s - loss: 0.0382
Epoch 24/80
 - 4s - loss: 0.0379
Epoch 25/80
 - 4s - loss: 0.0376
Epoch 26/80
 - 4s - loss: 0.0374
Epoch 27/80
 - 4s - loss: 0.0373
Epoch 28/80
 - 4s - loss: 0.0371
Epoch 29/80
 - 4s - loss: 0.0369
Epoch 30/80
 - 4s - loss: 0.0368
Epoch 31/80
 - 4s - loss: 0.0367
Epoch 32/80
 - 4s - loss: 0.0366
Epoch 33/80
 - 4s - loss: 0.0365
Epoch 34/80
 - 4s - loss: 0.0364
Epoch 35/80
 - 4s - loss: 0.0363
Epoch 36/80
 - 4s - loss: 0.0363
Epoch 37/80
 - 4s - loss: 0.0362
Epoch 38/80
 - 4s - loss: 0.0362
Epoch 39/80
 - 4s - loss: 0.0361
Epoch 40/80
 - 4s - loss: 0.0361
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 12:42:27.093435: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:42:27.261493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:42:27.261567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:42:27.577843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:42:27.577893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:42:27.577902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:42:27.578164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36115 rows...
Finished. It takes 6.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 4s - loss: 0.6341
Epoch 2/80
 - 3s - loss: 0.1360
Epoch 3/80
 - 3s - loss: 0.1193
Epoch 4/80
 - 3s - loss: 0.1103
Epoch 5/80
 - 3s - loss: 0.1034
Epoch 6/80
 - 3s - loss: 0.0968
Epoch 7/80
 - 3s - loss: 0.0891
Epoch 8/80
 - 3s - loss: 0.0815
Epoch 9/80
 - 3s - loss: 0.0748
Epoch 10/80
 - 3s - loss: 0.0691
Epoch 11/80
 - 3s - loss: 0.0645
Epoch 12/80
 - 3s - loss: 0.0608
Epoch 13/80
 - 3s - loss: 0.0578
Epoch 14/80
 - 3s - loss: 0.0553
Epoch 15/80
 - 3s - loss: 0.0531
Epoch 16/80
 - 3s - loss: 0.0513
Epoch 17/80
 - 3s - loss: 0.0499
Epoch 18/80
 - 3s - loss: 0.0487
Epoch 19/80
 - 3s - loss: 0.0477
Epoch 20/80
 - 3s - loss: 0.0469
Epoch 21/80
 - 3s - loss: 0.0463
Epoch 22/80
 - 3s - loss: 0.0457
Epoch 23/80
 - 3s - loss: 0.0452
Epoch 24/80
 - 3s - loss: 0.0448
Epoch 25/80
 - 3s - loss: 0.0444
Epoch 26/80
 - 3s - loss: 0.0441
Epoch 27/80
 - 3s - loss: 0.0438
Epoch 28/80
 - 3s - loss: 0.0435
Epoch 29/80
 - 3s - loss: 0.0433
Epoch 30/80
 - 3s - loss: 0.0431
Epoch 31/80
 - 3s - loss: 0.0429
Epoch 32/80
 - 3s - loss: 0.0428
Epoch 33/80
 - 3s - loss: 0.0427
Epoch 34/80
 - 3s - loss: 0.0425
Epoch 35/80
 - 3s - loss: 0.0424
Epoch 36/80
 - 3s - loss: 0.0423
Epoch 37/80
 - 3s - loss: 0.0422
Epoch 38/80
 - 3s - loss: 0.0421
Epoch 39/80
 - 3s - loss: 0.0421
Epoch 40/80
 - 3s - loss: 0.0420
Epoch 41/80
 - 3s - loss: 0.0419
Epoch 42/80
 - 3s - loss: 0.0419
Epoch 43/80
 - 3s - loss: 0.0418
Epoch 44/80
 - 3s - loss: 0.0417
Epoch 45/80
 - 3s - loss: 0.0417
Epoch 46/80
 - 3s - loss: 0.0417
Epoch 47/80
 - 3s - loss: 0.0416
Epoch 48/80
 - 3s - loss: 0.0416
Epoch 49/80
 - 3s - loss: 0.0415
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2b9b3c1c71d0>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 12:45:16.722310: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:45:16.889913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:45:16.889976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:45:17.194263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:45:17.194315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:45:17.194325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:45:17.194589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.9 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1793
Epoch 2/80
 - 2s - loss: 0.2214
Epoch 3/80
 - 2s - loss: 0.1699
Epoch 4/80
 - 2s - loss: 0.1551
Epoch 5/80
 - 2s - loss: 0.1418
Epoch 6/80
 - 2s - loss: 0.1311
Epoch 7/80
 - 2s - loss: 0.1225
Epoch 8/80
 - 2s - loss: 0.1152
Epoch 9/80
 - 2s - loss: 0.1088
Epoch 10/80
 - 2s - loss: 0.1031
Epoch 11/80
 - 2s - loss: 0.0978
Epoch 12/80
 - 2s - loss: 0.0925
Epoch 13/80
 - 2s - loss: 0.0873
Epoch 14/80
 - 2s - loss: 0.0825
Epoch 15/80
 - 2s - loss: 0.0780
Epoch 16/80
 - 2s - loss: 0.0740
Epoch 17/80
 - 2s - loss: 0.0705
Epoch 18/80
 - 2s - loss: 0.0675
Epoch 19/80
 - 2s - loss: 0.0650
Epoch 20/80
 - 2s - loss: 0.0629
Epoch 21/80
 - 2s - loss: 0.0612
Epoch 22/80
 - 2s - loss: 0.0597
Epoch 23/80
 - 2s - loss: 0.0584
Epoch 24/80
 - 2s - loss: 0.0573
Epoch 25/80
 - 2s - loss: 0.0564
Epoch 26/80
 - 2s - loss: 0.0557
Epoch 27/80
 - 2s - loss: 0.0550
Epoch 28/80
 - 2s - loss: 0.0544
Epoch 29/80
 - 2s - loss: 0.0539
Epoch 30/80
 - 2s - loss: 0.0535
Epoch 31/80
 - 2s - loss: 0.0532
Epoch 32/80
 - 2s - loss: 0.0529
Epoch 33/80
 - 2s - loss: 0.0526
Epoch 34/80
 - 2s - loss: 0.0524
Epoch 35/80
 - 2s - loss: 0.0522
Epoch 36/80
 - 2s - loss: 0.0520
Epoch 37/80
 - 2s - loss: 0.0518
Epoch 38/80
 - 2s - loss: 0.0516
Epoch 39/80
 - 2s - loss: 0.0515
Epoch 40/80
 - 2s - loss: 0.0514
Epoch 41/80
 - 2s - loss: 0.0513
Epoch 42/80
 - 2s - loss: 0.0512
Epoch 43/80
 - 2s - loss: 0.0511
Epoch 44/80
 - 2s - loss: 0.0510
Epoch 45/80
 - 2s - loss: 0.0509
Epoch 46/80
 - 2s - loss: 0.0508
Epoch 47/80
 - 2s - loss: 0.0508
Epoch 48/80
 - 2s - loss: 0.0507
Epoch 49/80
 - 2s - loss: 0.0507
Epoch 50/80
 - 2s - loss: 0.0506
Epoch 51/80
 - 2s - loss: 0.0506
Epoch 52/80
 - 2s - loss: 0.0505
Epoch 53/80
 - 2s - loss: 0.0505
Epoch 54/80
 - 2s - loss: 0.0504
Epoch 55/80
 - 2s - loss: 0.0504
Epoch 56/80
 - 2s - loss: 0.0504
Epoch 57/80
 - 2s - loss: 0.0503
Epoch 58/80
 - 2s - loss: 0.0503
Epoch 59/80
 - 2s - loss: 0.0502
Epoch 60/80
 - 2s - loss: 0.0502
Epoch 61/80
 - 2s - loss: 0.0502
Epoch 62/80
 - 2s - loss: 0.0502
Epoch 63/80
 - 2s - loss: 0.0501
Epoch 64/80
 - 2s - loss: 0.0490
Epoch 65/80
 - 2s - loss: 0.0489
Epoch 66/80
 - 2s - loss: 0.0489
Epoch 67/80
 - 2s - loss: 0.0489
Epoch 68/80
 - 2s - loss: 0.0489
Epoch 69/80
 - 2s - loss: 0.0486
Epoch 70/80
 - 2s - loss: 0.0486
Epoch 71/80
 - 2s - loss: 0.0486
Epoch 72/80
 - 2s - loss: 0.0486
Epoch 73/80
 - 2s - loss: 0.0485
Epoch 74/80
 - 2s - loss: 0.0485
Epoch 75/80
 - 2s - loss: 0.0485
Epoch 76/80
 - 2s - loss: 0.0485
Epoch 77/80
 - 2s - loss: 0.0485
Epoch 78/80
 - 2s - loss: 0.0485
Epoch 79/80
 - 2s - loss: 0.0485
Epoch 80/80
 - 2s - loss: 0.0485
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.6208 - val_loss: 1.3571
AUC: 0.7862

Epoch 2/80
 - 0s - loss: 2.1392 - val_loss: 0.8078
AUC: 0.8067

Epoch 3/80
 - 0s - loss: 1.5130 - val_loss: 0.7558
AUC: 0.8242

Epoch 4/80
 - 0s - loss: 1.2939 - val_loss: 0.7482
AUC: 0.8340

Epoch 5/80
 - 0s - loss: 1.2103 - val_loss: 0.6670
AUC: 0.8392

Epoch 6/80
 - 0s - loss: 1.1724 - val_loss: 0.6741
AUC: 0.8421

Epoch 7/80
 - 0s - loss: 1.1417 - val_loss: 0.6923
AUC: 0.8480

Epoch 8/80
 - 0s - loss: 1.1242 - val_loss: 0.6720
AUC: 0.8474

Epoch 9/80
 - 0s - loss: 1.1069 - val_loss: 0.7444
AUC: 0.8503

Epoch 10/80
 - 0s - loss: 1.0987 - val_loss: 0.6608
AUC: 0.8532

Epoch 11/80
 - 0s - loss: 1.0867 - val_loss: 0.6321
AUC: 0.8547

Epoch 12/80
 - 0s - loss: 1.0786 - val_loss: 0.6273
AUC: 0.8557

Epoch 13/80
 - 0s - loss: 1.0698 - val_loss: 0.6214
AUC: 0.8572

Epoch 14/80
 - 0s - loss: 1.0636 - val_loss: 0.6800
AUC: 0.8590

Epoch 15/80
 - 0s - loss: 1.0573 - val_loss: 0.6591
AUC: 0.8582

Epoch 16/80
 - 0s - loss: 1.0560 - val_loss: 0.6468
AUC: 0.8603

Epoch 17/80
 - 0s - loss: 1.0428 - val_loss: 0.6489
AUC: 0.8612

Epoch 18/80
 - 0s - loss: 1.0447 - val_loss: 0.6678
AUC: 0.8627

Epoch 19/80
 - 0s - loss: 1.0380 - val_loss: 0.6056
AUC: 0.8619

Epoch 20/80
 - 0s - loss: 1.0334 - val_loss: 0.6293
AUC: 0.8632

Epoch 21/80
 - 0s - loss: 1.0326 - val_loss: 0.6046
AUC: 0.8631

Epoch 22/80
 - 0s - loss: 1.0303 - val_loss: 0.6875
AUC: 0.8644

Epoch 23/80
 - 0s - loss: 1.0315 - val_loss: 0.6473
AUC: 0.8645

Epoch 24/80
 - 0s - loss: 1.0250 - val_loss: 0.5966
AUC: 0.8641

Epoch 25/80
 - 0s - loss: 1.0203 - val_loss: 0.6151
AUC: 0.8655

Epoch 26/80
 - 0s - loss: 1.0183 - val_loss: 0.5951
AUC: 0.8647

Epoch 27/80
 - 0s - loss: 1.0128 - val_loss: 0.6065
AUC: 0.8652

Epoch 28/80
 - 0s - loss: 1.0109 - val_loss: 0.6250
AUC: 0.8662

Epoch 29/80
 - 0s - loss: 1.0066 - val_loss: 0.5957
AUC: 0.8662

Epoch 30/80
 - 0s - loss: 1.0087 - val_loss: 0.6535
AUC: 0.8665

Epoch 31/80
 - 0s - loss: 1.0045 - val_loss: 0.6289
AUC: 0.8670

Epoch 32/80
 - 0s - loss: 1.0070 - val_loss: 0.5793
AUC: 0.8662

Epoch 33/80
 - 0s - loss: 1.0024 - val_loss: 0.5907
AUC: 0.8660

Epoch 34/80
 - 0s - loss: 1.0019 - val_loss: 0.6475
AUC: 0.8662

Epoch 35/80
 - 0s - loss: 0.9963 - val_loss: 0.6052
AUC: 0.8672

Epoch 36/80
 - 0s - loss: 0.9986 - val_loss: 0.6011
AUC: 0.8680

Epoch 37/80
 - 0s - loss: 0.9952 - val_loss: 0.6242
AUC: 0.8669

Epoch 38/80
 - 0s - loss: 0.9896 - val_loss: 0.5785
AUC: 0.8678

Epoch 39/80
 - 0s - loss: 0.9908 - val_loss: 0.6137
AUC: 0.8667

Epoch 40/80
 - 0s - loss: 0.9899 - val_loss: 0.6352
AUC: 0.8680

Epoch 41/80
 - 0s - loss: 0.9881 - val_loss: 0.5969
AUC: 0.8676

Epoch 42/80
 - 0s - loss: 0.9868 - val_loss: 0.5994
AUC: 0.8680

Epoch 43/80
 - 0s - loss: 0.9768 - val_loss: 0.5922
AUC: 0.8677

Epoch 44/80
 - 0s - loss: 0.9845 - val_loss: 0.5254
AUC: 0.8669

Epoch 45/80
 - 0s - loss: 0.9859 - val_loss: 0.6316
AUC: 0.8680

Epoch 46/80
 - 0s - loss: 0.9781 - val_loss: 0.6650
AUC: 0.8683

Epoch 47/80
 - 0s - loss: 0.9828 - val_loss: 0.5782
AUC: 0.8670

Epoch 48/80
 - 0s - loss: 0.9738 - val_loss: 0.6523
AUC: 0.8672

Epoch 49/80
 - 0s - loss: 0.9806 - val_loss: 0.6229
AUC: 0.8677

Epoch 50/80
 - 0s - loss: 0.9758 - val_loss: 0.6255
AUC: 0.8681

Epoch 51/80
 - 0s - loss: 0.9757 - val_loss: 0.5887
AUC: 0.8677

Epoch 52/80
 - 0s - loss: 0.9718 - val_loss: 0.5614
AUC: 0.8675

Epoch 53/80
 - 0s - loss: 0.9716 - val_loss: 0.5381
AUC: 0.8674

Epoch 54/80
 - 0s - loss: 0.9667 - val_loss: 0.6141
AUC: 0.8688

Epoch 55/80
 - 0s - loss: 0.9632 - val_loss: 0.6155
AUC: 0.8686

Epoch 56/80
 - 0s - loss: 0.9569 - val_loss: 0.6153
AUC: 0.8687

Epoch 57/80
 - 0s - loss: 0.9599 - val_loss: 0.5717
AUC: 0.8682

Epoch 58/80
 - 0s - loss: 0.9576 - val_loss: 0.6281
AUC: 0.8683

Epoch 59/80
 - 0s - loss: 0.9564 - val_loss: 0.6176
AUC: 0.8684

Epoch 60/80
 - 0s - loss: 0.9604 - val_loss: 0.5958
AUC: 0.8684

Epoch 61/80
 - 0s - loss: 0.9569 - val_loss: 0.6012
AUC: 0.8683

Epoch 62/80
 - 0s - loss: 0.9545 - val_loss: 0.6343
AUC: 0.8683

Epoch 63/80
 - 0s - loss: 0.9543 - val_loss: 0.6050
AUC: 0.8683

Epoch 64/80
 - 0s - loss: 0.9560 - val_loss: 0.5882
AUC: 0.8683

Epoch 65/80
 - 0s - loss: 0.9534 - val_loss: 0.5946
AUC: 0.8683

Epoch 66/80
 - 0s - loss: 0.9530 - val_loss: 0.6054
AUC: 0.8684

Epoch 67/80
 - 0s - loss: 0.9564 - val_loss: 0.6037
AUC: 0.8683

Epoch 68/80
 - 0s - loss: 0.9583 - val_loss: 0.6027
AUC: 0.8684

Epoch 69/80
 - 0s - loss: 0.9535 - val_loss: 0.6041
AUC: 0.8684

Epoch 70/80
 - 0s - loss: 0.9560 - val_loss: 0.6006
AUC: 0.8684

Epoch 71/80
 - 0s - loss: 0.9570 - val_loss: 0.6019
AUC: 0.8683

Epoch 72/80
 - 0s - loss: 0.9491 - val_loss: 0.6046
AUC: 0.8683

Epoch 73/80
 - 0s - loss: 0.9523 - val_loss: 0.5993
AUC: 0.8683

Epoch 74/80
 - 0s - loss: 0.9496 - val_loss: 0.5932
AUC: 0.8683

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9638 - val_loss: 0.6118
AUC: 0.8686

Epoch 2/30
 - 0s - loss: 0.9596 - val_loss: 0.5973
AUC: 0.8686

Epoch 3/30
 - 0s - loss: 0.9533 - val_loss: 0.6022
AUC: 0.8687

Epoch 4/30
 - 0s - loss: 0.9561 - val_loss: 0.6016
AUC: 0.8686

Epoch 5/30
 - 0s - loss: 0.9537 - val_loss: 0.5969
AUC: 0.8687

Epoch 6/30
 - 0s - loss: 0.9548 - val_loss: 0.5951
AUC: 0.8688

Epoch 7/30
 - 0s - loss: 0.9521 - val_loss: 0.5967
AUC: 0.8688

Epoch 8/30
 - 0s - loss: 0.9539 - val_loss: 0.6001
AUC: 0.8689

Epoch 9/30
 - 0s - loss: 0.9494 - val_loss: 0.6169
AUC: 0.8690

Epoch 10/30
 - 0s - loss: 0.9492 - val_loss: 0.6069
AUC: 0.8690

Epoch 11/30
 - 0s - loss: 0.9499 - val_loss: 0.6058
AUC: 0.8693

Epoch 12/30
 - 0s - loss: 0.9482 - val_loss: 0.6049
AUC: 0.8693

Epoch 13/30
 - 0s - loss: 0.9438 - val_loss: 0.5836
AUC: 0.8692

Epoch 14/30
 - 0s - loss: 0.9415 - val_loss: 0.6015
AUC: 0.8694

Epoch 15/30
 - 0s - loss: 0.9508 - val_loss: 0.5917
AUC: 0.8694

Epoch 16/30
 - 0s - loss: 0.9459 - val_loss: 0.5999
AUC: 0.8695

Epoch 17/30
 - 0s - loss: 0.9433 - val_loss: 0.5948
AUC: 0.8696

Epoch 18/30
 - 0s - loss: 0.9418 - val_loss: 0.6030
AUC: 0.8695

Epoch 19/30
 - 0s - loss: 0.9415 - val_loss: 0.6014
AUC: 0.8697

Epoch 20/30
 - 0s - loss: 0.9413 - val_loss: 0.5963
AUC: 0.8697

Epoch 21/30
 - 0s - loss: 0.9335 - val_loss: 0.5862
AUC: 0.8698

Epoch 22/30
 - 0s - loss: 0.9385 - val_loss: 0.5919
AUC: 0.8698

Epoch 23/30
 - 0s - loss: 0.9323 - val_loss: 0.5926
AUC: 0.8699

Epoch 24/30
 - 0s - loss: 0.9316 - val_loss: 0.5905
AUC: 0.8699

Epoch 25/30
 - 0s - loss: 0.9330 - val_loss: 0.5888
AUC: 0.8699

Epoch 26/30
 - 0s - loss: 0.9353 - val_loss: 0.5926
AUC: 0.8700

Epoch 27/30
 - 0s - loss: 0.9374 - val_loss: 0.5953
AUC: 0.8700

Epoch 28/30
 - 0s - loss: 0.9349 - val_loss: 0.5932
AUC: 0.8700

Epoch 29/30
 - 0s - loss: 0.9329 - val_loss: 0.5895
AUC: 0.8700

Epoch 30/30
 - 0s - loss: 0.9351 - val_loss: 0.5955
Using TensorFlow backend.
AUC: 0.8700

2019-03-08 12:49:33.780830: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:49:33.948107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:49:33.948153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:49:34.247725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:49:34.247787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:49:34.247797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:49:34.248081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36278 rows...
Finished. It takes 5.6 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 5s - loss: 0.4637
Epoch 2/80
 - 4s - loss: 0.1049
Epoch 3/80
 - 4s - loss: 0.0911
Epoch 4/80
 - 4s - loss: 0.0827
Epoch 5/80
 - 4s - loss: 0.0755
Epoch 6/80
 - 4s - loss: 0.0694
Epoch 7/80
 - 4s - loss: 0.0642
Epoch 8/80
 - 4s - loss: 0.0596
Epoch 9/80
 - 4s - loss: 0.0553
Epoch 10/80
 - 4s - loss: 0.0516
Epoch 11/80
 - 4s - loss: 0.0485
Epoch 12/80
 - 4s - loss: 0.0460
Epoch 13/80
 - 4s - loss: 0.0440
Epoch 14/80
 - 4s - loss: 0.0424
Epoch 15/80
 - 4s - loss: 0.0412
Epoch 16/80
 - 4s - loss: 0.0402
Epoch 17/80
 - 4s - loss: 0.0393
Epoch 18/80
 - 4s - loss: 0.0387
Epoch 19/80
 - 4s - loss: 0.0381
Epoch 20/80
 - 4s - loss: 0.0377
Epoch 21/80
 - 4s - loss: 0.0373
Epoch 22/80
 - 4s - loss: 0.0370
Epoch 23/80
 - 4s - loss: 0.0367
Epoch 24/80
 - 4s - loss: 0.0365
Epoch 25/80
 - 4s - loss: 0.0363
Epoch 26/80
 - 4s - loss: 0.0361
Epoch 27/80
 - 4s - loss: 0.0359
Epoch 28/80
 - 4s - loss: 0.0358
Epoch 29/80
 - 4s - loss: 0.0357
Epoch 30/80
 - 4s - loss: 0.0356
Epoch 31/80
 - 4s - loss: 0.0355
Epoch 32/80
 - 4s - loss: 0.0354
Epoch 33/80
 - 4s - loss: 0.0353
Epoch 34/80
 - 4s - loss: 0.0352
Epoch 35/80
 - 4s - loss: 0.0351
Epoch 36/80
 - 4s - loss: 0.0351
Epoch 37/80
 - 4s - loss: 0.0350
Epoch 38/80
 - 4s - loss: 0.0350
Epoch 39/80
 - 4s - loss: 0.0349
Epoch 40/80
 - 4s - loss: 0.0349
Epoch 41/80
 - 4s - loss: 0.0348
Epoch 42/80
 - 4s - loss: 0.0348
Epoch 43/80
 - 4s - loss: 0.0348
Epoch 44/80
 - 4s - loss: 0.0347
Epoch 45/80
 - 4s - loss: 0.0347
Epoch 46/80
 - 4s - loss: 0.0347
Epoch 47/80
 - 4s - loss: 0.0346
Epoch 48/80
 - 4s - loss: 0.0346
Epoch 49/80
 - 4s - loss: 0.0346
Epoch 50/80
 - 4s - loss: 0.0335
Epoch 51/80
 - 4s - loss: 0.0333
Epoch 52/80
 - 4s - loss: 0.0333
Epoch 53/80
 - 4s - loss: 0.0333
Epoch 54/80
 - 4s - loss: 0.0333
Epoch 55/80
 - 4s - loss: 0.0330
Epoch 56/80
 - 4s - loss: 0.0330
Epoch 57/80
 - 4s - loss: 0.0330
Epoch 58/80
 - 4s - loss: 0.0330
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
Exception ignored in: <bound method BaseSession.__del__ of <tensorflow.python.client.session.Session object at 0x2af2470f0668>>
Traceback (most recent call last):
  File "/home/wsliu/.local/lib/python3.5/site-packages/tensorflow/python/client/session.py", line 738, in __del__
TypeError: 'NoneType' object is not callable
2019-03-08 12:53:44.697021: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:53:44.861590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:53:44.861636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:53:45.159455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:53:45.159512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:53:45.159521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:53:45.159808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36194 rows...
Finished. It takes 5.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 4s - loss: 0.5579
Epoch 2/80
 - 3s - loss: 0.1241
Epoch 3/80
 - 3s - loss: 0.1095
Epoch 4/80
 - 3s - loss: 0.0980
Epoch 5/80
 - 3s - loss: 0.0878
Epoch 6/80
 - 3s - loss: 0.0807
Epoch 7/80
 - 3s - loss: 0.0752
Epoch 8/80
 - 3s - loss: 0.0702
Epoch 9/80
 - 4s - loss: 0.0654
Epoch 10/80
 - 3s - loss: 0.0611
Epoch 11/80
 - 3s - loss: 0.0572
Epoch 12/80
 - 3s - loss: 0.0540
Epoch 13/80
 - 3s - loss: 0.0513
Epoch 14/80
 - 3s - loss: 0.0492
Epoch 15/80
 - 3s - loss: 0.0476
Epoch 16/80
 - 3s - loss: 0.0462
Epoch 17/80
 - 3s - loss: 0.0451
Epoch 18/80
 - 3s - loss: 0.0442
Epoch 19/80
 - 3s - loss: 0.0434
Epoch 20/80
 - 3s - loss: 0.0428
Epoch 21/80
 - 3s - loss: 0.0422
Epoch 22/80
 - 3s - loss: 0.0418
Epoch 23/80
 - 3s - loss: 0.0414
Epoch 24/80
 - 4s - loss: 0.0411
Epoch 25/80
 - 4s - loss: 0.0408
Epoch 26/80
 - 3s - loss: 0.0406
Epoch 27/80
 - 3s - loss: 0.0403
Epoch 28/80
 - 3s - loss: 0.0402
Epoch 29/80
 - 3s - loss: 0.0400
Epoch 30/80
 - 3s - loss: 0.0399
Epoch 31/80
 - 3s - loss: 0.0397
Epoch 32/80
 - 3s - loss: 0.0396
Epoch 33/80
 - 3s - loss: 0.0395
Epoch 34/80
 - 3s - loss: 0.0394
Epoch 35/80
 - 4s - loss: 0.0393
Epoch 36/80
 - 3s - loss: 0.0393
Epoch 37/80
 - 3s - loss: 0.0392
Epoch 38/80
 - 3s - loss: 0.0391
Epoch 39/80
 - 3s - loss: 0.0391
Epoch 40/80
 - 3s - loss: 0.0390
Epoch 41/80
 - 3s - loss: 0.0390
Epoch 42/80
 - 3s - loss: 0.0389
Epoch 43/80
 - 3s - loss: 0.0389
Epoch 44/80
 - 3s - loss: 0.0388
Epoch 45/80
 - 3s - loss: 0.0388
Epoch 46/80
 - 3s - loss: 0.0388
Epoch 47/80
 - 3s - loss: 0.0388
Epoch 48/80
 - 3s - loss: 0.0376
Epoch 49/80
 - 3s - loss: 0.0374
Epoch 50/80
 - 3s - loss: 0.0374
Epoch 51/80
 - 3s - loss: 0.0374
Epoch 52/80
 - 3s - loss: 0.0374
Epoch 53/80
 - 3s - loss: 0.0371
Epoch 54/80
 - 3s - loss: 0.0371
Epoch 55/80
 - 3s - loss: 0.0371
Epoch 56/80
 - 3s - loss: 0.0371
Epoch 57/80
 - 3s - loss: 0.0370
Epoch 58/80
 - 3s - loss: 0.0370
Epoch 59/80
 - 3s - loss: 0.0370
Epoch 60/80
 - 3s - loss: 0.0370
Epoch 61/80
 - 3s - loss: 0.0370
Epoch 62/80
 - 3s - loss: 0.0370
Epoch 63/80
 - 3s - loss: 0.0370
Epoch 64/80
 - 3s - loss: 0.0370
Epoch 65/80
 - 3s - loss: 0.0370
Epoch 66/80
 - 3s - loss: 0.0370
Epoch 67/80
 - 3s - loss: 0.0370
Epoch 68/80
 - 3s - loss: 0.0370
Epoch 69/80
 - 3s - loss: 0.0370
Epoch 70/80
 - 3s - loss: 0.0370
Epoch 71/80
 - 3s - loss: 0.0370
Epoch 72/80
 - 3s - loss: 0.0370
Epoch 73/80
 - 3s - loss: 0.0370
Epoch 74/80
 - 3s - loss: 0.0370
Epoch 75/80
 - 3s - loss: 0.0370
Epoch 76/80
 - 3s - loss: 0.0370
Epoch 77/80
 - 3s - loss: 0.0370
Epoch 78/80
 - 3s - loss: 0.0370
Epoch 79/80
 - 3s - loss: 0.0370
Epoch 80/80
 - 3s - loss: 0.0370
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28955 samples, validate on 7239 samples
Epoch 1/80
 - 1s - loss: 3.8903 - val_loss: 1.3317
AUC: 0.8006

Epoch 2/80
 - 0s - loss: 2.1239 - val_loss: 1.0925
AUC: 0.8106

Epoch 3/80
 - 0s - loss: 1.4984 - val_loss: 0.7118
AUC: 0.8258

Epoch 4/80
 - 0s - loss: 1.2678 - val_loss: 0.7202
AUC: 0.8337

Epoch 5/80
 - 0s - loss: 1.2040 - val_loss: 0.7735
AUC: 0.8311

Epoch 6/80
 - 0s - loss: 1.1645 - val_loss: 0.7404
AUC: 0.8394

Epoch 7/80
 - 0s - loss: 1.1283 - val_loss: 0.6994
AUC: 0.8434

Epoch 8/80
 - 0s - loss: 1.1065 - val_loss: 0.6471
AUC: 0.8472

Epoch 9/80
 - 0s - loss: 1.0891 - val_loss: 0.6753
AUC: 0.8510

Epoch 10/80
 - 0s - loss: 1.0751 - val_loss: 0.6494
AUC: 0.8513

Epoch 11/80
 - 0s - loss: 1.0620 - val_loss: 0.6547
AUC: 0.8527

Epoch 12/80
 - 0s - loss: 1.0482 - val_loss: 0.6199
AUC: 0.8546

Epoch 13/80
 - 0s - loss: 1.0473 - val_loss: 0.6742
AUC: 0.8569

Epoch 14/80
 - 0s - loss: 1.0426 - val_loss: 0.7078
AUC: 0.8570

Epoch 15/80
 - 0s - loss: 1.0402 - val_loss: 0.6359
AUC: 0.8562

Epoch 16/80
 - 0s - loss: 1.0291 - val_loss: 0.6481
AUC: 0.8582

Epoch 17/80
 - 0s - loss: 1.0308 - val_loss: 0.5880
AUC: 0.8586

Epoch 18/80
 - 0s - loss: 1.0248 - val_loss: 0.6588
AUC: 0.8599

Epoch 19/80
 - 0s - loss: 1.0218 - val_loss: 0.5847
AUC: 0.8598

Epoch 20/80
 - 0s - loss: 1.0132 - val_loss: 0.5845
AUC: 0.8600

Epoch 21/80
 - 0s - loss: 1.0046 - val_loss: 0.6434
AUC: 0.8595

Epoch 22/80
 - 0s - loss: 1.0071 - val_loss: 0.6235
AUC: 0.8603

Epoch 23/80
 - 0s - loss: 1.0052 - val_loss: 0.5936
AUC: 0.8606

Epoch 24/80
 - 0s - loss: 1.0063 - val_loss: 0.6282
AUC: 0.8611

Epoch 25/80
 - 0s - loss: 1.0021 - val_loss: 0.6571
AUC: 0.8607

Epoch 26/80
 - 0s - loss: 0.9996 - val_loss: 0.6695
AUC: 0.8614

Epoch 27/80
 - 0s - loss: 0.9998 - val_loss: 0.5908
AUC: 0.8610

Epoch 28/80
 - 0s - loss: 0.9977 - val_loss: 0.6629
AUC: 0.8618

Epoch 29/80
 - 0s - loss: 0.9915 - val_loss: 0.6146
AUC: 0.8620

Epoch 30/80
 - 0s - loss: 0.9905 - val_loss: 0.6550
AUC: 0.8617

Epoch 31/80
 - 0s - loss: 0.9800 - val_loss: 0.6111
AUC: 0.8622

Epoch 32/80
 - 0s - loss: 0.9772 - val_loss: 0.5945
AUC: 0.8626

Epoch 33/80
 - 0s - loss: 0.9787 - val_loss: 0.6098
AUC: 0.8626

Epoch 34/80
 - 0s - loss: 0.9790 - val_loss: 0.6364
AUC: 0.8632

Epoch 35/80
 - 0s - loss: 0.9822 - val_loss: 0.6332
AUC: 0.8625

Epoch 36/80
 - 0s - loss: 0.9703 - val_loss: 0.6096
AUC: 0.8632

Epoch 37/80
 - 0s - loss: 0.9738 - val_loss: 0.6223
AUC: 0.8629

Epoch 38/80
 - 0s - loss: 0.9715 - val_loss: 0.6212
AUC: 0.8632

Epoch 39/80
 - 0s - loss: 0.9814 - val_loss: 0.6060
AUC: 0.8631

Epoch 40/80
 - 0s - loss: 0.9747 - val_loss: 0.6154
AUC: 0.8634

Epoch 41/80
 - 0s - loss: 0.9789 - val_loss: 0.6090
AUC: 0.8634

Epoch 42/80
 - 0s - loss: 0.9727 - val_loss: 0.6168
AUC: 0.8633

Epoch 43/80
 - 0s - loss: 0.9685 - val_loss: 0.6104
AUC: 0.8633

Epoch 44/80
 - 0s - loss: 0.9760 - val_loss: 0.6097
AUC: 0.8631

Epoch 45/80
 - 0s - loss: 0.9715 - val_loss: 0.6067
AUC: 0.8631

Epoch 46/80
 - 0s - loss: 0.9717 - val_loss: 0.6071
AUC: 0.8631

Epoch 47/80
 - 0s - loss: 0.9674 - val_loss: 0.6059
AUC: 0.8630

Epoch 48/80
 - 0s - loss: 0.9731 - val_loss: 0.6108
AUC: 0.8631

Epoch 49/80
 - 0s - loss: 0.9729 - val_loss: 0.6069
AUC: 0.8633

Epoch 50/80
 - 0s - loss: 0.9730 - val_loss: 0.6088
AUC: 0.8633

Train on 28955 samples, validate on 7239 samples
Epoch 1/30
 - 1s - loss: 0.9718 - val_loss: 0.6190
AUC: 0.8635

Epoch 2/30
 - 0s - loss: 0.9735 - val_loss: 0.6127
AUC: 0.8636

Epoch 3/30
 - 0s - loss: 0.9739 - val_loss: 0.6051
AUC: 0.8636

Epoch 4/30
 - 0s - loss: 0.9705 - val_loss: 0.6320
AUC: 0.8639

Epoch 5/30
 - 0s - loss: 0.9695 - val_loss: 0.6212
AUC: 0.8639

Epoch 6/30
 - 0s - loss: 0.9655 - val_loss: 0.6030
AUC: 0.8642

Epoch 7/30
 - 0s - loss: 0.9620 - val_loss: 0.5989
AUC: 0.8644

Epoch 8/30
 - 0s - loss: 0.9653 - val_loss: 0.6253
AUC: 0.8646

Epoch 9/30
 - 0s - loss: 0.9652 - val_loss: 0.6053
AUC: 0.8645

Epoch 10/30
 - 0s - loss: 0.9639 - val_loss: 0.5979
AUC: 0.8648

Epoch 11/30
 - 0s - loss: 0.9555 - val_loss: 0.6029
AUC: 0.8649

Epoch 12/30
 - 0s - loss: 0.9570 - val_loss: 0.6098
AUC: 0.8650

Epoch 13/30
 - 0s - loss: 0.9652 - val_loss: 0.6103
AUC: 0.8652

Epoch 14/30
 - 0s - loss: 0.9563 - val_loss: 0.6048
AUC: 0.8654

Epoch 15/30
 - 0s - loss: 0.9528 - val_loss: 0.6082
AUC: 0.8656

Epoch 16/30
 - 0s - loss: 0.9498 - val_loss: 0.5925
AUC: 0.8654

Epoch 17/30
 - 1s - loss: 0.9521 - val_loss: 0.5979
AUC: 0.8656

Epoch 18/30
 - 0s - loss: 0.9507 - val_loss: 0.6135
AUC: 0.8659

Epoch 19/30
 - 0s - loss: 0.9528 - val_loss: 0.5839
AUC: 0.8659

Epoch 20/30
 - 0s - loss: 0.9540 - val_loss: 0.6091
AUC: 0.8662

Epoch 21/30
 - 1s - loss: 0.9474 - val_loss: 0.5951
AUC: 0.8662

Epoch 22/30
 - 1s - loss: 0.9457 - val_loss: 0.5989
AUC: 0.8660

Epoch 23/30
 - 0s - loss: 0.9388 - val_loss: 0.5987
AUC: 0.8663

Epoch 24/30
 - 0s - loss: 0.9401 - val_loss: 0.5887
AUC: 0.8664

Epoch 25/30
 - 1s - loss: 0.9377 - val_loss: 0.6008
AUC: 0.8666

Epoch 26/30
 - 1s - loss: 0.9418 - val_loss: 0.6193
AUC: 0.8668

Epoch 27/30
 - 0s - loss: 0.9415 - val_loss: 0.6021
AUC: 0.8667

Epoch 28/30
 - 0s - loss: 0.9399 - val_loss: 0.5872
AUC: 0.8668

Epoch 29/30
 - 0s - loss: 0.9316 - val_loss: 0.5923
AUC: 0.8669

Epoch 30/30
 - 1s - loss: 0.9350 - val_loss: 0.5963
Using TensorFlow backend.
AUC: 0.8669

2019-03-08 12:59:29.020438: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 12:59:29.191811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 12:59:29.191862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 12:59:29.516105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 12:59:29.516162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 12:59:29.516172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 12:59:29.516448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35874 rows...
Finished. It takes 5.3 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.9710
Epoch 2/80
 - 2s - loss: 0.1884
Epoch 3/80
 - 2s - loss: 0.1606
Epoch 4/80
 - 2s - loss: 0.1541
Epoch 5/80
 - 2s - loss: 0.1473
Epoch 6/80
 - 2s - loss: 0.1375
Epoch 7/80
 - 2s - loss: 0.1249
Epoch 8/80
 - 2s - loss: 0.1127
Epoch 9/80
 - 2s - loss: 0.1032
Epoch 10/80
 - 2s - loss: 0.0951
Epoch 11/80
 - 2s - loss: 0.0882
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 13:00:09.170160: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:00:09.337280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:00:09.337327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:00:09.650188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:00:09.650241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:00:09.650250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:00:09.650510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35230 rows...
Finished. It takes 4.3 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 2s - loss: 2.3781
Epoch 2/80
 - 1s - loss: 0.7305
Epoch 3/80
 - 1s - loss: 0.2678
Epoch 4/80
 - 1s - loss: 0.2274
Epoch 5/80
 - 1s - loss: 0.2134
Epoch 6/80
 - 1s - loss: 0.2011
Epoch 7/80
 - 1s - loss: 0.1900
Epoch 8/80
 - 1s - loss: 0.1813
Epoch 9/80
 - 1s - loss: 0.1741
Epoch 10/80
 - 1s - loss: 0.1679
Epoch 11/80
 - 1s - loss: 0.1620
Epoch 12/80
 - 1s - loss: 0.1564
Epoch 13/80
 - 1s - loss: 0.1510
Epoch 14/80
 - 1s - loss: 0.1455
Epoch 15/80
 - 1s - loss: 0.1402
Epoch 16/80
 - 1s - loss: 0.1347
Epoch 17/80
 - 1s - loss: 0.1291
Epoch 18/80
 - 1s - loss: 0.1235
Epoch 19/80
 - 1s - loss: 0.1181
Epoch 20/80
 - 1s - loss: 0.1130
Epoch 21/80
 - 1s - loss: 0.1082
Epoch 22/80
 - 1s - loss: 0.1038
Epoch 23/80
 - 1s - loss: 0.0996
Epoch 24/80
 - 1s - loss: 0.0958
Epoch 25/80
 - 1s - loss: 0.0923
Epoch 26/80
 - 1s - loss: 0.0891
Epoch 27/80
 - 1s - loss: 0.0863
Epoch 28/80
 - 1s - loss: 0.0836
Epoch 29/80
 - 1s - loss: 0.0813
Epoch 30/80
 - 1s - loss: 0.0791
Epoch 31/80
 - 1s - loss: 0.0771
Epoch 32/80
 - 1s - loss: 0.0753
Epoch 33/80
 - 1s - loss: 0.0737
Epoch 34/80
 - 1s - loss: 0.0722
Epoch 35/80
 - 1s - loss: 0.0709
Epoch 36/80
 - 1s - loss: 0.0697
Epoch 37/80
 - 1s - loss: 0.0686
Epoch 38/80
 - 1s - loss: 0.0676
Epoch 39/80
 - 1s - loss: 0.0667
Epoch 40/80
 - 1s - loss: 0.0659
Epoch 41/80
 - 1s - loss: 0.0653
Epoch 42/80
 - 1s - loss: 0.0646
Epoch 43/80
 - 1s - loss: 0.0640
Epoch 44/80
 - 1s - loss: 0.0636
Epoch 45/80
 - 1s - loss: 0.0631
Epoch 46/80
 - 1s - loss: 0.0627
Epoch 47/80
 - 1s - loss: 0.0623
Epoch 48/80
 - 1s - loss: 0.0620
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 13:01:28.135622: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:01:28.307779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:01:28.307825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:01:28.603857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:01:28.603911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:01:28.603921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:01:28.604213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36244 rows...
Finished. It takes 5.5 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 4s - loss: 0.4964
Epoch 2/80
 - 4s - loss: 0.1126
Epoch 3/80
 - 4s - loss: 0.0982
Epoch 4/80
 - 3s - loss: 0.0892
Epoch 5/80
 - 4s - loss: 0.0823
Epoch 6/80
 - 3s - loss: 0.0766
Epoch 7/80
 - 3s - loss: 0.0711
Epoch 8/80
 - 4s - loss: 0.0657
Epoch 9/80
 - 3s - loss: 0.0608
Epoch 10/80
 - 3s - loss: 0.0568
Epoch 11/80
 - 3s - loss: 0.0534
Epoch 12/80
 - 3s - loss: 0.0505
Epoch 13/80
 - 4s - loss: 0.0481
Epoch 14/80
 - 3s - loss: 0.0462
Epoch 15/80
 - 3s - loss: 0.0446
Epoch 16/80
 - 3s - loss: 0.0434
Epoch 17/80
 - 3s - loss: 0.0423
Epoch 18/80
 - 4s - loss: 0.0415
Epoch 19/80
 - 3s - loss: 0.0407
Epoch 20/80
 - 3s - loss: 0.0402
Epoch 21/80
 - 4s - loss: 0.0397
Epoch 22/80
 - 4s - loss: 0.0393
Epoch 23/80
 - 4s - loss: 0.0389
Epoch 24/80
 - 4s - loss: 0.0386
Epoch 25/80
 - 3s - loss: 0.0384
Epoch 26/80
 - 3s - loss: 0.0382
Epoch 27/80
 - 4s - loss: 0.0380
Epoch 28/80
 - 3s - loss: 0.0378
Epoch 29/80
 - 3s - loss: 0.0377
Epoch 30/80
 - 3s - loss: 0.0375
Epoch 31/80
 - 3s - loss: 0.0374
Epoch 32/80
 - 3s - loss: 0.0373
Epoch 33/80
 - 3s - loss: 0.0372
Epoch 34/80
 - 3s - loss: 0.0371
Epoch 35/80
 - 3s - loss: 0.0371
Epoch 36/80
 - 4s - loss: 0.0370
Epoch 37/80
 - 3s - loss: 0.0369
Epoch 38/80
 - 3s - loss: 0.0369
Epoch 39/80
 - 3s - loss: 0.0368
Epoch 40/80
 - 3s - loss: 0.0368
Epoch 41/80
 - 4s - loss: 0.0367
Epoch 42/80
 - 4s - loss: 0.0367
Epoch 43/80
 - 4s - loss: 0.0366
Epoch 44/80
 - 4s - loss: 0.0366
Epoch 45/80
 - 3s - loss: 0.0366
Epoch 46/80
 - 3s - loss: 0.0365
Epoch 47/80
 - 3s - loss: 0.0365
Epoch 48/80
 - 3s - loss: 0.0365
Epoch 49/80
 - 3s - loss: 0.0365
Epoch 50/80
 - 3s - loss: 0.0353
Epoch 51/80
 - 3s - loss: 0.0352
Epoch 52/80
 - 4s - loss: 0.0351
Epoch 53/80
 - 4s - loss: 0.0351
Epoch 54/80
 - 4s - loss: 0.0351
Epoch 55/80
 - 4s - loss: 0.0348
Epoch 56/80
 - 4s - loss: 0.0348
Epoch 57/80
 - 4s - loss: 0.0348
Epoch 58/80
 - 3s - loss: 0.0348
Epoch 59/80
 - 4s - loss: 0.0348
Epoch 60/80
 - 4s - loss: 0.0348
Epoch 61/80
 - 3s - loss: 0.0348
Epoch 62/80
 - 3s - loss: 0.0347
Epoch 63/80
 - 3s - loss: 0.0347
Epoch 64/80
 - 4s - loss: 0.0347
Epoch 65/80
 - 3s - loss: 0.0347
Epoch 66/80
 - 3s - loss: 0.0347
Epoch 67/80
 - 3s - loss: 0.0347
Epoch 68/80
 - 3s - loss: 0.0347
Epoch 69/80
 - 3s - loss: 0.0347
Epoch 70/80
 - 3s - loss: 0.0347
Epoch 71/80
 - 4s - loss: 0.0347
Epoch 72/80
 - 3s - loss: 0.0347
Epoch 73/80
 - 3s - loss: 0.0347
Epoch 74/80
 - 3s - loss: 0.0347
Epoch 75/80
 - 3s - loss: 0.0347
Epoch 76/80
 - 3s - loss: 0.0347
Epoch 77/80
 - 4s - loss: 0.0347
Epoch 78/80
 - 4s - loss: 0.0347
Epoch 79/80
 - 3s - loss: 0.0347
Epoch 80/80
 - 3s - loss: 0.0347
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28995 samples, validate on 7249 samples
Epoch 1/80
 - 1s - loss: 4.7921 - val_loss: 1.6505
AUC: 0.7965

Epoch 2/80
 - 0s - loss: 2.9823 - val_loss: 0.9377
AUC: 0.8175

Epoch 3/80
 - 0s - loss: 1.8895 - val_loss: 0.7733
AUC: 0.8327

Epoch 4/80
 - 0s - loss: 1.4180 - val_loss: 0.7518
AUC: 0.8397

Epoch 5/80
 - 0s - loss: 1.2531 - val_loss: 0.7648
AUC: 0.8459

Epoch 6/80
 - 0s - loss: 1.1982 - val_loss: 0.6353
AUC: 0.8453

Epoch 7/80
 - 0s - loss: 1.1548 - val_loss: 0.6835
AUC: 0.8527

Epoch 8/80
 - 0s - loss: 1.1326 - val_loss: 0.6404
AUC: 0.8558

Epoch 9/80
 - 0s - loss: 1.1203 - val_loss: 0.6643
AUC: 0.8583

Epoch 10/80
 - 0s - loss: 1.1022 - val_loss: 0.6945
AUC: 0.8599

Epoch 11/80
 - 0s - loss: 1.0887 - val_loss: 0.5985
AUC: 0.8599

Epoch 12/80
 - 0s - loss: 1.0739 - val_loss: 0.6486
AUC: 0.8627

Epoch 13/80
 - 0s - loss: 1.0655 - val_loss: 0.6206
AUC: 0.8640

Epoch 14/80
 - 0s - loss: 1.0593 - val_loss: 0.6387
AUC: 0.8651

Epoch 15/80
 - 0s - loss: 1.0656 - val_loss: 0.5613
AUC: 0.8648

Epoch 16/80
 - 0s - loss: 1.0501 - val_loss: 0.5707
AUC: 0.8662

Epoch 17/80
 - 0s - loss: 1.0505 - val_loss: 0.5775
AUC: 0.8669

Epoch 18/80
 - 0s - loss: 1.0466 - val_loss: 0.6371
AUC: 0.8684

Epoch 19/80
 - 0s - loss: 1.0426 - val_loss: 0.6184
AUC: 0.8693

Epoch 20/80
 - 0s - loss: 1.0350 - val_loss: 0.6298
AUC: 0.8693

Epoch 21/80
 - 0s - loss: 1.0270 - val_loss: 0.5490
AUC: 0.8687

Epoch 22/80
 - 0s - loss: 1.0250 - val_loss: 0.6187
AUC: 0.8706

Epoch 23/80
 - 0s - loss: 1.0204 - val_loss: 0.6236
AUC: 0.8703

Epoch 24/80
 - 0s - loss: 1.0184 - val_loss: 0.5792
AUC: 0.8710

Epoch 25/80
 - 0s - loss: 1.0161 - val_loss: 0.6419
AUC: 0.8718

Epoch 26/80
 - 0s - loss: 1.0146 - val_loss: 0.6080
AUC: 0.8724

Epoch 27/80
 - 0s - loss: 1.0091 - val_loss: 0.6024
AUC: 0.8723

Epoch 28/80
 - 0s - loss: 1.0053 - val_loss: 0.5837
AUC: 0.8732

Epoch 29/80
 - 0s - loss: 1.0094 - val_loss: 0.6190
AUC: 0.8726

Epoch 30/80
 - 0s - loss: 1.0038 - val_loss: 0.6007
AUC: 0.8727

Epoch 31/80
 - 0s - loss: 1.0065 - val_loss: 0.6193
AUC: 0.8741

Epoch 32/80
 - 0s - loss: 0.9953 - val_loss: 0.5949
AUC: 0.8743

Epoch 33/80
 - 0s - loss: 0.9918 - val_loss: 0.6060
AUC: 0.8743

Epoch 34/80
 - 0s - loss: 0.9967 - val_loss: 0.5920
AUC: 0.8744

Epoch 35/80
 - 0s - loss: 0.9894 - val_loss: 0.5986
AUC: 0.8744

Epoch 36/80
 - 0s - loss: 0.9944 - val_loss: 0.6127
AUC: 0.8744

Epoch 37/80
 - 0s - loss: 0.9852 - val_loss: 0.5930
AUC: 0.8743

Epoch 38/80
 - 0s - loss: 0.9895 - val_loss: 0.5976
AUC: 0.8746

Epoch 39/80
 - 0s - loss: 0.9895 - val_loss: 0.5955
AUC: 0.8746

Epoch 40/80
 - 0s - loss: 0.9844 - val_loss: 0.6038
AUC: 0.8746

Epoch 41/80
 - 0s - loss: 0.9897 - val_loss: 0.6195
AUC: 0.8748

Epoch 42/80
 - 0s - loss: 0.9859 - val_loss: 0.6037
AUC: 0.8747

Epoch 43/80
 - 0s - loss: 0.9890 - val_loss: 0.6049
AUC: 0.8747

Epoch 44/80
 - 0s - loss: 0.9844 - val_loss: 0.6107
AUC: 0.8748

Epoch 45/80
 - 0s - loss: 0.9859 - val_loss: 0.6020
AUC: 0.8747

Epoch 46/80
 - 0s - loss: 0.9855 - val_loss: 0.6026
AUC: 0.8748

Epoch 47/80
 - 0s - loss: 0.9844 - val_loss: 0.6036
AUC: 0.8748

Epoch 48/80
 - 0s - loss: 0.9835 - val_loss: 0.6077
AUC: 0.8749

Epoch 49/80
 - 0s - loss: 0.9836 - val_loss: 0.6013
AUC: 0.8748

Epoch 50/80
 - 0s - loss: 0.9870 - val_loss: 0.6093
AUC: 0.8749

Epoch 51/80
 - 0s - loss: 0.9845 - val_loss: 0.6013
AUC: 0.8748

Train on 28995 samples, validate on 7249 samples
Epoch 1/30
 - 1s - loss: 0.9870 - val_loss: 0.6148
AUC: 0.8752

Epoch 2/30
 - 0s - loss: 0.9874 - val_loss: 0.6086
AUC: 0.8755

Epoch 3/30
 - 0s - loss: 0.9801 - val_loss: 0.6064
AUC: 0.8755

Epoch 4/30
 - 0s - loss: 0.9788 - val_loss: 0.6147
AUC: 0.8757

Epoch 5/30
 - 0s - loss: 0.9800 - val_loss: 0.5876
AUC: 0.8757

Epoch 6/30
 - 0s - loss: 0.9776 - val_loss: 0.5956
AUC: 0.8760

Epoch 7/30
 - 0s - loss: 0.9705 - val_loss: 0.5830
AUC: 0.8759

Epoch 8/30
 - 0s - loss: 0.9759 - val_loss: 0.5879
AUC: 0.8761

Epoch 9/30
 - 0s - loss: 0.9777 - val_loss: 0.5904
AUC: 0.8763

Epoch 10/30
 - 0s - loss: 0.9694 - val_loss: 0.5879
AUC: 0.8764

Epoch 11/30
 - 0s - loss: 0.9682 - val_loss: 0.5828
AUC: 0.8765

Epoch 12/30
 - 0s - loss: 0.9699 - val_loss: 0.5866
AUC: 0.8766

Epoch 13/30
 - 0s - loss: 0.9657 - val_loss: 0.5825
AUC: 0.8766

Epoch 14/30
 - 0s - loss: 0.9637 - val_loss: 0.5972
AUC: 0.8771

Epoch 15/30
 - 0s - loss: 0.9606 - val_loss: 0.5838
AUC: 0.8771

Epoch 16/30
 - 0s - loss: 0.9589 - val_loss: 0.6095
AUC: 0.8775

Epoch 17/30
 - 0s - loss: 0.9571 - val_loss: 0.5802
AUC: 0.8772

Epoch 18/30
 - 0s - loss: 0.9602 - val_loss: 0.5883
AUC: 0.8774

Epoch 19/30
 - 0s - loss: 0.9635 - val_loss: 0.5758
AUC: 0.8775

Epoch 20/30
 - 0s - loss: 0.9553 - val_loss: 0.6009
AUC: 0.8779

Epoch 21/30
 - 0s - loss: 0.9552 - val_loss: 0.5962
AUC: 0.8780

Epoch 22/30
 - 0s - loss: 0.9511 - val_loss: 0.5845
AUC: 0.8779

Epoch 23/30
 - 0s - loss: 0.9480 - val_loss: 0.5805
AUC: 0.8780

Epoch 24/30
 - 0s - loss: 0.9519 - val_loss: 0.5833
AUC: 0.8782

Epoch 25/30
 - 0s - loss: 0.9522 - val_loss: 0.5839
AUC: 0.8784

Epoch 26/30
 - 0s - loss: 0.9439 - val_loss: 0.5742
AUC: 0.8784

Epoch 27/30
 - 0s - loss: 0.9418 - val_loss: 0.5795
AUC: 0.8784

Epoch 28/30
 - 0s - loss: 0.9410 - val_loss: 0.5842
AUC: 0.8787

Epoch 29/30
 - 0s - loss: 0.9400 - val_loss: 0.5687
AUC: 0.8784

Epoch 30/30
 - 0s - loss: 0.9357 - val_loss: 0.5576
Using TensorFlow backend.
AUC: 0.8784

2019-03-08 13:07:36.285458: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:07:36.457332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:07:36.457378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:07:36.757477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:07:36.757533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:07:36.757542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:07:36.757812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35997 rows...
Finished. It takes 5.1 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 0.8252
Epoch 2/80
 - 2s - loss: 0.1643
Epoch 3/80
 - 3s - loss: 0.1432
Epoch 4/80
 - 3s - loss: 0.1323
Epoch 5/80
 - 3s - loss: 0.1202
Epoch 6/80
 - 2s - loss: 0.1098
Epoch 7/80
 - 2s - loss: 0.1016
Epoch 8/80
 - 2s - loss: 0.0946
Epoch 9/80
 - 2s - loss: 0.0881
Epoch 10/80
 - 2s - loss: 0.0821
Epoch 11/80
 - 2s - loss: 0.0768
Epoch 12/80
 - 2s - loss: 0.0720
Epoch 13/80
 - 2s - loss: 0.0678
Epoch 14/80
 - 2s - loss: 0.0642
Epoch 15/80
 - 2s - loss: 0.0611
Epoch 16/80
 - 2s - loss: 0.0587
Epoch 17/80
 - 2s - loss: 0.0566
Epoch 18/80
 - 2s - loss: 0.0550
Epoch 19/80
 - 2s - loss: 0.0536
Epoch 20/80
 - 2s - loss: 0.0525
Epoch 21/80
 - 2s - loss: 0.0515
Epoch 22/80
 - 2s - loss: 0.0507
Epoch 23/80
 - 2s - loss: 0.0500
Epoch 24/80
 - 2s - loss: 0.0494
Epoch 25/80
 - 2s - loss: 0.0489
Epoch 26/80
 - 2s - loss: 0.0485
Epoch 27/80
 - 2s - loss: 0.0481
Epoch 28/80
 - 2s - loss: 0.0478
Epoch 29/80
 - 2s - loss: 0.0475
Epoch 30/80
 - 2s - loss: 0.0472
Epoch 31/80
 - 3s - loss: 0.0470
Epoch 32/80
 - 3s - loss: 0.0468
Epoch 33/80
 - 3s - loss: 0.0467
Epoch 34/80
 - 3s - loss: 0.0465
Epoch 35/80
 - 3s - loss: 0.0464
Epoch 36/80
 - 2s - loss: 0.0463
Epoch 37/80
 - 2s - loss: 0.0462
Epoch 38/80
 - 2s - loss: 0.0461
Epoch 39/80
 - 3s - loss: 0.0460
Epoch 40/80
 - 2s - loss: 0.0459
Epoch 41/80
 - 2s - loss: 0.0458
Epoch 42/80
 - 2s - loss: 0.0457
Epoch 43/80
 - 2s - loss: 0.0457
Epoch 44/80
 - 2s - loss: 0.0456
Epoch 45/80
 - 2s - loss: 0.0456
Epoch 46/80
 - 2s - loss: 0.0455
Epoch 47/80
 - 2s - loss: 0.0455
Epoch 48/80
 - 2s - loss: 0.0454
Epoch 49/80
 - 2s - loss: 0.0454
Epoch 50/80
 - 2s - loss: 0.0453
Epoch 51/80
 - 2s - loss: 0.0453
Epoch 52/80
 - 2s - loss: 0.0453
Epoch 53/80
 - 2s - loss: 0.0452
Epoch 54/80
 - 2s - loss: 0.0452
Epoch 55/80
 - 3s - loss: 0.0441
Epoch 56/80
 - 3s - loss: 0.0440
Epoch 57/80
 - 2s - loss: 0.0439
Epoch 58/80
 - 2s - loss: 0.0439
Epoch 59/80
 - 2s - loss: 0.0439
Epoch 60/80
 - 2s - loss: 0.0436
Epoch 61/80
 - 2s - loss: 0.0436
Epoch 62/80
 - 2s - loss: 0.0436
Epoch 63/80
 - 2s - loss: 0.0436
Epoch 64/80
 - 2s - loss: 0.0436
Epoch 65/80
 - 2s - loss: 0.0436
Epoch 66/80
 - 2s - loss: 0.0436
Epoch 67/80
 - 2s - loss: 0.0435
Epoch 68/80
 - 2s - loss: 0.0435
Epoch 69/80
 - 2s - loss: 0.0435
Epoch 70/80
 - 2s - loss: 0.0435
Epoch 71/80
 - 2s - loss: 0.0435
Epoch 72/80
 - 2s - loss: 0.0435
Epoch 73/80
 - 2s - loss: 0.0435
Epoch 74/80
 - 2s - loss: 0.0435
Epoch 75/80
 - 2s - loss: 0.0435
Epoch 76/80
 - 2s - loss: 0.0435
Epoch 77/80
 - 2s - loss: 0.0435
Epoch 78/80
 - 2s - loss: 0.0435
Epoch 79/80
 - 2s - loss: 0.0435
Epoch 80/80
 - 2s - loss: 0.0435
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28797 samples, validate on 7200 samples
Epoch 1/80
 - 1s - loss: 5.3449 - val_loss: 2.3494
AUC: 0.7868

Epoch 2/80
 - 0s - loss: 3.3183 - val_loss: 1.1261
AUC: 0.8067

Epoch 3/80
 - 0s - loss: 2.1520 - val_loss: 0.9914
AUC: 0.8134

Epoch 4/80
 - 0s - loss: 1.5555 - val_loss: 0.7704
AUC: 0.8208

Epoch 5/80
 - 0s - loss: 1.2852 - val_loss: 0.6838
AUC: 0.8244

Epoch 6/80
 - 0s - loss: 1.1964 - val_loss: 0.7285
AUC: 0.8283

Epoch 7/80
 - 0s - loss: 1.1499 - val_loss: 0.7219
AUC: 0.8343

Epoch 8/80
 - 0s - loss: 1.1262 - val_loss: 0.6138
AUC: 0.8339

Epoch 9/80
 - 0s - loss: 1.1183 - val_loss: 0.7164
AUC: 0.8393

Epoch 10/80
 - 0s - loss: 1.1001 - val_loss: 0.6426
AUC: 0.8417

Epoch 11/80
 - 0s - loss: 1.0886 - val_loss: 0.6776
AUC: 0.8446

Epoch 12/80
 - 0s - loss: 1.0716 - val_loss: 0.6337
AUC: 0.8453

Epoch 13/80
 - 0s - loss: 1.0634 - val_loss: 0.6862
AUC: 0.8475

Epoch 14/80
 - 0s - loss: 1.0619 - val_loss: 0.6631
AUC: 0.8480

Epoch 15/80
 - 0s - loss: 1.0588 - val_loss: 0.6789
AUC: 0.8492

Epoch 16/80
 - 0s - loss: 1.0474 - val_loss: 0.6638
AUC: 0.8505

Epoch 17/80
 - 0s - loss: 1.0412 - val_loss: 0.7271
AUC: 0.8523

Epoch 18/80
 - 0s - loss: 1.0367 - val_loss: 0.6433
AUC: 0.8518

Epoch 19/80
 - 0s - loss: 1.0280 - val_loss: 0.6560
AUC: 0.8522

Epoch 20/80
 - 0s - loss: 1.0296 - val_loss: 0.6515
AUC: 0.8528

Epoch 21/80
 - 0s - loss: 1.0225 - val_loss: 0.6460
AUC: 0.8526

Epoch 22/80
 - 0s - loss: 1.0260 - val_loss: 0.6688
AUC: 0.8535

Epoch 23/80
 - 0s - loss: 1.0262 - val_loss: 0.6539
AUC: 0.8531

Epoch 24/80
 - 0s - loss: 1.0195 - val_loss: 0.6523
AUC: 0.8538

Epoch 25/80
 - 0s - loss: 1.0261 - val_loss: 0.6481
AUC: 0.8536

Epoch 26/80
 - 0s - loss: 1.0256 - val_loss: 0.6466
AUC: 0.8536

Epoch 27/80
 - 0s - loss: 1.0249 - val_loss: 0.6302
AUC: 0.8534

Epoch 28/80
 - 0s - loss: 1.0160 - val_loss: 0.6440
AUC: 0.8537

Epoch 29/80
 - 0s - loss: 1.0187 - val_loss: 0.6336
AUC: 0.8538

Epoch 30/80
 - 0s - loss: 1.0189 - val_loss: 0.6403
AUC: 0.8541

Epoch 31/80
 - 0s - loss: 1.0145 - val_loss: 0.6437
AUC: 0.8541

Epoch 32/80
 - 0s - loss: 1.0162 - val_loss: 0.6470
AUC: 0.8543

Epoch 33/80
 - 0s - loss: 1.0150 - val_loss: 0.6422
AUC: 0.8542

Epoch 34/80
 - 0s - loss: 1.0172 - val_loss: 0.6355
AUC: 0.8541

Epoch 35/80
 - 0s - loss: 1.0143 - val_loss: 0.6387
AUC: 0.8541

Epoch 36/80
 - 0s - loss: 1.0170 - val_loss: 0.6395
AUC: 0.8543

Epoch 37/80
 - 0s - loss: 1.0184 - val_loss: 0.6359
AUC: 0.8542

Epoch 38/80
 - 0s - loss: 1.0179 - val_loss: 0.6338
AUC: 0.8543

Train on 28797 samples, validate on 7200 samples
Epoch 1/30
 - 1s - loss: 1.0125 - val_loss: 0.6297
AUC: 0.8545

Epoch 2/30
 - 0s - loss: 1.0145 - val_loss: 0.6377
AUC: 0.8550

Epoch 3/30
 - 0s - loss: 1.0180 - val_loss: 0.6369
AUC: 0.8554

Epoch 4/30
 - 0s - loss: 1.0124 - val_loss: 0.6338
AUC: 0.8558

Epoch 5/30
 - 0s - loss: 1.0055 - val_loss: 0.6431
AUC: 0.8560

Epoch 6/30
 - 0s - loss: 1.0033 - val_loss: 0.6186
AUC: 0.8558

Epoch 7/30
 - 0s - loss: 1.0101 - val_loss: 0.6343
AUC: 0.8563

Epoch 8/30
 - 0s - loss: 0.9979 - val_loss: 0.6281
AUC: 0.8563

Epoch 9/30
 - 0s - loss: 1.0032 - val_loss: 0.6211
AUC: 0.8566

Epoch 10/30
 - 0s - loss: 1.0046 - val_loss: 0.6249
AUC: 0.8567

Epoch 11/30
 - 0s - loss: 0.9946 - val_loss: 0.6221
AUC: 0.8571

Epoch 12/30
 - 0s - loss: 0.9999 - val_loss: 0.6332
AUC: 0.8577

Epoch 13/30
 - 0s - loss: 0.9965 - val_loss: 0.6311
AUC: 0.8578

Epoch 14/30
 - 0s - loss: 0.9932 - val_loss: 0.6371
AUC: 0.8583

Epoch 15/30
 - 0s - loss: 0.9911 - val_loss: 0.6167
AUC: 0.8582

Epoch 16/30
 - 0s - loss: 0.9932 - val_loss: 0.6114
AUC: 0.8583

Epoch 17/30
 - 0s - loss: 0.9862 - val_loss: 0.6294
AUC: 0.8589

Epoch 18/30
 - 0s - loss: 0.9905 - val_loss: 0.6134
AUC: 0.8586

Epoch 19/30
 - 0s - loss: 0.9867 - val_loss: 0.6121
AUC: 0.8589

Epoch 20/30
 - 0s - loss: 0.9839 - val_loss: 0.6298
AUC: 0.8595

Epoch 21/30
 - 0s - loss: 0.9871 - val_loss: 0.6208
AUC: 0.8595

Epoch 22/30
 - 0s - loss: 0.9873 - val_loss: 0.6376
AUC: 0.8601

Epoch 23/30
 - 0s - loss: 0.9820 - val_loss: 0.6346
AUC: 0.8602

Epoch 24/30
 - 0s - loss: 0.9831 - val_loss: 0.6185
AUC: 0.8600

Epoch 25/30
 - 0s - loss: 0.9783 - val_loss: 0.6169
AUC: 0.8603

Epoch 26/30
 - 0s - loss: 0.9821 - val_loss: 0.6286
AUC: 0.8608

Epoch 27/30
 - 0s - loss: 0.9690 - val_loss: 0.6170
AUC: 0.8606

Epoch 28/30
 - 0s - loss: 0.9761 - val_loss: 0.6163
AUC: 0.8605

Epoch 29/30
 - 0s - loss: 0.9742 - val_loss: 0.6174
AUC: 0.8606

Epoch 30/30
 - 0s - loss: 0.9732 - val_loss: 0.6184
Using TensorFlow backend.
AUC: 0.8606

2019-03-08 13:12:09.497122: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:12:09.666230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:12:09.666291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:12:09.972266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:12:09.972321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:12:09.972331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:12:09.972596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35692 rows...
Finished. It takes 4.7 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.3113
Epoch 2/80
 - 2s - loss: 0.2473
Epoch 3/80
 - 2s - loss: 0.1854
Epoch 4/80
 - 2s - loss: 0.1776
Epoch 5/80
 - 2s - loss: 0.1725
Epoch 6/80
 - 2s - loss: 0.1668
Epoch 7/80
 - 2s - loss: 0.1600
Epoch 8/80
 - 2s - loss: 0.1523
Epoch 9/80
 - 2s - loss: 0.1437
Epoch 10/80
 - 2s - loss: 0.1336
Epoch 11/80
 - 2s - loss: 0.1223
Epoch 12/80
 - 2s - loss: 0.1116
Epoch 13/80
 - 2s - loss: 0.1026
Epoch 14/80
 - 2s - loss: 0.0952
Epoch 15/80
 - 2s - loss: 0.0890
Epoch 16/80
 - 2s - loss: 0.0837
Epoch 17/80
 - 2s - loss: 0.0792
Epoch 18/80
 - 2s - loss: 0.0754
Epoch 19/80
 - 2s - loss: 0.0721
Epoch 20/80
 - 2s - loss: 0.0692
Epoch 21/80
 - 2s - loss: 0.0668
Epoch 22/80
 - 2s - loss: 0.0648
Epoch 23/80
 - 2s - loss: 0.0631
Epoch 24/80
 - 2s - loss: 0.0617
Epoch 25/80
 - 2s - loss: 0.0605
Epoch 26/80
 - 2s - loss: 0.0595
Epoch 27/80
 - 2s - loss: 0.0586
Epoch 28/80
 - 2s - loss: 0.0578
Epoch 29/80
 - 2s - loss: 0.0572
Epoch 30/80
 - 2s - loss: 0.0566
Epoch 31/80
 - 2s - loss: 0.0561
Epoch 32/80
 - 2s - loss: 0.0557
Epoch 33/80
 - 2s - loss: 0.0553
Epoch 34/80
 - 2s - loss: 0.0549
Epoch 35/80
 - 2s - loss: 0.0546
Epoch 36/80
 - 2s - loss: 0.0543
Epoch 37/80
 - 2s - loss: 0.0541
Epoch 38/80
 - 2s - loss: 0.0539
Epoch 39/80
 - 2s - loss: 0.0537
Epoch 40/80
 - 2s - loss: 0.0535
Epoch 41/80
 - 2s - loss: 0.0533
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 13:13:50.701140: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:13:50.871353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:13:50.871414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:13:51.164941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:13:51.164997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:13:51.165007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:13:51.165271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36264 rows...
Finished. It takes 5.7 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 4s - loss: 0.4702
Epoch 2/80
 - 4s - loss: 0.1107
Epoch 3/80
 - 4s - loss: 0.0982
Epoch 4/80
 - 4s - loss: 0.0886
Epoch 5/80
 - 4s - loss: 0.0822
Epoch 6/80
 - 4s - loss: 0.0769
Epoch 7/80
 - 4s - loss: 0.0711
Epoch 8/80
 - 4s - loss: 0.0648
Epoch 9/80
 - 4s - loss: 0.0591
Epoch 10/80
 - 4s - loss: 0.0546
Epoch 11/80
 - 4s - loss: 0.0511
Epoch 12/80
 - 4s - loss: 0.0484
Epoch 13/80
 - 4s - loss: 0.0462
Epoch 14/80
 - 4s - loss: 0.0444
Epoch 15/80
 - 4s - loss: 0.0429
Epoch 16/80
 - 4s - loss: 0.0417
Epoch 17/80
 - 4s - loss: 0.0408
Epoch 18/80
 - 4s - loss: 0.0400
Epoch 19/80
 - 4s - loss: 0.0394
Epoch 20/80
 - 4s - loss: 0.0389
Epoch 21/80
 - 4s - loss: 0.0384
Epoch 22/80
 - 4s - loss: 0.0381
Epoch 23/80
 - 4s - loss: 0.0378
Epoch 24/80
 - 4s - loss: 0.0375
Epoch 25/80
 - 4s - loss: 0.0373
Epoch 26/80
 - 4s - loss: 0.0371
Epoch 27/80
 - 4s - loss: 0.0370
Epoch 28/80
 - 4s - loss: 0.0368
Epoch 29/80
 - 4s - loss: 0.0367
Epoch 30/80
 - 4s - loss: 0.0366
Epoch 31/80
 - 4s - loss: 0.0365
Epoch 32/80
 - 4s - loss: 0.0364
Epoch 33/80
 - 4s - loss: 0.0363
Epoch 34/80
 - 4s - loss: 0.0363
Epoch 35/80
 - 4s - loss: 0.0362
Epoch 36/80
 - 4s - loss: 0.0361
Epoch 37/80
 - 4s - loss: 0.0361
Epoch 38/80
 - 4s - loss: 0.0360
Epoch 39/80
 - 4s - loss: 0.0360
Epoch 40/80
 - 4s - loss: 0.0359
Epoch 41/80
 - 4s - loss: 0.0359
Epoch 42/80
 - 4s - loss: 0.0359
Epoch 43/80
 - 4s - loss: 0.0358
Epoch 44/80
 - 4s - loss: 0.0358
Epoch 45/80
 - 4s - loss: 0.0358
Epoch 46/80
 - 4s - loss: 0.0357
Epoch 47/80
 - 4s - loss: 0.0357
Epoch 48/80
 - 4s - loss: 0.0357
Epoch 49/80
 - 4s - loss: 0.0357
Epoch 50/80
 - 4s - loss: 0.0345
Epoch 51/80
 - 4s - loss: 0.0344
Epoch 52/80
 - 4s - loss: 0.0344
Epoch 53/80
 - 4s - loss: 0.0344
Epoch 54/80
 - 4s - loss: 0.0344
Epoch 55/80
 - 4s - loss: 0.0341
Epoch 56/80
 - 4s - loss: 0.0340
Epoch 57/80
 - 4s - loss: 0.0340
Epoch 58/80
 - 4s - loss: 0.0340
Epoch 59/80
 - 4s - loss: 0.0340
Epoch 60/80
 - 4s - loss: 0.0340
Epoch 61/80
 - 4s - loss: 0.0340
Epoch 62/80
 - 4s - loss: 0.0340
Epoch 63/80
 - 4s - loss: 0.0340
Epoch 64/80
 - 4s - loss: 0.0340
Epoch 65/80
 - 4s - loss: 0.0340
Epoch 66/80
 - 4s - loss: 0.0340
Epoch 67/80
 - 4s - loss: 0.0340
Epoch 68/80
 - 4s - loss: 0.0340
Epoch 69/80
 - 4s - loss: 0.0340
Epoch 70/80
 - 4s - loss: 0.0340
Epoch 71/80
 - 4s - loss: 0.0340
Epoch 72/80
 - 4s - loss: 0.0340
Epoch 73/80
 - 4s - loss: 0.0340
Epoch 74/80
 - 4s - loss: 0.0340
Epoch 75/80
 - 4s - loss: 0.0340
Epoch 76/80
 - 4s - loss: 0.0340
Epoch 77/80
 - 4s - loss: 0.0340
Epoch 78/80
 - 4s - loss: 0.0340
Epoch 79/80
 - 4s - loss: 0.0340
Epoch 80/80
 - 4s - loss: 0.0340
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 29011 samples, validate on 7253 samples
Epoch 1/80
 - 1s - loss: 7.3352 - val_loss: 1.5054
AUC: 0.7266

Epoch 2/80
 - 0s - loss: 4.0257 - val_loss: 1.3331
AUC: 0.7835

Epoch 3/80
 - 0s - loss: 3.0111 - val_loss: 1.0840
AUC: 0.8046

Epoch 4/80
 - 0s - loss: 2.3573 - val_loss: 0.9070
AUC: 0.8179

Epoch 5/80
 - 0s - loss: 1.7931 - val_loss: 0.8452
AUC: 0.8271

Epoch 6/80
 - 0s - loss: 1.4763 - val_loss: 0.7506
AUC: 0.8301

Epoch 7/80
 - 0s - loss: 1.2947 - val_loss: 0.6559
AUC: 0.8356

Epoch 8/80
 - 0s - loss: 1.1896 - val_loss: 0.6593
AUC: 0.8395

Epoch 9/80
 - 0s - loss: 1.1578 - val_loss: 0.6750
AUC: 0.8449

Epoch 10/80
 - 0s - loss: 1.1256 - val_loss: 0.6502
AUC: 0.8478

Epoch 11/80
 - 0s - loss: 1.1066 - val_loss: 0.6627
AUC: 0.8495

Epoch 12/80
 - 0s - loss: 1.1002 - val_loss: 0.6482
AUC: 0.8508

Epoch 13/80
 - 0s - loss: 1.0769 - val_loss: 0.6120
AUC: 0.8507

Epoch 14/80
 - 0s - loss: 1.0774 - val_loss: 0.6708
AUC: 0.8538

Epoch 15/80
 - 0s - loss: 1.0747 - val_loss: 0.6524
AUC: 0.8534

Epoch 16/80
 - 0s - loss: 1.0602 - val_loss: 0.6054
AUC: 0.8531

Epoch 17/80
 - 0s - loss: 1.0512 - val_loss: 0.6592
AUC: 0.8553

Epoch 18/80
 - 0s - loss: 1.0525 - val_loss: 0.6701
AUC: 0.8559

Epoch 19/80
 - 0s - loss: 1.0368 - val_loss: 0.5942
AUC: 0.8552

Epoch 20/80
 - 0s - loss: 1.0449 - val_loss: 0.6146
AUC: 0.8569

Epoch 21/80
 - 0s - loss: 1.0368 - val_loss: 0.6397
AUC: 0.8581

Epoch 22/80
 - 0s - loss: 1.0298 - val_loss: 0.5934
AUC: 0.8570

Epoch 23/80
 - 0s - loss: 1.0284 - val_loss: 0.5996
AUC: 0.8576

Epoch 24/80
 - 0s - loss: 1.0230 - val_loss: 0.6228
AUC: 0.8584

Epoch 25/80
 - 0s - loss: 1.0115 - val_loss: 0.6344
AUC: 0.8593

Epoch 26/80
 - 0s - loss: 1.0111 - val_loss: 0.6849
AUC: 0.8595

Epoch 27/80
 - 0s - loss: 1.0146 - val_loss: 0.6036
AUC: 0.8590

Epoch 28/80
 - 0s - loss: 1.0101 - val_loss: 0.6321
AUC: 0.8596

Epoch 29/80
 - 0s - loss: 1.0023 - val_loss: 0.6215
AUC: 0.8596

Epoch 30/80
 - 0s - loss: 1.0059 - val_loss: 0.6182
AUC: 0.8601

Epoch 31/80
 - 0s - loss: 1.0031 - val_loss: 0.5461
AUC: 0.8594

Epoch 32/80
 - 0s - loss: 1.0044 - val_loss: 0.6160
AUC: 0.8605

Epoch 33/80
 - 0s - loss: 0.9946 - val_loss: 0.6402
AUC: 0.8613

Epoch 34/80
 - 0s - loss: 0.9875 - val_loss: 0.6099
AUC: 0.8617

Epoch 35/80
 - 0s - loss: 0.9941 - val_loss: 0.6522
AUC: 0.8624

Epoch 36/80
 - 0s - loss: 0.9886 - val_loss: 0.5910
AUC: 0.8621

Epoch 37/80
 - 0s - loss: 0.9905 - val_loss: 0.6079
AUC: 0.8612

Epoch 38/80
 - 0s - loss: 0.9794 - val_loss: 0.5819
AUC: 0.8609

Epoch 39/80
 - 0s - loss: 0.9848 - val_loss: 0.6114
AUC: 0.8624

Epoch 40/80
 - 0s - loss: 0.9862 - val_loss: 0.5968
AUC: 0.8620

Epoch 41/80
 - 0s - loss: 0.9804 - val_loss: 0.5669
AUC: 0.8621

Epoch 42/80
 - 0s - loss: 0.9738 - val_loss: 0.5961
AUC: 0.8622

Epoch 43/80
 - 0s - loss: 0.9671 - val_loss: 0.6019
AUC: 0.8627

Epoch 44/80
 - 0s - loss: 0.9722 - val_loss: 0.6043
AUC: 0.8626

Epoch 45/80
 - 0s - loss: 0.9716 - val_loss: 0.5772
AUC: 0.8626

Epoch 46/80
 - 0s - loss: 0.9655 - val_loss: 0.5974
AUC: 0.8626

Epoch 47/80
 - 0s - loss: 0.9719 - val_loss: 0.5922
AUC: 0.8629

Epoch 48/80
 - 0s - loss: 0.9678 - val_loss: 0.5931
AUC: 0.8626

Epoch 49/80
 - 0s - loss: 0.9674 - val_loss: 0.6223
AUC: 0.8630

Epoch 50/80
 - 0s - loss: 0.9622 - val_loss: 0.5969
AUC: 0.8630

Epoch 51/80
 - 0s - loss: 0.9720 - val_loss: 0.5972
AUC: 0.8628

Epoch 52/80
 - 0s - loss: 0.9625 - val_loss: 0.6063
AUC: 0.8630

Epoch 53/80
 - 0s - loss: 0.9649 - val_loss: 0.5987
AUC: 0.8629

Epoch 54/80
 - 0s - loss: 0.9646 - val_loss: 0.5991
AUC: 0.8629

Epoch 55/80
 - 0s - loss: 0.9690 - val_loss: 0.6029
AUC: 0.8629

Epoch 56/80
 - 0s - loss: 0.9704 - val_loss: 0.6012
AUC: 0.8628

Epoch 57/80
 - 0s - loss: 0.9617 - val_loss: 0.5975
AUC: 0.8628

Epoch 58/80
 - 0s - loss: 0.9639 - val_loss: 0.6015
AUC: 0.8628

Epoch 59/80
 - 0s - loss: 0.9633 - val_loss: 0.6021
AUC: 0.8629

Epoch 60/80
 - 0s - loss: 0.9636 - val_loss: 0.5999
AUC: 0.8629

Epoch 61/80
 - 0s - loss: 0.9636 - val_loss: 0.5968
AUC: 0.8628

Train on 29011 samples, validate on 7253 samples
Epoch 1/30
 - 1s - loss: 0.9682 - val_loss: 0.5883
AUC: 0.8629

Epoch 2/30
 - 0s - loss: 0.9655 - val_loss: 0.6057
AUC: 0.8633

Epoch 3/30
 - 0s - loss: 0.9651 - val_loss: 0.5959
AUC: 0.8632

Epoch 4/30
 - 0s - loss: 0.9580 - val_loss: 0.6125
AUC: 0.8637

Epoch 5/30
 - 0s - loss: 0.9574 - val_loss: 0.6082
AUC: 0.8637

Epoch 6/30
 - 0s - loss: 0.9654 - val_loss: 0.6172
AUC: 0.8637

Epoch 7/30
 - 0s - loss: 0.9604 - val_loss: 0.5955
AUC: 0.8637

Epoch 8/30
 - 0s - loss: 0.9585 - val_loss: 0.5904
AUC: 0.8636

Epoch 9/30
 - 0s - loss: 0.9553 - val_loss: 0.5985
AUC: 0.8640

Epoch 10/30
 - 0s - loss: 0.9560 - val_loss: 0.5948
AUC: 0.8639

Epoch 11/30
 - 0s - loss: 0.9495 - val_loss: 0.5793
AUC: 0.8639

Epoch 12/30
 - 0s - loss: 0.9482 - val_loss: 0.6001
AUC: 0.8641

Epoch 13/30
 - 0s - loss: 0.9474 - val_loss: 0.5846
AUC: 0.8640

Epoch 14/30
 - 0s - loss: 0.9488 - val_loss: 0.5943
AUC: 0.8642

Epoch 15/30
 - 0s - loss: 0.9410 - val_loss: 0.5835
AUC: 0.8641

Epoch 16/30
 - 0s - loss: 0.9413 - val_loss: 0.5951
AUC: 0.8643

Epoch 17/30
 - 0s - loss: 0.9420 - val_loss: 0.5994
AUC: 0.8644

Epoch 18/30
 - 0s - loss: 0.9397 - val_loss: 0.5885
AUC: 0.8643

Epoch 19/30
 - 0s - loss: 0.9408 - val_loss: 0.6166
AUC: 0.8648

Epoch 20/30
 - 0s - loss: 0.9381 - val_loss: 0.5831
AUC: 0.8646

Epoch 21/30
 - 0s - loss: 0.9346 - val_loss: 0.5881
AUC: 0.8646

Epoch 22/30
 - 0s - loss: 0.9351 - val_loss: 0.5861
AUC: 0.8647

Epoch 23/30
 - 0s - loss: 0.9315 - val_loss: 0.5868
AUC: 0.8647

Epoch 24/30
 - 0s - loss: 0.9353 - val_loss: 0.5874
AUC: 0.8647

Epoch 25/30
 - 0s - loss: 0.9371 - val_loss: 0.5908
AUC: 0.8648

Epoch 26/30
 - 0s - loss: 0.9351 - val_loss: 0.5885
AUC: 0.8647

Epoch 27/30
 - 0s - loss: 0.9340 - val_loss: 0.5901
AUC: 0.8648

Epoch 28/30
 - 0s - loss: 0.9328 - val_loss: 0.5919
AUC: 0.8648

Epoch 29/30
 - 0s - loss: 0.9317 - val_loss: 0.5900
AUC: 0.8649

Epoch 30/30
 - 0s - loss: 0.9353 - val_loss: 0.5866
Using TensorFlow backend.
AUC: 0.8648

2019-03-08 13:20:09.229825: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:20:09.397557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:20:09.397604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:20:09.695347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:20:09.695404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:20:09.695414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:20:09.695681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 36115 rows...
Finished. It takes 5.2 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 4s - loss: 0.6270
Epoch 2/80
 - 3s - loss: 0.1370
Epoch 3/80
 - 3s - loss: 0.1227
Epoch 4/80
 - 3s - loss: 0.1145
Epoch 5/80
 - 3s - loss: 0.1073
Epoch 6/80
 - 3s - loss: 0.1003
Epoch 7/80
 - 3s - loss: 0.0927
Epoch 8/80
 - 3s - loss: 0.0847
Epoch 9/80
 - 3s - loss: 0.0776
Epoch 10/80
 - 3s - loss: 0.0713
Epoch 11/80
 - 3s - loss: 0.0660
Epoch 12/80
 - 3s - loss: 0.0617
Epoch 13/80
 - 3s - loss: 0.0582
Epoch 14/80
 - 3s - loss: 0.0553
Epoch 15/80
 - 3s - loss: 0.0530
Epoch 16/80
 - 3s - loss: 0.0511
Epoch 17/80
 - 3s - loss: 0.0496
Epoch 18/80
 - 3s - loss: 0.0484
Epoch 19/80
 - 3s - loss: 0.0474
Epoch 20/80
 - 3s - loss: 0.0466
Epoch 21/80
 - 3s - loss: 0.0460
Epoch 22/80
 - 3s - loss: 0.0454
Epoch 23/80
 - 3s - loss: 0.0449
Epoch 24/80
 - 3s - loss: 0.0446
Epoch 25/80
 - 3s - loss: 0.0442
Epoch 26/80
 - 3s - loss: 0.0439
Epoch 27/80
 - 3s - loss: 0.0437
Epoch 28/80
 - 3s - loss: 0.0435
Epoch 29/80
 - 3s - loss: 0.0433
Epoch 30/80
 - 3s - loss: 0.0431
Epoch 31/80
 - 3s - loss: 0.0430
Epoch 32/80
 - 3s - loss: 0.0428
Epoch 33/80
 - 3s - loss: 0.0427
Epoch 34/80
 - 3s - loss: 0.0426
Epoch 35/80
 - 3s - loss: 0.0425
Epoch 36/80
 - 3s - loss: 0.0424
Epoch 37/80
 - 3s - loss: 0.0423
Epoch 38/80
 - 3s - loss: 0.0422
Epoch 39/80
 - 3s - loss: 0.0421
Epoch 40/80
 - 3s - loss: 0.0421
Epoch 41/80
 - 3s - loss: 0.0420
Epoch 42/80
 - 3s - loss: 0.0420
Epoch 43/80
 - 3s - loss: 0.0419
Epoch 44/80
 - 3s - loss: 0.0419
Epoch 45/80
 - 3s - loss: 0.0418
Epoch 46/80
 - 3s - loss: 0.0418
Epoch 47/80
 - 3s - loss: 0.0417
Epoch 48/80
 - 3s - loss: 0.0417
Epoch 49/80
 - 3s - loss: 0.0416
Epoch 50/80
 - 3s - loss: 0.0416
Epoch 51/80
 - 3s - loss: 0.0416
Epoch 52/80
 - 3s - loss: 0.0416
Epoch 53/80
 - 3s - loss: 0.0415
Epoch 54/80
 - 3s - loss: 0.0415
Epoch 55/80
 - 3s - loss: 0.0404
Epoch 56/80
 - 3s - loss: 0.0402
Epoch 57/80
 - 3s - loss: 0.0402
Epoch 58/80
 - 3s - loss: 0.0402
Epoch 59/80
 - 3s - loss: 0.0402
Epoch 60/80
 - 3s - loss: 0.0399
Epoch 61/80
 - 3s - loss: 0.0399
Epoch 62/80
 - 3s - loss: 0.0399
Epoch 63/80
 - 3s - loss: 0.0399
Epoch 64/80
 - 3s - loss: 0.0398
Epoch 65/80
 - 3s - loss: 0.0398
Epoch 66/80
 - 3s - loss: 0.0398
Epoch 67/80
 - 3s - loss: 0.0398
Epoch 68/80
 - 3s - loss: 0.0398
Epoch 69/80
 - 3s - loss: 0.0398
Epoch 70/80
 - 3s - loss: 0.0398
Epoch 71/80
 - 3s - loss: 0.0398
Epoch 72/80
 - 3s - loss: 0.0398
Epoch 73/80
 - 3s - loss: 0.0398
Epoch 74/80
 - 3s - loss: 0.0398
Epoch 75/80
 - 3s - loss: 0.0398
Epoch 76/80
 - 3s - loss: 0.0398
Epoch 77/80
 - 3s - loss: 0.0398
Epoch 78/80
 - 3s - loss: 0.0398
Epoch 79/80
 - 3s - loss: 0.0398
Epoch 80/80
 - 3s - loss: 0.0398
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28892 samples, validate on 7223 samples
Epoch 1/80
 - 1s - loss: 9.3928 - val_loss: 1.4852
AUC: 0.6947

Epoch 2/80
 - 0s - loss: 3.9768 - val_loss: 1.4142
AUC: 0.7815

Epoch 3/80
 - 0s - loss: 2.9422 - val_loss: 1.2352
AUC: 0.8103

Epoch 4/80
 - 0s - loss: 2.1966 - val_loss: 0.9850
AUC: 0.8237

Epoch 5/80
 - 0s - loss: 1.6452 - val_loss: 0.8122
AUC: 0.8359

Epoch 6/80
 - 0s - loss: 1.4137 - val_loss: 0.7045
AUC: 0.8392

Epoch 7/80
 - 0s - loss: 1.2877 - val_loss: 0.7518
AUC: 0.8421

Epoch 8/80
 - 0s - loss: 1.2221 - val_loss: 0.6460
AUC: 0.8474

Epoch 9/80
 - 0s - loss: 1.1803 - val_loss: 0.6475
AUC: 0.8465

Epoch 10/80
 - 0s - loss: 1.1590 - val_loss: 0.7026
AUC: 0.8499

Epoch 11/80
 - 0s - loss: 1.1378 - val_loss: 0.6784
AUC: 0.8520

Epoch 12/80
 - 0s - loss: 1.1234 - val_loss: 0.6147
AUC: 0.8548

Epoch 13/80
 - 0s - loss: 1.1075 - val_loss: 0.6120
AUC: 0.8554

Epoch 14/80
 - 0s - loss: 1.1036 - val_loss: 0.6271
AUC: 0.8576

Epoch 15/80
 - 0s - loss: 1.0892 - val_loss: 0.6201
AUC: 0.8589

Epoch 16/80
 - 0s - loss: 1.0784 - val_loss: 0.6372
AUC: 0.8596

Epoch 17/80
 - 0s - loss: 1.0823 - val_loss: 0.6731
AUC: 0.8601

Epoch 18/80
 - 0s - loss: 1.0679 - val_loss: 0.6960
AUC: 0.8616

Epoch 19/80
 - 0s - loss: 1.0550 - val_loss: 0.6002
AUC: 0.8633

Epoch 20/80
 - 0s - loss: 1.0595 - val_loss: 0.6559
AUC: 0.8634

Epoch 21/80
 - 0s - loss: 1.0501 - val_loss: 0.6235
AUC: 0.8643

Epoch 22/80
 - 0s - loss: 1.0482 - val_loss: 0.6659
AUC: 0.8644

Epoch 23/80
 - 0s - loss: 1.0412 - val_loss: 0.6273
AUC: 0.8657

Epoch 24/80
 - 0s - loss: 1.0435 - val_loss: 0.6468
AUC: 0.8666

Epoch 25/80
 - 0s - loss: 1.0391 - val_loss: 0.6767
AUC: 0.8669

Epoch 26/80
 - 0s - loss: 1.0368 - val_loss: 0.6331
AUC: 0.8671

Epoch 27/80
 - 0s - loss: 1.0320 - val_loss: 0.6078
AUC: 0.8660

Epoch 28/80
 - 0s - loss: 1.0303 - val_loss: 0.6196
AUC: 0.8672

Epoch 29/80
 - 0s - loss: 1.0352 - val_loss: 0.6456
AUC: 0.8679

Epoch 30/80
 - 0s - loss: 1.0199 - val_loss: 0.6151
AUC: 0.8678

Epoch 31/80
 - 0s - loss: 1.0219 - val_loss: 0.6308
AUC: 0.8682

Epoch 32/80
 - 0s - loss: 1.0156 - val_loss: 0.6309
AUC: 0.8683

Epoch 33/80
 - 0s - loss: 1.0197 - val_loss: 0.6347
AUC: 0.8681

Epoch 34/80
 - 0s - loss: 1.0165 - val_loss: 0.6041
AUC: 0.8682

Epoch 35/80
 - 0s - loss: 1.0189 - val_loss: 0.6331
AUC: 0.8687

Epoch 36/80
 - 0s - loss: 1.0137 - val_loss: 0.6278
AUC: 0.8682

Epoch 37/80
 - 0s - loss: 1.0173 - val_loss: 0.6103
AUC: 0.8688

Epoch 38/80
 - 0s - loss: 1.0136 - val_loss: 0.6628
AUC: 0.8686

Epoch 39/80
 - 0s - loss: 1.0116 - val_loss: 0.6226
AUC: 0.8685

Epoch 40/80
 - 0s - loss: 1.0100 - val_loss: 0.6223
AUC: 0.8687

Epoch 41/80
 - 0s - loss: 1.0154 - val_loss: 0.6273
AUC: 0.8687

Epoch 42/80
 - 0s - loss: 1.0137 - val_loss: 0.6226
AUC: 0.8687

Epoch 43/80
 - 0s - loss: 1.0168 - val_loss: 0.6245
AUC: 0.8687

Epoch 44/80
 - 0s - loss: 1.0143 - val_loss: 0.6159
AUC: 0.8687

Epoch 45/80
 - 0s - loss: 1.0098 - val_loss: 0.6222
AUC: 0.8688

Epoch 46/80
 - 0s - loss: 1.0138 - val_loss: 0.6150
AUC: 0.8687

Epoch 47/80
 - 0s - loss: 1.0095 - val_loss: 0.6160
AUC: 0.8687

Epoch 48/80
 - 0s - loss: 1.0117 - val_loss: 0.6233
AUC: 0.8687

Epoch 49/80
 - 0s - loss: 1.0124 - val_loss: 0.6103
AUC: 0.8686

Train on 28892 samples, validate on 7223 samples
Epoch 1/30
 - 1s - loss: 1.0156 - val_loss: 0.6092
AUC: 0.8688

Epoch 2/30
 - 0s - loss: 1.0114 - val_loss: 0.6095
AUC: 0.8690

Epoch 3/30
 - 0s - loss: 1.0103 - val_loss: 0.6054
AUC: 0.8693

Epoch 4/30
 - 0s - loss: 1.0139 - val_loss: 0.6187
AUC: 0.8694

Epoch 5/30
 - 0s - loss: 1.0050 - val_loss: 0.6167
AUC: 0.8697

Epoch 6/30
 - 0s - loss: 1.0069 - val_loss: 0.6169
AUC: 0.8697

Epoch 7/30
 - 0s - loss: 1.0038 - val_loss: 0.6100
AUC: 0.8700

Epoch 8/30
 - 0s - loss: 1.0039 - val_loss: 0.6164
AUC: 0.8703

Epoch 9/30
 - 0s - loss: 0.9972 - val_loss: 0.6228
AUC: 0.8705

Epoch 10/30
 - 0s - loss: 0.9990 - val_loss: 0.6177
AUC: 0.8706

Epoch 11/30
 - 0s - loss: 1.0031 - val_loss: 0.6092
AUC: 0.8706

Epoch 12/30
 - 0s - loss: 0.9972 - val_loss: 0.6011
AUC: 0.8709

Epoch 13/30
 - 0s - loss: 0.9929 - val_loss: 0.6129
AUC: 0.8713

Epoch 14/30
 - 0s - loss: 0.9911 - val_loss: 0.6108
AUC: 0.8710

Epoch 15/30
 - 0s - loss: 0.9910 - val_loss: 0.6191
AUC: 0.8713

Epoch 16/30
 - 0s - loss: 0.9902 - val_loss: 0.6157
AUC: 0.8713

Epoch 17/30
 - 0s - loss: 0.9860 - val_loss: 0.6225
AUC: 0.8717

Epoch 18/30
 - 0s - loss: 0.9888 - val_loss: 0.5852
AUC: 0.8713

Epoch 19/30
 - 0s - loss: 0.9786 - val_loss: 0.6025
AUC: 0.8716

Epoch 20/30
 - 0s - loss: 0.9918 - val_loss: 0.6096
AUC: 0.8720

Epoch 21/30
 - 0s - loss: 0.9822 - val_loss: 0.6065
AUC: 0.8721

Epoch 22/30
 - 0s - loss: 0.9785 - val_loss: 0.6055
AUC: 0.8722

Epoch 23/30
 - 0s - loss: 0.9830 - val_loss: 0.6016
AUC: 0.8722

Epoch 24/30
 - 0s - loss: 0.9816 - val_loss: 0.6007
AUC: 0.8726

Epoch 25/30
 - 0s - loss: 0.9778 - val_loss: 0.6007
AUC: 0.8728

Epoch 26/30
 - 0s - loss: 0.9763 - val_loss: 0.6068
AUC: 0.8731

Epoch 27/30
 - 0s - loss: 0.9687 - val_loss: 0.5961
AUC: 0.8727

Epoch 28/30
 - 0s - loss: 0.9730 - val_loss: 0.6067
AUC: 0.8732

Epoch 29/30
 - 0s - loss: 0.9695 - val_loss: 0.5985
AUC: 0.8733

Epoch 30/30
 - 0s - loss: 0.9661 - val_loss: 0.6016
Using TensorFlow backend.
AUC: 0.8732

2019-03-08 13:25:21.494569: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:25:21.662611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:25:21.662659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:25:21.965697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:25:21.965775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:25:21.965787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:25:21.966085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.7 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1544
Epoch 2/80
 - 2s - loss: 0.2145
Epoch 3/80
 - 2s - loss: 0.1722
Epoch 4/80
 - 2s - loss: 0.1648
Epoch 5/80
 - 2s - loss: 0.1588
Epoch 6/80
 - 2s - loss: 0.1518
Epoch 7/80
 - 2s - loss: 0.1429
Epoch 8/80
 - 2s - loss: 0.1323
Epoch 9/80
 - 2s - loss: 0.1207
Epoch 10/80
 - 2s - loss: 0.1098
Epoch 11/80
 - 2s - loss: 0.1006
Epoch 12/80
 - 2s - loss: 0.0931
Epoch 13/80
 - 2s - loss: 0.0869
Epoch 14/80
 - 2s - loss: 0.0818
Epoch 15/80
 - 2s - loss: 0.0775
Epoch 16/80
 - 2s - loss: 0.0737
Epoch 17/80
 - 2s - loss: 0.0704
Epoch 18/80
 - 2s - loss: 0.0675
Epoch 19/80
 - 2s - loss: 0.0651
Epoch 20/80
 - 2s - loss: 0.0630
Epoch 21/80
 - 2s - loss: 0.0613
Epoch 22/80
 - 2s - loss: 0.0598
Epoch 23/80
 - 2s - loss: 0.0586
Epoch 24/80
 - 2s - loss: 0.0575
Epoch 25/80
 - 2s - loss: 0.0566
Epoch 26/80
 - 2s - loss: 0.0559
Epoch 27/80
 - 2s - loss: 0.0552
Epoch 28/80
 - 2s - loss: 0.0547
Epoch 29/80
 - 2s - loss: 0.0542
Epoch 30/80
 - 2s - loss: 0.0537
Epoch 31/80
 - 2s - loss: 0.0534
Epoch 32/80
 - 2s - loss: 0.0531
Epoch 33/80
 - 2s - loss: 0.0528
Epoch 34/80
 - 2s - loss: 0.0526
Epoch 35/80
 - 2s - loss: 0.0524
Epoch 36/80
 - 2s - loss: 0.0522
Epoch 37/80
 - 2s - loss: 0.0520
Epoch 38/80
 - 2s - loss: 0.0519
Epoch 39/80
 - 2s - loss: 0.0517
Epoch 40/80
 - 2s - loss: 0.0516
Epoch 41/80
 - 2s - loss: 0.0515
Epoch 42/80
 - 2s - loss: 0.0514
Epoch 43/80
 - 2s - loss: 0.0513
Epoch 44/80
 - 2s - loss: 0.0512
Epoch 45/80
 - 2s - loss: 0.0511
Epoch 46/80
 - 2s - loss: 0.0511
Epoch 47/80
 - 2s - loss: 0.0510
Epoch 48/80
 - 2s - loss: 0.0509
Epoch 49/80
 - 2s - loss: 0.0509
Epoch 50/80
 - 2s - loss: 0.0508
Epoch 51/80
 - 2s - loss: 0.0508
Epoch 52/80
 - 2s - loss: 0.0507
Epoch 53/80
 - 2s - loss: 0.0507
Epoch 54/80
 - 2s - loss: 0.0506
Epoch 55/80
 - 2s - loss: 0.0506
Epoch 56/80
 - 2s - loss: 0.0505
Epoch 57/80
 - 2s - loss: 0.0505
Epoch 58/80
 - 2s - loss: 0.0505
Epoch 59/80
 - 2s - loss: 0.0505
Epoch 60/80
 - 2s - loss: 0.0504
Epoch 61/80
 - 2s - loss: 0.0493
Epoch 62/80
 - 2s - loss: 0.0492
Epoch 63/80
 - 2s - loss: 0.0492
Epoch 64/80
 - 2s - loss: 0.0492
Epoch 65/80
 - 2s - loss: 0.0491
Epoch 66/80
 - 2s - loss: 0.0489
Epoch 67/80
 - 2s - loss: 0.0489
Epoch 68/80
 - 2s - loss: 0.0489
Epoch 69/80
 - 2s - loss: 0.0489
Epoch 70/80
 - 2s - loss: 0.0488
Epoch 71/80
 - 2s - loss: 0.0488
Epoch 72/80
 - 2s - loss: 0.0488
Epoch 73/80
 - 2s - loss: 0.0488
Epoch 74/80
 - 2s - loss: 0.0488
Epoch 75/80
 - 2s - loss: 0.0488
Epoch 76/80
 - 2s - loss: 0.0488
Epoch 77/80
 - 2s - loss: 0.0488
Epoch 78/80
 - 2s - loss: 0.0488
Epoch 79/80
 - 2s - loss: 0.0488
Epoch 80/80
 - 2s - loss: 0.0488
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.6457 - val_loss: 1.0348
AUC: 0.8118

Epoch 2/80
 - 0s - loss: 2.1902 - val_loss: 0.7481
AUC: 0.8253

Epoch 3/80
 - 0s - loss: 1.5204 - val_loss: 0.7458
AUC: 0.8324

Epoch 4/80
 - 0s - loss: 1.2873 - val_loss: 0.7443
AUC: 0.8384

Epoch 5/80
 - 0s - loss: 1.2017 - val_loss: 0.7870
AUC: 0.8444

Epoch 6/80
 - 0s - loss: 1.1622 - val_loss: 0.6961
AUC: 0.8456

Epoch 7/80
 - 0s - loss: 1.1415 - val_loss: 0.7568
AUC: 0.8506

Epoch 8/80
 - 0s - loss: 1.1083 - val_loss: 0.6564
AUC: 0.8495

Epoch 9/80
 - 0s - loss: 1.0953 - val_loss: 0.6789
AUC: 0.8530

Epoch 10/80
 - 0s - loss: 1.0949 - val_loss: 0.6712
AUC: 0.8542

Epoch 11/80
 - 0s - loss: 1.0754 - val_loss: 0.6972
AUC: 0.8560

Epoch 12/80
 - 0s - loss: 1.0684 - val_loss: 0.6243
AUC: 0.8557

Epoch 13/80
 - 0s - loss: 1.0613 - val_loss: 0.6855
AUC: 0.8585

Epoch 14/80
 - 0s - loss: 1.0526 - val_loss: 0.6987
AUC: 0.8585

Epoch 15/80
 - 0s - loss: 1.0528 - val_loss: 0.6487
AUC: 0.8603

Epoch 16/80
 - 0s - loss: 1.0432 - val_loss: 0.6614
AUC: 0.8596

Epoch 17/80
 - 0s - loss: 1.0384 - val_loss: 0.6222
AUC: 0.8609

Epoch 18/80
 - 0s - loss: 1.0446 - val_loss: 0.6141
AUC: 0.8623

Epoch 19/80
 - 0s - loss: 1.0351 - val_loss: 0.6783
AUC: 0.8630

Epoch 20/80
 - 0s - loss: 1.0263 - val_loss: 0.6337
AUC: 0.8630

Epoch 21/80
 - 0s - loss: 1.0169 - val_loss: 0.6263
AUC: 0.8633

Epoch 22/80
 - 0s - loss: 1.0227 - val_loss: 0.6731
AUC: 0.8644

Epoch 23/80
 - 0s - loss: 1.0165 - val_loss: 0.5774
AUC: 0.8633

Epoch 24/80
 - 0s - loss: 1.0101 - val_loss: 0.5826
AUC: 0.8637

Epoch 25/80
 - 0s - loss: 1.0105 - val_loss: 0.6241
AUC: 0.8649

Epoch 26/80
 - 0s - loss: 1.0107 - val_loss: 0.7035
AUC: 0.8655

Epoch 27/80
 - 0s - loss: 1.0069 - val_loss: 0.6209
AUC: 0.8657

Epoch 28/80
 - 0s - loss: 1.0107 - val_loss: 0.6507
AUC: 0.8663

Epoch 29/80
 - 0s - loss: 1.0041 - val_loss: 0.6503
AUC: 0.8660

Epoch 30/80
 - 0s - loss: 0.9993 - val_loss: 0.5773
AUC: 0.8648

Epoch 31/80
 - 0s - loss: 0.9977 - val_loss: 0.5852
AUC: 0.8663

Epoch 32/80
 - 0s - loss: 0.9942 - val_loss: 0.6446
AUC: 0.8668

Epoch 33/80
 - 0s - loss: 0.9913 - val_loss: 0.6774
AUC: 0.8665

Epoch 34/80
 - 0s - loss: 0.9904 - val_loss: 0.6194
AUC: 0.8666

Epoch 35/80
 - 0s - loss: 0.9836 - val_loss: 0.6150
AUC: 0.8666

Epoch 36/80
 - 0s - loss: 0.9828 - val_loss: 0.6404
AUC: 0.8668

Epoch 37/80
 - 0s - loss: 0.9799 - val_loss: 0.6436
AUC: 0.8666

Epoch 38/80
 - 0s - loss: 0.9774 - val_loss: 0.6176
AUC: 0.8668

Epoch 39/80
 - 0s - loss: 0.9791 - val_loss: 0.6057
AUC: 0.8666

Epoch 40/80
 - 0s - loss: 0.9786 - val_loss: 0.5903
AUC: 0.8663

Epoch 41/80
 - 0s - loss: 0.9867 - val_loss: 0.6206
AUC: 0.8669

Epoch 42/80
 - 0s - loss: 0.9800 - val_loss: 0.6233
AUC: 0.8668

Epoch 43/80
 - 0s - loss: 0.9838 - val_loss: 0.6407
AUC: 0.8670

Epoch 44/80
 - 0s - loss: 0.9797 - val_loss: 0.6075
AUC: 0.8668

Epoch 45/80
 - 0s - loss: 0.9742 - val_loss: 0.6107
AUC: 0.8668

Epoch 46/80
 - 0s - loss: 0.9744 - val_loss: 0.6099
AUC: 0.8668

Epoch 47/80
 - 0s - loss: 0.9744 - val_loss: 0.6082
AUC: 0.8668

Epoch 48/80
 - 0s - loss: 0.9744 - val_loss: 0.6087
AUC: 0.8668

Epoch 49/80
 - 0s - loss: 0.9771 - val_loss: 0.6091
AUC: 0.8667

Epoch 50/80
 - 0s - loss: 0.9729 - val_loss: 0.6087
AUC: 0.8668

Epoch 51/80
 - 0s - loss: 0.9720 - val_loss: 0.6145
AUC: 0.8669

Epoch 52/80
 - 0s - loss: 0.9715 - val_loss: 0.6156
AUC: 0.8668

Epoch 53/80
 - 0s - loss: 0.9721 - val_loss: 0.6062
AUC: 0.8667

Epoch 54/80
 - 0s - loss: 0.9793 - val_loss: 0.6072
AUC: 0.8667

Epoch 55/80
 - 0s - loss: 0.9755 - val_loss: 0.6084
AUC: 0.8668

Epoch 56/80
 - 0s - loss: 0.9737 - val_loss: 0.6084
AUC: 0.8668

Epoch 57/80
 - 0s - loss: 0.9749 - val_loss: 0.6100
AUC: 0.8668

Epoch 58/80
 - 0s - loss: 0.9713 - val_loss: 0.6086
AUC: 0.8668

Epoch 59/80
 - 0s - loss: 0.9809 - val_loss: 0.6084
AUC: 0.8668

Epoch 60/80
 - 0s - loss: 0.9772 - val_loss: 0.6095
AUC: 0.8668

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.9735 - val_loss: 0.6260
AUC: 0.8670

Epoch 2/30
 - 0s - loss: 0.9716 - val_loss: 0.6220
AUC: 0.8670

Epoch 3/30
 - 0s - loss: 0.9708 - val_loss: 0.6243
AUC: 0.8672

Epoch 4/30
 - 0s - loss: 0.9777 - val_loss: 0.6140
AUC: 0.8673

Epoch 5/30
 - 0s - loss: 0.9691 - val_loss: 0.6037
AUC: 0.8674

Epoch 6/30
 - 0s - loss: 0.9696 - val_loss: 0.5935
AUC: 0.8675

Epoch 7/30
 - 0s - loss: 0.9714 - val_loss: 0.5898
AUC: 0.8675

Epoch 8/30
 - 0s - loss: 0.9706 - val_loss: 0.6093
AUC: 0.8677

Epoch 9/30
 - 0s - loss: 0.9656 - val_loss: 0.6021
AUC: 0.8678

Epoch 10/30
 - 0s - loss: 0.9721 - val_loss: 0.6135
AUC: 0.8680

Epoch 11/30
 - 0s - loss: 0.9652 - val_loss: 0.5894
AUC: 0.8678

Epoch 12/30
 - 0s - loss: 0.9686 - val_loss: 0.5824
AUC: 0.8679

Epoch 13/30
 - 0s - loss: 0.9604 - val_loss: 0.6143
AUC: 0.8684

Epoch 14/30
 - 0s - loss: 0.9547 - val_loss: 0.6086
AUC: 0.8682

Epoch 15/30
 - 0s - loss: 0.9588 - val_loss: 0.5905
AUC: 0.8682

Epoch 16/30
 - 0s - loss: 0.9575 - val_loss: 0.5919
AUC: 0.8683

Epoch 17/30
 - 0s - loss: 0.9568 - val_loss: 0.5933
AUC: 0.8684

Epoch 18/30
 - 0s - loss: 0.9589 - val_loss: 0.5931
AUC: 0.8685

Epoch 19/30
 - 0s - loss: 0.9537 - val_loss: 0.6001
AUC: 0.8688

Epoch 20/30
 - 0s - loss: 0.9513 - val_loss: 0.6025
AUC: 0.8687

Epoch 21/30
 - 0s - loss: 0.9611 - val_loss: 0.6033
AUC: 0.8688

Epoch 22/30
 - 0s - loss: 0.9493 - val_loss: 0.5941
AUC: 0.8688

Epoch 23/30
 - 0s - loss: 0.9531 - val_loss: 0.5948
AUC: 0.8688

Epoch 24/30
 - 0s - loss: 0.9474 - val_loss: 0.5944
AUC: 0.8689

Epoch 25/30
 - 0s - loss: 0.9521 - val_loss: 0.5983
AUC: 0.8689

Epoch 26/30
 - 0s - loss: 0.9480 - val_loss: 0.5975
AUC: 0.8689

Epoch 27/30
 - 0s - loss: 0.9547 - val_loss: 0.5957
AUC: 0.8690

Epoch 28/30
 - 0s - loss: 0.9466 - val_loss: 0.5968
AUC: 0.8690

Epoch 29/30
 - 0s - loss: 0.9491 - val_loss: 0.5980
AUC: 0.8690

Epoch 30/30
 - 0s - loss: 0.9463 - val_loss: 0.5978
Using TensorFlow backend.
AUC: 0.8690

2019-03-08 13:29:17.879309: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:29:18.047347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:29:18.047395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:29:18.351002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:29:18.351079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:29:18.351103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:29:18.351387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.7 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1407
Epoch 2/80
 - 2s - loss: 0.2144
Epoch 3/80
 - 2s - loss: 0.1733
Epoch 4/80
 - 2s - loss: 0.1666
Epoch 5/80
 - 2s - loss: 0.1611
Epoch 6/80
 - 2s - loss: 0.1540
Epoch 7/80
 - 2s - loss: 0.1449
Epoch 8/80
 - 2s - loss: 0.1343
Epoch 9/80
 - 2s - loss: 0.1228
Epoch 10/80
 - 2s - loss: 0.1123
Epoch 11/80
 - 2s - loss: 0.1037
Epoch 12/80
 - 2s - loss: 0.0967
Epoch 13/80
 - 2s - loss: 0.0907
Epoch 14/80
 - 2s - loss: 0.0853
Epoch 15/80
 - 2s - loss: 0.0805
Epoch 16/80
 - 2s - loss: 0.0761
Epoch 17/80
 - 2s - loss: 0.0723
Epoch 18/80
 - 2s - loss: 0.0690
Epoch 19/80
 - 2s - loss: 0.0663
Epoch 20/80
 - 2s - loss: 0.0640
Epoch 21/80
 - 2s - loss: 0.0620
Epoch 22/80
 - 2s - loss: 0.0604
Epoch 23/80
 - 2s - loss: 0.0591
Epoch 24/80
 - 2s - loss: 0.0579
Epoch 25/80
 - 2s - loss: 0.0569
Epoch 26/80
 - 2s - loss: 0.0561
Epoch 27/80
 - 2s - loss: 0.0554
Epoch 28/80
 - 2s - loss: 0.0547
Epoch 29/80
 - 2s - loss: 0.0542
Epoch 30/80
 - 2s - loss: 0.0537
Epoch 31/80
 - 2s - loss: 0.0533
Epoch 32/80
 - 2s - loss: 0.0530
Epoch 33/80
 - 2s - loss: 0.0527
Epoch 34/80
 - 2s - loss: 0.0524
Epoch 35/80
 - 2s - loss: 0.0522
Epoch 36/80
 - 2s - loss: 0.0520
Epoch 37/80
 - 2s - loss: 0.0518
Epoch 38/80
 - 2s - loss: 0.0516
Epoch 39/80
 - 2s - loss: 0.0514
Epoch 40/80
 - 2s - loss: 0.0513
Epoch 41/80
 - 2s - loss: 0.0512
Epoch 42/80
 - 2s - loss: 0.0511
Epoch 43/80
 - 2s - loss: 0.0510
Epoch 44/80
 - 2s - loss: 0.0509
Epoch 45/80
 - 2s - loss: 0.0508
Epoch 46/80
 - 2s - loss: 0.0507
Epoch 47/80
 - 2s - loss: 0.0506
Epoch 48/80
 - 2s - loss: 0.0506
Epoch 49/80
 - 2s - loss: 0.0505
Epoch 50/80
 - 2s - loss: 0.0505
Epoch 51/80
 - 2s - loss: 0.0504
Epoch 52/80
 - 2s - loss: 0.0504
Epoch 53/80
 - 2s - loss: 0.0503
Epoch 54/80
 - 2s - loss: 0.0503
Epoch 55/80
 - 2s - loss: 0.0502
Epoch 56/80
 - 2s - loss: 0.0502
Epoch 57/80
 - 2s - loss: 0.0502
Epoch 58/80
 - 2s - loss: 0.0501
Epoch 59/80
 - 2s - loss: 0.0501
Epoch 60/80
 - 2s - loss: 0.0501
Epoch 61/80
 - 2s - loss: 0.0500
Epoch 62/80
 - 2s - loss: 0.0489
Epoch 63/80
 - 2s - loss: 0.0488
Epoch 64/80
 - 2s - loss: 0.0488
Epoch 65/80
 - 2s - loss: 0.0488
Epoch 66/80
 - 2s - loss: 0.0488
Epoch 67/80
 - 2s - loss: 0.0485
Epoch 68/80
 - 2s - loss: 0.0485
Epoch 69/80
 - 2s - loss: 0.0485
Epoch 70/80
 - 2s - loss: 0.0485
Epoch 71/80
 - 2s - loss: 0.0484
Epoch 72/80
 - 2s - loss: 0.0484
Epoch 73/80
 - 2s - loss: 0.0484
Epoch 74/80
 - 2s - loss: 0.0484
Epoch 75/80
 - 2s - loss: 0.0484
Epoch 76/80
 - 2s - loss: 0.0484
Epoch 77/80
 - 2s - loss: 0.0484
Epoch 78/80
 - 2s - loss: 0.0484
Epoch 79/80
 - 2s - loss: 0.0484
Epoch 80/80
 - 2s - loss: 0.0484
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.0017 - val_loss: 0.6661
AUC: 0.7597

Epoch 2/80
 - 0s - loss: 2.7923 - val_loss: 0.6619
AUC: 0.8131

Epoch 3/80
 - 0s - loss: 1.8622 - val_loss: 0.5922
AUC: 0.8320

Epoch 4/80
 - 0s - loss: 1.2859 - val_loss: 0.4834
AUC: 0.8364

Epoch 5/80
 - 0s - loss: 0.9982 - val_loss: 0.5325
AUC: 0.8411

Epoch 6/80
 - 0s - loss: 0.9008 - val_loss: 0.5023
AUC: 0.8439

Epoch 7/80
 - 0s - loss: 0.8533 - val_loss: 0.4628
AUC: 0.8467

Epoch 8/80
 - 0s - loss: 0.8389 - val_loss: 0.4657
AUC: 0.8471

Epoch 9/80
 - 0s - loss: 0.8254 - val_loss: 0.5237
AUC: 0.8501

Epoch 10/80
 - 0s - loss: 0.8235 - val_loss: 0.4837
AUC: 0.8522

Epoch 11/80
 - 0s - loss: 0.8076 - val_loss: 0.4611
AUC: 0.8526

Epoch 12/80
 - 0s - loss: 0.7978 - val_loss: 0.4898
AUC: 0.8565

Epoch 13/80
 - 0s - loss: 0.7924 - val_loss: 0.4985
AUC: 0.8565

Epoch 14/80
 - 0s - loss: 0.7881 - val_loss: 0.4842
AUC: 0.8588

Epoch 15/80
 - 0s - loss: 0.7874 - val_loss: 0.4913
AUC: 0.8603

Epoch 16/80
 - 0s - loss: 0.7755 - val_loss: 0.4599
AUC: 0.8600

Epoch 17/80
 - 0s - loss: 0.7827 - val_loss: 0.4757
AUC: 0.8608

Epoch 18/80
 - 0s - loss: 0.7818 - val_loss: 0.4337
AUC: 0.8602

Epoch 19/80
 - 0s - loss: 0.7761 - val_loss: 0.4255
AUC: 0.8596

Epoch 20/80
 - 0s - loss: 0.7738 - val_loss: 0.4851
AUC: 0.8612

Epoch 21/80
 - 0s - loss: 0.7664 - val_loss: 0.4127
AUC: 0.8609

Epoch 22/80
 - 0s - loss: 0.7623 - val_loss: 0.4609
AUC: 0.8641

Epoch 23/80
 - 0s - loss: 0.7625 - val_loss: 0.4691
AUC: 0.8646

Epoch 24/80
 - 0s - loss: 0.7622 - val_loss: 0.5059
AUC: 0.8657

Epoch 25/80
 - 0s - loss: 0.7536 - val_loss: 0.4919
AUC: 0.8656

Epoch 26/80
 - 0s - loss: 0.7582 - val_loss: 0.4526
AUC: 0.8662

Epoch 27/80
 - 0s - loss: 0.7496 - val_loss: 0.4738
AUC: 0.8665

Epoch 28/80
 - 0s - loss: 0.7502 - val_loss: 0.4373
AUC: 0.8662

Epoch 29/80
 - 0s - loss: 0.7483 - val_loss: 0.4254
AUC: 0.8674

Epoch 30/80
 - 0s - loss: 0.7449 - val_loss: 0.4707
AUC: 0.8690

Epoch 31/80
 - 0s - loss: 0.7472 - val_loss: 0.4424
AUC: 0.8679

Epoch 32/80
 - 0s - loss: 0.7426 - val_loss: 0.4482
AUC: 0.8682

Epoch 33/80
 - 0s - loss: 0.7389 - val_loss: 0.4594
AUC: 0.8684

Epoch 34/80
 - 0s - loss: 0.7411 - val_loss: 0.4578
AUC: 0.8689

Epoch 35/80
 - 0s - loss: 0.7378 - val_loss: 0.4464
AUC: 0.8692

Epoch 36/80
 - 0s - loss: 0.7393 - val_loss: 0.4560
AUC: 0.8692

Epoch 37/80
 - 0s - loss: 0.7363 - val_loss: 0.4557
AUC: 0.8699

Epoch 38/80
 - 0s - loss: 0.7352 - val_loss: 0.4442
AUC: 0.8693

Epoch 39/80
 - 0s - loss: 0.7409 - val_loss: 0.4475
AUC: 0.8696

Epoch 40/80
 - 0s - loss: 0.7396 - val_loss: 0.4473
AUC: 0.8693

Epoch 41/80
 - 0s - loss: 0.7373 - val_loss: 0.4498
AUC: 0.8698

Epoch 42/80
 - 0s - loss: 0.7340 - val_loss: 0.4479
AUC: 0.8697

Epoch 43/80
 - 0s - loss: 0.7341 - val_loss: 0.4398
AUC: 0.8695

Epoch 44/80
 - 0s - loss: 0.7375 - val_loss: 0.4474
AUC: 0.8697

Epoch 45/80
 - 0s - loss: 0.7341 - val_loss: 0.4489
AUC: 0.8697

Epoch 46/80
 - 0s - loss: 0.7345 - val_loss: 0.4454
AUC: 0.8698

Epoch 47/80
 - 0s - loss: 0.7346 - val_loss: 0.4456
AUC: 0.8698

Epoch 48/80
 - 0s - loss: 0.7376 - val_loss: 0.4493
AUC: 0.8699

Epoch 49/80
 - 0s - loss: 0.7344 - val_loss: 0.4484
AUC: 0.8698

Epoch 50/80
 - 0s - loss: 0.7358 - val_loss: 0.4418
AUC: 0.8696

Epoch 51/80
 - 0s - loss: 0.7356 - val_loss: 0.4492
AUC: 0.8698

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.7350 - val_loss: 0.4490
AUC: 0.8694

Epoch 2/30
 - 0s - loss: 0.7377 - val_loss: 0.4389
AUC: 0.8694

Epoch 3/30
 - 0s - loss: 0.7342 - val_loss: 0.4442
AUC: 0.8696

Epoch 4/30
 - 0s - loss: 0.7347 - val_loss: 0.4437
AUC: 0.8700

Epoch 5/30
 - 0s - loss: 0.7332 - val_loss: 0.4519
AUC: 0.8700

Epoch 6/30
 - 0s - loss: 0.7289 - val_loss: 0.4380
AUC: 0.8700

Epoch 7/30
 - 0s - loss: 0.7291 - val_loss: 0.4443
AUC: 0.8702

Epoch 8/30
 - 0s - loss: 0.7302 - val_loss: 0.4459
AUC: 0.8705

Epoch 9/30
 - 0s - loss: 0.7266 - val_loss: 0.4430
AUC: 0.8704

Epoch 10/30
 - 0s - loss: 0.7289 - val_loss: 0.4585
AUC: 0.8709

Epoch 11/30
 - 0s - loss: 0.7256 - val_loss: 0.4535
AUC: 0.8708

Epoch 12/30
 - 0s - loss: 0.7278 - val_loss: 0.4329
AUC: 0.8705

Epoch 13/30
 - 0s - loss: 0.7271 - val_loss: 0.4329
AUC: 0.8707

Epoch 14/30
 - 0s - loss: 0.7259 - val_loss: 0.4428
AUC: 0.8708

Epoch 15/30
 - 0s - loss: 0.7243 - val_loss: 0.4484
AUC: 0.8712

Epoch 16/30
 - 0s - loss: 0.7222 - val_loss: 0.4402
AUC: 0.8709

Epoch 17/30
 - 0s - loss: 0.7226 - val_loss: 0.4520
AUC: 0.8715

Epoch 18/30
 - 0s - loss: 0.7226 - val_loss: 0.4591
AUC: 0.8718

Epoch 19/30
 - 0s - loss: 0.7229 - val_loss: 0.4468
AUC: 0.8717

Epoch 20/30
 - 0s - loss: 0.7148 - val_loss: 0.4362
AUC: 0.8714

Epoch 21/30
 - 0s - loss: 0.7206 - val_loss: 0.4362
AUC: 0.8716

Epoch 22/30
 - 0s - loss: 0.7203 - val_loss: 0.4474
AUC: 0.8718

Epoch 23/30
 - 0s - loss: 0.7158 - val_loss: 0.4407
AUC: 0.8717

Epoch 24/30
 - 0s - loss: 0.7194 - val_loss: 0.4417
AUC: 0.8717

Epoch 25/30
 - 0s - loss: 0.7177 - val_loss: 0.4413
AUC: 0.8717

Epoch 26/30
 - 0s - loss: 0.7157 - val_loss: 0.4436
AUC: 0.8718

Epoch 27/30
 - 0s - loss: 0.7181 - val_loss: 0.4411
AUC: 0.8718

Epoch 28/30
 - 0s - loss: 0.7179 - val_loss: 0.4390
AUC: 0.8717

Epoch 29/30
 - 0s - loss: 0.7160 - val_loss: 0.4431
AUC: 0.8719

Epoch 30/30
 - 0s - loss: 0.7195 - val_loss: 0.4436
Using TensorFlow backend.
AUC: 0.8719

2019-03-08 13:33:08.177730: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:33:08.343599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:33:08.343644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:33:08.647105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:33:08.647164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:33:08.647173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:33:08.647444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1385
Epoch 2/80
 - 2s - loss: 0.2162
Epoch 3/80
 - 2s - loss: 0.1741
Epoch 4/80
 - 2s - loss: 0.1678
Epoch 5/80
 - 2s - loss: 0.1628
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 13:33:38.423805: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:33:38.591157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:33:38.591214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:33:38.894977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:33:38.895032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:33:38.895041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:33:38.895311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 5.0 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1664
Epoch 2/80
 - 2s - loss: 0.2192
Epoch 3/80
 - 2s - loss: 0.1736
Epoch 4/80
 - 2s - loss: 0.1651
Epoch 5/80
 - 2s - loss: 0.1583
Epoch 6/80
 - 2s - loss: 0.1503
Epoch 7/80
 - 2s - loss: 0.1408
Epoch 8/80
 - 2s - loss: 0.1298
Epoch 9/80
 - 2s - loss: 0.1184
Epoch 10/80
 - 2s - loss: 0.1077
Epoch 11/80
 - 2s - loss: 0.0987
Epoch 12/80
 - 2s - loss: 0.0915
Epoch 13/80
 - 2s - loss: 0.0857
Epoch 14/80
 - 2s - loss: 0.0810
Epoch 15/80
 - 2s - loss: 0.0769
Epoch 16/80
 - 2s - loss: 0.0735
Epoch 17/80
 - 2s - loss: 0.0704
Epoch 18/80
 - 2s - loss: 0.0677
Epoch 19/80
 - 2s - loss: 0.0653
Epoch 20/80
 - 2s - loss: 0.0633
Epoch 21/80
 - 2s - loss: 0.0616
Epoch 22/80
 - 2s - loss: 0.0601
Epoch 23/80
 - 2s - loss: 0.0588
Epoch 24/80
 - 2s - loss: 0.0578
Epoch 25/80
 - 2s - loss: 0.0569
Epoch 26/80
 - 2s - loss: 0.0561
Epoch 27/80
 - 2s - loss: 0.0554
Epoch 28/80
 - 2s - loss: 0.0548
Epoch 29/80
 - 2s - loss: 0.0543
Epoch 30/80
 - 2s - loss: 0.0539
Epoch 31/80
 - 2s - loss: 0.0535
Epoch 32/80
 - 2s - loss: 0.0531
Epoch 33/80
 - 2s - loss: 0.0528
Epoch 34/80
 - 2s - loss: 0.0526
Epoch 35/80
 - 2s - loss: 0.0523
Epoch 36/80
 - 2s - loss: 0.0521
Epoch 37/80
 - 2s - loss: 0.0520
Epoch 38/80
 - 2s - loss: 0.0518
Epoch 39/80
 - 2s - loss: 0.0516
Epoch 40/80
 - 2s - loss: 0.0515
Epoch 41/80
 - 2s - loss: 0.0513
Epoch 42/80
 - 2s - loss: 0.0512
Epoch 43/80
 - 2s - loss: 0.0511
Epoch 44/80
 - 2s - loss: 0.0510
Epoch 45/80
 - 2s - loss: 0.0509
Epoch 46/80
 - 2s - loss: 0.0508
Epoch 47/80
 - 2s - loss: 0.0508
Epoch 48/80
 - 2s - loss: 0.0507
Epoch 49/80
 - 2s - loss: 0.0506
Epoch 50/80
 - 2s - loss: 0.0506
Epoch 51/80
 - 2s - loss: 0.0505
Epoch 52/80
 - 2s - loss: 0.0505
Epoch 53/80
 - 2s - loss: 0.0504
Epoch 54/80
 - 2s - loss: 0.0504
Epoch 55/80
 - 2s - loss: 0.0503
Epoch 56/80
 - 2s - loss: 0.0503
Epoch 57/80
 - 2s - loss: 0.0502
Epoch 58/80
 - 2s - loss: 0.0502
Epoch 59/80
 - 2s - loss: 0.0502
Epoch 60/80
 - 2s - loss: 0.0501
Epoch 61/80
 - 2s - loss: 0.0501
Epoch 62/80
 - 2s - loss: 0.0501
Epoch 63/80
 - 2s - loss: 0.0501
Epoch 64/80
 - 2s - loss: 0.0490
Epoch 65/80
 - 2s - loss: 0.0488
Epoch 66/80
 - 2s - loss: 0.0488
Epoch 67/80
 - 2s - loss: 0.0488
Epoch 68/80
 - 2s - loss: 0.0488
Epoch 69/80
 - 2s - loss: 0.0485
Epoch 70/80
 - 2s - loss: 0.0485
Epoch 71/80
 - 2s - loss: 0.0485
Epoch 72/80
 - 2s - loss: 0.0485
Epoch 73/80
 - 2s - loss: 0.0484
Epoch 74/80
 - 2s - loss: 0.0484
Epoch 75/80
 - 2s - loss: 0.0484
Epoch 76/80
 - 2s - loss: 0.0484
Epoch 77/80
 - 2s - loss: 0.0484
Epoch 78/80
 - 2s - loss: 0.0484
Epoch 79/80
 - 2s - loss: 0.0484
Epoch 80/80
 - 2s - loss: 0.0484
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 5.5518 - val_loss: 2.1702
AUC: 0.7826

Epoch 2/80
 - 0s - loss: 3.8204 - val_loss: 1.9538
AUC: 0.8163

Epoch 3/80
 - 0s - loss: 2.6579 - val_loss: 1.2224
AUC: 0.8199

Epoch 4/80
 - 0s - loss: 1.9801 - val_loss: 1.0505
AUC: 0.8315

Epoch 5/80
 - 0s - loss: 1.5977 - val_loss: 0.9016
AUC: 0.8380

Epoch 6/80
 - 0s - loss: 1.4672 - val_loss: 0.8818
AUC: 0.8404

Epoch 7/80
 - 0s - loss: 1.3930 - val_loss: 0.8672
AUC: 0.8420

Epoch 8/80
 - 0s - loss: 1.3448 - val_loss: 0.8028
AUC: 0.8446

Epoch 9/80
 - 0s - loss: 1.3238 - val_loss: 0.8945
AUC: 0.8477

Epoch 10/80
 - 0s - loss: 1.2939 - val_loss: 0.8183
AUC: 0.8486

Epoch 11/80
 - 0s - loss: 1.2699 - val_loss: 0.8111
AUC: 0.8488

Epoch 12/80
 - 0s - loss: 1.2591 - val_loss: 0.7656
AUC: 0.8503

Epoch 13/80
 - 0s - loss: 1.2641 - val_loss: 0.8520
AUC: 0.8505

Epoch 14/80
 - 0s - loss: 1.2453 - val_loss: 0.7730
AUC: 0.8517

Epoch 15/80
 - 0s - loss: 1.2408 - val_loss: 0.8034
AUC: 0.8526

Epoch 16/80
 - 0s - loss: 1.2319 - val_loss: 0.7246
AUC: 0.8521

Epoch 17/80
 - 0s - loss: 1.2233 - val_loss: 0.7601
AUC: 0.8528

Epoch 18/80
 - 0s - loss: 1.2225 - val_loss: 0.7254
AUC: 0.8537

Epoch 19/80
 - 0s - loss: 1.2111 - val_loss: 0.7244
AUC: 0.8536

Epoch 20/80
 - 0s - loss: 1.1955 - val_loss: 0.7237
AUC: 0.8538

Epoch 21/80
 - 0s - loss: 1.2043 - val_loss: 0.6907
AUC: 0.8544

Epoch 22/80
 - 0s - loss: 1.1989 - val_loss: 0.8099
AUC: 0.8562

Epoch 23/80
 - 0s - loss: 1.1993 - val_loss: 0.7956
AUC: 0.8570

Epoch 24/80
 - 0s - loss: 1.1942 - val_loss: 0.7436
AUC: 0.8566

Epoch 25/80
 - 0s - loss: 1.1887 - val_loss: 0.7213
AUC: 0.8571

Epoch 26/80
 - 0s - loss: 1.1903 - val_loss: 0.8024
AUC: 0.8578

Epoch 27/80
 - 0s - loss: 1.1852 - val_loss: 0.8034
AUC: 0.8578

Epoch 28/80
 - 0s - loss: 1.1863 - val_loss: 0.7577
AUC: 0.8581

Epoch 29/80
 - 0s - loss: 1.1745 - val_loss: 0.7166
AUC: 0.8570

Epoch 30/80
 - 0s - loss: 1.1769 - val_loss: 0.7204
AUC: 0.8591

Epoch 31/80
 - 0s - loss: 1.1686 - val_loss: 0.6990
AUC: 0.8582

Epoch 32/80
 - 0s - loss: 1.1642 - val_loss: 0.7562
AUC: 0.8591

Epoch 33/80
 - 0s - loss: 1.1635 - val_loss: 0.7805
AUC: 0.8597

Epoch 34/80
 - 0s - loss: 1.1605 - val_loss: 0.7430
AUC: 0.8595

Epoch 35/80
 - 0s - loss: 1.1568 - val_loss: 0.7443
AUC: 0.8594

Epoch 36/80
 - 0s - loss: 1.1576 - val_loss: 0.7809
AUC: 0.8596

Epoch 37/80
 - 0s - loss: 1.1582 - val_loss: 0.7329
AUC: 0.8596

Epoch 38/80
 - 0s - loss: 1.1532 - val_loss: 0.7454
AUC: 0.8595

Epoch 39/80
 - 0s - loss: 1.1549 - val_loss: 0.7014
AUC: 0.8592

Epoch 40/80
 - 0s - loss: 1.1554 - val_loss: 0.7398
AUC: 0.8598

Epoch 41/80
 - 0s - loss: 1.1546 - val_loss: 0.7624
AUC: 0.8597

Epoch 42/80
 - 0s - loss: 1.1559 - val_loss: 0.7323
AUC: 0.8596

Epoch 43/80
 - 0s - loss: 1.1528 - val_loss: 0.7345
AUC: 0.8597

Epoch 44/80
 - 0s - loss: 1.1515 - val_loss: 0.7305
AUC: 0.8597

Epoch 45/80
 - 0s - loss: 1.1545 - val_loss: 0.7402
AUC: 0.8598

Epoch 46/80
 - 0s - loss: 1.1518 - val_loss: 0.7428
AUC: 0.8599

Epoch 47/80
 - 0s - loss: 1.1489 - val_loss: 0.7405
AUC: 0.8599

Epoch 48/80
 - 0s - loss: 1.1536 - val_loss: 0.7303
AUC: 0.8599

Epoch 49/80
 - 0s - loss: 1.1507 - val_loss: 0.7437
AUC: 0.8601

Epoch 50/80
 - 0s - loss: 1.1566 - val_loss: 0.7325
AUC: 0.8601

Epoch 51/80
 - 0s - loss: 1.1501 - val_loss: 0.7385
AUC: 0.8601

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.1541 - val_loss: 0.7508
AUC: 0.8600

Epoch 2/30
 - 0s - loss: 1.1534 - val_loss: 0.7174
AUC: 0.8601

Epoch 3/30
 - 0s - loss: 1.1479 - val_loss: 0.7503
AUC: 0.8604

Epoch 4/30
 - 0s - loss: 1.1482 - val_loss: 0.7303
AUC: 0.8606

Epoch 5/30
 - 0s - loss: 1.1480 - val_loss: 0.7402
AUC: 0.8607

Epoch 6/30
 - 0s - loss: 1.1424 - val_loss: 0.7272
AUC: 0.8608

Epoch 7/30
 - 0s - loss: 1.1458 - val_loss: 0.7347
AUC: 0.8608

Epoch 8/30
 - 0s - loss: 1.1495 - val_loss: 0.7593
AUC: 0.8612

Epoch 9/30
 - 0s - loss: 1.1397 - val_loss: 0.7162
AUC: 0.8610

Epoch 10/30
 - 0s - loss: 1.1386 - val_loss: 0.7268
AUC: 0.8610

Epoch 11/30
 - 0s - loss: 1.1388 - val_loss: 0.7482
AUC: 0.8614

Epoch 12/30
 - 0s - loss: 1.1410 - val_loss: 0.7269
AUC: 0.8612

Epoch 13/30
 - 0s - loss: 1.1387 - val_loss: 0.7055
AUC: 0.8613

Epoch 14/30
 - 0s - loss: 1.1331 - val_loss: 0.7279
AUC: 0.8616

Epoch 15/30
 - 0s - loss: 1.1264 - val_loss: 0.7325
AUC: 0.8617

Epoch 16/30
 - 0s - loss: 1.1317 - val_loss: 0.7343
AUC: 0.8618

Epoch 17/30
 - 0s - loss: 1.1294 - val_loss: 0.7215
AUC: 0.8619

Epoch 18/30
 - 0s - loss: 1.1313 - val_loss: 0.7406
AUC: 0.8621

Epoch 19/30
 - 0s - loss: 1.1284 - val_loss: 0.7332
AUC: 0.8621

Epoch 20/30
 - 0s - loss: 1.1284 - val_loss: 0.7056
AUC: 0.8619

Epoch 21/30
 - 0s - loss: 1.1226 - val_loss: 0.7114
AUC: 0.8623

Epoch 22/30
 - 0s - loss: 1.1276 - val_loss: 0.7100
AUC: 0.8623

Epoch 23/30
 - 0s - loss: 1.1231 - val_loss: 0.7068
AUC: 0.8623

Epoch 24/30
 - 0s - loss: 1.1250 - val_loss: 0.7171
AUC: 0.8624

Epoch 25/30
 - 0s - loss: 1.1149 - val_loss: 0.7214
AUC: 0.8624

Epoch 26/30
 - 0s - loss: 1.1111 - val_loss: 0.7187
AUC: 0.8624

Epoch 27/30
 - 0s - loss: 1.1169 - val_loss: 0.7199
AUC: 0.8625

Epoch 28/30
 - 0s - loss: 1.1163 - val_loss: 0.7204
AUC: 0.8625

Epoch 29/30
 - 0s - loss: 1.1251 - val_loss: 0.7190
AUC: 0.8625

Epoch 30/30
 - 0s - loss: 1.1197 - val_loss: 0.7202
Using TensorFlow backend.
AUC: 0.8625

2019-03-08 13:37:29.313267: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:37:29.479527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:37:29.479573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:37:29.782500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:37:29.782557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:37:29.782567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:37:29.782847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.7 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1490
Epoch 2/80
 - 2s - loss: 0.2151
Epoch 3/80
 - 2s - loss: 0.1737
Epoch 4/80
 - 2s - loss: 0.1672
Epoch 5/80
 - 2s - loss: 0.1603
Epoch 6/80
 - 2s - loss: 0.1501
Epoch 7/80
 - 2s - loss: 0.1373
Epoch 8/80
 - 2s - loss: 0.1254
Epoch 9/80
 - 2s - loss: 0.1156
Epoch 10/80
 - 2s - loss: 0.1073
Epoch 11/80
 - 2s - loss: 0.0999
Epoch 12/80
 - 2s - loss: 0.0933
Epoch 13/80
 - 2s - loss: 0.0875
Epoch 14/80
 - 2s - loss: 0.0825
Epoch 15/80
 - 2s - loss: 0.0782
Epoch 16/80
 - 2s - loss: 0.0745
Epoch 17/80
 - 2s - loss: 0.0713
Epoch 18/80
 - 2s - loss: 0.0684
Epoch 19/80
 - 2s - loss: 0.0660
Epoch 20/80
 - 2s - loss: 0.0638
Epoch 21/80
 - 2s - loss: 0.0620
Epoch 22/80
 - 2s - loss: 0.0604
Epoch 23/80
 - 2s - loss: 0.0591
Epoch 24/80
 - 2s - loss: 0.0579
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 13:38:40.801481: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:38:40.980440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:38:40.980487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:38:41.284015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:38:41.284071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:38:41.284081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:38:41.284355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.7 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1612
Epoch 2/80
 - 2s - loss: 0.2171
Epoch 3/80
 - 2s - loss: 0.1732
Epoch 4/80
 - 2s - loss: 0.1658
Epoch 5/80
 - 2s - loss: 0.1592
Epoch 6/80
 - 2s - loss: 0.1512
Epoch 7/80
 - 2s - loss: 0.1414
Epoch 8/80
 - 2s - loss: 0.1300
Epoch 9/80
 - 2s - loss: 0.1185
Epoch 10/80
 - 2s - loss: 0.1089
Epoch 11/80
 - 2s - loss: 0.1010
Epoch 12/80
 - 2s - loss: 0.0945
Epoch 13/80
 - 2s - loss: 0.0887
Epoch 14/80
 - 2s - loss: 0.0835
Epoch 15/80
 - 2s - loss: 0.0788
Epoch 16/80
 - 2s - loss: 0.0747
Epoch 17/80
 - 2s - loss: 0.0711
Epoch 18/80
 - 2s - loss: 0.0681
Epoch 19/80
 - 2s - loss: 0.0656
Epoch 20/80
 - 2s - loss: 0.0634
Epoch 21/80
 - 2s - loss: 0.0616
Epoch 22/80
 - 2s - loss: 0.0601
Epoch 23/80
 - 2s - loss: 0.0588
Epoch 24/80
 - 2s - loss: 0.0577
Epoch 25/80
 - 2s - loss: 0.0567
Epoch 26/80
 - 2s - loss: 0.0559
Epoch 27/80
 - 2s - loss: 0.0552
Epoch 28/80
 - 2s - loss: 0.0546
Epoch 29/80
 - 2s - loss: 0.0541
Epoch 30/80
 - 2s - loss: 0.0537
Epoch 31/80
 - 2s - loss: 0.0533
Epoch 32/80
 - 2s - loss: 0.0530
Epoch 33/80
 - 2s - loss: 0.0526
Epoch 34/80
 - 2s - loss: 0.0524
Epoch 35/80
 - 2s - loss: 0.0522
Epoch 36/80
 - 2s - loss: 0.0520
Epoch 37/80
 - 2s - loss: 0.0518
Epoch 38/80
 - 2s - loss: 0.0517
Epoch 39/80
 - 2s - loss: 0.0515
Epoch 40/80
 - 2s - loss: 0.0514
Epoch 41/80
 - 2s - loss: 0.0513
Epoch 42/80
 - 2s - loss: 0.0512
Epoch 43/80
 - 2s - loss: 0.0510
Epoch 44/80
 - 2s - loss: 0.0510
Epoch 45/80
 - 2s - loss: 0.0509
Epoch 46/80
 - 2s - loss: 0.0508
Epoch 47/80
 - 2s - loss: 0.0507
Epoch 48/80
 - 2s - loss: 0.0507
Epoch 49/80
 - 2s - loss: 0.0506
Epoch 50/80
 - 2s - loss: 0.0506
Epoch 51/80
 - 2s - loss: 0.0505
Epoch 52/80
 - 2s - loss: 0.0504
Epoch 53/80
 - 2s - loss: 0.0504
Epoch 54/80
 - 2s - loss: 0.0504
Epoch 55/80
 - 2s - loss: 0.0503
Epoch 56/80
 - 2s - loss: 0.0503
Epoch 57/80
 - 2s - loss: 0.0502
Epoch 58/80
 - 2s - loss: 0.0502
Epoch 59/80
 - 2s - loss: 0.0502
Epoch 60/80
 - 2s - loss: 0.0491
Epoch 61/80
 - 2s - loss: 0.0489
Epoch 62/80
 - 2s - loss: 0.0489
Epoch 63/80
 - 2s - loss: 0.0489
Epoch 64/80
 - 2s - loss: 0.0489
Epoch 65/80
 - 2s - loss: 0.0486
Epoch 66/80
 - 2s - loss: 0.0486
Epoch 67/80
 - 2s - loss: 0.0486
Epoch 68/80
 - 2s - loss: 0.0486
Epoch 69/80
 - 2s - loss: 0.0486
Epoch 70/80
 - 2s - loss: 0.0486
Epoch 71/80
 - 2s - loss: 0.0486
Epoch 72/80
 - 2s - loss: 0.0485
Epoch 73/80
 - 2s - loss: 0.0485
Epoch 74/80
 - 2s - loss: 0.0485
Epoch 75/80
 - 2s - loss: 0.0485
Epoch 76/80
 - 2s - loss: 0.0485
Epoch 77/80
 - 2s - loss: 0.0485
Epoch 78/80
 - 2s - loss: 0.0485
Epoch 79/80
 - 2s - loss: 0.0485
Epoch 80/80
 - 2s - loss: 0.0485
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.3652 - val_loss: 0.7304
AUC: 0.7893

Epoch 2/80
 - 0s - loss: 2.0732 - val_loss: 0.6194
AUC: 0.8104

Epoch 3/80
 - 0s - loss: 1.3129 - val_loss: 0.5652
AUC: 0.8260

Epoch 4/80
 - 0s - loss: 1.0056 - val_loss: 0.4904
AUC: 0.8303

Epoch 5/80
 - 0s - loss: 0.9124 - val_loss: 0.4812
AUC: 0.8394

Epoch 6/80
 - 0s - loss: 0.8670 - val_loss: 0.5083
AUC: 0.8460

Epoch 7/80
 - 0s - loss: 0.8418 - val_loss: 0.4918
AUC: 0.8500

Epoch 8/80
 - 0s - loss: 0.8299 - val_loss: 0.4664
AUC: 0.8522

Epoch 9/80
 - 0s - loss: 0.8079 - val_loss: 0.5065
AUC: 0.8531

Epoch 10/80
 - 0s - loss: 0.7985 - val_loss: 0.4697
AUC: 0.8551

Epoch 11/80
 - 0s - loss: 0.7948 - val_loss: 0.4683
AUC: 0.8573

Epoch 12/80
 - 0s - loss: 0.7891 - val_loss: 0.4597
AUC: 0.8570

Epoch 13/80
 - 0s - loss: 0.7813 - val_loss: 0.4575
AUC: 0.8596

Epoch 14/80
 - 0s - loss: 0.7815 - val_loss: 0.4248
AUC: 0.8585

Epoch 15/80
 - 0s - loss: 0.7714 - val_loss: 0.4666
AUC: 0.8610

Epoch 16/80
 - 0s - loss: 0.7654 - val_loss: 0.4519
AUC: 0.8604

Epoch 17/80
 - 0s - loss: 0.7632 - val_loss: 0.4462
AUC: 0.8623

Epoch 18/80
 - 0s - loss: 0.7642 - val_loss: 0.4617
AUC: 0.8629

Epoch 19/80
 - 0s - loss: 0.7622 - val_loss: 0.4978
AUC: 0.8649

Epoch 20/80
 - 0s - loss: 0.7550 - val_loss: 0.4841
AUC: 0.8647

Epoch 21/80
 - 0s - loss: 0.7512 - val_loss: 0.4673
AUC: 0.8653

Epoch 22/80
 - 0s - loss: 0.7506 - val_loss: 0.4891
AUC: 0.8655

Epoch 23/80
 - 0s - loss: 0.7491 - val_loss: 0.4433
AUC: 0.8650

Epoch 24/80
 - 0s - loss: 0.7479 - val_loss: 0.4579
AUC: 0.8654

Epoch 25/80
 - 0s - loss: 0.7421 - val_loss: 0.4336
AUC: 0.8652

Epoch 26/80
 - 0s - loss: 0.7389 - val_loss: 0.4329
AUC: 0.8657

Epoch 27/80
 - 0s - loss: 0.7407 - val_loss: 0.4341
AUC: 0.8657

Epoch 28/80
 - 0s - loss: 0.7379 - val_loss: 0.4641
AUC: 0.8668

Epoch 29/80
 - 0s - loss: 0.7388 - val_loss: 0.4620
AUC: 0.8665

Epoch 30/80
 - 0s - loss: 0.7337 - val_loss: 0.4637
AUC: 0.8664

Epoch 31/80
 - 0s - loss: 0.7343 - val_loss: 0.4430
AUC: 0.8665

Epoch 32/80
 - 0s - loss: 0.7353 - val_loss: 0.4333
AUC: 0.8663

Epoch 33/80
 - 0s - loss: 0.7326 - val_loss: 0.4424
AUC: 0.8662

Epoch 34/80
 - 0s - loss: 0.7366 - val_loss: 0.4422
AUC: 0.8664

Epoch 35/80
 - 0s - loss: 0.7347 - val_loss: 0.4459
AUC: 0.8665

Epoch 36/80
 - 0s - loss: 0.7352 - val_loss: 0.4450
AUC: 0.8666

Epoch 37/80
 - 0s - loss: 0.7336 - val_loss: 0.4451
AUC: 0.8666

Epoch 38/80
 - 0s - loss: 0.7330 - val_loss: 0.4459
AUC: 0.8666

Epoch 39/80
 - 0s - loss: 0.7313 - val_loss: 0.4462
AUC: 0.8667

Epoch 40/80
 - 0s - loss: 0.7368 - val_loss: 0.4472
AUC: 0.8668

Epoch 41/80
 - 0s - loss: 0.7343 - val_loss: 0.4470
AUC: 0.8668

Epoch 42/80
 - 0s - loss: 0.7333 - val_loss: 0.4443
AUC: 0.8668

Epoch 43/80
 - 0s - loss: 0.7354 - val_loss: 0.4550
AUC: 0.8671

Epoch 44/80
 - 0s - loss: 0.7353 - val_loss: 0.4431
AUC: 0.8669

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.7363 - val_loss: 0.4540
AUC: 0.8673

Epoch 2/30
 - 0s - loss: 0.7352 - val_loss: 0.4553
AUC: 0.8674

Epoch 3/30
 - 0s - loss: 0.7312 - val_loss: 0.4553
AUC: 0.8675

Epoch 4/30
 - 0s - loss: 0.7276 - val_loss: 0.4525
AUC: 0.8677

Epoch 5/30
 - 0s - loss: 0.7315 - val_loss: 0.4329
AUC: 0.8672

Epoch 6/30
 - 0s - loss: 0.7256 - val_loss: 0.4449
AUC: 0.8678

Epoch 7/30
 - 0s - loss: 0.7313 - val_loss: 0.4277
AUC: 0.8675

Epoch 8/30
 - 0s - loss: 0.7267 - val_loss: 0.4447
AUC: 0.8681

Epoch 9/30
 - 0s - loss: 0.7278 - val_loss: 0.4354
AUC: 0.8679

Epoch 10/30
 - 0s - loss: 0.7252 - val_loss: 0.4498
AUC: 0.8684

Epoch 11/30
 - 0s - loss: 0.7264 - val_loss: 0.4305
AUC: 0.8682

Epoch 12/30
 - 0s - loss: 0.7246 - val_loss: 0.4402
AUC: 0.8684

Epoch 13/30
 - 0s - loss: 0.7217 - val_loss: 0.4500
AUC: 0.8687

Epoch 14/30
 - 0s - loss: 0.7232 - val_loss: 0.4383
AUC: 0.8687

Epoch 15/30
 - 0s - loss: 0.7217 - val_loss: 0.4314
AUC: 0.8687

Epoch 16/30
 - 0s - loss: 0.7241 - val_loss: 0.4420
AUC: 0.8688

Epoch 17/30
 - 0s - loss: 0.7212 - val_loss: 0.4356
AUC: 0.8688

Epoch 18/30
 - 0s - loss: 0.7182 - val_loss: 0.4399
AUC: 0.8689

Epoch 19/30
 - 0s - loss: 0.7169 - val_loss: 0.4398
AUC: 0.8689

Epoch 20/30
 - 0s - loss: 0.7202 - val_loss: 0.4398
AUC: 0.8690

Epoch 21/30
 - 0s - loss: 0.7165 - val_loss: 0.4376
AUC: 0.8689

Epoch 22/30
 - 0s - loss: 0.7165 - val_loss: 0.4398
AUC: 0.8690

Epoch 23/30
 - 0s - loss: 0.7169 - val_loss: 0.4389
AUC: 0.8690

Epoch 24/30
 - 0s - loss: 0.7169 - val_loss: 0.4384
AUC: 0.8690

Epoch 25/30
 - 0s - loss: 0.7192 - val_loss: 0.4380
AUC: 0.8691

Epoch 26/30
 - 0s - loss: 0.7175 - val_loss: 0.4384
AUC: 0.8691

Epoch 27/30
 - 0s - loss: 0.7187 - val_loss: 0.4371
AUC: 0.8691

Epoch 28/30
 - 0s - loss: 0.7168 - val_loss: 0.4371
AUC: 0.8691

Epoch 29/30
 - 0s - loss: 0.7126 - val_loss: 0.4370
AUC: 0.8691

Epoch 30/30
 - 0s - loss: 0.7165 - val_loss: 0.4374
Using TensorFlow backend.
AUC: 0.8691

2019-03-08 13:42:28.892747: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:42:29.068556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:42:29.068602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:42:29.385802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:42:29.385846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:42:29.385856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:42:29.386172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.7 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1335
Epoch 2/80
 - 2s - loss: 0.2148
Epoch 3/80
 - 2s - loss: 0.1740
Epoch 4/80
 - 2s - loss: 0.1675
Epoch 5/80
 - 2s - loss: 0.1622
Epoch 6/80
 - 2s - loss: 0.1549
Epoch 7/80
 - 2s - loss: 0.1450
Epoch 8/80
 - 2s - loss: 0.1327
Epoch 9/80
 - 2s - loss: 0.1205
Epoch 10/80
 - 2s - loss: 0.1107
Epoch 11/80
 - 2s - loss: 0.1030
Epoch 12/80
 - 2s - loss: 0.0962
Epoch 13/80
 - 2s - loss: 0.0901
Epoch 14/80
 - 2s - loss: 0.0845
Epoch 15/80
 - 2s - loss: 0.0796
Epoch 16/80
 - 2s - loss: 0.0753
Epoch 17/80
 - 2s - loss: 0.0717
Epoch 18/80
 - 2s - loss: 0.0686
Epoch 19/80
 - 2s - loss: 0.0660
Epoch 20/80
 - 2s - loss: 0.0637
Epoch 21/80
 - 2s - loss: 0.0619
Epoch 22/80
 - 2s - loss: 0.0603
Epoch 23/80
 - 2s - loss: 0.0590
Epoch 24/80
 - 2s - loss: 0.0578
Epoch 25/80
 - 2s - loss: 0.0569
Epoch 26/80
 - 2s - loss: 0.0560
Epoch 27/80
 - 2s - loss: 0.0553
Epoch 28/80
 - 2s - loss: 0.0547
Epoch 29/80
 - 2s - loss: 0.0542
Epoch 30/80
 - 2s - loss: 0.0538
Epoch 31/80
 - 2s - loss: 0.0534
Epoch 32/80
 - 2s - loss: 0.0530
Epoch 33/80
 - 2s - loss: 0.0527
Epoch 34/80
 - 2s - loss: 0.0524
Epoch 35/80
 - 2s - loss: 0.0522
Epoch 36/80
 - 2s - loss: 0.0520
Epoch 37/80
 - 2s - loss: 0.0518
Epoch 38/80
 - 2s - loss: 0.0516
Epoch 39/80
 - 2s - loss: 0.0515
Epoch 40/80
 - 2s - loss: 0.0513
Epoch 41/80
 - 2s - loss: 0.0512
Epoch 42/80
 - 2s - loss: 0.0511
Epoch 43/80
 - 2s - loss: 0.0510
Epoch 44/80
 - 2s - loss: 0.0509
Epoch 45/80
 - 2s - loss: 0.0508
Epoch 46/80
 - 2s - loss: 0.0507
Epoch 47/80
 - 2s - loss: 0.0507
Epoch 48/80
 - 2s - loss: 0.0506
Epoch 49/80
 - 2s - loss: 0.0505
Epoch 50/80
 - 2s - loss: 0.0505
Epoch 51/80
 - 2s - loss: 0.0504
Epoch 52/80
 - 2s - loss: 0.0504
Epoch 53/80
 - 2s - loss: 0.0503
Epoch 54/80
 - 2s - loss: 0.0503
Epoch 55/80
 - 2s - loss: 0.0502
Epoch 56/80
 - 2s - loss: 0.0502
Epoch 57/80
 - 2s - loss: 0.0501
Epoch 58/80
 - 2s - loss: 0.0501
Epoch 59/80
 - 2s - loss: 0.0501
Epoch 60/80
 - 2s - loss: 0.0500
Epoch 61/80
 - 2s - loss: 0.0500
Epoch 62/80
 - 2s - loss: 0.0500
Epoch 63/80
 - 2s - loss: 0.0489
Epoch 64/80
 - 2s - loss: 0.0487
Epoch 65/80
 - 2s - loss: 0.0487
Epoch 66/80
 - 2s - loss: 0.0487
Epoch 67/80
 - 2s - loss: 0.0487
Epoch 68/80
 - 2s - loss: 0.0484
Epoch 69/80
 - 2s - loss: 0.0484
Epoch 70/80
 - 2s - loss: 0.0484
Epoch 71/80
 - 2s - loss: 0.0484
Epoch 72/80
 - 2s - loss: 0.0484
Epoch 73/80
 - 2s - loss: 0.0484
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 13:45:11.791034: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:45:11.956575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:45:11.956622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:45:12.260844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:45:12.260901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:45:12.260923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:45:12.261195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.7 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1533
Epoch 2/80
 - 2s - loss: 0.2164
Epoch 3/80
 - 2s - loss: 0.1735
Epoch 4/80
 - 2s - loss: 0.1668
Epoch 5/80
 - 2s - loss: 0.1601
Epoch 6/80
 - 2s - loss: 0.1503
Epoch 7/80
 - 2s - loss: 0.1383
Epoch 8/80
 - 2s - loss: 0.1266
Epoch 9/80
 - 2s - loss: 0.1164
Epoch 10/80
 - 2s - loss: 0.1077
Epoch 11/80
 - 2s - loss: 0.1000
Epoch 12/80
 - 2s - loss: 0.0931
Epoch 13/80
 - 2s - loss: 0.0870
Epoch 14/80
 - 2s - loss: 0.0818
Epoch 15/80
 - 2s - loss: 0.0774
Epoch 16/80
 - 2s - loss: 0.0736
Epoch 17/80
 - 2s - loss: 0.0703
Epoch 18/80
 - 2s - loss: 0.0675
Epoch 19/80
 - 2s - loss: 0.0651
Epoch 20/80
 - 2s - loss: 0.0630
Epoch 21/80
 - 2s - loss: 0.0613
Epoch 22/80
 - 2s - loss: 0.0598
Epoch 23/80
 - 2s - loss: 0.0585
Epoch 24/80
 - 2s - loss: 0.0574
Epoch 25/80
 - 2s - loss: 0.0565
Epoch 26/80
 - 2s - loss: 0.0557
Epoch 27/80
 - 2s - loss: 0.0550
Epoch 28/80
 - 2s - loss: 0.0544
Epoch 29/80
 - 2s - loss: 0.0539
Epoch 30/80
 - 2s - loss: 0.0534
Epoch 31/80
 - 2s - loss: 0.0531
Epoch 32/80
 - 2s - loss: 0.0527
Epoch 33/80
 - 2s - loss: 0.0524
Epoch 34/80
 - 2s - loss: 0.0522
Epoch 35/80
 - 2s - loss: 0.0520
Epoch 36/80
 - 2s - loss: 0.0518
Epoch 37/80
 - 2s - loss: 0.0516
Epoch 38/80
 - 2s - loss: 0.0515
Epoch 39/80
 - 2s - loss: 0.0513
Epoch 40/80
 - 2s - loss: 0.0512
Epoch 41/80
 - 2s - loss: 0.0511
Epoch 42/80
 - 2s - loss: 0.0509
Epoch 43/80
 - 2s - loss: 0.0509
Epoch 44/80
 - 2s - loss: 0.0508
Epoch 45/80
 - 2s - loss: 0.0507
Epoch 46/80
 - 2s - loss: 0.0506
Epoch 47/80
 - 2s - loss: 0.0505
Epoch 48/80
 - 2s - loss: 0.0505
Epoch 49/80
 - 2s - loss: 0.0504
Epoch 50/80
 - 2s - loss: 0.0504
Epoch 51/80
 - 2s - loss: 0.0503
Epoch 52/80
 - 2s - loss: 0.0503
Epoch 53/80
 - 2s - loss: 0.0502
Epoch 54/80
 - 2s - loss: 0.0502
Epoch 55/80
 - 2s - loss: 0.0501
Epoch 56/80
 - 2s - loss: 0.0501
Epoch 57/80
 - 2s - loss: 0.0501
Epoch 58/80
 - 2s - loss: 0.0500
Epoch 59/80
 - 2s - loss: 0.0489
Epoch 60/80
 - 2s - loss: 0.0488
Epoch 61/80
 - 2s - loss: 0.0488
Epoch 62/80
 - 2s - loss: 0.0488
Epoch 63/80
 - 2s - loss: 0.0487
Epoch 64/80
 - 2s - loss: 0.0485
Epoch 65/80
 - 2s - loss: 0.0485
Epoch 66/80
 - 2s - loss: 0.0485
Epoch 67/80
 - 2s - loss: 0.0485
Epoch 68/80
 - 2s - loss: 0.0484
Epoch 69/80
 - 2s - loss: 0.0484
Epoch 70/80
 - 2s - loss: 0.0484
Epoch 71/80
 - 2s - loss: 0.0484
Epoch 72/80
 - 2s - loss: 0.0484
Epoch 73/80
 - 2s - loss: 0.0484
Epoch 74/80
 - 2s - loss: 0.0484
Epoch 75/80
 - 2s - loss: 0.0484
Epoch 76/80
 - 2s - loss: 0.0484
Epoch 77/80
 - 2s - loss: 0.0484
Epoch 78/80
 - 2s - loss: 0.0484
Epoch 79/80
 - 2s - loss: 0.0484
Epoch 80/80
 - 2s - loss: 0.0484
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 5.1233 - val_loss: 1.9152
AUC: 0.7700

Epoch 2/80
 - 0s - loss: 3.3020 - val_loss: 1.4685
AUC: 0.8061

Epoch 3/80
 - 0s - loss: 2.2366 - val_loss: 1.0602
AUC: 0.8233

Epoch 4/80
 - 0s - loss: 1.7127 - val_loss: 1.0325
AUC: 0.8323

Epoch 5/80
 - 0s - loss: 1.5010 - val_loss: 0.8879
AUC: 0.8362

Epoch 6/80
 - 0s - loss: 1.4223 - val_loss: 0.8796
AUC: 0.8412

Epoch 7/80
 - 0s - loss: 1.3860 - val_loss: 0.8164
AUC: 0.8457

Epoch 8/80
 - 0s - loss: 1.3438 - val_loss: 0.8374
AUC: 0.8485

Epoch 9/80
 - 0s - loss: 1.3352 - val_loss: 0.7618
AUC: 0.8488

Epoch 10/80
 - 0s - loss: 1.3054 - val_loss: 0.7824
AUC: 0.8526

Epoch 11/80
 - 0s - loss: 1.2848 - val_loss: 0.8471
AUC: 0.8544

Epoch 12/80
 - 0s - loss: 1.2783 - val_loss: 0.8058
AUC: 0.8561

Epoch 13/80
 - 0s - loss: 1.2691 - val_loss: 0.7651
AUC: 0.8567

Epoch 14/80
 - 0s - loss: 1.2632 - val_loss: 0.8076
AUC: 0.8584

Epoch 15/80
 - 0s - loss: 1.2486 - val_loss: 0.7378
AUC: 0.8588

Epoch 16/80
 - 0s - loss: 1.2478 - val_loss: 0.8301
AUC: 0.8606

Epoch 17/80
 - 0s - loss: 1.2406 - val_loss: 0.7846
AUC: 0.8615

Epoch 18/80
 - 0s - loss: 1.2350 - val_loss: 0.7180
AUC: 0.8613

Epoch 19/80
 - 0s - loss: 1.2417 - val_loss: 0.7674
AUC: 0.8629

Epoch 20/80
 - 0s - loss: 1.2212 - val_loss: 0.7656
AUC: 0.8639

Epoch 21/80
 - 0s - loss: 1.2177 - val_loss: 0.6868
AUC: 0.8635

Epoch 22/80
 - 0s - loss: 1.2122 - val_loss: 0.7218
AUC: 0.8639

Epoch 23/80
 - 0s - loss: 1.2146 - val_loss: 0.8258
AUC: 0.8651

Epoch 24/80
 - 0s - loss: 1.2027 - val_loss: 0.7864
AUC: 0.8659

Epoch 25/80
 - 0s - loss: 1.2052 - val_loss: 0.7571
AUC: 0.8657

Epoch 26/80
 - 0s - loss: 1.1994 - val_loss: 0.7398
AUC: 0.8663

Epoch 27/80
 - 0s - loss: 1.2022 - val_loss: 0.7403
AUC: 0.8658

Epoch 28/80
 - 0s - loss: 1.1891 - val_loss: 0.7531
AUC: 0.8662

Epoch 29/80
 - 0s - loss: 1.1916 - val_loss: 0.7787
AUC: 0.8667

Epoch 30/80
 - 0s - loss: 1.1880 - val_loss: 0.7337
AUC: 0.8675

Epoch 31/80
 - 0s - loss: 1.1919 - val_loss: 0.6982
AUC: 0.8671

Epoch 32/80
 - 0s - loss: 1.1776 - val_loss: 0.7363
AUC: 0.8679

Epoch 33/80
 - 0s - loss: 1.1716 - val_loss: 0.7238
AUC: 0.8677

Epoch 34/80
 - 0s - loss: 1.1767 - val_loss: 0.7606
AUC: 0.8678

Epoch 35/80
 - 0s - loss: 1.1775 - val_loss: 0.7280
AUC: 0.8678

Epoch 36/80
 - 0s - loss: 1.1740 - val_loss: 0.6957
AUC: 0.8678

Epoch 37/80
 - 0s - loss: 1.1717 - val_loss: 0.7221
AUC: 0.8678

Epoch 38/80
 - 0s - loss: 1.1739 - val_loss: 0.7108
AUC: 0.8675

Epoch 39/80
 - 0s - loss: 1.1707 - val_loss: 0.7365
AUC: 0.8677

Epoch 40/80
 - 0s - loss: 1.1698 - val_loss: 0.7239
AUC: 0.8680

Epoch 41/80
 - 0s - loss: 1.1716 - val_loss: 0.7644
AUC: 0.8681

Epoch 42/80
 - 0s - loss: 1.1678 - val_loss: 0.7283
AUC: 0.8680

Epoch 43/80
 - 0s - loss: 1.1648 - val_loss: 0.7389
AUC: 0.8680

Epoch 44/80
 - 0s - loss: 1.1637 - val_loss: 0.7339
AUC: 0.8680

Epoch 45/80
 - 0s - loss: 1.1670 - val_loss: 0.7329
AUC: 0.8680

Epoch 46/80
 - 0s - loss: 1.1750 - val_loss: 0.7412
AUC: 0.8680

Epoch 47/80
 - 0s - loss: 1.1605 - val_loss: 0.7301
AUC: 0.8680

Epoch 48/80
 - 0s - loss: 1.1643 - val_loss: 0.7253
AUC: 0.8680

Epoch 49/80
 - 0s - loss: 1.1648 - val_loss: 0.7295
AUC: 0.8680

Epoch 50/80
 - 0s - loss: 1.1597 - val_loss: 0.7273
AUC: 0.8680

Epoch 51/80
 - 0s - loss: 1.1646 - val_loss: 0.7351
AUC: 0.8680

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.1658 - val_loss: 0.7207
AUC: 0.8680

Epoch 2/30
 - 0s - loss: 1.1644 - val_loss: 0.7220
AUC: 0.8682

Epoch 3/30
 - 0s - loss: 1.1665 - val_loss: 0.7228
AUC: 0.8683

Epoch 4/30
 - 0s - loss: 1.1615 - val_loss: 0.7245
AUC: 0.8684

Epoch 5/30
 - 0s - loss: 1.1594 - val_loss: 0.7387
AUC: 0.8686

Epoch 6/30
 - 0s - loss: 1.1543 - val_loss: 0.7467
AUC: 0.8687

Epoch 7/30
 - 0s - loss: 1.1597 - val_loss: 0.7420
AUC: 0.8688

Epoch 8/30
 - 0s - loss: 1.1569 - val_loss: 0.7300
AUC: 0.8689

Epoch 9/30
 - 0s - loss: 1.1567 - val_loss: 0.7114
AUC: 0.8690

Epoch 10/30
 - 0s - loss: 1.1531 - val_loss: 0.7338
AUC: 0.8692

Epoch 11/30
 - 0s - loss: 1.1546 - val_loss: 0.7140
AUC: 0.8692

Epoch 12/30
 - 0s - loss: 1.1485 - val_loss: 0.7109
AUC: 0.8693

Epoch 13/30
 - 0s - loss: 1.1452 - val_loss: 0.7158
AUC: 0.8694

Epoch 14/30
 - 0s - loss: 1.1412 - val_loss: 0.7023
AUC: 0.8696

Epoch 15/30
 - 0s - loss: 1.1440 - val_loss: 0.7280
AUC: 0.8698

Epoch 16/30
 - 0s - loss: 1.1452 - val_loss: 0.7290
AUC: 0.8699

Epoch 17/30
 - 0s - loss: 1.1401 - val_loss: 0.7203
AUC: 0.8698

Epoch 18/30
 - 0s - loss: 1.1411 - val_loss: 0.7099
AUC: 0.8699

Epoch 19/30
 - 0s - loss: 1.1439 - val_loss: 0.6934
AUC: 0.8698

Epoch 20/30
 - 0s - loss: 1.1435 - val_loss: 0.7372
AUC: 0.8702

Epoch 21/30
 - 0s - loss: 1.1413 - val_loss: 0.7236
AUC: 0.8702

Epoch 22/30
 - 0s - loss: 1.1321 - val_loss: 0.7210
AUC: 0.8704

Epoch 23/30
 - 0s - loss: 1.1397 - val_loss: 0.7285
AUC: 0.8707

Epoch 24/30
 - 0s - loss: 1.1439 - val_loss: 0.7110
AUC: 0.8706

Epoch 25/30
 - 0s - loss: 1.1302 - val_loss: 0.7303
AUC: 0.8705

Epoch 26/30
 - 0s - loss: 1.1411 - val_loss: 0.7181
AUC: 0.8706

Epoch 27/30
 - 0s - loss: 1.1296 - val_loss: 0.6961
AUC: 0.8707

Epoch 28/30
 - 0s - loss: 1.1269 - val_loss: 0.7175
AUC: 0.8709

Epoch 29/30
 - 0s - loss: 1.1278 - val_loss: 0.6947
AUC: 0.8708

Epoch 30/30
 - 0s - loss: 1.1287 - val_loss: 0.7151
Using TensorFlow backend.
AUC: 0.8709

2019-03-08 13:49:02.950134: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:49:03.119630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:49:03.119677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:49:03.424996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:49:03.425053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:49:03.425068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:49:03.425343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1954
Epoch 2/80
 - 2s - loss: 0.2251
Epoch 3/80
 - 2s - loss: 0.1721
Epoch 4/80
 - 2s - loss: 0.1618
Epoch 5/80
 - 2s - loss: 0.1529
Epoch 6/80
 - 2s - loss: 0.1424
Epoch 7/80
 - 2s - loss: 0.1312
Epoch 8/80
 - 2s - loss: 0.1205
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 13:49:37.161813: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:49:37.327734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:49:37.327802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:49:37.632473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:49:37.632533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:49:37.632543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:49:37.632871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1258
Epoch 2/80
 - 2s - loss: 0.2131
Epoch 3/80
 - 2s - loss: 0.1747
Epoch 4/80
 - 2s - loss: 0.1690
Epoch 5/80
 - 2s - loss: 0.1649
Epoch 6/80
 - 2s - loss: 0.1595
Epoch 7/80
 - 2s - loss: 0.1515
Epoch 8/80
 - 2s - loss: 0.1404
Epoch 9/80
 - 2s - loss: 0.1281
Epoch 10/80
 - 2s - loss: 0.1171
Epoch 11/80
 - 2s - loss: 0.1077
Epoch 12/80
 - 2s - loss: 0.0996
Epoch 13/80
 - 2s - loss: 0.0925
Epoch 14/80
 - 2s - loss: 0.0863
Epoch 15/80
 - 2s - loss: 0.0811
Epoch 16/80
 - 2s - loss: 0.0766
Epoch 17/80
 - 2s - loss: 0.0730
Epoch 18/80
 - 2s - loss: 0.0699
Epoch 19/80
 - 2s - loss: 0.0672
Epoch 20/80
 - 2s - loss: 0.0650
Epoch 21/80
 - 2s - loss: 0.0630
Epoch 22/80
 - 2s - loss: 0.0614
Epoch 23/80
 - 2s - loss: 0.0600
Epoch 24/80
 - 2s - loss: 0.0588
Epoch 25/80
 - 2s - loss: 0.0578
Epoch 26/80
 - 2s - loss: 0.0568
Epoch 27/80
 - 2s - loss: 0.0561
Epoch 28/80
 - 2s - loss: 0.0554
Epoch 29/80
 - 2s - loss: 0.0548
Epoch 30/80
 - 2s - loss: 0.0543
Epoch 31/80
 - 2s - loss: 0.0539
Epoch 32/80
 - 2s - loss: 0.0535
Epoch 33/80
 - 2s - loss: 0.0531
Epoch 34/80
 - 2s - loss: 0.0529
Epoch 35/80
 - 2s - loss: 0.0526
Epoch 36/80
 - 2s - loss: 0.0524
Epoch 37/80
 - 2s - loss: 0.0522
Epoch 38/80
 - 2s - loss: 0.0520
Epoch 39/80
 - 2s - loss: 0.0518
Epoch 40/80
 - 2s - loss: 0.0517
Epoch 41/80
 - 2s - loss: 0.0516
Epoch 42/80
 - 2s - loss: 0.0514
Epoch 43/80
 - 2s - loss: 0.0513
Epoch 44/80
 - 2s - loss: 0.0512
Epoch 45/80
 - 2s - loss: 0.0511
Epoch 46/80
 - 2s - loss: 0.0510
Epoch 47/80
 - 2s - loss: 0.0509
Epoch 48/80
 - 2s - loss: 0.0509
Epoch 49/80
 - 2s - loss: 0.0508
Epoch 50/80
 - 2s - loss: 0.0507
Epoch 51/80
 - 2s - loss: 0.0507
Epoch 52/80
 - 2s - loss: 0.0506
Epoch 53/80
 - 2s - loss: 0.0506
Epoch 54/80
 - 2s - loss: 0.0505
Epoch 55/80
 - 2s - loss: 0.0505
Epoch 56/80
 - 2s - loss: 0.0504
Epoch 57/80
 - 2s - loss: 0.0504
Epoch 58/80
 - 2s - loss: 0.0503
Epoch 59/80
 - 2s - loss: 0.0503
Epoch 60/80
 - 2s - loss: 0.0503
Epoch 61/80
 - 2s - loss: 0.0502
Epoch 62/80
 - 2s - loss: 0.0492
Epoch 63/80
 - 2s - loss: 0.0490
Epoch 64/80
 - 2s - loss: 0.0490
Epoch 65/80
 - 2s - loss: 0.0490
Epoch 66/80
 - 2s - loss: 0.0490
Epoch 67/80
 - 2s - loss: 0.0487
Epoch 68/80
 - 2s - loss: 0.0487
Epoch 69/80
 - 2s - loss: 0.0487
Epoch 70/80
 - 2s - loss: 0.0487
Epoch 71/80
 - 2s - loss: 0.0486
Epoch 72/80
 - 2s - loss: 0.0486
Epoch 73/80
 - 2s - loss: 0.0486
Epoch 74/80
 - 2s - loss: 0.0486
Epoch 75/80
 - 2s - loss: 0.0486
Epoch 76/80
 - 2s - loss: 0.0486
Epoch 77/80
 - 2s - loss: 0.0486
Epoch 78/80
 - 2s - loss: 0.0486
Epoch 79/80
 - 2s - loss: 0.0486
Epoch 80/80
 - 2s - loss: 0.0486
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 3.6878 - val_loss: 0.7592
AUC: 0.7631

Epoch 2/80
 - 0s - loss: 2.3873 - val_loss: 0.8398
AUC: 0.8068

Epoch 3/80
 - 0s - loss: 1.5957 - val_loss: 0.5713
AUC: 0.8127

Epoch 4/80
 - 0s - loss: 1.1637 - val_loss: 0.5225
AUC: 0.8166

Epoch 5/80
 - 0s - loss: 0.9833 - val_loss: 0.5126
AUC: 0.8238

Epoch 6/80
 - 0s - loss: 0.9060 - val_loss: 0.5340
AUC: 0.8340

Epoch 7/80
 - 0s - loss: 0.8806 - val_loss: 0.4724
AUC: 0.8321

Epoch 8/80
 - 0s - loss: 0.8582 - val_loss: 0.5386
AUC: 0.8403

Epoch 9/80
 - 0s - loss: 0.8378 - val_loss: 0.4947
AUC: 0.8409

Epoch 10/80
 - 0s - loss: 0.8270 - val_loss: 0.4912
AUC: 0.8442

Epoch 11/80
 - 0s - loss: 0.8234 - val_loss: 0.5288
AUC: 0.8477

Epoch 12/80
 - 0s - loss: 0.8095 - val_loss: 0.5006
AUC: 0.8477

Epoch 13/80
 - 0s - loss: 0.7966 - val_loss: 0.4763
AUC: 0.8490

Epoch 14/80
 - 0s - loss: 0.7913 - val_loss: 0.4553
AUC: 0.8497

Epoch 15/80
 - 0s - loss: 0.7821 - val_loss: 0.4656
AUC: 0.8513

Epoch 16/80
 - 0s - loss: 0.7856 - val_loss: 0.4594
AUC: 0.8514

Epoch 17/80
 - 0s - loss: 0.7809 - val_loss: 0.4433
AUC: 0.8527

Epoch 18/80
 - 0s - loss: 0.7687 - val_loss: 0.4965
AUC: 0.8551

Epoch 19/80
 - 0s - loss: 0.7719 - val_loss: 0.4645
AUC: 0.8555

Epoch 20/80
 - 0s - loss: 0.7645 - val_loss: 0.4767
AUC: 0.8563

Epoch 21/80
 - 0s - loss: 0.7613 - val_loss: 0.4410
AUC: 0.8556

Epoch 22/80
 - 0s - loss: 0.7606 - val_loss: 0.4343
AUC: 0.8560

Epoch 23/80
 - 0s - loss: 0.7587 - val_loss: 0.4402
AUC: 0.8563

Epoch 24/80
 - 0s - loss: 0.7583 - val_loss: 0.5120
AUC: 0.8592

Epoch 25/80
 - 0s - loss: 0.7537 - val_loss: 0.4747
AUC: 0.8588

Epoch 26/80
 - 0s - loss: 0.7562 - val_loss: 0.4606
AUC: 0.8580

Epoch 27/80
 - 0s - loss: 0.7498 - val_loss: 0.4487
AUC: 0.8600

Epoch 28/80
 - 0s - loss: 0.7471 - val_loss: 0.4325
AUC: 0.8591

Epoch 29/80
 - 0s - loss: 0.7434 - val_loss: 0.4813
AUC: 0.8604

Epoch 30/80
 - 0s - loss: 0.7439 - val_loss: 0.4831
AUC: 0.8614

Epoch 31/80
 - 0s - loss: 0.7419 - val_loss: 0.5273
AUC: 0.8625

Epoch 32/80
 - 0s - loss: 0.7429 - val_loss: 0.4483
AUC: 0.8615

Epoch 33/80
 - 0s - loss: 0.7390 - val_loss: 0.4643
AUC: 0.8619

Epoch 34/80
 - 0s - loss: 0.7320 - val_loss: 0.4247
AUC: 0.8608

Epoch 35/80
 - 0s - loss: 0.7334 - val_loss: 0.4748
AUC: 0.8632

Epoch 36/80
 - 0s - loss: 0.7352 - val_loss: 0.4781
AUC: 0.8628

Epoch 37/80
 - 0s - loss: 0.7353 - val_loss: 0.4411
AUC: 0.8627

Epoch 38/80
 - 0s - loss: 0.7340 - val_loss: 0.4620
AUC: 0.8625

Epoch 39/80
 - 0s - loss: 0.7293 - val_loss: 0.4577
AUC: 0.8635

Epoch 40/80
 - 0s - loss: 0.7270 - val_loss: 0.4845
AUC: 0.8630

Epoch 41/80
 - 0s - loss: 0.7240 - val_loss: 0.4272
AUC: 0.8628

Epoch 42/80
 - 0s - loss: 0.7227 - val_loss: 0.4385
AUC: 0.8634

Epoch 43/80
 - 0s - loss: 0.7232 - val_loss: 0.4539
AUC: 0.8649

Epoch 44/80
 - 0s - loss: 0.7206 - val_loss: 0.4336
AUC: 0.8633

Epoch 45/80
 - 0s - loss: 0.7171 - val_loss: 0.4538
AUC: 0.8645

Epoch 46/80
 - 0s - loss: 0.7194 - val_loss: 0.4462
AUC: 0.8645

Epoch 47/80
 - 0s - loss: 0.7189 - val_loss: 0.4428
AUC: 0.8645

Epoch 48/80
 - 0s - loss: 0.7132 - val_loss: 0.4383
AUC: 0.8647

Epoch 49/80
 - 0s - loss: 0.7145 - val_loss: 0.4522
AUC: 0.8648

Epoch 50/80
 - 0s - loss: 0.7160 - val_loss: 0.4537
AUC: 0.8649

Epoch 51/80
 - 0s - loss: 0.7120 - val_loss: 0.4294
AUC: 0.8644

Epoch 52/80
 - 0s - loss: 0.7159 - val_loss: 0.4396
AUC: 0.8647

Epoch 53/80
 - 0s - loss: 0.7140 - val_loss: 0.4289
AUC: 0.8643

Epoch 54/80
 - 0s - loss: 0.7147 - val_loss: 0.4533
AUC: 0.8649

Epoch 55/80
 - 0s - loss: 0.7139 - val_loss: 0.4441
AUC: 0.8648

Epoch 56/80
 - 0s - loss: 0.7132 - val_loss: 0.4411
AUC: 0.8648

Epoch 57/80
 - 0s - loss: 0.7116 - val_loss: 0.4451
AUC: 0.8648

Epoch 58/80
 - 0s - loss: 0.7133 - val_loss: 0.4463
AUC: 0.8649

Epoch 59/80
 - 0s - loss: 0.7130 - val_loss: 0.4451
AUC: 0.8649

Epoch 60/80
 - 0s - loss: 0.7133 - val_loss: 0.4443
AUC: 0.8649

Epoch 61/80
 - 0s - loss: 0.7113 - val_loss: 0.4438
AUC: 0.8649

Epoch 62/80
 - 0s - loss: 0.7125 - val_loss: 0.4459
AUC: 0.8649

Epoch 63/80
 - 0s - loss: 0.7098 - val_loss: 0.4421
AUC: 0.8648

Epoch 64/80
 - 0s - loss: 0.7115 - val_loss: 0.4471
AUC: 0.8649

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.7137 - val_loss: 0.4487
AUC: 0.8651

Epoch 2/30
 - 0s - loss: 0.7117 - val_loss: 0.4367
AUC: 0.8650

Epoch 3/30
 - 0s - loss: 0.7118 - val_loss: 0.4468
AUC: 0.8654

Epoch 4/30
 - 0s - loss: 0.7100 - val_loss: 0.4473
AUC: 0.8653

Epoch 5/30
 - 0s - loss: 0.7103 - val_loss: 0.4358
AUC: 0.8653

Epoch 6/30
 - 0s - loss: 0.7087 - val_loss: 0.4378
AUC: 0.8656

Epoch 7/30
 - 0s - loss: 0.7075 - val_loss: 0.4399
AUC: 0.8655

Epoch 8/30
 - 0s - loss: 0.7037 - val_loss: 0.4414
AUC: 0.8657

Epoch 9/30
 - 0s - loss: 0.7083 - val_loss: 0.4458
AUC: 0.8659

Epoch 10/30
 - 0s - loss: 0.7029 - val_loss: 0.4439
AUC: 0.8659

Epoch 11/30
 - 0s - loss: 0.7017 - val_loss: 0.4373
AUC: 0.8660

Epoch 12/30
 - 0s - loss: 0.7025 - val_loss: 0.4459
AUC: 0.8662

Epoch 13/30
 - 0s - loss: 0.7013 - val_loss: 0.4405
AUC: 0.8663

Epoch 14/30
 - 0s - loss: 0.7043 - val_loss: 0.4382
AUC: 0.8664

Epoch 15/30
 - 0s - loss: 0.7008 - val_loss: 0.4504
AUC: 0.8667

Epoch 16/30
 - 0s - loss: 0.7004 - val_loss: 0.4428
AUC: 0.8666

Epoch 17/30
 - 0s - loss: 0.6978 - val_loss: 0.4415
AUC: 0.8665

Epoch 18/30
 - 0s - loss: 0.6981 - val_loss: 0.4434
AUC: 0.8666

Epoch 19/30
 - 0s - loss: 0.6978 - val_loss: 0.4399
AUC: 0.8666

Epoch 20/30
 - 0s - loss: 0.6952 - val_loss: 0.4413
AUC: 0.8666

Epoch 21/30
 - 0s - loss: 0.6951 - val_loss: 0.4386
AUC: 0.8666

Epoch 22/30
 - 0s - loss: 0.7006 - val_loss: 0.4393
AUC: 0.8666

Epoch 23/30
 - 0s - loss: 0.6990 - val_loss: 0.4415
AUC: 0.8667

Epoch 24/30
 - 0s - loss: 0.6949 - val_loss: 0.4396
AUC: 0.8667

Epoch 25/30
 - 0s - loss: 0.6965 - val_loss: 0.4420
AUC: 0.8668

Epoch 26/30
 - 0s - loss: 0.6990 - val_loss: 0.4424
AUC: 0.8668

Epoch 27/30
 - 0s - loss: 0.6968 - val_loss: 0.4412
AUC: 0.8668

Epoch 28/30
 - 0s - loss: 0.6974 - val_loss: 0.4416
AUC: 0.8668

Epoch 29/30
 - 0s - loss: 0.6972 - val_loss: 0.4410
AUC: 0.8668

Epoch 30/30
 - 0s - loss: 0.6980 - val_loss: 0.4402
Using TensorFlow backend.
AUC: 0.8667

2019-03-08 13:53:36.065016: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:53:36.236289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:53:36.236338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:53:36.541525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:53:36.541583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:53:36.541593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:53:36.541869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1761
Epoch 2/80
 - 2s - loss: 0.2177
Epoch 3/80
 - 2s - loss: 0.1716
Epoch 4/80
 - 2s - loss: 0.1634
Epoch 5/80
 - 2s - loss: 0.1575
Epoch 6/80
 - 2s - loss: 0.1505
Epoch 7/80
 - 2s - loss: 0.1417
Epoch 8/80
 - 2s - loss: 0.1314
Epoch 9/80
 - 2s - loss: 0.1204
Epoch 10/80
 - 2s - loss: 0.1101
Epoch 11/80
 - 2s - loss: 0.1012
Epoch 12/80
 - 2s - loss: 0.0936
Epoch 13/80
 - 2s - loss: 0.0872
Epoch 14/80
 - 2s - loss: 0.0819
Epoch 15/80
 - 2s - loss: 0.0774
Epoch 16/80
 - 2s - loss: 0.0736
Epoch 17/80
 - 2s - loss: 0.0704
Epoch 18/80
 - 2s - loss: 0.0677
Epoch 19/80
 - 2s - loss: 0.0655
Epoch 20/80
 - 2s - loss: 0.0637
Epoch 21/80
 - 2s - loss: 0.0622
Epoch 22/80
 - 2s - loss: 0.0609
Epoch 23/80
 - 2s - loss: 0.0598
Epoch 24/80
 - 2s - loss: 0.0588
Epoch 25/80
 - 2s - loss: 0.0579
Epoch 26/80
 - 2s - loss: 0.0572
Epoch 27/80
 - 2s - loss: 0.0565
Epoch 28/80
 - 2s - loss: 0.0559
Epoch 29/80
 - 2s - loss: 0.0553
Epoch 30/80
 - 2s - loss: 0.0548
Epoch 31/80
 - 2s - loss: 0.0544
Epoch 32/80
 - 2s - loss: 0.0540
Epoch 33/80
 - 2s - loss: 0.0536
Epoch 34/80
 - 2s - loss: 0.0533
Epoch 35/80
 - 2s - loss: 0.0530
Epoch 36/80
 - 2s - loss: 0.0527
Epoch 37/80
 - 2s - loss: 0.0525
Epoch 38/80
 - 2s - loss: 0.0523
Epoch 39/80
 - 2s - loss: 0.0521
Epoch 40/80
 - 2s - loss: 0.0520
Epoch 41/80
 - 2s - loss: 0.0518
Epoch 42/80
 - 2s - loss: 0.0517
Epoch 43/80
 - 2s - loss: 0.0515
Epoch 44/80
 - 2s - loss: 0.0514
Epoch 45/80
 - 2s - loss: 0.0513
Epoch 46/80
 - 2s - loss: 0.0512
Epoch 47/80
 - 2s - loss: 0.0511
Epoch 48/80
 - 2s - loss: 0.0511
Epoch 49/80
 - 2s - loss: 0.0510
Epoch 50/80
 - 2s - loss: 0.0509
Epoch 51/80
 - 2s - loss: 0.0509
Epoch 52/80
 - 2s - loss: 0.0508
Epoch 53/80
 - 2s - loss: 0.0507
Epoch 54/80
 - 2s - loss: 0.0507
Epoch 55/80
 - 2s - loss: 0.0506
Epoch 56/80
 - 2s - loss: 0.0506
Epoch 57/80
 - 2s - loss: 0.0506
Epoch 58/80
 - 2s - loss: 0.0505
Epoch 59/80
 - 2s - loss: 0.0505
Epoch 60/80
 - 2s - loss: 0.0504
Epoch 61/80
 - 2s - loss: 0.0504
Epoch 62/80
 - 2s - loss: 0.0504
Epoch 63/80
 - 2s - loss: 0.0503
Epoch 64/80
 - 2s - loss: 0.0503
Epoch 65/80
 - 2s - loss: 0.0492
Epoch 66/80
 - 2s - loss: 0.0491
Epoch 67/80
 - 2s - loss: 0.0491
Epoch 68/80
 - 2s - loss: 0.0491
Epoch 69/80
 - 2s - loss: 0.0491
Epoch 70/80
 - 2s - loss: 0.0488
Epoch 71/80
 - 2s - loss: 0.0488
Epoch 72/80
 - 2s - loss: 0.0488
Epoch 73/80
 - 2s - loss: 0.0488
Epoch 74/80
 - 2s - loss: 0.0487
Epoch 75/80
 - 2s - loss: 0.0487
Epoch 76/80
 - 2s - loss: 0.0487
Epoch 77/80
 - 2s - loss: 0.0487
Epoch 78/80
 - 2s - loss: 0.0487
Epoch 79/80
 - 2s - loss: 0.0487
Epoch 80/80
 - 2s - loss: 0.0487
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 2.3261 - val_loss: 0.9223
AUC: 0.4663

Epoch 2/80
 - 0s - loss: 1.3785 - val_loss: 0.6704
AUC: 0.6221

Epoch 3/80
 - 0s - loss: 1.0347 - val_loss: 0.5305
AUC: 0.7100

Epoch 4/80
 - 0s - loss: 0.7898 - val_loss: 0.4146
AUC: 0.7581

Epoch 5/80
 - 0s - loss: 0.6028 - val_loss: 0.3961
AUC: 0.7671

Epoch 6/80
 - 0s - loss: 0.4671 - val_loss: 0.3645
AUC: 0.7827

Epoch 7/80
 - 0s - loss: 0.4040 - val_loss: 0.3450
AUC: 0.8043

Epoch 8/80
 - 0s - loss: 0.3856 - val_loss: 0.3410
AUC: 0.8090

Epoch 9/80
 - 0s - loss: 0.3672 - val_loss: 0.3414
AUC: 0.8095

Epoch 10/80
 - 0s - loss: 0.3651 - val_loss: 0.3386
AUC: 0.8140

Epoch 11/80
 - 0s - loss: 0.3565 - val_loss: 0.3358
AUC: 0.8174

Epoch 12/80
 - 0s - loss: 0.3512 - val_loss: 0.3338
AUC: 0.8214

Epoch 13/80
 - 0s - loss: 0.3439 - val_loss: 0.3327
AUC: 0.8229

Epoch 14/80
 - 0s - loss: 0.3464 - val_loss: 0.3293
AUC: 0.8287

Epoch 15/80
 - 0s - loss: 0.3419 - val_loss: 0.3277
AUC: 0.8293

Epoch 16/80
 - 0s - loss: 0.3391 - val_loss: 0.3276
AUC: 0.8293

Epoch 17/80
 - 0s - loss: 0.3368 - val_loss: 0.3262
AUC: 0.8334

Epoch 18/80
 - 0s - loss: 0.3350 - val_loss: 0.3242
AUC: 0.8345

Epoch 19/80
 - 0s - loss: 0.3344 - val_loss: 0.3242
AUC: 0.8353

Epoch 20/80
 - 0s - loss: 0.3331 - val_loss: 0.3218
AUC: 0.8380

Epoch 21/80
 - 0s - loss: 0.3324 - val_loss: 0.3217
AUC: 0.8378

Epoch 22/80
 - 0s - loss: 0.3271 - val_loss: 0.3233
AUC: 0.8415

Epoch 23/80
 - 0s - loss: 0.3258 - val_loss: 0.3190
AUC: 0.8428

Epoch 24/80
 - 0s - loss: 0.3256 - val_loss: 0.3184
AUC: 0.8420

Epoch 25/80
 - 0s - loss: 0.3227 - val_loss: 0.3173
AUC: 0.8449

Epoch 26/80
 - 0s - loss: 0.3237 - val_loss: 0.3169
AUC: 0.8440

Epoch 27/80
 - 0s - loss: 0.3202 - val_loss: 0.3162
AUC: 0.8465

Epoch 28/80
 - 0s - loss: 0.3219 - val_loss: 0.3149
AUC: 0.8471

Epoch 29/80
 - 0s - loss: 0.3185 - val_loss: 0.3155
AUC: 0.8468

Epoch 30/80
 - 0s - loss: 0.3198 - val_loss: 0.3144
AUC: 0.8475

Epoch 31/80
 - 0s - loss: 0.3180 - val_loss: 0.3138
AUC: 0.8482

Epoch 32/80
 - 0s - loss: 0.3178 - val_loss: 0.3122
AUC: 0.8504

Epoch 33/80
 - 0s - loss: 0.3163 - val_loss: 0.3137
AUC: 0.8494

Epoch 34/80
 - 0s - loss: 0.3135 - val_loss: 0.3112
AUC: 0.8516

Epoch 35/80
 - 0s - loss: 0.3140 - val_loss: 0.3103
AUC: 0.8530

Epoch 36/80
 - 0s - loss: 0.3124 - val_loss: 0.3102
AUC: 0.8531

Epoch 37/80
 - 0s - loss: 0.3141 - val_loss: 0.3096
AUC: 0.8532

Epoch 38/80
 - 0s - loss: 0.3112 - val_loss: 0.3096
AUC: 0.8558

Epoch 39/80
 - 0s - loss: 0.3113 - val_loss: 0.3083
AUC: 0.8554

Epoch 40/80
 - 0s - loss: 0.3093 - val_loss: 0.3087
AUC: 0.8559

Epoch 41/80
 - 0s - loss: 0.3090 - val_loss: 0.3068
AUC: 0.8570

Epoch 42/80
 - 0s - loss: 0.3092 - val_loss: 0.3079
AUC: 0.8558

Epoch 43/80
 - 0s - loss: 0.3079 - val_loss: 0.3071
AUC: 0.8572

Epoch 44/80
 - 0s - loss: 0.3086 - val_loss: 0.3067
AUC: 0.8574

Epoch 45/80
 - 0s - loss: 0.3064 - val_loss: 0.3070
AUC: 0.8573

Epoch 46/80
 - 0s - loss: 0.3056 - val_loss: 0.3056
AUC: 0.8592

Epoch 47/80
 - 0s - loss: 0.3062 - val_loss: 0.3064
AUC: 0.8586

Epoch 48/80
 - 0s - loss: 0.3059 - val_loss: 0.3059
AUC: 0.8584

Epoch 49/80
 - 0s - loss: 0.3049 - val_loss: 0.3050
AUC: 0.8593

Epoch 50/80
 - 0s - loss: 0.3038 - val_loss: 0.3046
AUC: 0.8601

Epoch 51/80
 - 0s - loss: 0.3029 - val_loss: 0.3049
AUC: 0.8601

Epoch 52/80
 - 0s - loss: 0.3033 - val_loss: 0.3060
AUC: 0.8598

Epoch 53/80
 - 0s - loss: 0.3037 - val_loss: 0.3049
AUC: 0.8597

Epoch 54/80
 - 0s - loss: 0.3042 - val_loss: 0.3043
AUC: 0.8602

Epoch 55/80
 - 0s - loss: 0.3024 - val_loss: 0.3049
AUC: 0.8595

Epoch 56/80
 - 0s - loss: 0.3016 - val_loss: 0.3036
AUC: 0.8612

Epoch 57/80
 - 0s - loss: 0.3019 - val_loss: 0.3034
AUC: 0.8615

Epoch 58/80
 - 0s - loss: 0.3006 - val_loss: 0.3059
AUC: 0.8590

Epoch 59/80
 - 0s - loss: 0.2991 - val_loss: 0.3036
AUC: 0.8627

Epoch 60/80
 - 0s - loss: 0.3002 - val_loss: 0.3037
AUC: 0.8616

Epoch 61/80
 - 0s - loss: 0.3010 - val_loss: 0.3071
AUC: 0.8606

Epoch 62/80
 - 0s - loss: 0.3002 - val_loss: 0.3031
AUC: 0.8626

Epoch 63/80
 - 0s - loss: 0.2987 - val_loss: 0.3027
AUC: 0.8624

Epoch 64/80
 - 0s - loss: 0.2979 - val_loss: 0.3024
AUC: 0.8627

Epoch 65/80
 - 0s - loss: 0.2982 - val_loss: 0.3028
AUC: 0.8636

Epoch 66/80
 - 0s - loss: 0.2977 - val_loss: 0.3023
AUC: 0.8629

Epoch 67/80
 - 0s - loss: 0.2964 - val_loss: 0.3033
AUC: 0.8621

Epoch 68/80
 - 0s - loss: 0.2963 - val_loss: 0.3045
AUC: 0.8623

Epoch 69/80
 - 0s - loss: 0.2969 - val_loss: 0.3051
AUC: 0.8625

Epoch 70/80
 - 0s - loss: 0.2970 - val_loss: 0.3018
AUC: 0.8652

Epoch 71/80
 - 0s - loss: 0.2977 - val_loss: 0.3013
AUC: 0.8652

Epoch 72/80
 - 0s - loss: 0.2955 - val_loss: 0.3021
AUC: 0.8642

Epoch 73/80
 - 0s - loss: 0.2947 - val_loss: 0.3014
AUC: 0.8641

Epoch 74/80
 - 0s - loss: 0.2953 - val_loss: 0.3010
AUC: 0.8650

Epoch 75/80
 - 0s - loss: 0.2957 - val_loss: 0.3062
AUC: 0.8642

Epoch 76/80
 - 0s - loss: 0.2942 - val_loss: 0.3016
AUC: 0.8648

Epoch 77/80
 - 0s - loss: 0.2936 - val_loss: 0.3050
AUC: 0.8651

Epoch 78/80
 - 0s - loss: 0.2935 - val_loss: 0.3031
AUC: 0.8649

Epoch 79/80
 - 0s - loss: 0.2943 - val_loss: 0.3024
AUC: 0.8654

Epoch 80/80
 - 0s - loss: 0.2928 - val_loss: 0.3024
AUC: 0.8636

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.2908 - val_loss: 0.2999
AUC: 0.8658

Epoch 2/30
 - 0s - loss: 0.2891 - val_loss: 0.2996
AUC: 0.8663

Epoch 3/30
 - 0s - loss: 0.2892 - val_loss: 0.2996
AUC: 0.8661

Epoch 4/30
 - 0s - loss: 0.2893 - val_loss: 0.2994
AUC: 0.8666

Epoch 5/30
 - 0s - loss: 0.2893 - val_loss: 0.2995
AUC: 0.8663

Epoch 6/30
 - 0s - loss: 0.2890 - val_loss: 0.2991
AUC: 0.8668

Epoch 7/30
 - 0s - loss: 0.2885 - val_loss: 0.2991
AUC: 0.8668

Epoch 8/30
 - 0s - loss: 0.2888 - val_loss: 0.2991
AUC: 0.8669

Epoch 9/30
 - 0s - loss: 0.2887 - val_loss: 0.2994
AUC: 0.8669

Epoch 10/30
 - 0s - loss: 0.2876 - val_loss: 0.2989
AUC: 0.8671

Epoch 11/30
 - 0s - loss: 0.2860 - val_loss: 0.2989
AUC: 0.8672

Epoch 12/30
 - 0s - loss: 0.2871 - val_loss: 0.2988
AUC: 0.8672

Epoch 13/30
 - 0s - loss: 0.2884 - val_loss: 0.2990
AUC: 0.8671

Epoch 14/30
 - 0s - loss: 0.2859 - val_loss: 0.2994
AUC: 0.8670

Epoch 15/30
 - 0s - loss: 0.2885 - val_loss: 0.2987
AUC: 0.8673

Epoch 16/30
 - 0s - loss: 0.2862 - val_loss: 0.2988
AUC: 0.8674

Epoch 17/30
 - 0s - loss: 0.2869 - val_loss: 0.2983
AUC: 0.8678

Epoch 18/30
 - 0s - loss: 0.2853 - val_loss: 0.2988
AUC: 0.8673

Epoch 19/30
 - 0s - loss: 0.2841 - val_loss: 0.2992
AUC: 0.8672

Epoch 20/30
 - 0s - loss: 0.2844 - val_loss: 0.2986
AUC: 0.8677

Epoch 21/30
 - 0s - loss: 0.2836 - val_loss: 0.2984
AUC: 0.8678

Epoch 22/30
 - 0s - loss: 0.2843 - val_loss: 0.2990
AUC: 0.8675

Epoch 23/30
 - 0s - loss: 0.2850 - val_loss: 0.2986
AUC: 0.8677

Epoch 24/30
 - 0s - loss: 0.2855 - val_loss: 0.2986
AUC: 0.8679

Epoch 25/30
 - 0s - loss: 0.2857 - val_loss: 0.2984
AUC: 0.8681

Epoch 26/30
 - 0s - loss: 0.2831 - val_loss: 0.2982
AUC: 0.8681

Epoch 27/30
 - 0s - loss: 0.2838 - val_loss: 0.2984
AUC: 0.8681

Epoch 28/30
 - 0s - loss: 0.2835 - val_loss: 0.2982
AUC: 0.8682

Epoch 29/30
 - 0s - loss: 0.2832 - val_loss: 0.2981
AUC: 0.8683

Epoch 30/30
 - 0s - loss: 0.2824 - val_loss: 0.2981
Using TensorFlow backend.
AUC: 0.8683

2019-03-08 13:57:46.060242: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 13:57:46.231202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 13:57:46.231248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 13:57:46.535242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 13:57:46.535295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 13:57:46.535305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 13:57:46.535577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.7 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1566
Epoch 2/80
 - 2s - loss: 0.2179
Epoch 3/80
 - 2s - loss: 0.1737
Epoch 4/80
 - 2s - loss: 0.1660
Epoch 5/80
 - 2s - loss: 0.1587
Epoch 6/80
 - 2s - loss: 0.1487
Epoch 7/80
 - 2s - loss: 0.1363
Epoch 8/80
 - 2s - loss: 0.1248
Epoch 9/80
 - 2s - loss: 0.1155
Epoch 10/80
 - 2s - loss: 0.1078
Epoch 11/80
 - 2s - loss: 0.1009
Epoch 12/80
 - 2s - loss: 0.0943
Epoch 13/80
 - 2s - loss: 0.0883
Epoch 14/80
 - 2s - loss: 0.0829
Epoch 15/80
 - 2s - loss: 0.0784
Epoch 16/80
 - 2s - loss: 0.0746
Epoch 17/80
 - 2s - loss: 0.0713
Epoch 18/80
 - 2s - loss: 0.0684
Epoch 19/80
 - 2s - loss: 0.0658
Epoch 20/80
 - 2s - loss: 0.0637
Epoch 21/80
 - 2s - loss: 0.0619
Epoch 22/80
 - 2s - loss: 0.0603
Epoch 23/80
 - 2s - loss: 0.0591
Epoch 24/80
 - 2s - loss: 0.0580
Epoch 25/80
 - 2s - loss: 0.0571
Epoch 26/80
 - 2s - loss: 0.0563
Epoch 27/80
 - 2s - loss: 0.0557
Epoch 28/80
 - 2s - loss: 0.0551
Epoch 29/80
 - 2s - loss: 0.0546
Epoch 30/80
 - 2s - loss: 0.0541
Epoch 31/80
 - 2s - loss: 0.0537
Epoch 32/80
 - 2s - loss: 0.0534
Epoch 33/80
 - 2s - loss: 0.0531
Epoch 34/80
 - 2s - loss: 0.0528
Epoch 35/80
 - 2s - loss: 0.0526
Epoch 36/80
 - 2s - loss: 0.0524
Epoch 37/80
 - 2s - loss: 0.0522
Epoch 38/80
 - 2s - loss: 0.0520
Epoch 39/80
 - 2s - loss: 0.0519
Epoch 40/80
 - 2s - loss: 0.0518
Epoch 41/80
 - 2s - loss: 0.0516
Epoch 42/80
 - 2s - loss: 0.0515
Epoch 43/80
 - 2s - loss: 0.0514
Epoch 44/80
 - 2s - loss: 0.0513
Epoch 45/80
 - 2s - loss: 0.0512
Epoch 46/80
 - 2s - loss: 0.0511
Epoch 47/80
 - 2s - loss: 0.0511
Epoch 48/80
 - 2s - loss: 0.0510
Epoch 49/80
 - 2s - loss: 0.0509
Epoch 50/80
 - 2s - loss: 0.0508
Epoch 51/80
 - 2s - loss: 0.0508
Epoch 52/80
 - 2s - loss: 0.0508
Epoch 53/80
 - 2s - loss: 0.0507
Epoch 54/80
 - 2s - loss: 0.0507
Epoch 55/80
 - 2s - loss: 0.0506
Epoch 56/80
 - 2s - loss: 0.0506
Epoch 57/80
 - 2s - loss: 0.0505
Epoch 58/80
 - 2s - loss: 0.0505
Epoch 59/80
 - 2s - loss: 0.0505
Epoch 60/80
 - 2s - loss: 0.0504
Epoch 61/80
 - 2s - loss: 0.0504
Epoch 62/80
 - 2s - loss: 0.0504
Epoch 63/80
 - 2s - loss: 0.0504
Epoch 64/80
 - 2s - loss: 0.0503
Epoch 65/80
 - 2s - loss: 0.0503
Epoch 66/80
 - 2s - loss: 0.0492
Epoch 67/80
 - 2s - loss: 0.0491
Epoch 68/80
 - 2s - loss: 0.0491
Epoch 69/80
 - 2s - loss: 0.0490
Epoch 70/80
 - 2s - loss: 0.0490
Epoch 71/80
 - 2s - loss: 0.0488
Epoch 72/80
 - 2s - loss: 0.0488
Epoch 73/80
 - 2s - loss: 0.0487
Epoch 74/80
 - 2s - loss: 0.0487
Epoch 75/80
 - 2s - loss: 0.0487
Epoch 76/80
 - 2s - loss: 0.0487
Epoch 77/80
 - 2s - loss: 0.0487
Epoch 78/80
 - 2s - loss: 0.0487
Epoch 79/80
 - 2s - loss: 0.0487
Epoch 80/80
 - 2s - loss: 0.0487
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 5.0295 - val_loss: 1.6472
AUC: 0.7939

Epoch 2/80
 - 0s - loss: 3.1116 - val_loss: 1.4679
AUC: 0.8121

Epoch 3/80
 - 0s - loss: 2.1626 - val_loss: 0.9969
AUC: 0.8263

Epoch 4/80
 - 0s - loss: 1.7000 - val_loss: 0.9382
AUC: 0.8333

Epoch 5/80
 - 0s - loss: 1.4844 - val_loss: 0.8311
AUC: 0.8383

Epoch 6/80
 - 0s - loss: 1.4072 - val_loss: 0.9389
AUC: 0.8444

Epoch 7/80
 - 0s - loss: 1.3496 - val_loss: 0.8778
AUC: 0.8471

Epoch 8/80
 - 0s - loss: 1.3420 - val_loss: 0.8120
AUC: 0.8481

Epoch 9/80
 - 0s - loss: 1.3139 - val_loss: 0.8743
AUC: 0.8509

Epoch 10/80
 - 0s - loss: 1.2842 - val_loss: 0.8323
AUC: 0.8509

Epoch 11/80
 - 0s - loss: 1.2780 - val_loss: 0.8133
AUC: 0.8522

Epoch 12/80
 - 0s - loss: 1.2648 - val_loss: 0.7651
AUC: 0.8526

Epoch 13/80
 - 0s - loss: 1.2683 - val_loss: 0.7675
AUC: 0.8525

Epoch 14/80
 - 0s - loss: 1.2491 - val_loss: 0.7122
AUC: 0.8547

Epoch 15/80
 - 0s - loss: 1.2374 - val_loss: 0.7299
AUC: 0.8546

Epoch 16/80
 - 0s - loss: 1.2383 - val_loss: 0.8147
AUC: 0.8570

Epoch 17/80
 - 0s - loss: 1.2237 - val_loss: 0.7865
AUC: 0.8565

Epoch 18/80
 - 0s - loss: 1.2216 - val_loss: 0.7201
AUC: 0.8565

Epoch 19/80
 - 0s - loss: 1.2267 - val_loss: 0.7561
AUC: 0.8568

Epoch 20/80
 - 0s - loss: 1.2154 - val_loss: 0.6991
AUC: 0.8577

Epoch 21/80
 - 0s - loss: 1.2150 - val_loss: 0.7252
AUC: 0.8576

Epoch 22/80
 - 0s - loss: 1.2127 - val_loss: 0.7566
AUC: 0.8591

Epoch 23/80
 - 0s - loss: 1.2071 - val_loss: 0.6694
AUC: 0.8581

Epoch 24/80
 - 0s - loss: 1.2016 - val_loss: 0.7748
AUC: 0.8592

Epoch 25/80
 - 0s - loss: 1.2008 - val_loss: 0.8340
AUC: 0.8600

Epoch 26/80
 - 0s - loss: 1.2011 - val_loss: 0.7594
AUC: 0.8609

Epoch 27/80
 - 0s - loss: 1.1991 - val_loss: 0.7317
AUC: 0.8598

Epoch 28/80
 - 0s - loss: 1.1904 - val_loss: 0.8089
AUC: 0.8607

Epoch 29/80
 - 0s - loss: 1.1834 - val_loss: 0.7357
AUC: 0.8609

Epoch 30/80
 - 0s - loss: 1.1881 - val_loss: 0.7838
AUC: 0.8609

Epoch 31/80
 - 0s - loss: 1.1870 - val_loss: 0.7107
AUC: 0.8615

Epoch 32/80
 - 0s - loss: 1.1866 - val_loss: 0.6918
AUC: 0.8615

Epoch 33/80
 - 0s - loss: 1.1807 - val_loss: 0.6708
AUC: 0.8617

Epoch 34/80
 - 0s - loss: 1.1784 - val_loss: 0.7520
AUC: 0.8627

Epoch 35/80
 - 0s - loss: 1.1686 - val_loss: 0.7504
AUC: 0.8632

Epoch 36/80
 - 0s - loss: 1.1606 - val_loss: 0.7698
AUC: 0.8631

Epoch 37/80
 - 0s - loss: 1.1651 - val_loss: 0.7199
AUC: 0.8627

Epoch 38/80
 - 0s - loss: 1.1661 - val_loss: 0.7357
AUC: 0.8630

Epoch 39/80
 - 0s - loss: 1.1660 - val_loss: 0.7497
AUC: 0.8633

Epoch 40/80
 - 0s - loss: 1.1680 - val_loss: 0.7188
AUC: 0.8631

Epoch 41/80
 - 0s - loss: 1.1632 - val_loss: 0.7399
AUC: 0.8633

Epoch 42/80
 - 0s - loss: 1.1623 - val_loss: 0.7597
AUC: 0.8634

Epoch 43/80
 - 0s - loss: 1.1666 - val_loss: 0.7230
AUC: 0.8633

Epoch 44/80
 - 0s - loss: 1.1616 - val_loss: 0.7402
AUC: 0.8635

Epoch 45/80
 - 0s - loss: 1.1611 - val_loss: 0.7386
AUC: 0.8635

Epoch 46/80
 - 0s - loss: 1.1591 - val_loss: 0.7351
AUC: 0.8635

Epoch 47/80
 - 0s - loss: 1.1666 - val_loss: 0.7399
AUC: 0.8636

Epoch 48/80
 - 0s - loss: 1.1652 - val_loss: 0.7383
AUC: 0.8635

Epoch 49/80
 - 0s - loss: 1.1658 - val_loss: 0.7450
AUC: 0.8636

Epoch 50/80
 - 0s - loss: 1.1615 - val_loss: 0.7372
AUC: 0.8635

Epoch 51/80
 - 0s - loss: 1.1600 - val_loss: 0.7304
AUC: 0.8635

Epoch 52/80
 - 0s - loss: 1.1569 - val_loss: 0.7383
AUC: 0.8635

Epoch 53/80
 - 0s - loss: 1.1584 - val_loss: 0.7292
AUC: 0.8635

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 1.1594 - val_loss: 0.7289
AUC: 0.8635

Epoch 2/30
 - 0s - loss: 1.1597 - val_loss: 0.7629
AUC: 0.8640

Epoch 3/30
 - 0s - loss: 1.1555 - val_loss: 0.7427
AUC: 0.8638

Epoch 4/30
 - 0s - loss: 1.1651 - val_loss: 0.7168
AUC: 0.8637

Epoch 5/30
 - 0s - loss: 1.1537 - val_loss: 0.7258
AUC: 0.8641

Epoch 6/30
 - 0s - loss: 1.1529 - val_loss: 0.7409
AUC: 0.8642

Epoch 7/30
 - 0s - loss: 1.1524 - val_loss: 0.7263
AUC: 0.8643

Epoch 8/30
 - 0s - loss: 1.1498 - val_loss: 0.7301
AUC: 0.8642

Epoch 9/30
 - 0s - loss: 1.1490 - val_loss: 0.7349
AUC: 0.8642

Epoch 10/30
 - 0s - loss: 1.1475 - val_loss: 0.7518
AUC: 0.8646

Epoch 11/30
 - 0s - loss: 1.1456 - val_loss: 0.7224
AUC: 0.8644

Epoch 12/30
 - 0s - loss: 1.1416 - val_loss: 0.7300
AUC: 0.8646

Epoch 13/30
 - 0s - loss: 1.1500 - val_loss: 0.7327
AUC: 0.8648

Epoch 14/30
 - 0s - loss: 1.1416 - val_loss: 0.7350
AUC: 0.8646

Epoch 15/30
 - 0s - loss: 1.1410 - val_loss: 0.7265
AUC: 0.8646

Epoch 16/30
 - 0s - loss: 1.1381 - val_loss: 0.7238
AUC: 0.8647

Epoch 17/30
 - 0s - loss: 1.1413 - val_loss: 0.7191
AUC: 0.8647

Epoch 18/30
 - 0s - loss: 1.1423 - val_loss: 0.7296
AUC: 0.8648

Epoch 19/30
 - 0s - loss: 1.1406 - val_loss: 0.7306
AUC: 0.8648

Epoch 20/30
 - 0s - loss: 1.1431 - val_loss: 0.7288
AUC: 0.8649

Epoch 21/30
 - 0s - loss: 1.1373 - val_loss: 0.7260
AUC: 0.8649

Epoch 22/30
 - 0s - loss: 1.1415 - val_loss: 0.7240
AUC: 0.8649

Epoch 23/30
 - 0s - loss: 1.1413 - val_loss: 0.7297
AUC: 0.8649

Epoch 24/30
 - 0s - loss: 1.1401 - val_loss: 0.7263
AUC: 0.8650

Epoch 25/30
 - 0s - loss: 1.1385 - val_loss: 0.7268
AUC: 0.8650

Epoch 26/30
 - 0s - loss: 1.1378 - val_loss: 0.7268
AUC: 0.8650

Epoch 27/30
 - 0s - loss: 1.1323 - val_loss: 0.7249
AUC: 0.8650

Epoch 28/30
 - 0s - loss: 1.1402 - val_loss: 0.7245
AUC: 0.8650

Epoch 29/30
 - 0s - loss: 1.1427 - val_loss: 0.7255
AUC: 0.8650

Epoch 30/30
 - 0s - loss: 1.1392 - val_loss: 0.7260
Using TensorFlow backend.
AUC: 0.8650

2019-03-08 14:01:39.650496: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 14:01:39.819459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 14:01:39.819506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 14:01:40.127216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 14:01:40.127273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 14:01:40.127282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 14:01:40.127579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.7 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1324
Epoch 2/80
 - 2s - loss: 0.2145
Epoch 3/80
 - 2s - loss: 0.1715
Epoch 4/80
 - 2s - loss: 0.1621
Epoch 5/80
 - 2s - loss: 0.1526
Epoch 6/80
 - 2s - loss: 0.1422
Epoch 7/80
 - 2s - loss: 0.1319
Epoch 8/80
 - 2s - loss: 0.1220
Epoch 9/80
 - 2s - loss: 0.1127
Using TensorFlow backend.
Traceback (most recent call last):
  File "train_template_sub0228.py", line 136, in <module>
    verbose=2)
  File "/home/wsliu/Codes/DLproj/NRD/glove.py", line 105, in train_glove
    sample_weight=weights, callbacks=[checkpoint, reduce_lr, earlystop], verbose=verbose)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training.py", line 1037, in fit
    validation_steps=validation_steps)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/training_arrays.py", line 217, in fit_loop
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 77, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/callbacks.py", line 442, in on_epoch_end
    self.model.save_weights(filepath, overwrite=True)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/keras/engine/network.py", line 1115, in save_weights
    with h5py.File(filepath, 'w') as f:
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 312, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, swmr=swmr)
  File "/sw/lsa/centos7/python-anaconda-arc-connect/created-20170421/lib/python3.5/site-packages/h5py/_hl/files.py", line 148, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 98, in h5py.h5f.create
OSError: Unable to create file (unable to lock file, errno = 11, error message = 'Resource temporarily unavailable')
2019-03-08 14:02:15.761936: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-03-08 14:02:15.927496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K40m major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:82:00.0
totalMemory: 11.17GiB freeMemory: 11.09GiB
2019-03-08 14:02:15.927542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-03-08 14:02:16.235875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-03-08 14:02:16.235932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-03-08 14:02:16.235941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-03-08 14:02:16.236215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10748 MB memory) -> physical GPU (device: 0, name: Tesla K40m, pci bus id: 0000:82:00.0, compute capability: 3.5)
Updating co-occurrence matrix from a Dataframe with 35770 rows...
Finished. It takes 4.8 seconds to update the cooccurrences.
Preparing data...
Defining the GloVe model...
Training the GloVe model...
Epoch 1/80
 - 3s - loss: 1.1546
Epoch 2/80
 - 2s - loss: 0.2165
Epoch 3/80
 - 2s - loss: 0.1738
Epoch 4/80
 - 2s - loss: 0.1668
Epoch 5/80
 - 2s - loss: 0.1597
Epoch 6/80
 - 2s - loss: 0.1489
Epoch 7/80
 - 2s - loss: 0.1367
Epoch 8/80
 - 2s - loss: 0.1264
Epoch 9/80
 - 2s - loss: 0.1177
Epoch 10/80
 - 2s - loss: 0.1097
Epoch 11/80
 - 2s - loss: 0.1019
Epoch 12/80
 - 2s - loss: 0.0946
Epoch 13/80
 - 2s - loss: 0.0880
Epoch 14/80
 - 2s - loss: 0.0825
Epoch 15/80
 - 2s - loss: 0.0779
Epoch 16/80
 - 2s - loss: 0.0739
Epoch 17/80
 - 2s - loss: 0.0705
Epoch 18/80
 - 2s - loss: 0.0677
Epoch 19/80
 - 2s - loss: 0.0653
Epoch 20/80
 - 2s - loss: 0.0632
Epoch 21/80
 - 2s - loss: 0.0616
Epoch 22/80
 - 2s - loss: 0.0602
Epoch 23/80
 - 2s - loss: 0.0590
Epoch 24/80
 - 2s - loss: 0.0580
Epoch 25/80
 - 2s - loss: 0.0571
Epoch 26/80
 - 2s - loss: 0.0563
Epoch 27/80
 - 2s - loss: 0.0556
Epoch 28/80
 - 2s - loss: 0.0550
Epoch 29/80
 - 2s - loss: 0.0545
Epoch 30/80
 - 2s - loss: 0.0541
Epoch 31/80
 - 2s - loss: 0.0537
Epoch 32/80
 - 2s - loss: 0.0533
Epoch 33/80
 - 2s - loss: 0.0530
Epoch 34/80
 - 2s - loss: 0.0527
Epoch 35/80
 - 2s - loss: 0.0525
Epoch 36/80
 - 2s - loss: 0.0523
Epoch 37/80
 - 2s - loss: 0.0521
Epoch 38/80
 - 2s - loss: 0.0519
Epoch 39/80
 - 2s - loss: 0.0518
Epoch 40/80
 - 2s - loss: 0.0517
Epoch 41/80
 - 2s - loss: 0.0515
Epoch 42/80
 - 2s - loss: 0.0514
Epoch 43/80
 - 2s - loss: 0.0513
Epoch 44/80
 - 2s - loss: 0.0512
Epoch 45/80
 - 2s - loss: 0.0511
Epoch 46/80
 - 2s - loss: 0.0511
Epoch 47/80
 - 2s - loss: 0.0510
Epoch 48/80
 - 2s - loss: 0.0509
Epoch 49/80
 - 2s - loss: 0.0508
Epoch 50/80
 - 2s - loss: 0.0508
Epoch 51/80
 - 2s - loss: 0.0507
Epoch 52/80
 - 2s - loss: 0.0507
Epoch 53/80
 - 2s - loss: 0.0506
Epoch 54/80
 - 2s - loss: 0.0506
Epoch 55/80
 - 2s - loss: 0.0505
Epoch 56/80
 - 2s - loss: 0.0505
Epoch 57/80
 - 2s - loss: 0.0504
Epoch 58/80
 - 2s - loss: 0.0504
Epoch 59/80
 - 2s - loss: 0.0504
Epoch 60/80
 - 2s - loss: 0.0503
Epoch 61/80
 - 2s - loss: 0.0503
Epoch 62/80
 - 2s - loss: 0.0503
Epoch 63/80
 - 2s - loss: 0.0502
Epoch 64/80
 - 2s - loss: 0.0492
Epoch 65/80
 - 2s - loss: 0.0490
Epoch 66/80
 - 2s - loss: 0.0490
Epoch 67/80
 - 2s - loss: 0.0490
Epoch 68/80
 - 2s - loss: 0.0490
Epoch 69/80
 - 2s - loss: 0.0487
Epoch 70/80
 - 2s - loss: 0.0487
Epoch 71/80
 - 2s - loss: 0.0487
Epoch 72/80
 - 2s - loss: 0.0487
Epoch 73/80
 - 2s - loss: 0.0486
Epoch 74/80
 - 2s - loss: 0.0486
Epoch 75/80
 - 2s - loss: 0.0486
Epoch 76/80
 - 2s - loss: 0.0486
Epoch 77/80
 - 2s - loss: 0.0486
Epoch 78/80
 - 2s - loss: 0.0486
Epoch 79/80
 - 2s - loss: 0.0486
Epoch 80/80
 - 2s - loss: 0.0486
Finished. The pretrained embedding matrix can be retrieved by .get_embed_mat().
Train on 28616 samples, validate on 7154 samples
Epoch 1/80
 - 1s - loss: 4.4068 - val_loss: 0.6566
AUC: 0.7302

Epoch 2/80
 - 0s - loss: 2.1866 - val_loss: 0.6451
AUC: 0.7734

Epoch 3/80
 - 0s - loss: 1.6235 - val_loss: 0.5866
AUC: 0.7965

Epoch 4/80
 - 0s - loss: 1.2568 - val_loss: 0.5776
AUC: 0.8134

Epoch 5/80
 - 0s - loss: 1.0572 - val_loss: 0.5837
AUC: 0.8225

Epoch 6/80
 - 0s - loss: 0.9406 - val_loss: 0.4865
AUC: 0.8269

Epoch 7/80
 - 0s - loss: 0.8812 - val_loss: 0.5076
AUC: 0.8344

Epoch 8/80
 - 0s - loss: 0.8509 - val_loss: 0.5162
AUC: 0.8387

Epoch 9/80
 - 0s - loss: 0.8291 - val_loss: 0.4761
AUC: 0.8408

Epoch 10/80
 - 0s - loss: 0.8185 - val_loss: 0.4756
AUC: 0.8426

Epoch 11/80
 - 0s - loss: 0.8052 - val_loss: 0.5064
AUC: 0.8460

Epoch 12/80
 - 0s - loss: 0.7965 - val_loss: 0.4826
AUC: 0.8470

Epoch 13/80
 - 0s - loss: 0.7953 - val_loss: 0.4483
AUC: 0.8453

Epoch 14/80
 - 0s - loss: 0.7878 - val_loss: 0.4214
AUC: 0.8451

Epoch 15/80
 - 0s - loss: 0.7826 - val_loss: 0.4787
AUC: 0.8485

Epoch 16/80
 - 0s - loss: 0.7795 - val_loss: 0.4579
AUC: 0.8488

Epoch 17/80
 - 0s - loss: 0.7781 - val_loss: 0.5215
AUC: 0.8546

Epoch 18/80
 - 0s - loss: 0.7680 - val_loss: 0.4520
AUC: 0.8523

Epoch 19/80
 - 0s - loss: 0.7689 - val_loss: 0.4939
AUC: 0.8548

Epoch 20/80
 - 0s - loss: 0.7664 - val_loss: 0.4505
AUC: 0.8546

Epoch 21/80
 - 0s - loss: 0.7626 - val_loss: 0.4952
AUC: 0.8560

Epoch 22/80
 - 0s - loss: 0.7575 - val_loss: 0.4983
AUC: 0.8580

Epoch 23/80
 - 0s - loss: 0.7585 - val_loss: 0.4668
AUC: 0.8576

Epoch 24/80
 - 0s - loss: 0.7563 - val_loss: 0.4948
AUC: 0.8584

Epoch 25/80
 - 0s - loss: 0.7489 - val_loss: 0.4487
AUC: 0.8570

Epoch 26/80
 - 0s - loss: 0.7467 - val_loss: 0.4568
AUC: 0.8575

Epoch 27/80
 - 0s - loss: 0.7465 - val_loss: 0.4572
AUC: 0.8573

Epoch 28/80
 - 0s - loss: 0.7510 - val_loss: 0.4595
AUC: 0.8579

Epoch 29/80
 - 0s - loss: 0.7474 - val_loss: 0.4621
AUC: 0.8577

Epoch 30/80
 - 0s - loss: 0.7456 - val_loss: 0.4565
AUC: 0.8580

Epoch 31/80
 - 0s - loss: 0.7433 - val_loss: 0.4742
AUC: 0.8582

Epoch 32/80
 - 0s - loss: 0.7479 - val_loss: 0.4661
AUC: 0.8581

Epoch 33/80
 - 0s - loss: 0.7464 - val_loss: 0.4638
AUC: 0.8580

Epoch 34/80
 - 0s - loss: 0.7461 - val_loss: 0.4531
AUC: 0.8578

Epoch 35/80
 - 0s - loss: 0.7442 - val_loss: 0.4604
AUC: 0.8582

Epoch 36/80
 - 0s - loss: 0.7424 - val_loss: 0.4618
AUC: 0.8583

Epoch 37/80
 - 0s - loss: 0.7417 - val_loss: 0.4614
AUC: 0.8584

Epoch 38/80
 - 0s - loss: 0.7454 - val_loss: 0.4655
AUC: 0.8586

Epoch 39/80
 - 0s - loss: 0.7449 - val_loss: 0.4624
AUC: 0.8586

Epoch 40/80
 - 0s - loss: 0.7456 - val_loss: 0.4609
AUC: 0.8586

Epoch 41/80
 - 0s - loss: 0.7453 - val_loss: 0.4601
AUC: 0.8586

Epoch 42/80
 - 0s - loss: 0.7415 - val_loss: 0.4585
AUC: 0.8586

Epoch 43/80
 - 0s - loss: 0.7422 - val_loss: 0.4680
AUC: 0.8588

Epoch 44/80
 - 0s - loss: 0.7422 - val_loss: 0.4580
AUC: 0.8585

Train on 28616 samples, validate on 7154 samples
Epoch 1/30
 - 1s - loss: 0.7442 - val_loss: 0.4618
AUC: 0.8591

Epoch 2/30
 - 0s - loss: 0.7437 - val_loss: 0.4518
AUC: 0.8588

Epoch 3/30
 - 0s - loss: 0.7382 - val_loss: 0.4614
AUC: 0.8595

Epoch 4/30
 - 0s - loss: 0.7376 - val_loss: 0.4611
AUC: 0.8595

Epoch 5/30
 - 0s - loss: 0.7401 - val_loss: 0.4546
AUC: 0.8597

Epoch 6/30
 - 0s - loss: 0.7378 - val_loss: 0.4612
AUC: 0.8600

Epoch 7/30
 - 0s - loss: 0.7391 - val_loss: 0.4650
AUC: 0.8605

Epoch 8/30
 - 0s - loss: 0.7364 - val_loss: 0.4698
AUC: 0.8609

Epoch 9/30
 - 0s - loss: 0.7336 - val_loss: 0.4561
AUC: 0.8609

Epoch 10/30
 - 0s - loss: 0.7327 - val_loss: 0.4607
AUC: 0.8609

Epoch 11/30
 - 0s - loss: 0.7307 - val_loss: 0.4584
AUC: 0.8612

Epoch 12/30
 - 0s - loss: 0.7316 - val_loss: 0.4643
AUC: 0.8614

Epoch 13/30
 - 0s - loss: 0.7292 - val_loss: 0.4572
AUC: 0.8612

Epoch 14/30
 - 0s - loss: 0.7287 - val_loss: 0.4563
AUC: 0.8613

Epoch 15/30
 - 0s - loss: 0.7301 - val_loss: 0.4553
AUC: 0.8613

Epoch 16/30
 - 0s - loss: 0.7288 - val_loss: 0.4558
AUC: 0.8613

Epoch 17/30
 - 0s - loss: 0.7328 - val_loss: 0.4576
AUC: 0.8614

Epoch 18/30
 - 0s - loss: 0.7267 - val_loss: 0.4543
AUC: 0.8614

Epoch 19/30
 - 0s - loss: 0.7304 - val_loss: 0.4556
AUC: 0.8614

Epoch 20/30
 - 0s - loss: 0.7282 - val_loss: 0.4552
AUC: 0.8614

Epoch 21/30
 - 0s - loss: 0.7269 - val_loss: 0.4557
AUC: 0.8615

Epoch 22/30
 - 0s - loss: 0.7286 - val_loss: 0.4564
AUC: 0.8615

Epoch 23/30
 - 0s - loss: 0.7240 - val_loss: 0.4558
AUC: 0.8615

Epoch 24/30
 - 0s - loss: 0.7282 - val_loss: 0.4556
AUC: 0.8615

Epoch 25/30
 - 0s - loss: 0.7294 - val_loss: 0.4563
AUC: 0.8616

Epoch 26/30
 - 0s - loss: 0.7272 - val_loss: 0.4560
AUC: 0.8616

Epoch 27/30
 - 0s - loss: 0.7280 - val_loss: 0.4556
AUC: 0.8616

Epoch 28/30
 - 0s - loss: 0.7294 - val_loss: 0.4566
AUC: 0.8616

Epoch 29/30
 - 0s - loss: 0.7286 - val_loss: 0.4560
AUC: 0.8616

Epoch 30/30
 - 0s - loss: 0.7275 - val_loss: 0.4563
Using TensorFlow backend.
AUC: 0.8616

